{"meta":{"title":"å€¼å¾—è","subtitle":"å€¼å¾—æ¨èçš„åŸåˆ›æ–‡ç« ï¼ŒæŠ€æœ¯æ–‡ç« æˆ–æ˜¯ç§‘æ™®æ–‡ç« ","description":"åŒä¹ç§‘æŠ€","author":"1One's Dad","url":"http://www.wortyby.com"},"pages":[{"title":"404 Not Foundï¼šè¯¥é¡µæ— æ³•æ˜¾ç¤º","date":"2018-08-29T02:08:14.000Z","updated":"2018-08-29T05:24:24.000Z","comments":false,"path":"/404.html","permalink":"http://www.wortyby.com//404.html","excerpt":"","text":""},{"title":"tags","date":"2018-08-31T09:08:27.000Z","updated":"2018-08-31T09:13:13.000Z","comments":true,"path":"tags/index.html","permalink":"http://www.wortyby.com/tags/index.html","excerpt":"","text":""},{"title":"datastructure","date":"2018-08-31T09:09:28.000Z","updated":"2018-08-31T09:12:41.000Z","comments":true,"path":"datastructure/index.html","permalink":"http://www.wortyby.com/datastructure/index.html","excerpt":"","text":""},{"title":"categories","date":"2018-08-31T09:06:48.000Z","updated":"2018-08-31T09:12:59.000Z","comments":true,"path":"categories/index.html","permalink":"http://www.wortyby.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"æŒ‡æ ‡ä½“ç³»","slug":"metric_info","date":"2019-03-21T13:36:02.874Z","updated":"2019-03-21T14:47:06.521Z","comments":true,"path":"2019/03/21/metric_info/","link":"","permalink":"http://www.wortyby.com/2019/03/21/metric_info/","excerpt":"","text":"ç”¨æˆ· ä¼šå‘˜ç±»æŒ‡æ ‡* æ³¨å†Œä¼šå‘˜æ•° (ä¸€å®šç»Ÿè®¡å‘¨æœŸå†…çš„æ³¨å†Œä¼šå‘˜æ•°é‡) * æ´»è·ƒä¼šå‘˜æ•° (ä¸€å®šç»Ÿè®¡å‘¨æœŸå†…çš„æœ‰æ¶ˆè´¹æˆ–ç™»å½•è¡Œä¸ºçš„ä¼šå‘˜æ€»æ•°) * æ´»è·ƒä¼šå‘˜ç‡ (æ´»è·ƒä¼šå‘˜å æ³¨å†Œä¼šå‘˜æ€»æ•°çš„æ¯”é‡) * ä¼šå‘˜å¤è´­ç‡ (ç»Ÿè®¡å‘¨æœŸå†…ï¼Œäº§ç”ŸäºŒæ¬¡åŠäºŒæ¬¡ä»¥ä¸Šè´­ä¹°çš„ä¼šå‘˜å è´­ä¹°ä¼šå‘˜çš„æ€»æ•°) * ä¼šå‘˜å¹³å‡è´­ä¹°æ¬¡æ•° (æŒ‡ç»Ÿè®¡å‘¨æœŸå†…,æ¯ä¸ªä¼šå‘˜å¹³å‡è´­ä¹°çš„æ¬¡æ•°,ä¼šå‘˜è®¢å•æ€»æ•°/è´­ä¹°çš„ä¼šå‘˜ç”¨æˆ·æ€»æ•°) * ä¼šå‘˜å›è´­ç‡ (ä¸Šä¸€æœŸæœªæ´»è·ƒç”¨æˆ·åœ¨ä¸‹ä¸€æœŸæ—¶é—´å†…æœ‰è´­ä¹°è¡Œä¸ºçš„ä¼šå‘˜æ¯”ä¾‹) * ä¼šå‘˜ç•™å­˜ç‡ (è®¿é—®ä¹‹åï¼Œè¿‡ä¸€æ®µæ—¶é—´å‘¨æœŸåï¼Œè¿˜ä¼šç»§ç»­è®¿é—®æ´»åŠ¨,æ´»åŠ¨å‘¨æœŸä¸€èˆ¬æ˜¯æ—¥ã€å‘¨ã€æœˆã€åŠå¹´åº¦) * æ–°ä¼šå‘˜ç•™å­˜ç‡(å¯ä»¥æŒ‰æ´»è·ƒåº¦è®¡ç®—) * æ–°ä¼šå‘˜ç•™å­˜ç‡(å¯ä»¥æŒ‰æ¶ˆè´¹çº¬åº¦è®¡ç®—) * æ´»è·ƒç”¨æˆ·ç•™å­˜ç‡ è®¢å• è®¢å•ç”Ÿäº§ç‡æŒ‡æ ‡* æ€»è®¢å•æ•°é‡(è®¢å•æ•°ä¹‹å’Œï¼Œæ´»åŠ¨ID) * æ€»è®¢å•æ•°é‡(è®¢å•æ•°ä¹‹å’Œï¼Œæ´»åŠ¨å‘¨æœŸå…¨å¹³å°) * è®¿é—®åˆ°ä¸‹å•è½¬åŒ–ç‡(ä¸‹å•æ¬¡æ•°ä¸è®¿é—®æ¬¡æ•°ä¹‹æ¯”,æ´»åŠ¨ID) * è®¿é—®åˆ°ä¸‹å•è½¬åŒ–ç‡(ä¸‹å•æ¬¡æ•°ä¸è®¿é—®æ¬¡æ•°ä¹‹æ¯”ï¼Œæ´»åŠ¨å‘¨æœŸå†…å¹³å°æ€»çš„) æ€»ä½“é”€å”®ä¸šç»©æŒ‡æ ‡* GMV(æˆäº¤é¢ï¼Œåªç»Ÿè®¡è®¢å•å·é‡‘é¢) * é”€å”®é‡‘é¢(å‡ºå”®çš„é‡‘é¢æ€»é¢) * å®¢å•ä»·(è®¢å•é‡‘é¢/è®¢å•æ•°é‡ æ¯”å€¼) ç»Ÿè®¡ç±»æŒ‡æ ‡* é€€æ¬¾è®¢å•æ•°(ä¾æ®æ”¯ä»˜çŠ¶æ€) * æ´»åŠ¨ID * æ´»åŠ¨å‘¨æœŸå…¨å¹³å° * ä¼šå‘˜/éä¼šå‘˜è®¢å•æ¯”ä¾‹(å‚ä¸æ´»åŠ¨) * æ´»åŠ¨ID * æ´»åŠ¨å‘¨æœŸå…¨å¹³å° * è®¢å•åˆ†å¸ƒçŠ¶æ€ * åŸå¸‚(è®¢å•æ€»æ•°,å–æ¶ˆè®¢å•æ•°,URN,SRN,OCC) * æ´»åŠ¨ID * æ´»åŠ¨å‘¨æœŸå…¨å¹³å° * æ¸ é“(è®¢å•æ€»æ•°,å–æ¶ˆè®¢å•æ•°,URN,SRN,OCC) * æ´»åŠ¨ID * æ´»åŠ¨å‘¨æœŸå…¨å¹³å° * é…’åº—(è®¢å•æ€»æ•°ï¼Œå–æ¶ˆè®¢å•æ•°ï¼Œæ”¯ä»˜æ€»èµ„é‡‘,URN,SRN,OCC)) * æ´»åŠ¨ID * æ´»åŠ¨å‘¨æœŸå…¨å¹³å° * é£æ§ç»Ÿè®¡å¯¹è±¡ * äººå‘˜ä¿¡æ¯ * è®¢å•æ•° * ç”¨æˆ·å†å²å®Œæˆè®¢å•æ•° * ç”¨æˆ·å†å²å–æ¶ˆè®¢å•æ•° * å½“æ—¥å…¥ä½é€€æˆ¿æ€»è®¢å•æ•° * å…¥ä½æ—¶é•¿å°äº5å°æ—¶æ€»è®¢å•æ•° * å…¥ä½æ—¶é—´åœ¨23:00-05:00 æ€»è®¢å•æ•°(åŠå¤œé€€æˆ¿) * ç”¨æˆ·å†å²å½“æ—¥é€€æˆ¿è®¢å•æ•° * ç”¨æˆ·å†å²åŠå¤œé€€æˆ¿è®¢å•æ•° * ç”¨æˆ·å…¥ä½æ—¶é•¿å°äº5å°æ—¶è®¢å•æ•° * ç”¨æˆ·å…¥ä½æ—¶é—´åœ¨23:00-05:00 æ€»è®¢å•æ•°(åŠå¤œé€€æˆ¿) * å­˜é‡å®¢æˆ·å„é¡¹é¢„è®¢é—´éš”è®¢å•æ•°(å½“å¤©ï¼Œæå‰ä¸€è‡³ä¸‰å¤©ï¼Œæå‰3-10å¤©ï¼Œæå‰10å¤©ä»¥ä¸Š) * å®¢æˆ·è®¢å•æ•°(å‘¨ä¸€è‡³å‘¨æ—¥) * ç”¨æˆ·åœ¨å½“æ—¥ä¸‹å•æ€»æ•°é‡Œæ‰€å çš„æ¬¡æ•°è´¡çŒ®(æ¯”å¦‚ è®¢å•æ€»æ•° 100æ¬¡ï¼Œç”¨æˆ·æ•°å°±2æ¬¡) * é‡‘é¢ * ç”¨æˆ·å†å²å®Œæˆæ€»é‡‘é¢ * ç”¨æˆ·ç»Ÿè®¡åˆ†å¸ƒ * å½“æ—¥æ³¨å†Œç”¨æˆ·æ€»æ•° * åŸå¸‚å½“æ—¥æ³¨å†Œç”¨æˆ·æ€»æ•° * å½“æ—¥é¢„è®¢ç”¨æˆ·æ€»æ•° * åŸå¸‚å½“æ—¥é¢„è®¢ç”¨æˆ·æ€»æ•° * å½“æ—¥å…¥ä½ç”¨æˆ·æ€»æ•° * åŸå¸‚å½“æ—¥å…¥ä½ç”¨æˆ·æ€»æ•° * å½“æ—¥æ³¨å†Œä¸”å…¥ä½ç”¨æˆ·æ€»æ•° * å½“æ—¥æ¨èæ³¨å†Œç”¨æˆ·æ€»æ•° * æ´»åŠ¨æ—¥é‡å¤ç”¨æˆ·æ•°(è®¡ç®—å‚åŠ å†å²æ´»åŠ¨æ—¥çš„é‡å¤å®¢æˆ·çš„æ•°é‡) * å†å²æ³¨å†Œç”¨æˆ·æ•°æ‰‹æœºå“ç‰Œåˆ†å¸ƒ * å†å²æ³¨å†Œç”¨æˆ·æ•°æ‰‹æœºå·å½’å±åœ°åˆ†å¸ƒ * å†å²æ³¨å†Œç”¨æˆ·æ•°æ‰‹æœºè¿è¥å•†åˆ†å¸ƒ * åƒµå°¸ç”¨æˆ·æ•° * æ—¥æ´»è·ƒç”¨æˆ·æ•°(DAU) * ç‹¬ç«‹è®¿å®¢(UV) * æ—¥è®¿é—®é¡µé¢æ•° * æ—¥åœç•™æ—¶é•¿ * æ—¥è®¿é—®è¡Œä¸ºæ•°é‡ * å†å²é¢„å®šä¸åŒé…’åº—æ•°çš„æ•°é‡ * é¢„å®šä¸åŒé—´å¤œçš„ç”¨æˆ·æ•° * å†å²é¢„å®šåŸå¸‚çš„æ•°é‡ * é¢„å®šä¸åŒé…’åº—æ•°çš„ç”¨æˆ·æ•°é‡ * æ¸ é“ * è®¢å•æ•° * å„æ¸ é“å½“æ—¥é¢„è®¢å•æ•° * å„æ¸ é“å†å²é¢„è®¢å•æ•° * é‡‘é¢ * å„æ¸ é“å†å²å®Œæˆæ€»é‡‘é¢ * å„æ¸ é“å½“æ—¥å®Œæˆæ€»é‡‘é¢ * å•†å“ * é‡‘é¢ æˆ¿é—´æœ€é«˜ä»·æ ¼å†å²æ³¢åŠ¨(è®¡ç®—ä¸€å‘¨å†…çš„æœ€é«˜ä»·/å¹³å‡ä»·) * è¥é”€ * é‡‘é¢åˆ†å¸ƒ * é¦–æ¬¡é¢„è®¢æŠ˜æ‰£é‡‘é¢ * å„æ¬¡é¢„å®šçš„æŠ˜æ‰£é‡‘é¢ * è®¢å•æ•° * é¦–æ¬¡é¢„è®¢æœ‰æŠ˜æ‰£çš„è®¢å•æ•° * é¢„è®¢æŠ˜æ‰£ä½äº95%çš„è®¢å•æ•° * è¥é”€æ´»åŠ¨æœŸé—´çš„è®¢å•æ•° * è¥é”€æ´»åŠ¨æœŸé—´å„åŸå¸‚çš„è®¢å•æ•° * ä¼˜æƒ åˆ¸ * å„åˆ¸å†å²å·²ä½¿ç”¨æ€»é‡ * å„åˆ¸å·²å¤±æ•ˆæ•°é‡ * å„åˆ¸å­˜é‡æ•°é‡ * ç”¨æˆ·æ•° * è¥é”€æ´»åŠ¨æœŸé—´æ–°å¢ç”¨æˆ·æ•° è¥é”€ æ¸ é“* å¤–éƒ¨æ¸ é“ * æ¸ é“æ–°å¢ç”¨æˆ· * æ¸ é“æ–°å¢è®¢å• æ´»åŠ¨* æ•ˆæœè¯„ä¼° * æ–°å¢ç”¨æˆ·æ•° * æ–°å¢æ³¨å†Œäººæ•° * æ€»è®¿é—®æ¬¡æ•° * è®¢å•æ•°é‡ * ä¸‹å•è½¬åŒ–ç‡ * ROI * æ´»åŠ¨æœŸé—´ç”¨æˆ·æ´»è·ƒåº¦ * æ´»åŠ¨å±•ç°æ¸ é“ * æ´»åŠ¨å‘¨æœŸ * ä¸åŒæ´»åŠ¨æ•´ä½“ç¯æ¯”å¢é•¿ç‡ * ä¼˜æƒ åˆ¸ * é¢†å–ç”¨æˆ·æ•° * é¢†å–å¹¶æ¶ˆè´¹ç”¨æˆ·æ•° * ä¼˜æƒ åˆ¸è¿‡æœŸä»æœªæ¶ˆè´¹ç”¨æˆ·æ•° * å®æ—¶ç›‘æµ‹ç±»æŒ‡æ ‡ * å½“å‰æ´»åŠ¨æ€»è®¿é—®ç”¨æˆ·æ•° * è¿‘ä¸€å‘¨æœŸçš„æœ€ä½è®¿é—®æ•° * è¿‘ä¸€å‘¨æœŸçš„æœ€é«˜è®¿é—®æ•° * ä»Šæ—¥è®¿é—®ç”¨æˆ·æ¦‚å†µ * è®¿é—®ç”¨æˆ·æ€»æ•° * ç™»å½•è€ç”¨æˆ·æ€»æ•° * ç™»å½•æ–°ç”¨æˆ·æ€»æ•° * ä¸‹å•ç”¨æˆ·æ€»æ•° * æ³¨å†Œç”¨æˆ·æ€»æ•° * ç”¨æˆ·è®¿é—®æ•°åˆ†æ—¶å›¾ * ç”¨æˆ·æœç´¢æ´»åŠ¨æ•°åˆ†æ—¶å›¾ * å®æ—¶ç”¨æˆ·è¡Œä¸º 12user_id action page timestamp&apos;å¼ ä¸‰&apos; &apos;è®¿é—®äº†&apos; &apos;æ´»åŠ¨é¦–é¡µ&apos; &apos;2019-03-18&apos; * å®æ—¶æ´»åŠ¨é¡µé¢è¢«è®¿é—®æ¬¡æ•°æ’å * æ´»åŠ¨é¦–é¡µæ¬¡æ•° * æ´»åŠ¨è¯¦æƒ…é¡µæ¬¡æ•° * æ´»åŠ¨ä¸‹å•é¡µæ¬¡æ•° * åº“å­˜å˜åŒ– * åº“å­˜é…’åº—å˜åŒ–æ’å * åº“å­˜æˆ¿å‹å˜åŒ–æ’å * åº“å­˜æˆ¿å‹æ¶ˆè´¹ä»·æ ¼å˜åŒ–æ’å æµé‡ç±»æŒ‡æ ‡ è§„æ¨¡ç±»æŒ‡æ ‡* UV(ç‹¬ç«‹è®¿å®¢æ•°) * PV(é¡µé¢è®¿é—®æ•°) * PV/UV(äººå‡é¡µé¢è®¿é—®æ•°,ååº”è®¿é—®ç²˜æ€§å˜åŒ–) æµé‡è´¨é‡ç±»æŒ‡æ ‡* è·³å‡ºç‡(æµè§ˆå•é¡µå³é€€å‡ºçš„æ¬¡æ•°/è¯¥é¡µè®¿é—®æ¬¡æ•°,ä¸»è¦æ˜¯æ¥åˆ¤æ–­æ¨å¹¿æ¸ é“ç›®æ ‡äººç¾¤å’Œæ¨å¹¿æ´»åŠ¨å†…å®¹åŒ¹é…ç¨‹åº¦) * é¡µé¢è®¿é—®æ—¶é•¿(å•ä¸ªé¡µé¢è¢«è®¿é—®çš„æ—¶é—´)ï¼Œç»“åˆè½¬åŒ–ç‡çœ‹ï¼Œè¯„åˆ¤é¡µé¢ä½“éªŒè®¾è®¡ * äººå‡é¡µé¢æµè§ˆé‡(ç»Ÿè®¡å‘¨æœŸå†…ï¼Œå¹³å‡æ¯ä¸ªè®¿å®¢æ‰€æµè§ˆçš„é¡µé¢é‡) å•†å“(é…’åº—) è½¬åŒ–ç±»æŒ‡æ ‡* æ”¶è—ç‡ * ä¸‹å•ç‡ * æ”¯ä»˜ç‡ * è¯„ä»·ç‡ åº“å­˜ç±»æŒ‡æ ‡* åº“å­˜æ¶ˆè´¹çš„é…’åº—åˆ†å¸ƒ * é…’åº—ä½ç½®(åŸå¸‚,å…·ä½“åœ°æ®µå¯èƒ½éœ€è¦ä½¿ç”¨å¤–éƒ¨æ¥å£æ•°æ®) * é…’åº—æ€»æˆ¿é—´æ•° * å‚ä¸æ´»åŠ¨æˆ¿é—´æ•° * æ¶ˆè´¹å‰ç”¨æˆ·çš„é…’åº—æµè§ˆè®°å½•(ä¸»è¦çœ‹ç”¨æˆ·æ˜¯ç¬¬ä¸€é€‰æ‹©è¿˜æ˜¯å¤‡é€‰) * åº“å­˜æ¶ˆè´¹çš„æˆ¿å‹åˆ†å¸ƒ * æˆ¿å‹é…ç½® * æˆ¿å‹ä»·ä½ * åŸå¸‚ä½ç½® * æ¶ˆè´¹å‰ç”¨æˆ·çš„é…’åº—æµè§ˆè®°å½•(ä¸»è¦çœ‹ç”¨æˆ·æ˜¯ç¬¬ä¸€é€‰æ‹©è¿˜æ˜¯å¤‡é€‰) * åº“å­˜æ¶ˆè´¹çš„æ´»åŠ¨ä»·ä½åˆ†å¸ƒ * åŸå¸‚ä½ç½® * é…’åº—ç±»å‹ * é…’åº—è§„æ¨¡ * æ¶ˆè´¹å‰ç”¨æˆ·çš„é…’åº—æµè§ˆè®°å½•(ä¸»è¦çœ‹ç”¨æˆ·æ˜¯ç¬¬ä¸€é€‰æ‹©è¿˜æ˜¯å¤‡é€‰)","categories":[{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"http://www.wortyby.com/categories/æ•°æ®åˆ†æ/"}],"tags":[{"name":"è®¢å•åˆ†æ","slug":"è®¢å•åˆ†æ","permalink":"http://www.wortyby.com/tags/è®¢å•åˆ†æ/"},{"name":"æŒ‡æ ‡","slug":"æŒ‡æ ‡","permalink":"http://www.wortyby.com/tags/æŒ‡æ ‡/"}]},{"title":"ç¦»çº¿æ•°æ®åˆ†æå¹³å°å®æˆ˜-è®¢å•åˆ†æ","slug":"ç¦»çº¿æ•°æ®åˆ†æå¹³å°å®æˆ˜-è®¢å•åˆ†æ","date":"2019-02-20T09:02:55.754Z","updated":"2019-02-21T13:01:53.731Z","comments":true,"path":"2019/02/20/ç¦»çº¿æ•°æ®åˆ†æå¹³å°å®æˆ˜-è®¢å•åˆ†æ/","link":"","permalink":"http://www.wortyby.com/2019/02/20/ç¦»çº¿æ•°æ®åˆ†æå¹³å°å®æˆ˜-è®¢å•åˆ†æ/","excerpt":"","text":"ç°åœ¨ç”µå•†è¡Œä¸šç”±äºä¸šåŠ¡å‘è¾¾ï¼Œå¯èƒ½ä¼šæ¶‰åŠåˆ°å…·ä½“åˆ†æï¼Œæ˜¯å“ªé‡Œçš„å“ªäº›ç”¨æˆ·ï¼Œä¼šå¯¹è¯¥ç”µå•†å¹³å°çš„äº§å“æ„Ÿå…´è¶£ï¼Œè¯¥ç”¨æˆ·ä»å“ªé‡Œè¿›æ¥ï¼Œè¯¥ç”¨æˆ·è®¿é—®çš„æ·±åº¦ä¿¡æ¯ç­‰ï¼Œä¸‹é¢ç®€å•æè¿°ä¸€ä¸‹ï¼Œè¦åˆ†æè¿™äº›å†…å®¹ï¼Œè¯¥ä»å“ªäº›æ–¹é¢å…¥æ‰‹ï¼Œå…·ä½“çš„å¯ä»¥ä»ä»¥ä¸‹ä¿¡æ¯çœ‹åˆ°ã€‚ é¡¹ç›® wbs æ­¥éª¤æ¨¡å—åç§°çŠ¶æ€æ£€æŸ¥è¯­è¨€ç”¨æˆ·åŸºæœ¬ä¿¡æ¯åˆ†æâˆšsparkæµè§ˆå™¨ä¿¡æ¯åˆ†æ(UA)âˆšsparkåœ°åŸŸä¿¡æ¯åˆ†æâˆšsparkå¤–é“¾ä¿¡æ¯åˆ†æâˆšsparkç”¨æˆ·æµè§ˆæ·±åº¦åˆ†æâˆšsparkè®¢å•åˆ†æå…·ä½“è¦å†™ä»£ç çš„sparkäº‹ä»¶åˆ†æå…·ä½“è¦å†™ä»£ç çš„sparké€šè¿‡ä¸€ä¸ªairflow ä»»åŠ¡è°ƒåº¦æ¨¡å—ï¼Œå½¢æˆä¸€ä¸ªä¾èµ–çš„dags å…³ç³»å›¾ï¼Œè¿›è€Œå½¢æˆä¸€ä¸ªå›ºå®šå·¥ä½œæµç¨‹ã€‚ æ¨¡å—ä»‹ç»è®¢å•åˆ†æ åˆ†åˆ«åˆ†æ è®¢å•çš„æ•°é‡ã€è®¢å•çš„é‡‘é¢ã€ä»¥åŠå°†è®¢å•åˆ†ä¸º æ€»è®¢å• ã€æ”¯ä»˜æˆåŠŸè®¢å• ä»¥åŠ é€€æ¬¾è®¢å• ä¸‰ç§ç±»å‹çš„æ•°æ®ï¼Œé€šè¿‡è¿™å…­ä¸ªåˆ†ææŒ‡æ ‡çš„æ•°æ®æˆ‘ä»¬å¯ä»¥æŒ‡å®šç½‘ç«™çš„è®¢å•æƒ…å†µã€‚ è®¡ç®—è§„åˆ™å’Œç»Ÿè®¡stats_event&amp;stats_view_depthè¡¨çš„æ•°æ®ä¸å¤ªä¸€æ ·ï¼Œæˆ‘ä»¬é‡‡ç”¨æ¯ä¸ªç»Ÿè®¡æŒ‡æ ‡å†™ä¸€ä¸ªhqlè¯­å¥+sqoopè¯­å¥çš„æ–¹æ³•è¿›è¡Œæ•°æ®çš„æ’å…¥æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´åˆ†åˆ«ç»Ÿè®¡è®¢å•æ•°é‡å’Œè®¢å•é‡‘é¢ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸€å¼ hiveè¡¨åŒæ—¶ä¿å­˜å¤šä¸ªæŒ‡æ ‡çš„æ•°æ®ï¼Œè€Œæ˜¯é‡‡ç”¨å¤šä¸ªè¡¨åˆ†åˆ«ä¿å­˜ä¸åŒæŒ‡æ ‡çš„æ•°æ®æˆ–è€…é‡‡ç”¨ä¸€å¼ è¡¨éåŒæ—¶çš„ä¿å­˜å¤šä¸ªæŒ‡æ ‡çš„æ•°æ®ã€‚åˆ†åˆ«ç»Ÿè®¡oidçš„å»é‡æ•°é‡ä½œä¸ºè®¢å•æ•°é‡ï¼Œä½¿ç”¨å»é‡åçš„è®¢å•çš„æ”¯ä»˜é‡‘é¢ä½œä¸ºè®¢å•é‡‘é¢ã€‚æœ€ç»ˆæ•°æ®ä¿å­˜ï¼šstats_orderã€‚æ¶‰åŠåˆ°æ‰€æœ‰åˆ—ã€‚æ¶‰åŠåˆ°å…¶ä»–è¡¨æœ‰dimension_platformã€dimension_dateã€dimension_currency_typeã€dimension_payment_type. ä»£ç æ­¥éª¤hive ä¸­åˆ›å»º hbase å¯¹åº”çš„å¤–éƒ¨è¡¨;è®¢å•æ•°é‡&amp;è®¢å•é‡‘é¢çš„ hive &amp; sqoop åˆ†æ;å®ç°è‡ªå®šä¹‰ UDF &amp; è‡ªå®šä¹‰å‡½æ•°åˆ›å»ºhive + sqoop è„šæœ¬æˆåŠŸæ”¯ä»˜è®¢å•æ•°é‡ &amp; é‡‘é¢ &amp; æ€»é‡‘é¢çš„ hive &amp; sqoop åˆ†æè®¢å•æ•°æ®ä¿å­˜mysql;å®ç°è‡ªå®šä¹‰ udf &amp; è‡ªå®šä¹‰å‡½æ•°åˆ›å»ºhive + sqoop è„šæœ¬é€€æ¬¾è®¢å•æ•°é‡ &amp; é‡‘é¢ &amp; æ€»é‡‘é¢çš„ hive &amp; sqoop åˆ†æshell è„šæœ¬ç¼–å†™ä»¥åŠæµ‹è¯•","categories":[{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"http://www.wortyby.com/categories/æ•°æ®åˆ†æ/"}],"tags":[{"name":"è®¢å•åˆ†æ","slug":"è®¢å•åˆ†æ","permalink":"http://www.wortyby.com/tags/è®¢å•åˆ†æ/"},{"name":"åˆ†ææ–¹æ³•","slug":"åˆ†ææ–¹æ³•","permalink":"http://www.wortyby.com/tags/åˆ†ææ–¹æ³•/"}]},{"title":"æ•°æ®åˆ†æå¸¸è§æŒ‡æ ‡","slug":"æ•°æ®åˆ†æå¸¸è§æŒ‡æ ‡","date":"2019-02-20T08:20:58.160Z","updated":"2019-02-20T08:41:19.024Z","comments":true,"path":"2019/02/20/æ•°æ®åˆ†æå¸¸è§æŒ‡æ ‡/","link":"","permalink":"http://www.wortyby.com/2019/02/20/æ•°æ®åˆ†æå¸¸è§æŒ‡æ ‡/","excerpt":"","text":"é€šå¸¸å¯¹ä¸€ä¸ªäº‹æƒ…çš„è¯„ä»·ï¼Œä¼šæœ‰ä¸€ä¸ªé‡åŒ–çš„æŒ‡æ ‡ï¼Œå³ä¸€ä¸ªé‡åŒ–æ ‡å‡†ï¼Œè¿™é‡Œæˆ‘ä»¬è®²ä¸‹é€šå¸¸ç”¨æ¥è¯„ä»·ä¸€ä¸ªç½‘ç«™çš„å¥½åï¼Œä¼šæ¶‰åŠåˆ°ä»¥ä¸‹å†…å®¹ã€‚ ä»€ä¹ˆæ˜¯å±•ç°é‡ã€ç‚¹å‡»é‡ã€ç‚¹å‡»ç‡åœ¨ç™¾åº¦æ¨å¹¿åå°å¯ä»¥çœ‹åˆ°æ¶ˆè´¹ã€å¹³å‡ä»·æ ¼ã€ç‚¹å‡»ã€å±•ç°ã€ç‚¹å‡»ç‡ã€åƒæ¬¡å±•ç°è´¹ç”¨ç­‰æ•°æ®ï¼Œè¿™äº›æ•°æ®æ˜¯ä½ å…¨é¢è¯„ä¼°æ¨å¹¿æ•ˆæœã€æ·±å…¥å¼€å±•æ¨å¹¿ä¼˜åŒ–çš„åŸºç¡€ã€‚åœ¨ç½‘æ°‘æœç´¢æŸ¥è¯¢æ—¶ï¼Œå¦‚æœæ‚¨è´¦æˆ·å†…ç¬¦åˆç½‘æ°‘æœç´¢éœ€æ±‚çš„å…³é”®è¯è¢«è§¦å‘ï¼Œè¯¥å…³é”®è¯æ‰€å¯¹åº”çš„åˆ›æ„å°†å‡ºç°åœ¨æœç´¢ç»“æœé¡µï¼Œç§°ä¹‹ä¸ºå…³é”®è¯å’Œåˆ›æ„çš„ä¸€æ¬¡å±•ç°ã€‚ä¸€æ®µæ—¶é—´å†…æ‚¨è·å¾—çš„å±•ç°æ¬¡æ•°ç§°ä¹‹ä¸º â€œå±•ç°é‡â€ã€‚å±•ç°é‡ä½“ç°äº†ä½ çš„å…³é”®è¯è´¨é‡åº¦å’Œåˆ›æ„çš„å¥½åï¼ˆå¦‚æœä½ çš„åˆ›æ„å±•ç°æ–¹å¼æ˜¯ä¼˜å…ˆå±•ç°çš„è¯ï¼‰ã€‚åœ¨æ‚¨çš„æ¨å¹¿ç»“æœå±•ç°æ—¶ï¼Œå¦‚æœç½‘æ°‘å¯¹æ‚¨çš„æ¨å¹¿ç»“æœæ„Ÿå…´è¶£ï¼Œå¸Œæœ›è¿›ä¸€æ­¥åœ°äº†è§£æ‚¨çš„äº§å“/æœåŠ¡ï¼Œå¯èƒ½å°†ä¼šç‚¹å‡»è®¿é—®æ‚¨çš„ç½‘ç«™ã€‚ä¸€æ®µæ—¶é—´å†…æ‚¨è·å¾—çš„ç‚¹å‡»æ¬¡æ•°ç§°ä¹‹ä¸ºâ€œç‚¹å‡»é‡â€ã€‚ç®€å•çš„è¯´ï¼Œç‚¹å‡»é‡æŒ‡ä½ çš„åˆ›æ„è¢«ç‚¹å‡»çš„æ¬¡æ•°ã€‚ ç‚¹å‡»é‡/å±•ç°é‡=ç‚¹å‡»ç‡ã€‚ç‚¹å‡»ç‡ä½“ç°ä½ çš„åˆ›æ„çš„å¸å¼•åŠ›ã€‚ å¦‚ä½•ç”¨å¥½å±•ç°é‡ã€ç‚¹å‡»ç‡è®©æ¨å¹¿æ›´é«˜æ•ˆï¼Ÿå±•ç°é‡æœ‰åŠ©äºæ‚¨äº†è§£æ¨å¹¿ç»“æœè¦†ç›–äº†å¤šå°‘ç½‘æ°‘ï¼Œæ˜¯ä¸€ä¸ªæ•°é‡ä¸Šçš„æ¦‚å¿µã€‚é€šè¿‡ç»Ÿè®¡æŠ¥å‘Šæä¾›çš„å±•ç°é‡æ•°æ®ï¼Œæ‚¨å¯ä»¥å‘ç°å“ªäº›å…³é”®è¯åˆ›æ„çš„å±•ç°æœºä¼šè¾ƒå¤§ï¼Œæ¯å¤©èƒ½å¤Ÿç»™æ‚¨å¸¦æ¥å¤šå°‘æ¬¡çš„æ›å…‰æœºä¼šï¼Œä»è€Œä¼°ç®—å‡ºæ‚¨çš„æ¨å¹¿æ´»åŠ¨èƒ½å¤Ÿè¦†ç›–åˆ°å¤šå°‘æ•°é‡çš„æ½œåœ¨å®¢æˆ·ã€‚å¦‚æœæ‚¨çš„æ‰€æœ‰å…³é”®è¯æ¯å¤©åˆè®¡çš„å±•ç°é‡ä¸€ç›´æ¯”è¾ƒå°‘ï¼Œæ— æ³•è®©æ‚¨çš„æ¨å¹¿ç»“æœå¾—åˆ°å……åˆ†çš„æ›å…‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»ºè®®æ‚¨å¯ä»¥è€ƒè™‘æäº¤æ›´å¤šçš„å…³é”®è¯ï¼Œå¹¶é‡‡ç”¨å¹¿æ³›åŒ¹é…ï¼Œä»è€Œè¾¾åˆ°è¦†ç›–æ›´å¤šæ½œåœ¨å®¢æˆ·çš„ç›®çš„ã€‚ ä»€ä¹ˆæ˜¯è®¿å®¢æ•°(UV)è®¿å®¢æ•°å°±æ˜¯æŒ‡ä¸€å¤©ä¹‹å†…åˆ°åº•æœ‰å¤šå°‘ä¸åŒçš„ç”¨æˆ·è®¿é—®äº†ä½ çš„ç½‘ç«™ã€‚è®¿å®¢æ•°è¦æ¯”IPæ•°æ›´èƒ½çœŸå®å‡†ç¡®åœ°åæ˜ ç”¨æˆ·æ•°é‡ã€‚ç™¾åº¦ç»Ÿè®¡å®Œå…¨æŠ›å¼ƒäº†IPè¿™ä¸ªæŒ‡æ ‡ï¼Œè€Œå¯ç”¨äº†è®¿å®¢æ•°è¿™ä¸€æŒ‡æ ‡ï¼Œæ˜¯å› ä¸ºIPå¾€å¾€ä¸èƒ½åæ˜ çœŸå®çš„ç”¨æˆ·æ•°é‡ã€‚å°¤å…¶å¯¹äºä¸€äº›æµé‡è¾ƒå°‘çš„ä¼ä¸šç«™æ¥è¯´ï¼ŒIPæ•°å’Œè®¿å®¢æ•°ä¼šæœ‰ä¸€å®šçš„å·®åˆ«ã€‚è®¿å®¢æ•°ä¸»è¦æ˜¯ä»¥cookieä¸ºä¾æ®æ¥è¿›è¡Œåˆ¤æ–­çš„ï¼Œè€Œæ¯å°ç”µè„‘çš„cookieä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚æœ‰äº›æƒ…å†µä¸‹IPæ•°ä¼šå¤§äºçœŸå®çš„è®¿å®¢æ•°ã€‚æœ‰æ—¶å€™è®¿å®¢æ•°ä¹Ÿä¼šå¤§äºIPæ•°ã€‚è®¿å®¢æ•°è¦æ¯”IPæ•°æ›´èƒ½çœŸå®å‡†ç¡®åœ°åæ˜ ç”¨æˆ·æ•°é‡ã€‚ ä»€ä¹ˆæ˜¯è®¿é—®æ¬¡æ•°è®¿é—®æ¬¡æ•°æ˜¯æŒ‡è®¿å®¢å®Œæ•´æ‰“å¼€äº†ç½‘ç«™é¡µé¢è¿›è¡Œè®¿é—®çš„æ¬¡æ•°ã€‚è®¿é—®æ¬¡æ•°æ˜¯ç½‘ç«™çš„è®¿é—®é€Ÿåº¦çš„è¡¡é‡æ ‡å‡†ã€‚å¦‚æœè®¿é—®æ¬¡æ•°æ˜æ˜¾å°‘äºè®¿å®¢æ•°ï¼Œå°±è¯´æ˜å¾ˆå¤šç”¨æˆ·åœ¨æ²¡æœ‰å®Œå…¨æ‰“å¼€ç½‘é¡µæ—¶å°±å°†ç½‘é¡µå…³é—­äº†ã€‚å¦‚æœæ˜¯è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬å°±è¦å¥½å¥½æ£€æŸ¥ä¸€ä¸‹ç½‘ç«™çš„è®¿é—®é€Ÿåº¦äº†ï¼Œçœ‹çœ‹åˆ°åº•æ˜¯ç½‘ç«™ç©ºé—´å‡ºäº†é—®é¢˜è¿˜æ˜¯ç½‘ç«™ç¨‹åºå‡ºäº†é—®é¢˜ã€‚è®¿é—®æ¬¡æ•°ä¸€èˆ¬ä¼šå¤§äºè®¿å®¢æ•°ã€‚ ä»€ä¹ˆæ˜¯æµè§ˆé‡(PV)æµè§ˆé‡å’Œè®¿é—®æ¬¡æ•°æ˜¯å‘¼åº”çš„ã€‚ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶æ¯æ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼Œå°±è®°ä¸º1ä¸ªPVã€‚åŒä¸€ä¸ªé¡µé¢è¢«è®¿é—®å¤šæ¬¡ï¼Œæµè§ˆé‡ä¹Ÿä¼šç´¯ç§¯ã€‚ä¸€ä¸ªç½‘ç«™çš„æµè§ˆé‡è¶Šé«˜ï¼Œè¯´æ˜è¿™ä¸ªç½‘ç«™çš„çŸ¥ååº¦è¶Šé«˜ï¼Œå†…å®¹è¶Šå—ç”¨æˆ·å–œæ¬¢ã€‚ä¸€å‘³åœ°é‡è§†PVä¹Ÿæ˜¯æ²¡æœ‰å¤ªå¤§æ„ä¹‰çš„ï¼ˆPVè·Ÿç‚¹å‡»é‡å·®ä¸å¤šå§ï¼‰ã€‚PVæ˜¯ä¸€ä¸ªé‡è¦çš„æŒ‡æ ‡ï¼Œåæ˜ äº†ç½‘ç«™å†…å®¹æ˜¯å¦å¯¹ç”¨æˆ·æœ‰è¶³å¤Ÿçš„å¸å¼•åŠ›ã€‚å¯¹äºç«ä»·è€Œè¨€ï¼Œåªèƒ½æ˜¯ä¾§é¢åæ˜ ï¼Œå› ä¸ºæˆ‘ä»¬è®¾ç½®äº†è®¿é—®URLã€‚å¾ˆå¤šç”¨æˆ·éœ€æ±‚ä¹Ÿéå¸¸æ˜ç¡®ï¼Œæ¥åˆ°ç½‘ç«™ä¹‹åï¼Œå¾€å¾€åªä¼šå¯»æ‰¾è‡ªå·±éœ€æ±‚çš„äº§å“ï¼Œæ‰€ä»¥ä¸€å‘³åœ°é‡è§†PVä¹Ÿæ˜¯æ²¡æœ‰å¤ªå¤§æ„ä¹‰çš„ã€‚åº”è¯¥æŠŠé‡ç‚¹å†…å®¹å±•ç¤ºç»™ç›®æ ‡å®¢æˆ·å°±å¯ä»¥äº†ï¼Œå°±æ²¡å¿…è¦ä¸€å‘³åœ°è¿½æ±‚PVå€¼ï¼Œè¿½æ±‚é‚£äº› è½¬åŒ–ç‡ã€è·³å‡ºç‡ã€UVã€è½¬åŒ–æ¬¡æ•°ç­‰é‚£æ‰æ˜¯é‡ç‚¹ã€‚ ä»€ä¹ˆæ˜¯è½¬åŒ–æ¬¡æ•°ï¼ˆé‡è¦ï¼Œä½†æ˜¯å¯¹äºç«ä»·ï¼Œä¸€èˆ¬æ˜¯æŠŠç‚¹å‡»å•†åŠ¡é€šä½œä¸ºè½¬åŒ–é¡µé¢çš„ï¼Œæ‰€ä»¥å¾ˆå¤šæ˜¯æ— æ„ç‚¹å‡»ï¼‰æ½œåœ¨ç”¨æˆ·åœ¨æˆ‘ä»¬çš„ç½‘ç«™ä¸Šå®Œæˆä¸€æ¬¡æˆ‘ä»¬æœŸæœ›çš„è¡Œä¸ºï¼Œå°±å«åšä¸€æ¬¡è½¬åŒ–ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ç™¾åº¦ç»Ÿè®¡çš„åå°è®¾ç½®ç›¸åº”çš„è½¬åŒ–é¡µé¢ï¼Œç”¨æˆ·è®¿é—®è¿™ä¸ªé¡µé¢1æ¬¡ï¼Œå°±è®°ä¸º1æ¬¡è½¬åŒ–ã€‚ ä»€ä¹ˆæ˜¯è½¬åŒ–ç‡ï¼šè½¬åŒ–ç‡=è½¬åŒ–æ¬¡æ•°/è®¿é—®æ¬¡æ•°ã€‚å¯¹ç«ä»·è€Œè¨€ï¼Œæ˜¯å…³é”®è¯å’Œè®¿é—®é¡µé¢çš„ç²¾å‡†çš„æŒ‡æ ‡ã€‚è½¬åŒ–ç‡å¯ä»¥ç”¨æ¥è¡¡é‡ç½‘ç»œè¥é”€çš„æ•ˆæœã€‚å¦‚æœæˆ‘ä»¬åœ¨Aã€Bä¸¤ä¸ªç½‘ç«™åŒæ—¶æŠ•æ”¾äº†å¹¿å‘Šï¼ŒAç½‘ç«™æ¯å¤©èƒ½å¸¦æ¥100æ¬¡ç”¨æˆ·è®¿é—®ï¼Œä½†æ˜¯åªæœ‰1ä¸ªè½¬åŒ–ï¼ŒBç½‘ç«™æ¯å¤©èƒ½å¸¦æ¥10æ¬¡ç”¨æˆ·è®¿é—®ï¼Œä½†æ˜¯å´æœ‰5ä¸ªè½¬åŒ–ã€‚è¿™å°±è¯´æ˜Bç½‘ç«™å¸¦æ¥çš„è½¬åŒ–ç‡æ›´é«˜ï¼Œç”¨æˆ·æ›´åŠ ç²¾å‡†ï¼Œç½‘ç»œè¥é”€æ•ˆæœæ›´å¥½ã€‚ ä»€ä¹ˆæ˜¯å¹³å‡è®¿é—®æ—¶é•¿ï¼šå¹³å‡è®¿é—®æ—¶é•¿æ˜¯è¡¡é‡ç½‘ç«™ç”¨æˆ·ä½“éªŒçš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡å¹³å‡è®¿é—®æ—¶é•¿æ˜¯ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å¹³å‡åœç•™æ—¶é—´ã€‚å¹³å‡è®¿é—®æ—¶é•¿=æ€»è®¿é—®æ—¶é•¿/è®¿é—®æ¬¡æ•°ã€‚å¦‚æœç”¨æˆ·ä¸å–œæ¬¢ç½‘ç«™çš„å†…å®¹ï¼Œå¯èƒ½ç¨å¾®çœ‹ä¸€çœ¼å°±å…³é—­ç½‘é¡µäº†ï¼Œé‚£ä¹ˆå¹³å‡è®¿é—®æ—¶é•¿å°±å¾ˆçŸ­;å¦‚æœç”¨æˆ·å¯¹ç½‘ç«™çš„å†…å®¹å¾ˆæ„Ÿå…´è¶£ï¼Œä¸€è¿çœ‹äº†å¾ˆå¤šå†…å®¹ï¼Œæˆ–è€…åœ¨ç½‘ç«™åœç•™äº†å¾ˆé•¿æ—¶é—´ï¼Œå¹³å‡è®¿é—®æ—¶é•¿å°±å¾ˆé•¿ã€‚ ä»€ä¹ˆå«å¹³å‡è®¿é—®é¡µæ•°ï¼šå¹³å‡è®¿é—®é¡µæ•°ä¹Ÿæ˜¯è¡¡é‡ç½‘ç«™çš„ç”¨æˆ·ä½“éªŒçš„æŒ‡æ ‡å¹³å‡è®¿é—®é¡µæ•°æ˜¯ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å¹³å‡æµè§ˆé¡µæ•°ã€‚å¹³å‡è®¿é—®é¡µæ•°=æµè§ˆé‡/è®¿é—®æ¬¡æ•°ã€‚å¹³å‡è®¿é—®é¡µæ•°å¾ˆå°‘ï¼Œè¯´æ˜è®¿å®¢è¿›å…¥ä½ çš„ç½‘ç«™åè®¿é—®å°‘æ•°å‡ ä¸ªé¡µé¢å°±ç¦»å¼€äº†ã€‚ ä»€ä¹ˆæ˜¯è·³å‡ºç‡ï¼šè·³å‡ºç‡æ˜¯åæ˜ ç½‘ç«™æµé‡è´¨é‡çš„é‡è¦æŒ‡æ ‡è·³å‡ºç‡æ˜¯æŒ‡è®¿å®¢æ¥åˆ°ç½‘ç«™åï¼Œåªè®¿é—®äº†ä¸€ä¸ªé¡µé¢å°±ç¦»å¼€ç½‘ç«™çš„è®¿é—®æ¬¡æ•°å æ€»è®¿é—®æ¬¡æ•°çš„ç™¾åˆ†æ¯”ã€‚è·³å‡ºç‡=åªè®¿é—®ä¸€ä¸ªé¡µé¢å°±ç¦»å¼€ç½‘ç«™çš„è®¿é—®æ¬¡æ•°/æ€»è®¿é—®æ¬¡æ•°ï¼Œè·³å‡ºç‡è¶Šä½è¯´æ˜æµé‡è´¨é‡è¶Šå¥½ï¼Œç”¨æˆ·å¯¹ç½‘ç«™çš„å†…å®¹è¶Šæ„Ÿå…´è¶£ã€‚åŸæ–‡é“¾æ¥","categories":[{"name":"æ•°æ®åˆ†æ","slug":"æ•°æ®åˆ†æ","permalink":"http://www.wortyby.com/categories/æ•°æ®åˆ†æ/"}],"tags":[{"name":"è¯„ä»·æŒ‡æ ‡","slug":"è¯„ä»·æŒ‡æ ‡","permalink":"http://www.wortyby.com/tags/è¯„ä»·æŒ‡æ ‡/"},{"name":"pv","slug":"pv","permalink":"http://www.wortyby.com/tags/pv/"},{"name":"uv","slug":"uv","permalink":"http://www.wortyby.com/tags/uv/"},{"name":"è®¿é—®æ¬¡æ•°","slug":"è®¿é—®æ¬¡æ•°","permalink":"http://www.wortyby.com/tags/è®¿é—®æ¬¡æ•°/"},{"name":"è·³å‡ºç‡","slug":"è·³å‡ºç‡","permalink":"http://www.wortyby.com/tags/è·³å‡ºç‡/"},{"name":"è½¬åŒ–ç‡","slug":"è½¬åŒ–ç‡","permalink":"http://www.wortyby.com/tags/è½¬åŒ–ç‡/"},{"name":"å¹³å‡è®¿é—®æ—¶é•¿","slug":"å¹³å‡è®¿é—®æ—¶é•¿","permalink":"http://www.wortyby.com/tags/å¹³å‡è®¿é—®æ—¶é•¿/"}]},{"title":"é›†ç¾¤ç®¡ç†ç›¸å…³æ–‡æ¡£","slug":"é›†ç¾¤ç®¡ç†ç›¸å…³æ–‡æ¡£","date":"2019-02-02T03:01:02.000Z","updated":"2019-02-02T03:01:02.000Z","comments":true,"path":"2019/02/02/é›†ç¾¤ç®¡ç†ç›¸å…³æ–‡æ¡£/","link":"","permalink":"http://www.wortyby.com/2019/02/02/é›†ç¾¤ç®¡ç†ç›¸å…³æ–‡æ¡£/","excerpt":"","text":"ç»“åˆç›®å‰å…¬å¸ä½¿ç”¨çš„hdp å¹³å°æ­å»ºçš„ ambari ç®¡ç†å¹³å°ï¼Œæ‰¾åˆ°çš„é‡‘å±±äº‘ç›¸å…³çš„æ–‡æ¡£ä¸­å¿ƒï¼Œæ•´ç†å¦‚ä¸‹ é‡‘å±±äº‘ ambarié‡‘å±±ambarié‡‘å±±Kafka","categories":[{"name":"é›†ç¾¤ç®¡ç†ç›¸å…³","slug":"é›†ç¾¤ç®¡ç†ç›¸å…³","permalink":"http://www.wortyby.com/categories/é›†ç¾¤ç®¡ç†ç›¸å…³/"}],"tags":[{"name":"æ–‡æ¡£","slug":"æ–‡æ¡£","permalink":"http://www.wortyby.com/tags/æ–‡æ¡£/"}]},{"title":"pyppeteer ä½¿ç”¨æ€»ç»“","slug":"pyppeteer","date":"2019-01-22T07:20:30.000Z","updated":"2019-01-22T07:20:30.000Z","comments":true,"path":"2019/01/22/pyppeteer/","link":"","permalink":"http://www.wortyby.com/2019/01/22/pyppeteer/","excerpt":"","text":"æœ€è¿‘æœ‰ä¸ªçˆ¬è™«é¡¹ç›®ç½‘ç«™å¤ªå¤šï¼Œç»å¤§éƒ¨åˆ†æ¥å£éƒ½æ˜¯jsonï¼Œæœ‰äº›è¿˜æœ‰å‚æ•°åŠ å¯†ï¼Œä¸€ä¸ªä¸ªåˆ†ææ¥å£å°±å¤ªéº»çƒ¦ï¼Œå°±æƒ³ç”¨æµè§ˆå™¨å…¨éƒ¨æ¸²æŸ“å‡ºæ¥ï¼Œå°±å¯ä»¥çœæ‰è¿™äº›æ­¥éª¤ã€‚æœ€è¿‘æµè¡Œ headless å°±ç”¨å®ƒäº†ã€‚puppeteer æ˜¯ nodejs çš„ï¼Œå®ƒçš„ pythonç»‘å®šæ¯”è¾ƒå¥½çš„æ˜¯ pyppeteerã€‚ åŸºæœ¬ç”¨æ³•ä¸­æ–‡èµ„æ–™éå¸¸å°‘ï¼Œæ¥å£çœ‹æ–‡æ¡£ï¼Œä¾‹å­çœ‹ tests ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹ã€‚è¿˜å¯ä»¥çœ‹çœ‹ puppeteer çš„æ•™ç¨‹ã€‚ å¯åŠ¨å‚æ•°browser = await pyppeteer.launch({ 'devtools': False, 'args': ['--no-sandbox', '--user-agent=&quot;' + UserAgent + '&quot;'] }) devtools æ§åˆ¶ç•Œé¢çš„æ˜¾ç¤ºï¼Œç”¨æ¥è°ƒè¯•ã€‚args æ˜¯æµè§ˆå™¨å¯åŠ¨çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯ä»¥è®¾ç½®æµè§ˆå™¨å¤´éƒ¨ï¼Œä¸ç„¶ä¼šæ ‡ç¤ºä¸ºæ— å¤´æµè§ˆå™¨ã€‚--no-sandbox åœ¨ docker é‡Œä½¿ç”¨æ—¶éœ€è¦åŠ å…¥çš„å‚æ•°ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚ è¯·æ±‚é’©å­ä¸ºäº†åŠ å¿«æ¸²æŸ“é€Ÿåº¦ï¼Œå¯ä»¥ç¦æ­¢åŠ è½½å›¾ç‰‡ä¹‹ç±»çš„ã€‚123456789async def request_check(req): &apos;&apos;&apos;è¯·æ±‚è¿‡æ»¤&apos;&apos;&apos; if req.resourceType in [&apos;image&apos;, &apos;media&apos;, &apos;eventsource&apos;, &apos;websocket&apos;]: await req.abort() else: await req.continue_()await page.setRequestInterception(True)page.on(&apos;request&apos;, request_check) ç½‘ç»œé—®é¢˜è¯·æ±‚åŠ è½½æ˜¯å¦å®Œæˆï¼Œæ— ç½‘éƒ½éœ€è¦å¤„ç†123456789101112131415async def goto(page, url): while True: try: await page.goto(url, &#123; &apos;timeout&apos;: 0, &apos;waitUntil&apos;: &apos;networkidle0&apos; &#125;) break except (pyppeteer.errors.NetworkError, pyppeteer.errors.PageError) as ex: # æ— ç½‘ç»œ &apos;net::ERR_INTERNET_DISCONNECTED&apos;,&apos;net::ERR_TUNNEL_CONNECTION_FAILED&apos; if &apos;net::&apos; in str(ex): await asyncio.sleep(10) else: raise æ³¨å…¥ js æ–‡ä»¶æ¯”å¦‚ä¸€äº›jsåº“ï¼Œæˆ‘ä½¿ç”¨ Ajax-hook æ¥ç»Ÿè®¡ ajax çš„è¯·æ±‚å®Œæˆæƒ…å†µï¼Œéœ€è¦åœ¨ç½‘é¡µå¤´éƒ¨æ³¨å…¥jsæ–‡ä»¶ï¼Œä¸€äº›è‡ªå·±çš„åº“ï¼Œæ¯”è¾ƒå¤§ï¼Œä¹Ÿè¿™æ ·æ³¨å…¥ã€‚123456from pathlib import PathCURDIR = Path(__file__).parentJS_AJAX_HOOK_LIB = str(CURDIR / &apos;static&apos; / &apos;ajaxhook.min.js&apos;)await page.addScriptTag(path=JS_AJAX_HOOK_LIB)è¿™æ ·æ³¨å…¥çš„jsæ–‡ä»¶ä¸èƒ½æœ‰ä¸­æ–‡ï¼Œå› ä¸º pyppeteer é‡Œé¢æ‰“å¼€æ–‡ä»¶ç”¨çš„æ˜¯é»˜è®¤ç¼–ç ï¼Œå¯ä»¥ hook ä½open å‡½æ•°æ¥è§£å†³ã€‚12# å› ä¸º pyppeteer åº“é‡Œé¢ addScriptTag ç”¨çš„æ˜¯ç³»ç»Ÿé»˜è®¤ç¼–ç ,å¯¼è‡´jsæ–‡ä»¶é‡Œé¢ä¸èƒ½æœ‰ä¸­æ–‡pyppeteer.frame_manager.open = lambda file: open(file, encoding=&apos;utf8&apos;) åœ¨dockeré‡Œä½¿ç”¨åœ¨ window10 é‡Œå¼€å‘å¾ˆæµç¨‹ï¼Œéƒ¨ç½²åˆ° windows server ä¸Šï¼Œå¯èƒ½ç”±äºé…ç½®æ¯”è¾ƒå·®æˆ–å…¶ä»–åŸå› ï¼Œç½‘ç«™æ¸²æŸ“å¾ˆæ…¢ã€‚å¯ä»¥æ”¾åœ¨å®¹å™¨é‡Œï¼Œæ•ˆæœæ˜æ˜¾ã€‚æ³¨æ„ç‚¹æ˜¯ä¸Šé¢æåˆ°äº†çš„å…³é—­æ²™ç›’æ¨¡å¼ï¼Œéœ€è¦ä¸‹ä¸€äº›æµè§ˆå™¨çš„ä¾èµ–ï¼Œè¿˜æœ‰å°±æ˜¯æœ€å¥½å…ˆæŠŠæµè§ˆå™¨ä¸‹å¥½ï¼Œåšåˆ°é•œåƒé‡Œï¼Œè¿™æ ·å°±ä¸ä¼šåœ¨å®¹å™¨é‡Œä¸€ä¸ªä¸€ä¸ªä¸‹äº†ã€‚123456789101112131415FROM python:slimWORKDIR /usr/src/appRUN apt-get update &amp;&amp; apt-get install -y gconf-service libasound2 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wgetRUN apt-get install -y vimCOPY requirements.txt ./RUN pip install --no-cache-dir -r requirements.txtRUN python -c &quot;import pyppeteer;pyppeteer.chromium_downloader.download_chromium();&quot;COPY . .VOLUME /data","categories":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://www.wortyby.com/categories/çˆ¬è™«/"}],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://www.wortyby.com/tags/çˆ¬è™«/"}]},{"title":"ç»å…¸æ¡ˆä¾‹","slug":"ç»å…¸æ¡ˆä¾‹","date":"2019-01-15T08:36:13.000Z","updated":"2019-01-15T08:36:13.000Z","comments":true,"path":"2019/01/15/ç»å…¸æ¡ˆä¾‹/","link":"","permalink":"http://www.wortyby.com/2019/01/15/ç»å…¸æ¡ˆä¾‹/","excerpt":"","text":"ç®—æ³•èƒŒæ™¯CTRä¹‹FFMæƒ…æ„Ÿåˆ†æçš„ç°ä»£æ–¹æ³•ï¼ˆåŒ…å«word2vec Doc2Vecï¼‰åŸºäºTextCNNçš„æƒ…æ„ŸäºŒåˆ†ç±»æ–°é—»ä¸Šçš„æ–‡æœ¬åˆ†ç±»ï¼šæœºå™¨å­¦ä¹ å¤§ä¹±æ–—æ·±å…¥æµ…å‡ºæ’åºå­¦ä¹ ï¼šå†™ç»™ç¨‹åºå‘˜çš„ç®—æ³•ç³»ç»Ÿå¼€å‘å®è·µå¹²è´§ï½œä¸ªæ€§åŒ–æ¨èç³»ç»Ÿäº”å¤§ç ”ç©¶çƒ­ç‚¹ä¹‹ç”¨æˆ·ç”»åƒï¼ˆå››ï¼‰å¹²è´§ | ä¸ªæ€§åŒ–æ¨èç³»ç»Ÿäº”å¤§ç ”ç©¶çƒ­ç‚¹ä¹‹æ·±åº¦å­¦ä¹ ï¼ˆä¸€ï¼‰å¤šå›¾ä¸‡å­—æ–‡ | ä»ç¥ç»å…ƒåˆ° CNNã€RNNã€GANâ€¦ ç¥ç»ç½‘ç»œçœ‹æœ¬æ–‡ç»å¯¹å¤Ÿäº†æœºå™¨å­¦ä¹ (03)æœ´ç´ è´å¶æ–¯æ„å»ºæ•æ„Ÿè¯è¿‡æ»¤ç³» å…·ä½“çš„æ¡ˆä¾‹åˆ†æå¾®åšç”¨æˆ·è¡Œä¸ºç‰¹å¾åˆ†æå¾®åšåª’ä½“ç‰¹æ€§ä»¥åŠç”¨æˆ·ä½¿ç”¨çŠ¶å†µç ”ç©¶å¤§æ•°æ®ç¯å¢ƒä¸‹å¾®åšèˆ†æƒ…çƒ­ç‚¹è¯é¢˜æŒ–æ˜æ–¹æ³•ç ”ç©¶å¾®åšä¼ æ’­ä¸å¾®åšè¥é”€ä¹‹åª’ä½“ä¼ æ’­ç‰¹æ€§åŒ—é‚®å¤æ‚ç½‘ç»œä¸åœ¨çº¿ç¤¾äº¤ç½‘ç»œæ¦‚è®º è®ºæ–‡ åœ¨çº¿ç¤¾äº¤ç½‘ç»œä¿¡æ¯ä¼ æ’­ç ”ç©¶â€”â€”ä»¥å¾®åšä¸ºä¾‹å¾®åšè¯é¢˜ç ”ç©¶å¾®åšä¿¡æ¯ä¼ æ’­åŠè¡°æœŸç ”ç©¶(ä¿®æ­£ç‰ˆ) æ¨èç›¸å…³ä¸€ä½ç®—æ³•å¸ˆå·¥ç¨‹å¸ˆçš„Sparkæœºå™¨å­¦ä¹ ç¬”è®°ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„æ¨èç³»ç»Ÿæ¨èç³»ç»Ÿé‚£ç‚¹äº‹ â€”â€” åŸºäºSpark MLlibçš„ç‰¹å¾é€‰æ‹©sparkæœºå™¨å­¦ä¹ ç¬”è®°ï¼šï¼ˆä¸‰ï¼‰ç”¨Spark Pythonæ„å»ºæ¨èç³»ç»Ÿæ¨èç³»ç»Ÿé‡ä¸Šæ·±åº¦å­¦ä¹ (ä¸€)â€“FMæ¨¡å‹ç†è®ºå’Œå®è·µæ¨èç³»ç»Ÿé‡ä¸Šæ·±åº¦å­¦ä¹ (åå…«)â€“æ¢ç§˜é˜¿é‡Œä¹‹æ·±åº¦å…´è¶£ç½‘ç»œ(DIN)æµ…æåŠå®ç° æ–‡æœ¬åˆ†ç±»CNN å’Œ word2Vec çš„æ–‡æœ¬åˆ†ç±»åŸºäº word2vec å’Œ CNN çš„æ–‡æœ¬åˆ†ç±» ï¼šç»¼è¿° &amp; å®è·µæ–‡æœ¬åˆ†ç±»(ä¸‹)-å·ç§¯ç¥ç»ç½‘ç»œ(CNN)åœ¨æ–‡æœ¬åˆ†ç±»ä¸Šçš„åº”ç”¨pythonæ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—NLPä¹‹æ–‡æœ¬ç›¸ä¼¼åº¦æ¼«è°ˆï¼šæœºå™¨å­¦ä¹ ä¸­è·ç¦»å’Œç›¸ä¼¼æ€§åº¦é‡æ–¹æ³• ç²¾åBLOGDanifreeâ€™s Blogæˆ‘çˆ±è‡ªç„¶è¯­è¨€å¤„ç†Mark Changâ€™s Blog å®¢æˆ·ç«¯å¯è§†åŒ–æ˜¾ç¤ºSeabornä½¿ç”¨Seaborn æ•™ç¨‹ æ›¾ç»çš„ç–‘æƒ‘è®¡ç®—ä¸­æ–‡æ–‡æœ¬ç›¸ä¼¼åº¦æœ‰å“ªäº›å¥½ç”¨çš„ç®—æ³•ï¼Ÿæ—¥ç­–ç•¥æœºå™¨å­¦ä¹ æ¨¡å‹åˆ†æï¼ˆå°ç»„å†…éƒ¨è®¨è®ºï¼‰ Spark2.2.0 ä¸­æ–‡æ–‡æ¡£spark2.2.2 æ–‡æ¡£spark è‹±æ–‡æ–‡æ¡£","categories":[{"name":"å­¦ä¹ è®¡åˆ’","slug":"å­¦ä¹ è®¡åˆ’","permalink":"http://www.wortyby.com/categories/å­¦ä¹ è®¡åˆ’/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://www.wortyby.com/tags/ç®—æ³•/"},{"name":"æ¡ˆä¾‹","slug":"æ¡ˆä¾‹","permalink":"http://www.wortyby.com/tags/æ¡ˆä¾‹/"}]},{"title":"Protobuf","slug":"Protobuf åŸç†å‰–æ","date":"2018-12-19T07:26:26.000Z","updated":"2018-12-19T07:26:26.000Z","comments":true,"path":"2018/12/19/Protobuf åŸç†å‰–æ/","link":"","permalink":"http://www.wortyby.com/2018/12/19/Protobuf åŸç†å‰–æ/","excerpt":"","text":"Protobuf åŸç†å‰–æAuthorDateVersionSevenFeng2017.01.11Ver1.0ç®€ä»‹Protocol Buffersæ˜¯Googleå¼€å‘ä¸€ç§æ•°æ®æè¿°è¯­è¨€ï¼Œèƒ½å¤Ÿå°†ç»“æ„åŒ–æ•°æ®åºåˆ—åŒ–ï¼Œå¯ç”¨äºæ•°æ®å­˜å‚¨ã€é€šä¿¡åè®®ç­‰æ–¹é¢ã€‚ä¸äº†è§£Protocol Buffersçš„åŒå­¦å¯ä»¥æŠŠå®ƒç†è§£ä¸ºæ›´å¿«ã€æ›´ç®€å•ã€æ›´å°çš„JSONæˆ–è€…XMLï¼ŒåŒºåˆ«åœ¨äºProtocol Buffersæ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œè€ŒJSONå’ŒXMLæ˜¯æ–‡æœ¬æ ¼å¼ã€‚protobuf Githubåœ°å€æ®Googleå®˜æ–¹æ–‡æ¡£ä»‹ç»ï¼Œç°åœ¨Googleå†…éƒ¨å·²ç»æœ‰48,162ä¸ªæ¶ˆæ¯ç±»å‹å®šä¹‰åœ¨12,183ä¸ªprotoæ–‡ä»¶ä¸­ï¼Œå› æ­¤ä½¿ç”¨Protocol æ–‡ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿèƒ½ä¹Ÿéœ€è¦å®šä¹‰ä¸€äº› xxx.protoã€‚æœ¬æ–‡ä¼šä»å¿«é€Ÿå…¥é—¨ã€è¯­è¨€è§„èŒƒã€ç¼–ç åè®®ã€æ€§èƒ½è¯„ä¼°ç­‰å‡ ä¸ªæ–¹é¢å¯¹Prototol Buffersè¿›è¡Œä»‹ç»ã€‚å˜é•¿ç¼–ç wikiå˜é•¿ç¼–ç å¹¿æ³›ä½¿ç”¨åœ¨å¯¹å†…å­˜å¤§å°è¦æ±‚è¾ƒé«˜çš„åœºæ™¯.protobuf é‡‡ç”¨çš„æ˜¯è‡ªå·±å¼€å‘çš„ Base 128 Varintsç¼–ç 12345678910111213&gt;&gt; åœ¨ç†è§£Protocol Bufferçš„ç¼–ç è§„åˆ™ä¹‹å‰ï¼Œä½ é¦–å…ˆéœ€è¦äº†è§£varintsã€‚&gt;&gt;varintsæ˜¯ä¸€ç§ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚è¡¨ç¤ºæ•´å‹æ•°æ®&gt;&gt;çš„æ–¹æ³•ã€‚å…¶ä¸­æ•°å€¼æœ¬èº«è¶Šå°ï¼Œå…¶æ‰€å ç”¨çš„å­—èŠ‚æ•°è¶Šå°‘ã€‚&gt;&gt; &gt;&gt; åœ¨varintä¸­ï¼Œé™¤äº†æœ€åä¸€ä¸ªå­—èŠ‚ä¹‹å¤–çš„æ¯ä¸ªå­—èŠ‚ä¸­éƒ½åŒ…å«ä¸€ä¸ªmsb(most significant bit)è®¾ç½®(ä½¿ç”¨æœ€é«˜ä½)ï¼Œè¿™æ„å‘³ç€å…¶åçš„å­—èŠ‚æ˜¯å¦å’Œå½“å‰å­—èŠ‚ä¸€èµ·æ¥è¡¨ç¤ºåŒä¸€ä¸ªæ•´å‹æ•°å€¼ã€‚è€Œå­—èŠ‚ä¸­çš„å…¶ä½™ä¸ƒä½å°†ç”¨äºå­˜å‚¨æ•°æ®æœ¬èº«ã€‚ç”±æ­¤æˆ‘ä»¬å¯ä»¥ç®€å•çš„è§£é‡Šä¸€ä¸‹Base 128ï¼Œé€šå¸¸è€Œè¨€ï¼Œæ•´æ•°æ•°å€¼éƒ½æ˜¯ç”±å­—èŠ‚è¡¨ç¤ºï¼Œå…¶ä¸­æ¯ä¸ªå­—èŠ‚ä¸º8ä½ï¼Œå³Base 256ã€‚ç„¶è€Œåœ¨Protocol Bufferçš„ç¼–ç ä¸­ï¼Œæœ€é«˜ä½æˆä¸ºäº†msbï¼Œåªæœ‰åé¢çš„7ä½å­˜å‚¨å®é™…çš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬ç§°å…¶ä¸ºBase 128ï¼ˆ2çš„7æ¬¡æ–¹ï¼‰ã€‚&gt;&gt;å­—èŠ‚åº:å°ç«¯æ¨¡å¼ å°†ä½åºå­—èŠ‚å­˜å‚¨åœ¨èµ·å§‹åœ°å€;åœ¨ç½‘ç»œç¨‹åºå¼€å‘æ—¶ æˆ–æ˜¯è·¨å¹³å°å¼€å‘æ—¶ ä¹Ÿåº”è¯¥æ³¨æ„ä¿è¯åªç”¨ä¸€ç§å­—èŠ‚åº ä¸ç„¶ä¸¤æ–¹çš„è§£é‡Šä¸ä¸€æ ·å°±ä¼šäº§ç”Ÿbug. å› æ­¤ä¸åŒçš„å¹³å°å¼€å‘ç½‘ç»œé€šä¿¡æ•°æ®çš„æ—¶å€™éœ€è¦ä¿è¯ Host to Network htons ä»¥åŠNetwork to Host ntohs çš„æ•°æ®å­—èŠ‚åºä¿è¯ä¸€è‡´ï¼Œæ‰€å¹¸protobuf åº“å·²ç»å¸®æˆ‘ä»¬åšå¥½äº†è¿™ä¸ªè½¬æ¢.ç¤ºä¾‹è§£ædecode1234567891011121314&gt;&gt;10101011 01100001&gt;&gt;&gt;&gt;ä¸Šè¿°æ˜¯é€šè¿‡ç¼–ç äº†ä¹‹åçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæ€»å…±16ä½ï¼Œ2ä¸ªå­—èŠ‚ã€‚ã€‚ã€‚&gt;&gt;&gt;&gt;(1) ä»å‰é¢çš„ä¸€ä¸ªå­—èŠ‚è¯´èµ·å§ï¼š10101011 æœ€å¼€å§‹çš„ä½æ˜¯1ï¼Œ&gt;&gt; é‚£ä¹ˆå®ƒè¡¨ç¤ºè¿™ä¸ªå­—èŠ‚ä»¥åè¿˜æœ‰åç»­çš„å­—èŠ‚ã€‚ã€‚ã€‚&gt;&gt; ç„¶åå°†æœ€å‰é¢çš„1å»æ‰ï¼Œè¿˜å‰©ä¸‹ 0101011&gt;&gt;&gt;&gt;(2) æ¥ä¸‹æ¥çœ‹åé¢çš„ä¸€ä¸ªå­—èŠ‚ï¼š01100001 æœ€å¼€å§‹çš„ä½æ˜¯0ï¼Œé‚£ä¹ˆè¡¨ç¤ºè¿™ä¸ªå­—èŠ‚æ˜¯æœ€åä¸€ä¸ªå­—èŠ‚äº†ï¼Œ&gt;&gt;ä»¥åæ²¡æœ‰æ›´å¤šçš„å­—èŠ‚ï¼Œé‚£ä¹ˆå»æ‰è¿™ä¸ª0ä¹‹åè¿˜å‰©ä¸‹ 1100001&gt;&gt;(3) é‚£ä¹ˆæœ€åä¸Šé¢çš„äºŒè¿›åˆ¶å˜æˆäº† 0101011 1100001 ç„¶åé¦–ä½é¡ºåºè¿˜éœ€è¦é¢ å€’ä¸€ä¸‹ï¼Œé‚£ä¹ˆå˜æˆäº†1100001 0101011ï¼Œç”¨10è¿›åˆ¶æ¥è¡¨ç¤ºçš„è¯å°±æ˜¯ 12459&gt;&gt;æ¶ˆæ¯ç»“æ„ä¿è¯æ¶ˆæ¯æ–°æ—§ç‰ˆæœ¬å…¼å®¹æ€§åŸå› 123456789&gt;&gt;Protocol Bufferä¸­çš„æ¶ˆæ¯éƒ½æ˜¯ç”±ä¸€ç³»åˆ—çš„é”®å€¼å¯¹æ„æˆçš„ã€‚&gt;&gt;æ¯ä¸ªæ¶ˆæ¯çš„äºŒè¿›åˆ¶ç‰ˆæœ¬éƒ½æ˜¯ä½¿ç”¨æ ‡ç­¾å·ä½œä¸ºkeyï¼Œ&gt;&gt;è€Œæ¯ä¸€ä¸ªå­—æ®µçš„åå­—å’Œç±»å‹å‡æ˜¯åœ¨è§£ç çš„è¿‡ç¨‹ä¸­æ ¹æ®ç›®æ ‡ç±»å‹&gt;&gt;ï¼ˆååºåˆ—åŒ–åçš„å¯¹è±¡ç±»å‹ï¼‰è¿›è¡Œé…å¯¹çš„ã€‚åœ¨è¿›è¡Œæ¶ˆæ¯ç¼–ç æ—¶ï¼Œkey/valueè¢«è¿æ¥æˆå­—èŠ‚æµã€‚&gt;&gt;åœ¨è§£ç æ—¶ï¼Œè§£æå™¨å¯ä»¥ç›´æ¥è·³è¿‡ä¸è¯†åˆ«çš„å­—æ®µï¼Œ&gt;&gt;è¿™æ ·å°±å¯ä»¥ä¿è¯æ–°è€ç‰ˆæœ¬æ¶ˆæ¯å®šä¹‰åœ¨æ–°è€ç¨‹åºä¹‹é—´çš„å…¼å®¹æ€§ï¼Œ&gt;&gt;ä»è€Œæœ‰æ•ˆçš„é¿å…äº†ä½¿ç”¨olderæ¶ˆæ¯æ ¼å¼çš„olderç¨‹åºåœ¨è§£ænewerç¨‹åºå‘æ¥çš„neweræ¶ˆæ¯æ—¶ï¼Œ&gt;&gt;ä¸€æ—¦é‡åˆ°æœªçŸ¥ï¼ˆæ–°æ·»åŠ çš„ï¼‰å­—æ®µæ—¶è€Œå¼•å‘çš„è§£æå’Œå¯¹è±¡åˆå§‹åŒ–çš„é”™è¯¯ã€‚&gt;&gt;Protobuf æ”¯æŒçš„ å­—æ®µ ç±»å‹Type|Meaning|Used For--------------------|------------------------|-----|0|Varint|int32, int64, uint32, uint64, sint32, sint64, bool, enum1|64-bit|fixed64,sfixed64,double2|Length-delimited|string, bytes, embedded messages, packed repeated fields3|32-bit|fixed32, sfixed32, floatå­—æ®µè§£æåŸç†ç”±äºåœ¨ç¼–ç åæ¯ä¸€ä¸ªå­—æ®µçš„keyéƒ½æ˜¯varintç±»å‹ï¼Œkeyçš„å€¼æ˜¯ç”±å­—æ®µæ ‡å·å’Œå­—æ®µç±»å‹åˆæˆç¼–ç æ‰€å¾—ï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š12&gt;&gt;field_number &lt;&lt; 3 | field_type&gt;&gt;ç”±æ­¤çœ‹å‡ºï¼Œkeyçš„æœ€å3ä¸ªbitsç”¨äºå­˜å‚¨å­—æ®µçš„ç±»å‹ä¿¡æ¯ã€‚é‚£ä¹ˆåœ¨ä½¿ç”¨è¯¥ç¼–ç æ—¶ï¼ŒProtocol Bufferæ‰€æ”¯æŒçš„å­—æ®µç±»å‹å°†ä¸ä¼šè¶…è¿‡8ç§ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥è®¡ç®—å‡ºProtocol Bufferåœ¨ä¸€ä¸ªæ¶ˆæ¯ä¸­å¯ä»¥æ”¯æŒçš„å­—æ®µæ•°é‡ä¸º2çš„29æ¬¡æ–¹å‡ä¸€ã€‚ä¸¾ä¾‹ int32 æ¥è¯´1234&gt;&gt;message Test1 &#123;&gt;&gt;int32 a = 1;&gt;&gt;&#125;&gt;&gt;å‡è®¾æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­å°†å­—æ®µaçš„å€¼è®¾ç½®ä¸º150ï¼ˆåè¿›åˆ¶ï¼‰ï¼Œæ­¤åå†å°†è¯¥å¯¹è±¡åºåˆ—åŒ–åˆ°Binaryæ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„æ•°æ®ä¸ºï¼š08 96 01ç°åœ¨æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹ä¹‹å‰ç»™å‡ºçš„Testæ¶ˆæ¯è¢«åºåˆ—åŒ–åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚08çš„ç”±æ¥ã€‚123&gt;&gt;0000 1000-&gt; 000 1000 //dropæ‰msbï¼ˆæœ€é«˜ä½ï¼‰&gt;&gt;æœ€ä½çš„3ä½è¡¨ç¤ºå­—æ®µç±»å‹ï¼Œå³0ä¸ºvarintã€‚æˆ‘ä»¬å†å°†ç»“æœå³ç§»3ä½( &gt;&gt; 3)ï¼Œæ­¤æ—¶å¾—åˆ°çš„ç»“æœä¸º1ï¼Œå³å­—æ®µaåœ¨æ¶ˆæ¯Test1ä¸­çš„æ ‡ç­¾å·ã€‚é€šè¿‡è¿™æ ·çš„ç»“æœï¼ŒProtocol Bufferçš„è§£ç å™¨å¯ä»¥è·æ‚‰å½“å‰å­—æ®µçš„æ ‡ç­¾å·æ˜¯1ï¼Œå…¶åæ‰€è·Ÿéšæ•°æ®çš„ç±»å‹ä¸ºvarintã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»§ç»­åˆ©ç”¨ä¸Šé¢è®²åˆ°çš„çŸ¥è¯†åˆ†æå‡ºåä¸¤ä¸ªå­—èŠ‚(96 01)çš„ç”±æ¥ã€‚123456&gt;&gt;96 01 = 1001 0110 0000 0001 //ä¸€ä¸ªå­—èŠ‚æ•°å­—96ï¼Œä¸€ä¸ªå­—èŠ‚01 -&gt; 001 0110 000 0001 //dropä¸¤ä¸ªå­—èŠ‚çš„msb -&gt; 000 0001 001 0110 //ç¿»è½¬é«˜ä½å­—èŠ‚ -&gt; 10010110 //å»æ‰æœ€é«˜ä½ä¸­æ²¡ç”¨çš„0 -&gt; 128 + 16 + 4 + 2 = 150&gt;&gt;æ›´å¤šç±»å‹æœ‰ç¬¦å·ç±»å‹å¦‚å‰æ‰€è¿°ï¼Œç±»å‹0è¡¨ç¤ºvarintï¼Œå…¶ä¸­åŒ…å«int32/int64/uint32/uint64/sint32/sint64/bool/enumã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¦‚æœå½“å‰å­—æ®µå¯ä»¥è¡¨ç¤ºä¸ºè´Ÿæ•°ï¼Œé‚£ä¹ˆå¯¹äºint32/int64å’Œsint32/sint64è€Œè¨€ï¼Œå®ƒä»¬åœ¨è¿›è¡Œç¼–ç æ—¶å°†å­˜åœ¨ç€è¾ƒå¤§çš„å·®åˆ«ã€‚å¦‚æœä½¿ç”¨int32/int64è¡¨ç¤ºä¸€ä¸ªè´Ÿæ•°ï¼Œè¯¥å­—æ®µçš„å€¼æ— è®ºæ˜¯-1è¿˜æ˜¯-2147483648ï¼Œå…¶ç¼–ç åé•¿åº¦å°†å§‹ç»ˆä¸º10ä¸ªå­—èŠ‚ï¼Œå°±å¦‚åŒå¯¹å¾…ä¸€ä¸ªå¾ˆå¤§çš„æ— ç¬¦å·æ•´å‹ä¸€æ ·ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯sint32/sint64 ç¼–ç è´Ÿæ•°ï¼ŒProtocol Bufferå°†ä¼šé‡‡ç”¨ZigZagç¼–ç æ–¹å¼ï¼Œå…¶ç¼–ç åçš„ç»“æœå°†ä¼šæ›´åŠ é«˜æ•ˆã€‚ä¸‹é¢æ˜¯ ZigZag å¯¹ç…§è¡¨ï¼šSigned Original|Encoded Asâ€”|---|0|0-1|11|2-2|32147483647|4294967294-2147483648|4294967295å…¶å…¬å¼å¦‚ä¸‹ï¼š123(n &lt;&lt; 1) ^ (n &gt;&gt; 31) //sint32(n &lt;&lt; 1&gt; ^ (n &gt;&gt; 63) //sint64&gt;&gt;éœ€è¦è¡¥å……è¯´æ˜çš„æ˜¯ï¼ŒProtocol Bufferåœ¨å®ç°ä¸Šè¿°ä½ç§»æ“ä½œæ—¶å‡é‡‡ç”¨çš„ç®—æœ¯ä½ç§»ï¼Œå› æ­¤å¯¹äº(n &gt;&gt; 31)å’Œ(n &gt;&gt; 63)è€Œè¨€ï¼Œå¦‚æœnä¸ºè´Ÿå€¼ä½ç§»åçš„ç»“æœå°±æ˜¯-1ï¼Œå¦åˆ™å°±æ˜¯0ã€‚æ³¨ï¼šç®€å•è§£é‡Šä¸€ä¸‹Cè¯­è¨€ä¸­çš„ç®—æœ¯ä½ç§»å’Œé€»è¾‘ä½ç§»ã€‚ä»–ä»¬çš„å·¦ç§»æ“ä½œéƒ½æ˜¯ç›¸åŒçš„ï¼Œå³ä½ä½è¡¥0ï¼Œé«˜ä½ç›´æ¥ç§»é™¤ã€‚ä¸åŒçš„æ˜¯å³ç§»æ“ä½œï¼Œé€»è¾‘ä½ç§»æ¯”è¾ƒç®€å•ï¼Œé«˜ä½å…¨éƒ¨è¡¥0ã€‚è€Œç®—æœ¯ä½ç§»åˆ™éœ€è¦è§†å½“å‰å€¼çš„ç¬¦å·ä½è€Œå®šï¼Œè¡¥è¿›çš„ä½å’Œç¬¦å·ä½ç›¸åŒï¼Œå³æ­£æ•°å…¨è¡¥0ï¼Œè´Ÿæ•°å…¨è¡¥1ã€‚æ¢å¥è¯è¯´ï¼Œç®—æœ¯ä½ç§»å³ç§»æ—¶è¦ä¿è¯ç¬¦å·ä½çš„ä¸€è‡´æ€§ã€‚åœ¨Cè¯­è¨€ä¸­ï¼Œå¦‚æœä½¿ç”¨ intå˜é‡ä½ç§»æ—¶å°±æ˜¯ç®—æœ¯ä½ç§»ï¼Œuintå˜é‡ä½ç§»æ—¶æ˜¯é€»è¾‘ä½ç§»ã€‚Non-varint æ•°å€¼å‹double/fixed64å§‹ç»ˆéƒ½å ç”¨8ä¸ªå­—èŠ‚ï¼Œfloat/fixed32å§‹ç»ˆå ç”¨4ä¸ªå­—èŠ‚ã€‚Strings ç±»å‹å…¶ç±»å‹å€¼ä¸º2ï¼Œkeyä¿¡æ¯ä¹‹åæ˜¯å­—èŠ‚æ•°ç»„çš„é•¿åº¦ä¿¡æ¯ï¼Œæœ€ååœ¨ç´§éšæŒ‡å®šé•¿åº¦çš„å®é™…æ•°æ®å€¼ä¿¡æ¯ã€‚12345&gt;&gt;&gt;message Test2 &gt;&gt;&gt;&#123; required string b = 2;//æ ‡å·ä¸º2&#125;&gt;&gt;&gt;ç°åœ¨æˆ‘ä»¬è®¾ç½®bçš„å€¼ä¸º&quot;testing&quot;ã€‚å…¶ç¼–ç åæ•°æ®å¦‚ä¸‹ï¼š12&gt;&gt;&gt;12 07 74 65 73 74 69 6E 67&gt;&gt;&gt;ç¬¬ä¸€ä¸ªå­—èŠ‚ 0x12(0001 0010) è¡¨ç¤ºkeyï¼Œé€šè¿‡è§£ç **(12==&gt;0x12==&gt;0b(0001 0010)&gt;18&gt;2&lt;&lt;3|2)**å¯ä»¥å¾—åˆ°å­—æ®µç±»å‹2å’Œå­—æ®µæ ‡å·2ã€‚ç¬¬äºŒä¸ªå­—èŠ‚ 07 è¡¨ç¤ºtestingçš„é•¿åº¦ã€‚æŸ¥é˜…Ascii ç è¡¨74==&gt;(0x74)==t65==&gt;(0x65)==e73==&gt;(0x73)==e74==&gt;(0x74)==t69==&gt;(0x69)==i6E==&gt;(0x6E)==n67==&gt;(0x67)==gæ‰€ä»¥ åé¢ 7ä¸ªå­—èŠ‚åˆ™è¡¨ç¤ºtestingã€‚åµŒå…¥æ¶ˆæ¯å…ˆå®šä¹‰ä¸€ä¸ªåµŒå¥—çš„æ¶ˆæ¯ç±»å‹12345&gt;&gt;&gt;message Test3 &gt;&gt;&gt;&#123; Test1 c = 3;//æ ‡å·ä¸º3&#125;&gt;&gt;&gt;æ­¤æ—¶æˆ‘ä»¬å…ˆå°†Test1çš„aå­—æ®µå€¼è®¾ç½®ä¸º150ï¼Œå…¶ç¼–ç ç»“æœå¦‚ä¸‹ï¼š1A 03 08 96 01 ä»ä¸Šé¢çš„ç»“æœå¯ä»¥çœ‹å‡º08 96 01å’Œä¹‹å‰ç›´æ¥ç¼–ç Test1æ—¶æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œåªæ˜¯åœ¨å‰é¢å¢åŠ äº†key(å­—æ®µç±»å‹ + æ ‡å·)å’Œé•¿åº¦ä¿¡æ¯ã€‚æ–°å¢ä¿¡æ¯çš„è§£ç æ–¹å¼å’Œå«ä¹‰ä¸å‰é¢çš„Stringså®Œå…¨ç›¸åŒï¼Œè¿™é‡Œä¸å†é‡å¤è§£é‡Šäº†ã€‚1A==&gt;0x1A==&gt;0b(0001 1010)&gt;26&gt;3&lt;&lt;3|2æ‰€ä»¥ type =2;æ ‡å·å¾—3repeated æ¶ˆæ¯è¯´æ˜12345&gt;&gt;&gt;æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ä¼šè¢«ç¼–ç æˆä¸€ä¸ªå•ä¸€çš„key/valueå½¢å¼ã€‚&gt;&gt;&gt;æ¯•ç«Ÿæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å…·æœ‰ç›¸åŒçš„å­—æ®µç±»å‹å’Œæ ‡å·ã€‚è¯¥ç¼–ç å½¢å¼ï¼Œ&gt;&gt;&gt;å¯¹åŒ…å«è¾ƒå°å€¼çš„æ•´å‹å…ƒç´ è€Œè¨€ï¼Œ&gt;&gt;&gt;ä¼˜åŒ–åçš„ç¼–ç ç»“æœå¯ä»¥èŠ‚çœæ›´å¤šçš„ç©ºé—´ã€‚&gt;&gt;&gt;å…ˆå®šä¹‰ä¸€ä¸ª repeated çš„æ¶ˆæ¯ç±»å‹12345&gt;&gt;&gt;message Test4 &gt;&gt;&gt;&#123; repeat int32 d = 4;//æ ‡å·ä¸º4&#125;&gt;&gt;&gt;è¿™é‡Œæˆ‘ä»¬å‡è®¾då­—æ®µåŒ…å«3ä¸ªå…ƒç´ ï¼Œå€¼åˆ†åˆ«ä¸º3,270,86942ã€‚å…¶ç¼–ç ç»“æœå¦‚ä¸‹ï¼š22 // key (å­—æ®µæ ‡å·4ï¼Œç±»å‹ä¸º2) 06 // æ•°æ®ä¸­æ‰€æœ‰å…ƒç´ æ‰€å ç”¨çš„å­—èŠ‚æ•°é‡ (3å 1 Byte; 270 å  2Byte ;86942 å  3å­—èŠ‚) 03 // ç¬¬ä¸€ä¸ªå…ƒç´ (varint 3) 8E 02 // ç¬¬äºŒä¸ªå…ƒç´ (varint 270) 9E A7 05 // ç¬¬ä¸‰ä¸ªå…ƒç´ (varint 86942) 1234&gt;&gt;270==&gt;0b 1 0000 1110 ==å­—èŠ‚ç¿»è½¬å»é™¤msb==&gt; 0b 000 1110 000 0010==è¡¥å……æˆªæ­¢ç¬¦å·==&gt; 0b 1000 1110 0000 0010 ===&gt;0x8E 0x02==&gt;8E 02&gt;&gt;&gt;å­—æ®µé¡ºåºåœ¨.protoæ–‡ä»¶ä¸­å®šä¹‰æ¶ˆæ¯çš„å­—æ®µæ ‡å·æ—¶ï¼Œå¯ä»¥æ˜¯ä¸è¿ç»­çš„ï¼Œä½†æ˜¯å¦‚æœå°†å…¶å®šä¹‰ä¸ºè¿ç»­é€’å¢çš„æ•°å€¼ï¼Œå°†è·å¾—æ›´å¥½çš„ç¼–ç å’Œè§£ç æ€§èƒ½ã€‚ Protobuf æ€§èƒ½æŒ‡æ ‡åºåˆ—åŒ–é€Ÿåº¦æŠ¥æ–‡å¤§å°è¯„ä¼°å‡†å¤‡ä½¿ç”¨ç»Ÿä¸€çš„æ¶ˆæ¯ä½“æ ¼å¼ä½¿ç”¨çš„ç±»åº“è¯­è¨€|ç±»åº“----------|---------|Java|Java SerializeJava|XML;JAXBJava| Jsonä½¿ç”¨gson åº“Java |Protobuf å®˜æ–¹æ ‡å‡†åº“ 3.1.0C#|.Net SerializeC# |Protobuf å®˜æ–¹æ ‡å‡†åº“ 3.1.0C++|protobuf å®˜æ–¹æ ‡å‡†åº“ 3.1.0Objective-C|protobuf å®˜æ–¹æ ‡å‡†åº“ 3.1.0è¯„ä¼°ç»“æœç±»æŠ¥æ–‡å¤§å°(bytes)åºåˆ—åŒ–è€—æ—¶(ms)ååºåˆ—åŒ–è€—æ—¶(ms)Java Serialize|1610|997|1037Java XML|4141|2468|4001Java Json|3153|11437|17351Java Protobuf|933|776|422C# .Net Serialize|2726|4573|3185C# Protobuf|933|488|673C++ Protobuf|933|282|297Objective-C|933|310|308 proto æ–‡ä»¶å®šä¹‰å°ç»“syntax = â€œproto3â€; //å£°æ˜proto ç‰ˆæœ¬option java_package = â€œcom.ajmd.ajpolling.protoâ€; //å£°æ˜ç”Ÿæˆçš„Java ç±»åŒ…åoption java_outer_classname = â€œAJMD_LCâ€; //å£°æ˜ç”Ÿæˆçš„Java ç±»å‰ç¼€option optimize_for = SPEED; //å£°æ˜ä¼˜åŒ–ç±»å‹(SPEED/CODE_SIZE/LITE_RUNTIME)SPEEDè¡¨ç¤ºç”Ÿæˆçš„ä»£ç è¿è¡Œæ•ˆç‡é«˜ï¼Œä½†æ˜¯ç”±æ­¤ç”Ÿæˆçš„ä»£ç ç¼–è¯‘åä¼šå ç”¨æ›´å¤šçš„ç©ºé—´CODE_SIZEå’ŒSPEEDæ°æ°ç›¸åï¼Œä»£ç è¿è¡Œæ•ˆç‡è¾ƒä½ï¼Œä½†æ˜¯ç”±æ­¤ç”Ÿæˆçš„ä»£ç ç¼–è¯‘åä¼šå ç”¨æ›´å°‘çš„ç©ºé—´ï¼Œé€šå¸¸ç”¨äºèµ„æºæœ‰é™çš„å¹³å°ï¼Œå¦‚Mobileã€‚LITE_RUNTIMEç”Ÿæˆçš„ä»£ç æ‰§è¡Œæ•ˆç‡é«˜ï¼ŒåŒæ—¶ç”Ÿæˆä»£ç ç¼–è¯‘åçš„æ‰€å ç”¨çš„ç©ºé—´ä¹Ÿæ˜¯éå¸¸å°‘ã€‚è¿™æ˜¯ä»¥ç‰ºç‰²Protocol Bufferæä¾›çš„åå°„åŠŸèƒ½ä¸ºä»£ä»·çš„ã€‚å› æ­¤æˆ‘ä»¬åœ¨C++ä¸­é“¾æ¥Protocol Bufferåº“æ—¶ä»…éœ€é“¾æ¥libprotobuf-liteï¼Œè€Œélibprotobufã€‚åœ¨Javaä¸­ä»…éœ€åŒ…å«protobuf-java-2.4.1-lite.jarï¼Œè€Œéprotobuf-java-2.4.1.jarã€‚ protobuf ä¸ json å…±é€šæ®è¯´ protobuf V3 ä¸ json å·²ç»æ”¯æŒ(åé¢å»ç ”ç©¶)","categories":[{"name":"Protobuf","slug":"Protobuf","permalink":"http://www.wortyby.com/categories/Protobuf/"}],"tags":[{"name":"Protobuf","slug":"Protobuf","permalink":"http://www.wortyby.com/tags/Protobuf/"}]},{"title":"mqtt","slug":"mqttLib è®¾è®¡æ–‡æ¡£","date":"2018-12-19T07:26:14.000Z","updated":"2018-12-19T07:26:14.000Z","comments":true,"path":"2018/12/19/mqttLib è®¾è®¡æ–‡æ¡£/","link":"","permalink":"http://www.wortyby.com/2018/12/19/mqttLib è®¾è®¡æ–‡æ¡£/","excerpt":"","text":"mqttLib(TLS/SSL)mqtt å»ºç«‹è¿æ¥ (è¯¦æƒ…è¯·æŸ¥é˜… demo ä»£ç )æ‰€éœ€è¦çš„clientId,userName/Passwordå…¶ä¸­æ‰€æœ‰çš„timestamp ä½¿ç”¨çš„æ˜¯year+month+day+hour+minute+second æ¯”å¦‚[20170110130506]salt ä¼šä¾æ®appçš„ version åŠ¨æ€å˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦å®¢æˆ·ç«¯ç»´æŠ¤ä¸€ä¸ª map(version,salt)**æ¯”å¦‚ {@â€œ2.0.1â€ğŸ˜¡â€œJLEYcOiE45gTm6T2dUc7cgRC4DY8WYAtâ€} **Password éœ€è¦å¤§å†™cleansession=False &amp;&amp; subscribe qos=1 or 2 æ¥ä¿éšœoffline message receive.sub topictopic è§„åˆ™**(ajmd/program/music/7204442/v1)**;consume messageå»ºç«‹æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†æ¥å—åˆ°çš„ä¿¡æ¯;è¿æ¥å¤±è´¥ï¼Œæ–­å¼€è¿æ¥ï¼Œé‡è¿æœºåˆ¶ï¼Œè®¢é˜…æˆåŠŸå¤„ç†ï¼Œè®¢é˜…å¤±è´¥å¤„ç†;android éœ€è¦æœåŠ¡å™¨æä¾›è‡ªç­¾åè¯ä¹¦.å‚æ•°è¯´æ˜clientID1clientId = ajmd_devicetoken_[iosandroid]_version#_timestampe.g1ajmd_ffffffff-9ce0-40a7-0033-c5870033c587_android_2.0.1_20170110130506userName1username=ajmd_devicetokene.g1ajmd_ffffffff-9ce0-40a7-0033-c5870033c587password1password=md5(devicetoken+version#+timestamp+salt)e.g12md5String = [md5(6ac33d90-79fb-4be4-865c-bb65cb912af62.0.120170110130506JLEYcOiE45gTm6T2dUc7cgRC4DY8WYAt) uppercaseString]password =52EBCE000A3588686CBA5464DC946974 åŠ¨æ€åº“é™æ€åº“(.so/.a)ç¼–è¯‘ç¼–è¯‘ç¯å¢ƒæ­å»ºCMake/Android Studio/Xcodeç¼–è¯‘é€‰é¡¹è®¾å®šæ”¯æŒçš„cpu æ¶æ„iOS(armv7 i386 x86_64 arm64)[Android(â€˜x86â€™, â€˜armeabiâ€™, â€˜armeabi-v7aâ€™)SSL/TLS åŠ å¯†ç¼–è¯‘ä»¥åŠè®¾ç½®æ‰“å¼€ç¼–è¯‘é€‰é¡¹ å¢åŠ OPENSSL å® ;ä¸‹è½½openssl æºç åˆ°æœ¬åœ°ç”µè„‘ç›®å½• ;Xcode æˆ– CMake è®¾å®šopenssl æºç æ–‡ä»¶ç›®å½• ;Xcode build .aandroid studio build .so protobuf åº“ç¼–è¯‘iOS ç›´æ¥ä½¿ç”¨ cocoaPods ç®¡ç†;android ä½¿ç”¨protobuf å®˜æ–¹çš„3.1.0 ç‰ˆæœ¬ã€‚ MQTTLib Arch serverã€iOSã€Android æ•°æ®äº¤æ¢æ ¼å¼å®šä¹‰æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104syntax = &quot;proto3&quot;;option java_package = &quot;com.ajmd.ajpolling.proto&quot;;option java_outer_classname = &quot;AJMD_LC&quot;;option optimize_for = SPEED;message MessageReqResp&#123; string code =1;//æ¶ˆæ¯ID string msg = 2; message PollData &#123; enum Msg_Type &#123; Msg_Type_Chat = 0;//èŠå¤© Msg_Type_Gift =1;//ç¤¼ç‰© Msg_Type_Plug =2;//æ’ä»¶ Msg_Type_Command =3;//å‘½ä»¤ Msg_Type_Music =4;//éŸ³ä¹ Msg_Type_Pack =5;//ç¤¼åŒ… Msg_Type_Prize =6;//ä¸­å¥– &#125; message Chat&#123; int64 msgid = 1; string c = 2; string m = 3; int32 i = 4; string username = 5; string uimgPath = 6; string attach = 7; &#125; message Gift&#123; int64 msgid = 1; string c = 2; string m = 3; int32 i = 4; string username = 5; string uimgPath = 6; int32 giftType = 7; int32 giftNum = 8; string giftimgPath = 9; string giftUnit = 10; &#125; message Plug&#123; int64 msgid = 1; string c = 2; string m = 3; int32 i = 4; string username = 5; string uimgPath = 6; message TopicAttach&#123; string link=1; string name = 2; int64 programId = 3; string subject = 4; string thread_imgpath = 5; string topic_id = 6; string type = 7; string uimgPath = 8; string username=9; &#125; TopicAttach topicAttach = 7; &#125; message Command&#123; string date=1; string command=2; &#125; message Music &#123; int32 duration = 1;//æ—¶é•¿ int32 musicOnTime = 2;//éŸ³ä¹æ‰€åœ¨æµä¸­çš„æ—¶é—´ string ablum = 3;//ä¸“è¾‘åç§° string artist = 4;//æ¼”å”±è€… string title = 5;//æ ‡é¢˜åç§° &#125; message Pack &#123; int64 packageId=1; string presenterName=2; string presenterImgPath=3; string packageImg=4; &#125; message Prize &#123; int64 msgid=1; string c = 2; string m=3; int32 i = 4; string giftImg=5; string username=6; string uimgPath=7; &#125; Msg_Type type = 1; Chat chat =2; Gift gift = 3; Plug plug =4; Command cmd=5; Music music = 6; Pack pack =7; Prize prize =8; &#125; repeated PollData list = 3;&#125;&gt;åˆ›å»ºå¹³å°ä»£ç &gt;&gt;protoc --java_out=. --objc_out=. --php_out=. ajmideMessage.proto","categories":[{"name":"mqtt","slug":"mqtt","permalink":"http://www.wortyby.com/categories/mqtt/"}],"tags":[{"name":"mqtt","slug":"mqtt","permalink":"http://www.wortyby.com/tags/mqtt/"}]},{"title":"Data Format","slug":"binary_data_format","date":"2018-12-19T07:25:59.000Z","updated":"2018-12-19T07:25:59.000Z","comments":true,"path":"2018/12/19/binary_data_format/","link":"","permalink":"http://www.wortyby.com/2018/12/19/binary_data_format/","excerpt":"","text":"Data Format We use protobuf to pack transfer Info message in version 3.1.0Since Protobuf Version 3.1.* begin to support more program language such as c/c++ ,objective-c ,python ,php,java etc to produce proper RPC Code for Android,iOS,Server to communicate each other. Transfer Binary Data FormatThe following is a sample which Ajmd Client communicate with Server:protobuf DataType Data (fixed 4Bytes)CMDRequest0001ChatMessage0002â€¦â€¦â€¦â€¦GameMessage1001â€¦â€¦â€¦â€¦GiftMessage1111parameter explain12- protobuf Data segment pack the Objective-C object data to send.- type Data segment pack the type enum that points out what response parser to parse the protobuf Data segment,this segment represent pack Transfer Binary Datastore the send data into a binary array which size is large 4bytes.store the needed parse type into the up binary arrayâ€™s last 4bytessend the new packed binary data to the other.android exam:123456789101112131415161718192021222324252627282930CMDRequest.Builder builder = CMDRequest.newBuilder(); builder.setAction(CMD_TYPE.CMD_TYPE_ENDMUTELIVE); CMDRequest request = builder.build(); byte[] reqBytes = request.toByteArray(); final int len = reqBytes.length; final int type =5 ; final byte[] sendData = new byte[len+4]; final byte[] typeData = intToByteArray(type); System.arraycopy(reqBytes,0,sendData,0,len); System.arraycopy(typeData,0,sendData,len,4); final MqttMessage message = new MqttMessage(sendData); if(mqttClient==null || !mqttClient.isConnected())&#123; Toast.makeText(getApplicationContext(),&quot;MQTTæœªè¿æ¥&quot;,Toast.LENGTH_LONG).show(); return; &#125; new Thread(new Runnable() &#123; @Override public void run() &#123; try&#123; mqttClient.publish(targetID, message); &#125; catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; &#125;).start();ios exam:123456789101112131415161718192021222324252627 CMDRequest* req = [[CMDRequest alloc]init];[req setAction:CMD_TYPE_CmdTypeNeedendlive];NSData* sendData = [req data];int type = 5;NSData *data = [NSData dataWithBytes: &amp;type length: sizeof(type)];NSMutableData* sd = [NSMutableData data];[sd appendData:sendData];[sd appendData:data];MQTTAsync_message message = MQTTAsync_message_initializer;message.payload = (void*)[sd bytes];message.payloadlen = (int)[sd length];_publishButton.enabled = NO;_publishField.enabled = NO;MQTTAsync_responseOptions pubOptions = MQTTAsync_responseOptions_initializer;pubOptions.onSuccess = mqttPublishSucceeded;pubOptions.onFailure = mqttPublishFailed;pubOptions.context = (__bridge void*)weakSelf;int status = MQTTAsync_sendMessage(_mqttClient, _publishField.text.UTF8String, &amp;message, &amp;pubOptions);if (!status != MQTTASYNC_SUCCESS) &#123; _publishField.enabled = YES; _publishButton.enabled = YES; &#125; upack Transfer Binary DataReceive the entire binary data to a binary array.Extract last fixed 4bytes data to get the parse response type;According the typeâ€™s value ,client can parse the protobuf to proper client language object.android exam:12345678910111213141516171819202122232425@Override public void messageArrived(String topic, MqttMessage message) throws Exception &#123; final byte[] rdata = message.getPayload(); final int len = rdata.length; final int type ; final byte[] realData = new byte[len-4]; final byte[] typeData = new byte[4]; System.arraycopy(rdata,0,realData,0,realData.length); System.arraycopy(rdata,len-4,typeData,0,4); type = byteArrayToInt(typeData); CMDResponse response = CMDResponse.parseFrom(realData); final String msg = new String(message.getPayload()); this.runOnUiThread(new Runnable() &#123; public void run() &#123; Toast.makeText(getApplicationContext(), &quot;æ”¶åˆ°:&quot;+msg, Toast.LENGTH_LONG).show(); &#125; &#125;); &#125;ios exam:123456789101112131415161718192021int mqttMessageArrived(void* context, char* topicName, int topicLen, MQTTAsync_message* message)&#123; dispatch_async(dispatch_get_main_queue(), ^&#123; NSError* error = nil; NSData* data = [NSData dataWithBytes:message-&gt;payload length:message-&gt;payloadlen]; int type; NSMutableData* rd = [NSMutableData dataWithData:data]; NSData* typeData = [rd subdataWithRange:NSMakeRange(message-&gt;payloadlen-sizeof(type), sizeof(type))]; [typeData getBytes: &amp;type length: sizeof(type)]; NSData* RealData = [rd subdataWithRange:NSMakeRange(0, message-&gt;payloadlen-sizeof(type))]; CMDResponse* response = [CMDResponse parseFromData:RealData error:&amp;error]; printf(&quot;MQTT message arrived from topic: %s with body: %zi\\n&quot;, topicName, response.action); return true;&#125; how to use protobufdescribe the web service in a xxx.proto file likedefine the proto version by syntax= â€œproto3â€;define the proto java package by option java_package = â€œcom.ajmide.protoâ€;define the proto java class name by option java_outer_classname = â€œAJMD_LCâ€;define the compile option by option optimize_for = SPEED;example for definetion named ajmideMessage.proto123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170syntax = &quot;proto3&quot;;option java_package = &quot;com.ajmide.proto&quot;;option java_outer_classname = &quot;AJMD_LC&quot;;option optimize_for = SPEED;message ChatMessageRequest&#123; enum Msg_Type&#123; Msg_Type_Label = 0;//æ–‡å­— Msg_Type_Image =1;//å›¾ç‰‡ &#125; Msg_Type type = 1 ;//æ¶ˆæ¯ç±»å‹ string msg = 2; string msgColor = 3; string img = 4; int32 time = 5; int32 insertTime = 6;&#125;message ChatMessageResponse&#123; message Result &#123; string msgId =1;//æ¶ˆæ¯ID enum Msg_Type&#123; Msg_Type_Label = 0;//æ–‡å­— Msg_Type_Image =1;//å›¾ç‰‡ &#125; Msg_Type type = 2 ;//æ¶ˆæ¯ç±»å‹ string msg = 3; string msgColor = 4; string img = 6; int32 time = 7; int32 insertTime = 8; string usernick = 9; enum Role_Type &#123; Role_Type_Usual = 0;//æ™®é€šç”¨æˆ· Role_Type_Host = 1;//ä¸»æ’­ &#125; Role_Type userrole = 10 ;//ç”¨æˆ·è§’è‰² string portrait = 11; &#125; repeated Result result = 1;&#125;message GiftMessageRequest&#123; enum Gift_Type &#123; Gift_Type_Gift = 0;//ç¤¼ç‰© Gift_Type_Money =1;//æ‰“èµ &#125; Gift_Type type = 1 ;//ç¤¼ç‰©ç±»å‹ string presenterId = 2;//ä¸»æŒäººID string giftId = 3;//ç¤¼ç‰©ID int32 count = 4;//ç¤¼ç‰©å›¾ç‰‡ int32 giftCode = 5;//ç¤¼ç‰©code int32 time = 6;//å‘é€æ—¶é—´ç‚¹ ç§’&#125;message GiftMessageResponse&#123; message Result &#123; string msgId =1;//æ¶ˆæ¯ID enum Gift_Type&#123; Gift_Type_Gift = 0;//ç¤¼ç‰© Gift_Type_Money =1;//æ‰“èµ &#125; Gift_Type type = 2 ;//ç¤¼ç‰©ç±»å‹ int32 giftNum = 3;//ç¤¼ç‰©æ•°é‡ string giftUnit = 4;//ç¤¼ç‰©å•ä½ string giftImg = 5;//ç¤¼ç‰©å›¾ç‰‡ int32 time = 6;//å‘é€æ—¶é—´ç‚¹ ç§’ string usernick = 7;//ç”¨æˆ·æ˜µç§° string portrait = 8;//ç”¨æˆ·å¤´åƒ &#125; repeated Result result = 1;&#125;message PluginMessageRequest&#123; enum Plugin_Type&#123; Plugin_Type_Topic = 0;//å¸–å­ Plugin_Type_Vote =1;//æŠ•ç¥¨ Plugin_Type_Sec = 2;//ç§’æ€ &#125; Plugin_Type type = 1 ;//æ’ä»¶ç±»å‹ string name = 2;//æ’ä»¶åç§° string subject = 3;//æ’ä»¶æ ‡é¢˜ string topicId = 4;//å¸–å­ID string programId = 5;//èŠ‚ç›®ID string plugImg = 6;//æ’ä»¶å›¾ç‰‡ string link = 7;//æ’ä»¶é“¾æ¥åœ°å€?è¿™ä¸ªå‘é€çš„æ—¶å€™ä¼šä¸ä¼šèµ°ä¸€ä¸ªhttpå‘é€callback æˆURLï¼Ÿ int32 time = 8;//ç”¨æˆ·æ˜µç§°&#125;message PluginMessageResponse&#123; message Result&#123; string msgId =1; enum Plugin_Type&#123; Plugin_Type_Topic = 0;//å¸–å­ Plugin_Type_Vote =1;//æŠ•ç¥¨ Plugin_Type_Sec = 2;//ç§’æ€ &#125; Plugin_Type type = 2 ;//æ’ä»¶ç±»å‹ string name = 3;//æ’ä»¶åç§° string subject = 4;//æ’ä»¶æ ‡é¢˜ string topicId = 5;//å¸–å­ID string programId = 6;//èŠ‚ç›®ID string plugImg = 7;//æ’ä»¶å›¾ç‰‡ string link = 8;//æ’ä»¶é“¾æ¥åœ°å€ string usernick = 9;//ç”¨æˆ·æ˜µç§° string portrait = 10;//ç”¨æˆ·å¤´åƒ &#125; repeated Result result = 1;&#125;message DistinguishMusicMessageResponse&#123; message Result&#123; int32 duration = 1;//æ—¶é•¿ int32 musicOnTime = 2;//éŸ³ä¹æ‰€åœ¨æµä¸­çš„æ—¶é—´ string ablum = 3;//ä¸“è¾‘åç§° string artist = 4;//æ¼”å”±è€… string giftImg = 5;//ç¤¼ç‰©å›¾ç‰‡ &#125; repeated Result result = 1;&#125;enum CMD_TYPE&#123; CMD_TYPE_STARTLIVE =0;//å¼€å§‹ç›´æ’­ CMD_TYPE_ENDLIVE=1;//ç»“æŸç›´æ’­ CMD_TYPE_NEEDENDLIVE=2;//å³å°†ç»“æŸç›´æ’­ CMD_TYPE_STARTMUTELIVE=3;//é™éŸ³ CMD_TYPE_ENDMUTELIVE=4;//ç»“æŸé™éŸ³&#125;message CMDRequest&#123; CMD_TYPE action =1;&#125;message CMDResponse&#123; CMD_TYPE action=1;&#125;//å½“å‰åªæœ‰ä»¥ä¸‹4ç§ä¿¡æ¯éœ€è¦è§£æå¤„ç†ï¼ŒåæœŸå¦‚æœæœ‰æ·»åŠ ï¼Œéœ€è¦æ›´æ–°ä»¥ä¸‹æšä¸¾æ–‡ä»¶enum ResponseParseType&#123; ResponseParseType_ChatMessageResponse=0;//èŠå¤©ä¿¡æ¯è§£æ ResponseParseType_GiftMessageResponse=1;//ç¤¼ç‰©ä¿¡æ¯è§£æ ResponseParseType_PluginMessageResponse=2;//æ’ä»¶ä¿¡æ¯è§£æ ResponseParseType_DistinguishMusicMessageResponse=3;//éŸ³ä¹è¯†åˆ«ä¿¡æ¯è§£æ&#125;generate RPC code by the following command1protoc --java_out=. --objc_out=. --php_out=. ajmideMessage.proto","categories":[{"name":"Data Format","slug":"Data-Format","permalink":"http://www.wortyby.com/categories/Data-Format/"}],"tags":[{"name":"Data Format","slug":"Data-Format","permalink":"http://www.wortyby.com/tags/Data-Format/"}]},{"title":"AJMD Content Workflows (AJCW)","slug":"tornado å†ä½“éªŒ","date":"2018-12-19T07:24:45.000Z","updated":"2018-12-19T07:24:45.000Z","comments":true,"path":"2018/12/19/tornado å†ä½“éªŒ/","link":"","permalink":"http://www.wortyby.com/2018/12/19/tornado å†ä½“éªŒ/","excerpt":"","text":"AJMD Content Workflows (AJCW)AJCW is a library designed to bring a simple appraoch to workflows in Content Processing Mornitor .It provides :workflow definition;Running code when performing transitions;Hooks for running extra code before/after transition;A hook for logging performed transitions;GlossaryLSFPlatform LSF is a commercial DRMSGESun Grid Engine is a commercial DRMGEGrid Engine is an open source version of SGEDRMDistributed Resource Management System. This is the underlying queuing software that manages jobs on a cluster. Examples include LSF, and SGEDRMAADistributed Resorce Management Application API. A standard library that is an abstraction built on top of DRM so that the same application code can seamlessly run on any DRM that supports DRMAADAGDirected Acyclic Graph. A DAG is used byCosmos to describe a workflowâ€™s jobs and their dependencies on each other.FlaskA Python web framework Cosmos uses for its web-interfaceSqlalchemyA popular Python ORM that Cosmos uses","categories":[{"name":"workFlow","slug":"workFlow","permalink":"http://www.wortyby.com/categories/workFlow/"}],"tags":[{"name":"workflow","slug":"workflow","permalink":"http://www.wortyby.com/tags/workflow/"}]},{"title":"weUI åˆä½“éªŒ","slug":"weUI åˆä½“éªŒ","date":"2018-12-19T07:23:39.000Z","updated":"2018-12-19T07:23:39.000Z","comments":true,"path":"2018/12/19/weUI åˆä½“éªŒ/","link":"","permalink":"http://www.wortyby.com/2018/12/19/weUI åˆä½“éªŒ/","excerpt":"","text":"weUI åˆä½“éªŒ1. Header Placeholder1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-cmn-Hans&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1,user-scalable=0&quot; /&gt; &lt;title&gt;WeUI&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;../style/weui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;./example.css&quot; /&gt; &lt;/head&gt; &lt;body ontouchstart=&quot;&quot;&gt; &lt;div class=&quot;weui-toptips weui-toptips_warn js_tooltips&quot;&gt; é”™è¯¯æç¤º &lt;/div&gt; &lt;div class=&quot;container&quot; id=&quot;container&quot;&gt;&lt;/div&gt;2. Page Content123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259&lt;script type=&quot;text/html&quot; id=&quot;tpl_home&quot;&gt;&lt;div class=&quot;page&quot;&gt; &lt;div class=&quot;page__hd&quot;&gt; &lt;h1 class=&quot;page__title&quot;&gt; &lt;img src=&quot;./images/logo.png&quot; alt=&quot;WeUI&quot; height=&quot;21px&quot; /&gt; &lt;/h1&gt; &lt;p class=&quot;page__desc&quot;&gt;WeUI æ˜¯ä¸€å¥—åŒå¾®ä¿¡åŸç”Ÿè§†è§‰ä½“éªŒä¸€è‡´çš„åŸºç¡€æ ·å¼åº“ï¼Œç”±å¾®ä¿¡å®˜æ–¹è®¾è®¡å›¢é˜Ÿä¸ºå¾®ä¿¡å†…ç½‘é¡µå’Œå¾®ä¿¡å°ç¨‹åºé‡èº«è®¾è®¡ï¼Œä»¤ç”¨æˆ·çš„ä½¿ç”¨æ„ŸçŸ¥æ›´åŠ ç»Ÿä¸€ã€‚&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;page__bd page__bd_spacing&quot;&gt; &lt;ul&gt; &lt;li&gt; &lt;div class=&quot;weui-flex js_category&quot;&gt; &lt;p class=&quot;weui-flex__item&quot;&gt;è¡¨å•&lt;/p&gt; &lt;img src=&quot;./images/icon_nav_form.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;page__category js_categoryInner&quot;&gt; &lt;div class=&quot;weui-cells page__category-content&quot;&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;button&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Button&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;input&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Input&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;list&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;List&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;slider&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Slider&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;uploader&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Uploader&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div class=&quot;weui-flex js_category&quot;&gt; &lt;p class=&quot;weui-flex__item&quot;&gt;åŸºç¡€ç»„ä»¶&lt;/p&gt; &lt;img src=&quot;./images/icon_nav_layout.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;page__category js_categoryInner&quot;&gt; &lt;div class=&quot;weui-cells page__category-content&quot;&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;articl43&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Article&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;badge&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Badge&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;flex&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Flex&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;footer&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Footer&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;gallery&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Gallery&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;grid&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Grid&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;icons&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Icons&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;loadmore&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Loadmore&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;panel&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Panel&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;preview&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Preview&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;progress&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Progress&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div class=&quot;weui-flex js_category&quot;&gt; &lt;p class=&quot;weui-flex__item&quot;&gt;æ“ä½œåé¦ˆ&lt;/p&gt; &lt;img src=&quot;./images/icon_nav_feedback.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;page__category js_categoryInner&quot;&gt; &lt;div class=&quot;weui-cells page__category-content&quot;&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;actionsheet&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Actionsheet&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;dialog&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Dialog&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;msg&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Msg&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;picker&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Picker&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;toast&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Toast&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div class=&quot;weui-flex js_category&quot;&gt; &lt;p class=&quot;weui-flex__item&quot;&gt;å¯¼èˆªç›¸å…³&lt;/p&gt; &lt;img src=&quot;./images/icon_nav_nav.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;page__category js_categoryInner&quot;&gt; &lt;div class=&quot;weui-cells page__category-content&quot;&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;navbar&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Navbar&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;tabbar&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Tabbar&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div class=&quot;weui-flex js_category&quot;&gt; &lt;p class=&quot;weui-flex__item&quot;&gt;æœç´¢ç›¸å…³&lt;/p&gt; &lt;img src=&quot;./images/icon_nav_search.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;page__category js_categoryInner&quot;&gt; &lt;div class=&quot;weui-cells page__category-content&quot;&gt; &lt;a class=&quot;weui-cell weui-cell_access js_item&quot; data-id=&quot;searchbar&quot; href=&quot;javascript:;&quot;&gt; &lt;div class=&quot;weui-cell__bd&quot;&gt; &lt;p&gt;Search Bar&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;weui-cell__ft&quot;&gt;&lt;/div&gt; &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div class=&quot;weui-flex js_item&quot; data-id=&quot;layers&quot;&gt; &lt;p class=&quot;weui-flex__item&quot;&gt;å±‚çº§è§„èŒƒ&lt;/p&gt; &lt;img src=&quot;./images/icon_nav_z-index.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;div class=&quot;page__ft&quot;&gt; &lt;a href=&quot;javascript:home()&quot;&gt;&lt;img src=&quot;./images/icon_footer.png&quot; /&gt;&lt;/a&gt; &lt;/div&gt;&lt;/div&gt;&lt;script type=&quot;text/javascript&quot;&gt; $(function()&#123; var winH = $(window).height(); var categorySpace = 10; $(&apos;.js_item&apos;).on(&apos;click&apos;, function()&#123; var id = $(this).data(&apos;id&apos;); window.pageManager.go(id); &#125;); $(&apos;.js_category&apos;).on(&apos;click&apos;, function()&#123; var $this = $(this), $inner = $this.next(&apos;.js_categoryInner&apos;), $page = $this.parents(&apos;.page&apos;), $parent = $(this).parent(&apos;li&apos;); var innerH = $inner.data(&apos;height&apos;); bear = $page; if(!innerH)&#123; $inner.css(&apos;height&apos;, &apos;auto&apos;); innerH = $inner.height(); $inner.removeAttr(&apos;style&apos;); $inner.data(&apos;height&apos;, innerH); &#125; if($parent.hasClass(&apos;js_show&apos;))&#123; $parent.removeClass(&apos;js_show&apos;); &#125;else&#123; $parent.siblings().removeClass(&apos;js_show&apos;); $parent.addClass(&apos;js_show&apos;); if(this.offsetTop + this.offsetHeight + innerH &gt; $page.scrollTop() + winH)&#123; var scrollTop = this.offsetTop + this.offsetHeight + innerH - winH + categorySpace; if(scrollTop &gt; this.offsetTop)&#123; scrollTop = this.offsetTop - categorySpace; &#125; $page.scrollTop(scrollTop); &#125; &#125; &#125;); &#125;);&lt;/script&gt;3 Content Link Distinguish.1234567891011121314151617181920212223242526272829303132333435363738394041&lt;script type=&quot;text/html&quot; id=&quot;tpl_articl43&quot;&gt;&lt;div class=&quot;page&quot;&gt; &lt;div class=&quot;page__hd&quot;&gt; &lt;h1 class=&quot;page__title&quot;&gt;Article&lt;/h1&gt; &lt;p class=&quot;page__desc&quot;&gt;æ–‡ç« &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;page__bd&quot;&gt; &lt;article class=&quot;weui-article&quot;&gt; &lt;h1&gt;å¤§æ ‡é¢˜&lt;/h1&gt; &lt;section&gt; &lt;h2 class=&quot;title&quot;&gt;ç« æ ‡é¢˜&lt;/h2&gt; &lt;section&gt; &lt;h3&gt;1.1 èŠ‚æ ‡é¢˜&lt;/h3&gt; &lt;p&gt; Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. &lt;/p&gt; &lt;p&gt; &lt;img src=&quot;./images/pic_article.png&quot; alt=&quot;&quot;&gt; &lt;img src=&quot;./images/pic_article.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt; &lt;/section&gt; &lt;section&gt; &lt;h3&gt;1.2 èŠ‚æ ‡é¢˜&lt;/h3&gt; &lt;p&gt; Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. &lt;/p&gt; &lt;/section&gt; &lt;/section&gt; &lt;/article&gt; &lt;/div&gt; &lt;div class=&quot;page__ft&quot;&gt; &lt;a href=&quot;javascript:home()&quot;&gt;&lt;img src=&quot;./images/icon_footer_link.png&quot; /&gt;&lt;/a&gt; &lt;/div&gt;&lt;/div&gt;&lt;/script&gt;4 footer123456 &lt;script src=&quot;./zepto.min.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;https://res.wx.qq.com/open/js/jweixin-1.0.0.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./weui.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./example.js&quot;&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt;","categories":[{"name":"weUI","slug":"weUI","permalink":"http://www.wortyby.com/categories/weUI/"}],"tags":[{"name":"weUI","slug":"weUI","permalink":"http://www.wortyby.com/tags/weUI/"}]},{"title":"Spark æäº¤ Python é‚£ç‚¹äº‹","slug":"Spark æäº¤PYTHON é‚£ç‚¹äº‹","date":"2018-12-18T02:58:15.000Z","updated":"2018-12-18T02:58:15.000Z","comments":true,"path":"2018/12/18/Spark æäº¤PYTHON é‚£ç‚¹äº‹/","link":"","permalink":"http://www.wortyby.com/2018/12/18/Spark æäº¤PYTHON é‚£ç‚¹äº‹/","excerpt":"","text":"èƒŒæ™¯é€šè¿‡ shell è„šæœ¬æäº¤ spark-submit ä»»åŠ¡çš„æ—¶å€™ï¼Œå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å‰ä¸€ç§’å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œåä¸€ç§’å‘ç°æ‰¾ä¸åˆ°ç›¸å…³è‡ªå®šä¹‰çš„moduleï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯å¼•ç”¨ä½œç”¨åŸŸçš„é—®é¢˜ã€‚åç»­ç¡®è®¤Pythonåœ¨æœ¬åœ°æµ‹è¯•æ²¡æœ‰é—®é¢˜ï¼Œè¿è¡Œæ­£å¸¸ï¼Œéƒ¨ç½²åˆ°server å°±å‡ºç° ImportError: No module named * ï¼Œæœ‰ç‚¹è«åçš„å¥‡æ€ªã€‚ æ’é”™ ç¡®è®¤pythonpathé€šè¿‡ sys.path æŸ¥çœ‹ module æ‰€åœ¨è·¯å¾„éƒ½åœ¨ sys.path è·¯å¾„åˆ—è¡¨é‡Œ.æ‰€ä»¥å¯ä»¥æ’é™¤ module ä¸åœ¨ server çš„çŠ¶å†µã€‚ ç¡®è®¤Pythonå®‰è£…ç‰ˆæœ¬é€šè¿‡ which python æŸ¥å¾— Python çš„ç‰ˆæœ¬æ•°ä¸æœ¬åœ°å¼€å‘ç¯å¢ƒçš„Python ç‰ˆæœ¬ä¸€è‡´ã€æ‰€ä»¥æ’é™¤server ç”±äºå®‰è£…å¤šä¸ªPython ç‰ˆæœ¬å¯¼è‡´çš„é—®é¢˜ã€‚ç›®å‰ server ä¸Šæ²¡æœ‰å®‰è£…è™šæ‹Ÿç¯å¢ƒï¼Œæ¯•ç«Ÿä¸šåŠ¡å•ä¸€ã€‚ æœŸå¾…ç”±äºspark æ˜¯ä»¥é›†ç¾¤èµ„æºæ¥è¿è¡Œï¼Œä½†æ˜¯å‘ç°å•çº¯çš„é€šè¿‡spark-submit æäº¤çš„ä»»åŠ¡ï¼Œé€šè¿‡å¢åŠ  --verbose æŸ¥çœ‹è¿è¡Œä¿¡æ¯ï¼Œæ˜¾ç¤ºçš„éƒ½æ˜¯local è¿è¡Œæ¨¡å¼ï¼Œé€šè¿‡æŒ‡å®š --master yarn æ‰èƒ½æŒ‡å®šé›†ç¾¤ä»¥ yarn è¿è¡Œï¼Œå……åˆ†åˆ©ç”¨åˆ†å¸ƒå¼é›†ç¾¤çš„ yarn ä»»åŠ¡è°ƒåº¦ã€‚æ­¤æ—¶ï¼Œä½ ä¼šå‘ç° deployMode è¿˜æ˜¯ ä»¥ client æ–¹å¼è¿è¡Œï¼Œé€šè¿‡æ–‡æ¡£å¯çŸ¥ï¼ŒdeployMode è¿˜æœ‰ä¸€ä¸ª cluster æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘é€šè¿‡å¢åŠ  ä¸€ä¸ªå‚æ•° --deployMode cluster æ¥è¾¾åˆ°ä¸€ä¸ªï¼Œè®©ä»»åŠ¡ä»¥é›†ç¾¤æ–¹å¼æ­£å¸¸è¿è¡Œã€‚OOPS ï¼Œå‘ç°å±…ç„¶ä¹Ÿæ˜¯æç¤º ImportError: No module named *å¥½äº†ï¼ŒçŸ¥é“æ€ä¹ˆä¸Š Google åˆ©ç”¨å…³é”®è¯æœç´¢äº†ï¼Œè¾“å…¥ spark python ImportError: No module named ï¼Œéœéœï¼Œå±…ç„¶æœ‰å¥½å¤šç±»ä¼¼ç­”æ¡ˆï¼Œæœ€ç»ˆé€šè¿‡é€‰æ‹© è¿™é‡Œ ç»™å‡ºçš„æ–¹æ¡ˆï¼Œè¿›è¡Œå°è¯•ï¼Œeverything éƒ½è§£å†³äº†ã€‚ æ€»ç»“12345spark-submit --verbose audio_als.py --py-files audio_als_dep.zip--master yarn --deployMode cluster &gt;&gt;/data/log/audio_als.logé€šè¿‡ --py-files å°† Python ä¾èµ–çš„ module æˆ– Pythonæ–‡ä»¶ æ‰“åŒ…æˆä¸€ä¸ªzip ç»Ÿä¸€æäº¤åˆ°é›†ç¾¤é‡Œï¼Œä»è€Œå®ç°é›†ç¾¤èµ„æºçš„ä¸€ä¸ªç»Ÿä¸€è°ƒåº¦ä»¥åŠèµ„æºè§„åˆ’ã€‚å½’æ ¹ç»“åº•ï¼Œè¿˜æ˜¯è¦å¤šç ”è¯»å®˜æ–¹æ–‡æ¡£ã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"PySpark","slug":"PySpark","permalink":"http://www.wortyby.com/tags/PySpark/"},{"name":"Module","slug":"Module","permalink":"http://www.wortyby.com/tags/Module/"}]},{"title":"An Introduction to Random Forest using the fastai Library (Machine Learning for Programmersâ€Šâ€”â€ŠPart 1)","slug":"An Introduction to Random Forest using the fastai Library (Machine Learning for Programmersâ€Šâ€”â€ŠPart 1)","date":"2018-12-14T05:10:53.000Z","updated":"2018-12-14T05:10:53.000Z","comments":true,"path":"2018/12/14/An Introduction to Random Forest using the fastai Library (Machine Learning for Programmersâ€Šâ€”â€ŠPart 1)/","link":"","permalink":"http://www.wortyby.com/2018/12/14/An Introduction to Random Forest using the fastai Library (Machine Learning for Programmersâ€Šâ€”â€ŠPart 1)/","excerpt":"","text":"Programming is a crucial prerequisite for anyone wanting to learn machine learning. Sure quite a few autoML tools are out there, but most are still at a very nascent stage and well beyond an individualâ€™s budget. The sweet spot for a data scientist lies in combining programming with machine learning algorithms.Fast.ai led by the amazing partnership of Jeremy Howard and Rachel Thomas. So when they released their machine learning course, I couldnâ€™t wait to get started.What I personally liked about this course is the top-down approach to teaching. You first learn how to code an algorithm in Python, and then move to the theory aspect. While not a unique approach, it certainly has itâ€™s advantages.While going these videos, I decided to curate my learning in the form of a series of articles for our awesome community! So in this first post, I have provided a comprehensive summary (including the code) of the first two videos where Jeremy Howard teaches us how to build a random forest model using the fastai library, and how tuning the different hyperparameters can significantly alter our modelâ€™s accuracy.You need to have a bit of experience in Python to follow along with the code. So if youâ€™re a beginner in machine learning and have not used Python and Jupyter Notebooks before, I recommend checking out the below two resources first:Introduction to Data Science (covers the basics of Python, Statistics and Predictive Modeling)Beginnerâ€™s Guide to Jupyter NotebooksTable of contentsCourse Structure and MaterialsIntroduction to Machine Learning: Lesson 12.1 Importing Necessary Libraries2.2 Downloading the Dataset2.3 Introduction to Random Forest2.4 Preprocessing2.5 Model BuildingIntroduction to Machine Learning: Lesson 23.1 Creating a validation set3.2 Creating a single treeAdditional TopicsCourse Structure and MaterialsThe video lectures are available on YouTube and the course has been divided into twelve lectures as per the below structure:Lesson 1 â€” Introduction to Random ForestsLesson 2 â€” Random Forest Deep DiveLesson 3 â€” Performance, Validation and Model InterpretationLesson 4 â€” Feature Importance, Tree InterpreterLesson 5 â€” Extrapolation and RF from ScratchLesson 6 â€” Data Products and Live CodingLesson 7 â€” RF from Scratch and Gradient DescentLesson 8 â€” Gradient Descent and Logistic RegressionLesson 9 â€” Regularization, Learning Rates, and NLPLesson 10 â€” More NLP and Columnar DataLesson 11 â€” EmbeddingsLesson 12 â€” Complete Rossman, Ethical IssuesThis course assumes that you have Jupyter Notebook installed on your machine. In case you donâ€™t (and donâ€™t prefer installing it either), you can choose any of the following (these have a nominal fee attached to them):CrestlePaperspaceAll the Notebooks associated with each lecture are available on fast.aiâ€™s GitHub repository. You can clone or download the entire repository in one go. You can locate the full installation steps under the to-install section.Introduction to Machine Learning: Lesson 1Ready to get started? Then check out the Jupyter Notebook and the below video for the first lesson.In this lecture, we will learn how to build a random forest model in Python. Since a top-down approach is followed in this course, we will go ahead and code first while simultaneously understanding how the code work. Weâ€™ll then look into the inner workings of the random forest algorithm.Letâ€™s deep dive into what this lecture covers.Importing necessary libraries%load ext_autoreload%autoreload 2The above two commands will automatically modify the notebook when the source code is updated. Thus, using ext_autoreload will automatically and dynamically make the changes in your notebook.%matplotlib inlineUsing %matplotlib inline, we can visualize the plots inside the notebook.from fastai.imports import*from fastai.structured import *from pandas_summary import DataFrameSummaryfrom sklearn.ensemble import RandomForestRegressor, RandomForestClassifierfrom IPython.display import displayfrom sklearn import metricsUsing import* will import everything in the fastai library. Other necessary libraries have also been imported for reading the dataframe summary, creating random forest models and metrics for calculating the RMSE (evaluation metric).Downloading the DatasetThe dataset weâ€™ll be using is the â€˜Blue Book for Bulldozersâ€™. The problem statement for this challenge is described below:The goal is to predict the sale price of a particular piece of heavy equipment at an auction, based on its usage, equipment type, and configuration. The data is sourced from auction result postings and includes information on usage and equipment configurations. Fast Iron is creating a â€œblue book for bulldozersâ€, for customers to value what their heavy equipment fleet is worth at an auction.The evaluation metric is RMSLE (root mean squared log error). Donâ€™t worry if you havenâ€™t heard of it before, weâ€™ll understand and deal with it during the code walk-through. Assuming you have successfully downloaded the dataset, letâ€™s move on to coding!PATH = â€œdata/bulldozers/â€This command is used to set the location of our dataset. We currently have the downloaded dataset stored in a folder named bulldozers within the data folder. To check what are the files inside the PATH, you can type:!ls data/bulldozers/Or,!ls {PATH}Reading the filesThe dataset provided is in a .csv format. This is a structured dataset, with columns representing a range of things, such as ID, Date, state, product group, etc. For dealing with structured data, pandas is the most important library. We already imported pandas as pd when we used the import* command earlier. We will now use the read_csv function of pandas to read the data :df_raw = pd.read_csv(fâ€™{PATH}Train.csvâ€™, low_memory=False, parse_dates=[â€œsaledateâ€])Let us look at the first few rows of the data:df_raw.head()Since the dataset is large, this command does not show us the complete column-wise data. Instead, we will see some dots for the data that isnâ€™t being displayed (as shown in the screenshot):To fix this, we will define the following function, where we set max.rows and max.columns to 1000.def display_all(df):with pd.option_context(â€œdisplay.max_rowsâ€, 1000, display.max_columns&quot;, 1000):display(df)We can now print the head of the dataset using this newly minted function. We have taken the transpose to make it visually appealing (we see column names as the index).display_all(df_raw.head().transpose())Remember the evaluation metric is RMSLE â€” which is basically the RMSE between the log values of the result. So we will transform the target variable by taking itâ€™s log values. This is where the popular library numpy comes to the rescue.df_raw.SalePrice = np.log(df_raw.SalePrice)Introduction to Random ForestThe concept of how a Random Forest model works from scratch will be discussed in detail in the later sections of the course, but here is a brief introduction in Jeremy Howardâ€™s words:Random forest is a kind of universal machine learning techniqueIt can be used for both regression (target is a continuous variable) or classification (target is a categorical variable) problemsIt also works with columns of any kinds, like pixel values, zip codes, revenue, etc.In general, random forest does not overfit (itâ€™s very easy to stop it from overfitting)You do not need a separate validation set in general. It can tell you how well it generalizes even if you only have one datasetIt has few (if any) statistical assumptions (it doesnâ€™t assume that data is normally distributed, data is linear, or that you need to specify the interactions)Requires very few feature engineering tactics, so itâ€™s a great place to start. For many different types of situations, you do not have to take the log of the data or multiply interactions togetherSounds like a smashing technique, right?RandomForestRegressor and RandomForestClassifier functions are used in Python for regression and classification problems respectively. Since weâ€™re dealing with a regression challenge, we will stick to the RandomForestRegressor.m = RandomForestRegressor(n_jobs=-1) m.fit(df_raw.drop(â€˜SalePriceâ€™, axis=1), df_raw.SalePrice)The m.fit function takes two inputs:Independent variablesDependent (target) variableThe target variable here is df_raw.SalePrice. The independent variables are all the variables except SalePrice. Here, we are using df_raw.drop to drop the SalePrice column (axis = 1 represents column). This would throw up an error like the one below:ValueError: could not convert string to float: â€˜Conventionalâ€™This suggests that the model could not deal with the value â€˜Conventionalâ€™. Most machine learning models (including random forest) cannot directly use categorical columns. We need to convert these columns into numbers first. So naturally the next step is to convert all the categorical columns into continuous variables.Data PreprocessingLetâ€™s take each categorical column individually. First, consider the saledate column which is of datetime format. From the date column, we can extract numerical values such as â€” year, month, day of month, day of the week, holiday or not, weekend or weekday, was it raining?, etc.Weâ€™ll leverage the add_datepart function from the fastai library to create these features for us. The function creates the following features:â€˜Yearâ€™, â€˜Monthâ€™, â€˜Weekâ€™, â€˜Dayâ€™, â€˜Dayofweekâ€™, â€˜Dayofyearâ€™, â€˜Is_month_endâ€™, â€˜Is_month_startâ€™, â€˜Is_quarter_endâ€™, â€˜Is_quarter_startâ€™, â€˜Is_year_endâ€™, â€˜Is_year_startâ€™Letâ€™s run the function and check the columns:add_datepart(df_raw, â€˜saledateâ€™)df_raw.columnsoutput:Index([â€˜SalesIDâ€™, â€˜SalePriceâ€™, â€˜MachineIDâ€™, â€˜ModelIDâ€™, â€˜datasourceâ€™, â€˜auctioneerIDâ€™, â€˜YearMadeâ€™, â€˜MachineHoursCurrentMeterâ€™, â€˜UsageBandâ€™, â€˜fiModelDescâ€™, â€˜fiBaseModelâ€™, â€˜fiSecondaryDescâ€™, â€˜fiModelSeriesâ€™, â€˜fiModelDescriptorâ€™, â€˜ProductSizeâ€™, â€˜fiProductClassDescâ€™, â€˜stateâ€™, â€˜ProductGroupâ€™, â€˜ProductGroupDescâ€™, â€˜Drive_Systemâ€™, â€˜Enclosureâ€™, â€˜Forksâ€™, â€˜Pad_Typeâ€™, â€˜Ride_Controlâ€™, â€˜Stickâ€™, â€˜Transmissionâ€™, â€˜Turbochargedâ€™, â€˜Blade_Extensionâ€™, â€˜Blade_Widthâ€™, â€˜Enclosure_Typeâ€™, â€˜Engine_Horsepowerâ€™, â€˜Hydraulicsâ€™, â€˜Pushblockâ€™, â€˜Ripperâ€™, â€˜Scarifierâ€™, â€˜Tip_Controlâ€™, â€˜Tire_Sizeâ€™, â€˜Couplerâ€™, â€˜Coupler_Systemâ€™, â€˜Grouser_Tracksâ€™, â€˜Hydraulics_Flowâ€™, â€˜Track_Typeâ€™, â€˜Undercarriage_Pad_Widthâ€™, â€˜Stick_Lengthâ€™, â€˜Thumbâ€™, â€˜Pattern_Changerâ€™, â€˜Grouser_Typeâ€™, â€˜Backhoe_Mountingâ€™, â€˜Blade_Typeâ€™, â€˜Travel_Controlsâ€™, â€˜Differential_Typeâ€™, â€˜Steering_Controlsâ€™, â€˜saleYearâ€™, â€˜saleMonthâ€™, â€˜saleWeekâ€™, â€˜saleDayâ€™, â€˜saleDayofweekâ€™, â€˜saleDayofyearâ€™, â€˜saleIs_month_endâ€™, â€˜saleIs_month_startâ€™, â€˜saleIs_quarter_endâ€™, â€˜saleIs_quarter_startâ€™, â€˜saleIs_year_endâ€™, â€˜saleIs_year_startâ€™, â€˜saleElapsedâ€™], dtype=â€˜objectâ€™)The next step is to convert the categorical variables into numbers. We can use the train_cats function from fastai for this:train_cats(df_raw)While converting categorical to numeric columns, we have to take the following two issues into consideration:Some categorical variables can have an order among them (for example â€” High&gt;Medium&gt;Low). We can use set_categories to set the order.If a category gets a particular number in the train data, it should have the same value in the test data. For instance, if the train data has 3 for high and test data has 2, then it will have two different meanings. We can use apply_cats for validation and test sets to make sure that the mappings are the same throughout the different setsAlthough this wonâ€™t make much of a difference in our current case since random forest works on splitting the dataset (we will understand how random forest works in detail in the shortly), itâ€™s still good to know this for other algorithms.Missing Value TreatmentThe next step is to look at the number of missing values in the dataset and understand how to deal with them. This is a pretty widespread challenge in both machine learning competitions and real-life industry problems.display_all(df_raw.isnull().sum().sort_index()/len(df_raw))We use .isnull().sum() to get the total number of missing values. This is divided by the length of the dataset to determine the ratio of missing values.The dataset is now ready to be used for creating a model. Data cleaning is always a tedious and time consuming process. Hence, ensure to save the transformed dataset so that the next time we load the data, we will not have to perform the above tasks again.We will save it in a feather format, as this letâ€™s us access the data efficiently:#to saveos.makedirs(â€˜tmpâ€™, exist_ok=True)df.to_feather(â€˜tmp/bulldozers-rawâ€™)#to readdf_raw = pd.read_feather(â€˜tmp/bulldozers-rawâ€™)We have to impute the missing values and store the data as dependent and independent part. This is done by using the fastai function proc_df. The function performs the following tasks:For continuous variables, it checks whether a column has missing values or notIf the column has missing values, it creates another column called columnname_na, which has 1 for missing and 0 for not missingSimultaneously, the missing values are replaced with the median of the columnFor categorical variables, pandas replaces missing values with -1. So proc_df adds 1 to all the values for categorical variables. Thus, we have 0 for missing while all other values are incremented by 1df, y, nas = proc_df(df_raw, â€˜SalePriceâ€™)Model BuildingWe have dealt with the categorical columns and the date values. We have also taken care of the missing values. Now we can finally power up and build the random forest model we have been inching towards.m = RandomForestRegressor(n_jobs=-1)m.fit(df, y)m.score(df,y)The n_jobs is set to -1 to use all the available cores on the machine. This gives us a score (rÂ²) of 0.98, which is excellent. The caveat here is that we have trained the model on the training set, and checked the result on the same. Thereâ€™s a high chance that this model might not perform as well on unseen data (test set, in our case).The only way to find out is to create a validation set and check the performance of the model on it. So letâ€™s create a validation set that contains 12,000 data points (and the train set will contain the rest).def split_vals(a,n):return a[:n].copy(), a[n:].copy()n_valid = 12000 # same as Kaggleâ€™s test set sizen_trn = len(df)-n_validraw_train, raw_valid = split_vals(df_raw, n_trn)X_train, X_valid = split_vals(df, n_trn)y_train, y_valid = split_vals(y, n_trn)X_train.shape, y_train.shape, X_valid.shapeOutput:((389125, 66), (389125,), (12000, 66))Here, we will train the model on our new set (which is a sample of the original set) and check the performance across both â€” train and validation sets.#define a function to check rmse valuedef rmse(x,y):return math.sqrt(((x-y)**2).mean())In order to compare the score against the train and test sets, the below function returns the RMSE value and score for both datasets.def print_score(m):res = [rmse(m.predict(X_train), y_train),rmse(m.predict(X_valid), y_valid),m.score(X_train, y_train), m.score(X_valid, y_valid)]if hasattr(m, â€˜oob_score_â€™): res.append(m.oob_score_)print(res)m = RandomForestRegressor(n_jobs=-1)%time m.fit(X_train, y_train)print_score(m)The result of the above code is shown below. The train set has a score of 0.98, while the validation set has a score of 0.88. A bit of a drop-off, but the model still performed well overall.CPU times: user 1min 3s, sys: 356 ms, total: 1min 3sWall time: 8.46 s[0.09044244804386327, 0.2508166961122146, 0.98290459302099709, 0.88765316048270615]Introduction to Machine Learning: Lesson 2Now that you know how to code a random forest model in Python, itâ€™s equally important to understand how it actually works underneath all that code. Random forest is often cited as a black box model, and itâ€™s time to put that misconception to bed.We observed in the first lesson that the model performs extremely well on the training data (the points it has seen before) but dips when tested on the validation set (the data points model was not trained on). Let us first understand how we created the validation set and why itâ€™s so crucial.Creating a Validation setCreating a good validation set that closely resembles the test set is one of the most important tasks in machine learning. The validation score is representative of how our model performs on real-world data, or on the test data.Keep in mind that if thereâ€™s a time component involved, then the most recent rows should be included in the validation set. So, our validation set will be of the same size as the test set (last 12,000 rows from the training data).def split_vals(a,n):return a[:n].copy(), a[n:].copy()n_valid = 12000n_trn = len(df)-n_validraw_train, raw_valid = split_vals(df_raw, n_trn)X_train, X_valid = split_vals(df, n_trn)y_train, y_valid = split_vals(y, n_trn)The data points from 0 to (length â€” 12000) are stored as the train set (x_train, y_train). A model is built using the train set and its performance is measured on both the train and validation sets as before.m = RandomForestRegressor(n_jobs=-1)%time m.fit(X_train, y_train)print_score(m)Result :CPU times: user 1min 3s, sys: 356 ms, total: 1min 3sWall time: 8.46 s[0.09044244804386327, 0.2508166961122146, 0.98290459302099709, 0.88765316048270615]From the above code, we get the results:RMSE on the training setRMSE on the validation setR-square on the training setR-square on validation setItâ€™s clear that the model is overfitting on the training set. Also, it takes a smidge over 1 minute to train. Can we reduce the training time? Yes, we can! To do this, we will further take a subset of the original dataset:df_trn, y_trn, nas = proc_df(df, â€˜SalePriceâ€™, subset=30000)X_train, _ = split_vals(df_trn, 20000)y_train, _ = split_vals(y_trn, 20000)A subset of 30,000 samples has been created from which we take 20,000 for training the Random Forest model.Building a single treeRandom Forest is a group of trees which are called estimators. The number of trees in a random forest model is defined by the parameter n_estimator. We will first look at a single tree (set n_estimator = 1) with a maximum depth of 3.m = RandomForestRegressor(n_estimators=1, max_depth=3, bootstrap=False, n_jobs=-1)m.fit(X_train, y_train)print_score(m)Result:[0.4965829795739235, 0.5246832258551836, 0.50149617735615859, 0.5083655198087873]Plotting the tree:draw_tree(m.estimators_[0], df_trn, precision=3)The tree is a set of binary decisions. Looking at the first box, the first split is on coupler-system value: less than/equal to 0.5 or greater than 0.5. After the split, we get 3,185 rows with coupler_system&gt;0.5 and remaining 16,815 with &lt;0.5. Similarly, next split is on enclosure and Year_made.For the first box, a model is created using only the average value (10.189). This means that all the rows have a predicted value of 10.189 and the MSE (Mean Squared Error) for these predictions is 0.459. Instead, if we make a split and separate the rows based on coupler_system &lt;0.5, the MSE is reduced to 0.414 for samples satisfying the condition (true) and 0.109 for the remaining samples.So how do we decide which variable to split on? The idea is to split the data into two groups which are as different from each other as possible. This can be done by checking each possible split point for each variable, and then figuring out which one gives the lower MSE. To do this, we can take a weighted average of the two MSE values after the split. The splitting stops when it either reaches the pre-specified max_depth value or when each leaf node has only one value.We have a basic model â€” a single tree, but this is not a very good model. We need something a bit more complex that builds upon this structure. For creating a forest, we will use a statistical technique called bagging.Introduction to BaggingIn the bagging technique, we create multiple models, each giving predictions which are not correlated to the other. Then we average the predictions from these models. Random Forest is a bagging technique.If all the trees created are similar to each other and give similar predictions, then averaging these predictions will not improve the model performance. Instead, we can create multiple trees on a different subset of data, so that even if these trees overfit, they will do so on a different set of points. These samples are taken with replacement.In simple words, we create multiple poor performing models and average them to create one good model. The individual models must be as predictive as possible, but together should be uncorrelated. We will now increase the number of estimators in our random forest and see the results.m = RandomForestRegressor(n_jobs=-1)m.fit(X_train, y_train)print_score(m)If we do not give a value to the n_estimator parameter, it is taken as 10 by default. We will get predictions from each of the 10 trees. Further, np.stack will be used to concatenate the predictions one over the other.preds = np.stack([t.predict(X_valid) for t in m.estimators_])preds.shapeThe dimensions of the predictions is (10, 12000) . This means we have 10 predictions for each row in the validation set.Now for comparing our modelâ€™s results against the validation set, here is the row of predictions, the mean of the predictions and the actual value from validation set.preds[:,0], np.mean(preds[:,0]), y_valid[0]The actual value is 9.17 but none of our predictions comes close to this value. On taking the average of all our predictions we get 9.07, which is a better prediction than any of the individual trees.(array([ 9.21034, 8.9872 , 8.9872 , 8.9872 , 8.9872 , 9.21034, 8.92266, 9.21034, 9.21034, 8.9872 ]),9.0700003890739005,9.1049798563183568)Itâ€™s always a good idea to visualize your model as much as possible. Here is a plot that shows the variation in rÂ² value as the number of trees increases.plt.plot([metrics.r2_score(y_valid, np.mean(preds[:i+1], axis=0)) for i in range(10)]);As expected, the rÂ² becomes better as the number of trees increases. You can experiment with the n_estimator value and see how the rÂ² value changes with each iteration. Youâ€™ll notice that after a certain number of trees, the rÂ² value plateaus.Out-of-Bag (OOB) ScoreCreating a separate validation set for a small dataset can potentially be a problem since it will result in an even smaller training set. In such cases, we can use the data points (or samples) which the tree was not trained on.For this, we set the parameter oob_score =True.m = RandomForestRegressor(n_estimators=40, n_jobs=-1, oob_score=True)m.fit(X_train, y_train)print_score(m)[0.10198464613020647, 0.2714485881623037, 0.9786192457999483, 0.86840992079038759, 0.84831537630038534]The oob_score is 0.84 which is close to that of the validation set. Let us look at some other interesting techniques by which we can improve our model.SubsamplingEarlier, we created a subset of 30,000 rows and the train set was randomly chosen from this subset. As an alternative, we can create a different subset each time so that the model is trained on a larger part of the data.df_trn, y_trn, nas = proc_df(df_raw, â€˜SalePriceâ€™)X_train, X_valid = split_vals(df_trn, n_trn)y_train, y_valid = split_vals(y_trn, n_trn)set_rf_samples(20000)We use set_rf_sample to specify the sample size. Let us check if the performance of the model has improved or not.m = RandomForestRegressor(n_estimators=40, n_jobs=-1, oob_score=True)m.fit(X_train, y_train)print_score(m)[0.2317315086850927, 0.26334275954117264, 0.89225792718146846, 0.87615150359885019, 0.88097587673696554]We get a validation score of 0.876. So far, we have worked on a subset of one sample. We can fit this model on the entire dataset (but it will take a long time to run depending on how good your computational resources are!).reset_rf_samples()m = RandomForestRegressor(n_estimators=40, n_jobs=-1, oob_score=True)m.fit(X_train, y_train)print_score(m)[0.07843013746508616, 0.23879806957665775, 0.98490742269867626, 0.89816206196980131, 0.90838819297302553]Other Hyperparameters to Experiment with and TuneMin sample leafThis can be treated as the stopping criteria for the tree. The tree stops growing (or splitting) when the number of samples in the leaf node is less than specified.m = RandomForestRegressor(n_estimators=40, min_samples_leaf=3,n_jobs=-1, oob_score=True)m.fit(X_train, y_train)print_score(m)[0.11595869956476182, 0.23427349924625201, 0.97209195463880227, 0.90198460308551043, 0.90843297242839738]Here we have specified the min_sample_leaf as 3. This means that the minimum number of samples in the node should be 3 for each split. We see that the rÂ² has improved for the validation set and reduced on the test set, concluding that the model does not overfit on the training data.Max featureAnother important parameter in random forest is max_features. We have discussed previously that the individual trees must be as uncorrelated as possible. For the same, random forest uses a subset of rows to train each tree. Additionally, we can also use a subset of columns (features) instead of using all the features. This is achieved by tweaking the max_features parameter.m = RandomForestRegressor(n_estimators=40, min_samples_leaf=3, max_features=0.5, n_jobs=-1, oob_score=True)m.fit(X_train, y_train)print_score(m)[0.11926975747908228, 0.22869111042050522, 0.97026995966445684, 0.9066000722129437, 0.91144914977164715]Setting max_features has slightly improved the validation score. Here the max_features is set to 0.5 which means using 50% of the features for each split. Keep in mind that this parameter can also take values like log2 or sqrt.Additional TopicsTips and tricks in Jupyter NotebooksJeremy Howard mentioned a few tips and tricks for navigating Jupyter Notebooks which newcomers will find quite useful. Below are some of the highlights:To find out which library the function is located in, simply type the function name and run the cell (shift-enter):displayTo see the documentation, use a question mark before the function:?displayTo see the source code of the function, use a double question mark before the function name:??displayCurse of dimensionalityThe curse of dimensionality is the idea that the more dimensions we have, the more points sit on the edge of that space. So if the number of columns is more, it creates more and more empty space. What that means, in theory, is that the distance between points is much less meaningful. This should not be true because the points still are different distances away from each other. Even though they are on the edges, we can still determine how far away they are from each other.Continuous, categorical, ordinal variablesContinuous variables are variables with integer or float values. For example â€” Age, distance, weight, income etcCategorical variables are usually strings or values representing names or labels. For example â€” gender, state, zip code, rank etcOrdinal variables are those categorical variables which have an order among them. For example rank (I, II, III ) or remark (poor, good, excellent) have an order.Overfitting and UnderfittingUnderfitting: A model that performs poorly on the train data and also on the test data. The model does not generalize well. (left plot)Overfitting: A model that performs extremely well on the train data but does not show a similar high performance on the test data. (right plot)Root mean squared log errorThe evaluation metric of our dataset is RMSLE. The formula for this isWe first take the mean of squared differences of log values. We take a square root of the result obtained. This is equivalent to calculating the root mean squared error (rmse) of log of the values.R-squareHere is the mathematical formula for R-square:SSregression is the sum of squares of (actual value â€” prediction)SStotal is the sum of squares of (actual value â€” average)The value of R-square can be anything less than 1. If the r square is negative, it means that your model is worse than predicting mean.Extremely Randomized TreeIn scikit-learn, we have another algorithm ExtraTreeClassifier which is extremely randomized tree model. Unlike Random forest, instead of trying each split point for every variable, it randomly tries a few split points for a few variables.End NotesThis article was a pretty comprehensive summary of the first two videos from fast.aiâ€™s machine learning course. During the first lesson we learnt to code a simple random forest model on the bulldozer dataset. Random forest (and most ml algorithms) do not work with categorical variables. We faced a similar problem during the random forest implementation and we saw hoe can we use the date column and other categorical columns in the dataset for creating a model.In the second video, the concept of creating a validation set was introduced. We then used this validation set to check the performance of the model and tuned some basic hyper-parameters to improve the model. My favorite part from this video was plotting and visualizing the tree we built. I am sure you would have learnt a lot through these videos. I will shortly post another article covering the next two videos from the course.Update: Here is part two of the series (Covers Lesson 3, 4 and 5)An Intuitive Guide to Interpret a Random Forest Model using fastai library (Machine learning for Programmers â€” Part 2)Originally published at www.analyticsvidhya.com on October 8, 2018.","categories":[{"name":"å‡è®¾æ£€éªŒ","slug":"å‡è®¾æ£€éªŒ","permalink":"http://www.wortyby.com/categories/å‡è®¾æ£€éªŒ/"}],"tags":[{"name":"è‡ªç”±åº¦","slug":"è‡ªç”±åº¦","permalink":"http://www.wortyby.com/tags/è‡ªç”±åº¦/"},{"name":"åŸå‡è®¾","slug":"åŸå‡è®¾","permalink":"http://www.wortyby.com/tags/åŸå‡è®¾/"},{"name":"å¯¹ç«‹å‡è®¾","slug":"å¯¹ç«‹å‡è®¾","permalink":"http://www.wortyby.com/tags/å¯¹ç«‹å‡è®¾/"}]},{"title":"Pythonæ—¥å¸¸","slug":"Python æ—¥å¸¸","date":"2018-11-27T05:49:57.000Z","updated":"2018-11-27T05:49:57.000Z","comments":true,"path":"2018/11/27/Python æ—¥å¸¸/","link":"","permalink":"http://www.wortyby.com/2018/11/27/Python æ—¥å¸¸/","excerpt":"","text":"å‰è¨€Pythonä¸­å†…ç½®äº†4ç§æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ï¼šlistï¼Œtupleï¼Œsetï¼Œdictï¼Œè¿™äº›æ•°æ®ç±»å‹éƒ½æœ‰å…¶å„è‡ªçš„ç‰¹ç‚¹ï¼Œä½†æ˜¯è¿™äº›ç‰¹ç‚¹ï¼ˆæ¯”å¦‚dictæ— åºï¼‰åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯¹æ•°æ®ç±»å‹çš„ä½¿ç”¨äº§ç”Ÿäº†çº¦æŸï¼Œåœ¨æŸäº›ä½¿ç”¨åœºæ™¯ä¸‹æ•ˆç‡ä¼šæ¯”è¾ƒä½ï¼Œæ¯”å¦‚æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦ç»´æŠ¤ä¸€ä¸ªæœ‰åºçš„å­—å…¸ç­‰æƒ…å†µã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pythonå†…å»ºçš„collectionsæ¨¡å—ï¼Œå®ƒåŒ…æ‹¬äº†å¾ˆå¤šæœ‰ç”¨çš„é›†åˆç±»ï¼Œåˆç†çš„ä½¿ç”¨å¯ä»¥æé«˜æˆ‘ä»¬ä»£ç çš„è¿è¡Œæ•ˆç‡ã€‚ ä¸¾ä¾‹æ¥ä¸‹æ¥ä¸»è¦å¯¹collectionsæ¨¡å—ä¸­çš„å¸¸ç”¨é›†åˆç±»è¿›è¡Œä»‹ç»ï¼Œè°ƒç”¨collectionsæ¨¡å—ï¼š1from collections import * defaultdictdictåœ¨ä½¿ç”¨æ—¶ï¼Œå½“keyå€¼ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥æ·»åŠ valueæ—¶ä¼šå‡ºç°é”™è¯¯ï¼Œä½¿ç”¨defaultdictå¯ä»¥å¾ˆå¥½çš„è§„é¿è¯¥é”™è¯¯ã€‚defaultdictæ˜¯å¯¹å­—å…¸ç±»å‹çš„è¡¥å……ï¼Œå®ƒå¯ä»¥ç»™å­—å…¸çš„å€¼è®¾ç½®ä¸€ä¸ªç±»å‹ï¼Œå½“keyä¸å­˜åœ¨æ—¶å¯ä»¥è‡ªåŠ¨ç”Ÿæˆç›¸åº”ç±»å‹çš„valueã€‚ä¸¾ä¾‹:12345678910111213141516from collections import defaultdicttest_data = ( (&apos;cat&apos;, 2), (&apos;dog&apos;, 5), (&apos;sheep&apos;, 3), (&apos;cat&apos;, 1), (&apos;sheep&apos;, 2))test_data_dict = defaultdict(list)for name, num in test_data: test_data_dict[name].append(num) print test_data_dict orderedDictåœ¨Python3.6ä¹‹å‰çš„å­—å…¸æ˜¯æ— åºçš„ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¿æŒå­—å…¸çš„æœ‰åºæ€§ï¼ŒorderDictå¯ä»¥åœ¨dictçš„åŸºç¡€ä¸Šå®ç°å­—å…¸çš„æœ‰åºæ€§ï¼Œè¿™é‡Œçš„æœ‰åºæŒ‡çš„æ˜¯æŒ‰ç…§å­—å…¸keyæ’å…¥çš„é¡ºåºæ¥æ’åˆ—ï¼Œè¿™æ ·å°±å®ç°äº†ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„dictï¼Œå½“å®¹é‡è¶…å‡ºé™åˆ¶æ—¶ï¼Œå…ˆåˆ é™¤æœ€æ—©æ·»åŠ çš„keyã€‚ä¸¾ä¾‹ï¼š12345678#orderedDictoriginal_dict = &#123;&apos;a&apos;: 2, &apos;b&apos;: 4, &apos;c&apos;: 5&#125;for key, value in original_dict.items(): print key, valueordered_dict = OrderedDict([(&apos;a&apos;, 2), (&apos;b&apos;, 4), (&apos;c&apos;, 5)])for key, value in ordered_dict.items(): print key, valueå¯ä»¥çœ‹åˆ°orderDictæ˜¯æŒ‰ç…§å­—å…¸åˆ›å»ºæ—¶çš„æ’å…¥é¡ºåºæ¥æ’åºã€‚ dequePythonä¸­çš„listæ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼Œæ‰€ä»¥ï¼ŒæŸ¥æ‰¾å®¹æ˜“ï¼Œä½†æ˜¯æ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦è¾ƒå¤§ã€‚dequeå°±æ˜¯ä¸ºäº†é«˜æ•ˆå®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨ï¼Œé€‚åˆç”¨äºé˜Ÿåˆ—å’Œæ ˆï¼Œè€Œä¸”çº¿ç¨‹å®‰å…¨ã€‚liståªæä¾›äº†appendå’Œpopæ–¹æ³•æ¥ä»listçš„å°¾éƒ¨æ’å…¥æˆ–è€…åˆ é™¤å…ƒç´ ï¼Œdequeæ–°å¢äº†appendleft/popleftç­‰æ–¹æ³•å¯ä»¥æ›´é«˜æ•ˆçš„åœ¨å…ƒç´ çš„å¼€å¤´æ¥æ’å…¥/åˆ é™¤å…ƒç´ ã€‚ä¸¾ä¾‹ï¼š1234567from collections import dequed = deque([1,2,3,4,5])d.extendleft([0])print dd.extend([6,7])d.popleft()print då¯ä»¥è¿›è¡ŒåŒå‘æ“ä½œå…ƒç´ ï¼Œååˆ†æ–¹ä¾¿ã€‚ Counterå­—å…¸å­ç±»ï¼Œä¸ºå¯ä»¥å“ˆå¸Œçš„å¯¹è±¡è®¡æ•°ã€‚ä¸¾ä¾‹ï¼š123456789from collections import Countertest_counter_data = [&apos;cat&apos;, &apos;dog&apos;, &apos;sheep&apos;, &apos;cat&apos;, &apos;dog&apos;]counter_data = Counter()for item in test_counter_data: counter_data[item] += 1 print counter_dataå¯ä»¥å®ç°å¯¹ä¸€ä¸ªå¯¹è±¡ä¸­çš„å…ƒç´ è¿›è¡Œè®¡æ•°ã€‚ namedtupleå…ƒç»„å­ç±»ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒPythonä¸­å…ƒç»„çš„ä¸€ä¸ªé‡è¦ç‰¹å¾å°±æ˜¯å…ƒç´ ä¸å¯å¢åˆ æ”¹ï¼Œè€ŒæŸ¥æ‰¾tupleå…ƒç´ æ—¶ä¸€èˆ¬é‡‡å–ç´¢å¼•ã€‚ä½¿ç”¨namedtuple(typename, field_name)å¯ä»¥å‘½åtupleä¸­çš„å…ƒç´ ï¼Œä¹‹åä¾¿å¯ä½¿ç”¨åå­—æ¥æŸ¥æ‰¾tupleä¸­çš„å€¼ï¼Œæœ‰ç‚¹ç±»ä¼¼äºå­—å…¸ä¸­çš„æŸ¥æ‰¾ã€‚ä¸¾ä¾‹ï¼š1234from collections import namedtupleanimal = namedtuple(&apos;animal&apos;, &apos;type age&apos;)mark = animal(type=&apos;dog&apos;, age=2)print mark.typeä½¿ç”¨namedtupleå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œæ–‡æ¡£æ€§ã€‚","categories":[{"name":"Python è¯­è¨€","slug":"Python-è¯­è¨€","permalink":"http://www.wortyby.com/categories/Python-è¯­è¨€/"}],"tags":[{"name":"collections","slug":"collections","permalink":"http://www.wortyby.com/tags/collections/"}]},{"title":"Data Vault åˆæ¢","slug":"Data Vault åˆæ¢","date":"2018-11-23T05:29:07.000Z","updated":"2018-11-23T05:29:07.000Z","comments":true,"path":"2018/11/23/Data Vault åˆæ¢/","link":"","permalink":"http://www.wortyby.com/2018/11/23/Data Vault åˆæ¢/","excerpt":"","text":"**Data Vaultï¼ˆDVï¼‰**æ¨¡å‹æ˜¯ç”¨äºä¼ä¸šçº§çš„æ•°æ®ä»“åº“å»ºæ¨¡ã€‚ç”±Dan Linstedtåœ¨20ä¸–çºª90å¹´ä»£æå‡ºã€‚åœ¨æœ€è¿‘å‡ å¹´ï¼ŒData Vaultæ¨¡å‹è·å¾—äº†å¾ˆå¤šå…³æ³¨ï¼Œå¹¶åœ¨BIç¤¾åŒºé‡Œæ‹¥æœ‰äº†ä¸€æ‰¹è¿½éšè€…ã€‚ å®šä¹‰Dan Linstedtå°†Data Vaultæ¨¡å‹å®šä¹‰å¦‚ä¸‹ï¼šData Vaultæ˜¯é¢å‘ç»†èŠ‚çš„ï¼Œå¯è¿½è¸ªå†å²çš„ï¼Œå®ƒæ˜¯ä¸€ç»„æœ‰è¿æ¥å…³ç³»çš„è§„èŒƒåŒ–çš„è¡¨çš„é›†åˆã€‚è¿™äº›è¡¨å¯ä»¥æ”¯æŒä¸€ä¸ªæˆ–å¤šä¸ªä¸šåŠ¡åŠŸèƒ½ï¼Œå®ƒæ˜¯ä¸€ç§ç»¼åˆäº†ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰å’Œæ˜Ÿå‹æ¨¡å‹ä¼˜ç‚¹çš„å»ºæ¨¡æ–¹æ³•ã€‚å…¶è®¾è®¡ç†å¿µæ˜¯è¦æ»¡è¶³ä¼ä¸šå¯¹çµæ´»æ€§ã€å¯æ‰©å±•æ€§ã€ä¸€è‡´æ€§å’Œå¯¹éœ€æ±‚çš„é€‚åº”æ€§è¦æ±‚ï¼Œå®ƒæ˜¯ä¸€ç§ä¸“ä¸ºä¼ä¸šçº§æ•°æ®ä»“åº“é‡èº«å®šåˆ¶çš„å»ºæ¨¡æ–¹å¼ã€‚ä»ä¸Šé¢çš„å®šä¹‰ï¼Œå¯ä»¥çœ‹å‡ºData Vaultæ—¢æ˜¯ä¸€ç§æ•°æ®å»ºæ¨¡çš„æ–¹æ³•è®ºï¼Œåˆæ˜¯æ„å»ºä¼ä¸šæ•°æ®ä»“åº“çš„ä¸€ç§å…·ä½“æ–¹æ³•ã€‚ ç»„æˆData Vaultæ¨¡å‹ç”±ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼Œä¸­å¿ƒè¡¨ã€é“¾æ¥è¡¨ã€é™„å±è¡¨ã€‚å»ºæ¨¡æ–¹æ³•è®ºé‡Œå®šä¹‰äº†Data Vaultçš„ç»„æˆéƒ¨åˆ†å’Œç»„æˆéƒ¨åˆ†ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚ æœ€ä½³å®è·µData Vaultçš„å»ºæ¨¡æ–¹æ³•ä¸­è¿˜åŒ…æ‹¬äº† æœ€ä½³å®è·µï¼Œæ¥æŒ‡å¯¼æ„å»ºä¼ä¸šæ•°æ®ä»“åº“ã€‚ä¾‹å¦‚ï¼Œä¸šåŠ¡è§„åˆ™åº”è¯¥åœ¨æ•°æ®çš„ä¸‹æ¸¸å®ç°ï¼Œå°±æ˜¯è¯´Data VaultåªæŒ‰ç…§ä¸šåŠ¡æ•°æ®çš„åŸæ ·ä¿å­˜æ•°æ®ï¼Œä¸åšä»»ä½•è§£é‡Šã€è¿‡æ»¤ã€æ¸…æ´—ã€è½¬æ¢ã€‚å³ä½¿ä»ä¸åŒæ•°æ®æºæ¥çš„æ•°æ®æ˜¯è‡ªè¡ŒçŸ›ç›¾çš„ï¼ˆä¾‹å¦‚åŒä¸€ä¸ªå®¢æˆ·æœ‰ä¸åŒçš„åœ°å€ï¼‰ï¼ŒData Vaultæ¨¡å‹ä¸ä¼šéµç…§ä»»ä½•ä¸šåŠ¡çš„è§„åˆ™ï¼Œå¦‚â€œç³»ç»ŸAçš„åœ°å€ä¸ºå‡†â€ã€‚Data Vaultæ¨¡å‹ä¼šä¿å­˜ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„æ•°æ®ï¼Œå¯¹æ•°æ®çš„è§£é‡Šå°†æ¨è¿Ÿåˆ°æ•´ä¸ªæ¶æ„çš„åä¸€ä¸ªé˜¶æ®µ (æ•°æ®é›†å¸‚)ã€‚åŸæ–‡é“¾æ¥","categories":[{"name":"æ•°æ®ä»“åº“","slug":"æ•°æ®ä»“åº“","permalink":"http://www.wortyby.com/categories/æ•°æ®ä»“åº“/"}],"tags":[{"name":"æ•°æ®ä»“åº“","slug":"æ•°æ®ä»“åº“","permalink":"http://www.wortyby.com/tags/æ•°æ®ä»“åº“/"}]},{"title":"å¡æ–¹æ£€éªŒ","slug":"å¡æ–¹æ£€éªŒ","date":"2018-11-15T06:37:14.000Z","updated":"2018-11-15T06:37:14.000Z","comments":true,"path":"2018/11/15/å¡æ–¹æ£€éªŒ/","link":"","permalink":"http://www.wortyby.com/2018/11/15/å¡æ–¹æ£€éªŒ/","excerpt":"","text":"The P value, or calculated probability, is the probability of finding the observed, or more extreme, results when the null hypothesis (H0) of a study question is true â€“ the definition of â€˜extremeâ€™ depends on how the hypothesis is being tested. P is also described in terms of rejecting H0 when it is actually true, however, it is not a direct probability of this state.The null hypothesis is usually an hypothesis of â€œno differenceâ€ e.g. no difference between blood pressures in group A and group B. Define a null hypothesis for each study question clearly before the start of your study.The only situation in which you should use a one sided P value is when a large change in an unexpected direction would have absolutely no relevance to your study. This situation is unusual; if you are in any doubt then use a two sided P value.The term significance level (alpha) is used to refer to a pre-chosen probability and the term â€œP valueâ€ is used to indicate a probability that you calculate after a given study.The alternative hypothesis (H1) is the opposite of the null hypothesis; in plain language terms this is usually the hypothesis you set out to investigate. For example, question is â€œis there a significant (not due to chance) difference in blood pressures between groups A and B if we give group A the test drug and group B a sugar pill?â€ and alternative hypothesis is &quot; there is a difference in blood pressures between groups A and B if we give group A the test drug and group B a sugar pill&quot;.If your P value is less than the chosen significance level then you reject the null hypothesis i.e. accept that your sample gives reasonable evidence to support the alternative hypothesis. It does NOT imply a â€œmeaningfulâ€ or â€œimportantâ€ difference; that is for you to decide when considering the real-world relevance of your result.The choice of significance level at which you reject H0 is arbitrary. Conventionally the 5% (less than 1 in 20 chance of being wrong), 1% and 0.1% (P &lt; 0.05, 0.01 and 0.001) levels have been used. These numbers can give a false sense of security.In the ideal world, we would be able to define a â€œperfectlyâ€ random sample, the most appropriate test and one definitive conclusion. We simply cannot. What we can do is try to optimise all stages of our research to minimise sources of uncertainty. When presenting P values some groups find it helpful to use the asterisk rating system as well as quoting the P value:P &lt; 0.05 *P &lt; 0.01 **P &lt; 0.001Most authors refer to statistically significant as P &lt; 0.05 and statistically highly significant as P &lt; 0.001 (less than one in a thousand chance of being wrong).The asterisk system avoids the woolly term â€œsignificantâ€. Please note, however, that many statisticians do not like the asterisk rating system when it is used without showing P values. As a rule of thumb, if you can quote an exact P value then do. You might also want to refer to a quoted exact P value as an asterisk in text narrative or tables of contrasts elsewhere in a report.At this point, a word about error. Type I error is the false rejection of the null hypothesis and type II error is the false acceptance of the null hypothesis. As an aid memoir: think that our cynical society rejects before it accepts.The significance level (alpha) is the probability of type I error. The power of a test is one minus the probability of type II error (beta). Power should be maximised when selecting statistical methods. If you want to estimate sample sizes then you must understand all of the terms mentioned here.The following table shows the relationship between power and error in hypothesis testing:123456789101112131415 DECISIONTRUTH Accept H0: Reject H0: H0 is true: correct decision P type I error P 1-alpha alpha (significance) H0 is false: type II error P correct decision P beta 1-beta (power) H0 = null hypothesis P = probabilityIf you are interested in further details of probability and sampling theory at this point then please refer to one of the general texts listed in the reference section.You must understand confidence intervals if you intend to quote P values in reports and papers. Statistical referees of scientific journals expect authors to quote confidence intervals with greater prominence than P values.Notes about Type I error:is the incorrect rejection of the null hypothesismaximum probability is set in advance as alphais not affected by sample size as it is set in advanceincreases with the number of tests or end points (i.e. do 20 rejections of H0 and 1 is likely to be wrongly significant for alpha = 0.05)Notes about Type II error:is the incorrect acceptance of the null hypothesisprobability is betabeta depends upon sample size and alphacanâ€™t be estimated except as a function of the true population effectbeta gets smaller as the sample size gets largerbeta gets smaller as the number of tests or end points increases","categories":[{"name":"å‡è®¾æ£€éªŒ","slug":"å‡è®¾æ£€éªŒ","permalink":"http://www.wortyby.com/categories/å‡è®¾æ£€éªŒ/"}],"tags":[{"name":"è‡ªç”±åº¦","slug":"è‡ªç”±åº¦","permalink":"http://www.wortyby.com/tags/è‡ªç”±åº¦/"},{"name":"åŸå‡è®¾","slug":"åŸå‡è®¾","permalink":"http://www.wortyby.com/tags/åŸå‡è®¾/"},{"name":"å¯¹ç«‹å‡è®¾","slug":"å¯¹ç«‹å‡è®¾","permalink":"http://www.wortyby.com/tags/å¯¹ç«‹å‡è®¾/"}]},{"title":"ç‰¹å¾å·¥ç¨‹","slug":"è¦çœ‹çš„æ–‡ç« ","date":"2018-11-13T05:44:05.000Z","updated":"2018-11-13T05:44:05.000Z","comments":true,"path":"2018/11/13/è¦çœ‹çš„æ–‡ç« /","link":"","permalink":"http://www.wortyby.com/2018/11/13/è¦çœ‹çš„æ–‡ç« /","excerpt":"","text":"ç‰¹å¾å·¥ç¨‹æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„è¯¾é¢˜ï¼Œæ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸å¯ç¼ºå°‘çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå‡ ä¹å¾ˆå°‘å‡ºç°äºæœºå™¨å­¦ä¹ ä¹¦æœ¬é‡Œé¢çš„æŸä¸€ç« ã€‚åœ¨æœºå™¨å­¦ä¹ æ–¹é¢çš„æˆåŠŸå¾ˆå¤§ç¨‹åº¦ä¸Šåœ¨äºå¦‚æœä½¿ç”¨ç‰¹å¾å·¥ç¨‹ã€‚ ç‰¹å¾å·¥ç¨‹å¯ä»¥è§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Ÿåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç»å¸¸æ˜¯ç”¨ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼ˆçº¿æ€§å›å½’ï¼Œé€»è¾‘å›å½’ï¼ŒSVDç­‰ï¼‰å’Œä¸€å †åŸå§‹æ•°æ®æ¥å¾—åˆ°ä¸€äº›é¢„æµ‹çš„ç»“æœï¼Œäººä»¬éœ€è¦åšçš„æ˜¯ä»è¿™å †åŸå§‹æ•°æ®ä¸­å»æç‚¼è¾ƒä¼˜çš„ç»“æœï¼Œç„¶ååšåˆ°æœ€ä¼˜çš„é¢„æµ‹ã€‚è¿™ä¸ªå°±åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼Œç¬¬ä¸€å°±æ˜¯å¦‚ä½•é€‰æ‹©å’Œä½¿ç”¨å„ç§æ¨¡å‹ï¼Œç¬¬äºŒå°±æ˜¯æ€ä¹ˆæ ·å»ä½¿ç”¨è¿™äº›åŸå§‹çš„æ•°æ®æ‰èƒ½è¾¾åˆ°æœ€ä¼˜çš„æ•ˆæœã€‚é‚£ä¹ˆæ€ä¹ˆæ ·æ‰èƒ½å¤Ÿè·å¾—æœ€ä¼˜çš„ç»“æœå‘¢ï¼Ÿè´´ä¸Šä¸€å¥ç»å…¸çš„è¯å°±æ˜¯ï¼šActually the sucess of all Machine Learning algorithms depends on how you present the data.------ Mohammad Pezeshkiç›´æ¥ç¿»è¯‘è¿‡æ¥ä¾¿æ˜¯ï¼šäº‹å®ä¸Šæ‰€æœ‰æœºå™¨å­¦ä¹ ç®—æ³•ä¸Šé¢çš„æˆåŠŸéƒ½åœ¨äºä½ æ€ä¹ˆæ ·å»å±•ç¤ºè¿™äº›æ•°æ®ã€‚ç”±æ­¤å¯è§ç‰¹å¾å·¥ç¨‹åœ¨å®é™…çš„æœºå™¨å­¦ä¹ ä¸­çš„é‡è¦æ€§ï¼Œä»æ•°æ®é‡Œé¢æå–å‡ºæ¥çš„ç‰¹å¾å¥½åä¸å¦å°±ä¼šç›´æ¥å½±å“æ¨¡å‹çš„æ•ˆæœã€‚ä»æŸäº›å±‚é¢ä¸Šæ¥è¯´ï¼Œæ‰€ä½¿ç”¨çš„ç‰¹å¾è¶Šå¥½ï¼Œå¾—åˆ°çš„æ•ˆæœå°±ä¼šè¶Šå¥½ã€‚æ‰€éœ€è¦çš„ç‰¹å¾å°±æ˜¯å¯ä»¥å€Ÿæ­¤æ¥æè¿°å·²çŸ¥æ•°æ®çš„å†…åœ¨å…³ç³»ã€‚æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šBetter feature means flexibility. Better feature means simpler models. Better feature means better results.æœ‰çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›ä¸æ˜¯æœ€ä¼˜çš„æ¨¡å‹æ¥è®­ç»ƒæ•°æ®ï¼Œå¦‚æœç‰¹å¾é€‰æ‹©å¾—å¥½çš„è¯ï¼Œä¾ç„¶å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸é”™çš„ç»“æœã€‚å¾ˆå¤šæœºå™¨å­¦ä¹ çš„æ¨¡å‹éƒ½èƒ½å¤Ÿä»æ•°æ®ä¸­é€‰æ‹©å‡ºä¸é”™çš„ç»“æ„ï¼Œä»è€Œè¿›è¡Œè‰¯å¥½çš„é¢„æµ‹ã€‚ä¸€ä¸ªä¼˜ç§€çš„ç‰¹å¾å…·æœ‰æå¼ºçš„çµæ´»æ€§ï¼Œå¯ä»¥ä½¿ç”¨ä¸é‚£ä¹ˆå¤æ‚çš„ï¼Œè¿ç®—é€Ÿåº¦å¿«ï¼Œå®¹æ˜“ç†è§£å’Œç»´æŠ¤çš„æ¨¡å‹æ¥å¾—åˆ°ä¸é”™çš„ç»“æœã€‚ ä»€ä¹ˆæ‰æ˜¯ç‰¹å¾å·¥ç¨‹ï¼ŸFeature Engineering is the process of transforming raw data into features that better represent the underlying problem to the predictive models, resulting in improved model accuracy on unseen data.------ Jason BrownleeFeature Engineering is manually designing what the input xâ€™s should be.------ Tomasz Malisiewiczä»è¿™ä¸ªæ¦‚å¿µå¯ä»¥çœ‹å‡ºï¼Œç‰¹å¾å·¥ç¨‹å…¶å®æ˜¯ä¸€ä¸ªå¦‚ä½•å±•ç¤ºå’Œè¡¨ç°æ•°æ®çš„é—®é¢˜ï¼Œåœ¨å®é™…å·¥ä½œä¸­éœ€è¦æŠŠæ•°æ®ä»¥ä¸€ç§â€œè‰¯å¥½â€çš„æ–¹å¼å±•ç¤ºå‡ºæ¥ï¼Œä½¿å¾—èƒ½å¤Ÿä½¿ç”¨å„ç§å„æ ·çš„æœºå™¨å­¦ä¹ æ¨¡å‹æ¥å¾—åˆ°æ›´å¥½çš„æ•ˆæœã€‚å¦‚ä½•ä»åŸå§‹æ•°æ®ä¸­å»é™¤ä¸ä½³çš„æ•°æ®ï¼Œå±•ç¤ºåˆé€‚çš„æ•°æ®å°±æˆä¸ºäº†ç‰¹å¾å·¥ç¨‹çš„å…³é”®é—®é¢˜ã€‚ ç‰¹å¾æœ‰ç”¨æ€§çš„é¢„ä¼°æ¯æ¬¡æ„é€ äº†ä¸€ä¸ªç‰¹å¾ï¼Œéƒ½éœ€è¦ä»å„ä¸ªæ–¹é¢å»è¯æ˜è¯¥ç‰¹å¾çš„æœ‰æ•ˆæ€§ã€‚ä¸€ä¸ªç‰¹å¾æ˜¯å¦é‡è¦ä¸»è¦åœ¨äºè¯¥ç‰¹å¾ä¸è¦é¢„æµ‹çš„ä¸œè¥¿æ˜¯å¦æ˜¯é«˜åº¦ç›¸å…³çš„ï¼Œå¦‚æœæ˜¯é«˜åº¦ç›¸å…³ï¼Œé‚£ä¹ˆè¯¥ç‰¹å¾å°±æ˜¯ååˆ†é‡è¦çš„ã€‚æ¯”å¦‚å¸¸ç”¨çš„å·¥å…·å°±æ˜¯ç»Ÿè®¡å­¦é‡Œé¢çš„ç›¸å…³ç³»æ•°ã€‚ ç‰¹å¾çš„æ„é€ è¿‡ç¨‹åœ¨å®é™…å·¥ä½œä¸­é¦–å…ˆè‚¯å®šè¦ç¡®å®šå…·ä½“çš„é—®é¢˜ï¼Œç„¶åå°±æ˜¯æ•°æ®çš„é€‰æ‹©å’Œå‡†å¤‡è¿‡ç¨‹ï¼Œå†å°±æ˜¯æ¨¡å‹çš„å‡†å¤‡å’Œè®¡ç®—å·¥ä½œï¼Œæœ€åæ‰æ˜¯å±•ç¤ºæ•°æ®çš„é¢„æµ‹ç»“æœã€‚æ„é€ ç‰¹å¾çš„ä¸€èˆ¬æ­¥éª¤ï¼š ä»»åŠ¡çš„ç¡®å®šï¼šæ ¹æ®å…·ä½“çš„ä¸šåŠ¡ç¡®å®šéœ€è¦è§£å†³çš„é—®é¢˜ï¼› æ•°æ®çš„é€‰æ‹©ï¼šæ•´åˆæ•°æ®ï¼Œæ”¶é›†æ•°æ®ï¼› é¢„å¤„ç†æ•°æ®ï¼šè®¾è®¡æ•°æ®å±•ç°çš„æ ¼å¼ï¼Œæ¸…æ´—æ•°æ®ï¼Œé€‰æ‹©åˆé€‚çš„æ ·æœ¬ä½¿å¾—æœºå™¨å­¦ä¹ æ¨¡å‹èƒ½å¤Ÿä½¿ç”¨å®ƒã€‚æ¯”æ–¹è¯´ä¸€äº›å¹´é¾„ç‰¹å¾æ˜¯ç©ºå€¼æˆ–è€…è´Ÿæ•°æˆ–è€…å¤§äº200ç­‰ï¼Œæˆ–è€…è¯´æŸä¸ªé¡µé¢çš„æ’­æ”¾æ•°æ®å¤§äºæ›å…‰æ•°æ®ï¼Œè¿™äº›å°±æ˜¯æ•°æ®çš„ä¸åˆç†ï¼Œéœ€è¦åœ¨ä½¿ç”¨ä¹‹å‰æŠŠè¿™ä¸€æ‰¹æ•°æ®æ’é™¤æ‰ã€‚ ç‰¹å¾çš„æ„é€ ï¼šè½¬åŒ–æ•°æ®ï¼Œä½¿ä¹‹æˆä¸ºæœ‰æ•ˆçš„ç‰¹å¾ã€‚å¸¸ç”¨çš„æ–¹æ³•æ˜¯æ ‡å‡†åŒ–ï¼Œå½’ä¸€åŒ–ï¼Œç‰¹å¾çš„ç¦»æ•£åŒ–ç­‰ã€‚ æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰ï¼šæ¯”æ–¹è¯´æœ‰ä¸€äº›æ•°å­—çš„å•ä½æ˜¯åƒå…‹ï¼Œæœ‰ä¸€äº›æ•°å­—çš„å•ä½æ˜¯å…‹ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç»Ÿä¸€å•ä½ã€‚å¦‚æœæ²¡æœ‰æ ‡å‡†åŒ–ï¼Œä¸¤ä¸ªå˜é‡æ··åœ¨ä¸€èµ·æï¼Œé‚£ä¹ˆè‚¯å®šå°±ä¼šä¸åˆé€‚ã€‚ å½’ä¸€åŒ–ï¼ˆNormalizationï¼‰ï¼šå½’ä¸€åŒ–æ˜¯å› ä¸ºåœ¨ç‰¹å¾ä¼šåœ¨ä¸åŒçš„å°ºåº¦ä¸‹æœ‰ä¸åŒçš„è¡¨ç°å½¢å¼ï¼Œå½’ä¸€åŒ–ä¼šä½¿å¾—å„ä¸ªç‰¹å¾èƒ½å¤ŸåŒæ—¶ä»¥æ°å½“çš„æ–¹å¼è¡¨ç°ã€‚æ¯”æ–¹è¯´æŸä¸ªä¸“è¾‘çš„ç‚¹å‡»æ’­æ”¾ç‡ä¸€èˆ¬ä¸ä¼šè¶…è¿‡0.2ï¼Œä½†æ˜¯ä¸“è¾‘çš„æ’­æ”¾æ¬¡æ•°å¯èƒ½ä¼šè¾¾åˆ°å‡ åƒæ¬¡ï¼Œæ‰€ä»¥è¯´ä¸ºäº†èƒ½å¤Ÿåœ¨æ¨¡å‹é‡Œé¢å¾—åˆ°æ›´åˆé€‚ç»“æœï¼Œéœ€è¦å…ˆæŠŠä¸€äº›ç‰¹å¾åœ¨å°ºåº¦ä¸Šè¿›è¡Œå½’ä¸€åŒ–ï¼Œç„¶åè¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚ ç‰¹å¾çš„ç¦»æ•£åŒ–ï¼ˆDiscretizationï¼‰ï¼šç¦»æ•£åŒ–æ˜¯æŒ‡æŠŠç‰¹å¾è¿›è¡Œå¿…è¦çš„ç¦»æ•£å¤„ç†ï¼Œæ¯”æ–¹è¯´å¹´é¾„ç‰¹å¾æ˜¯ä¸€ä¸ªè¿ç»­çš„ç‰¹å¾ï¼Œä½†æ˜¯æŠŠå¹´é¾„å±‚åˆ†æˆ5ï¼18å²ï¼ˆä¸­å°å­¦ç”Ÿï¼‰ï¼Œ19ï¼23å²ï¼ˆå¤§å­¦ç”Ÿï¼‰ï¼Œ24ï¼29å²ï¼ˆå·¥ä½œå‰å‡ å¹´ï¼‰ï¼Œ30ï¼40å²ï¼ˆæˆå®¶ç«‹ä¸šï¼‰ï¼Œ40ï¼60å²ï¼ˆä¸­å¹´äººï¼‰ä»æŸäº›å±‚é¢æ¥è¯´æ¯”è¿ç»­çš„å¹´é¾„æ•°æ®ï¼ˆæ¯”å¦‚è¯´æŸäººå¹´é¾„æ˜¯20å²1æœˆ3æ—¥ä¹‹ç±»çš„ï¼‰æ›´å®¹æ˜“ç†è§£ä¸åŒå¹´é¾„å±‚äººçš„ç‰¹æ€§ã€‚ å…¸å‹çš„ç¦»æ•£åŒ–æ­¥éª¤ï¼šå¯¹ç‰¹å¾åšæ’åº;é€‰æ‹©åˆé€‚çš„åˆ†å‰²ç‚¹;ä½œå‡ºåŒºé—´çš„åˆ†å‰²;ä½œå‡ºåŒºé—´åˆ†å‰²;æŸ¥çœ‹æ˜¯å¦èƒ½å¤Ÿè¾¾åˆ°åœæ­¢æ¡ä»¶ã€‚ æ¨¡å‹çš„ä½¿ç”¨ï¼šåˆ›é€ æ¨¡å‹ï¼Œé€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼Œç”¨åˆé€‚çš„æ¨¡å‹æ¥è¿›è¡Œé¢„æµ‹ï¼Œç”¨å„ç§ç»Ÿè®¡æŒ‡æ ‡æ¥åˆ¤æ–­è¯¥ç‰¹å¾æ˜¯å¦åˆé€‚ï¼› ä¸Šçº¿çš„æ•ˆæœï¼šé€šè¿‡åœ¨çº¿æµ‹è¯•æ¥çœ‹æ•ˆæœã€‚æ•°æ®çš„è½¬æ¢ï¼ˆTransforming Dataï¼‰å°±æ˜¯æŠŠæ•°æ®ä»åŸå§‹çš„æ•°æ®çŠ¶æ€è½¬æ¢æˆé€‚åˆæ¨¡å‹è®¡ç®—çš„çŠ¶æ€ï¼Œä»æŸäº›å±‚é¢ä¸Šæ¥è¯´ï¼Œâ€œæ•°æ®è½¬æ¢â€œå’Œâ€ç‰¹å¾æ„é€ â€œçš„è¿‡ç¨‹å‡ ä¹æ˜¯ä¸€è‡´çš„ã€‚ ç‰¹å¾å·¥ç¨‹çš„è¿­ä»£è¿‡ç¨‹ ç‰¹å¾å·¥ç¨‹çš„è¿­ä»£æ­¥éª¤ï¼š é€‰æ‹©ç‰¹å¾ï¼šéœ€è¦è¿›è¡Œå¤´è„‘é£æš´ï¼ˆbrainstormï¼‰ã€‚é€šè¿‡å…·ä½“çš„é—®é¢˜åˆ†æï¼ŒæŸ¥çœ‹å¤§é‡çš„æ•°æ®ï¼Œä»æ•°æ®ä¸­æŸ¥çœ‹å‡ºå¯ä»¥æå–å‡ºæ•°æ®çš„å…³é”®ï¼› è®¾è®¡ç‰¹å¾ï¼šè¿™ä¸ªéœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œå¯ä»¥è‡ªåŠ¨è¿›è¡Œç‰¹å¾æå–å·¥ä½œï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ‰‹å·¥è¿›è¡Œç‰¹å¾çš„æ„é€ å·¥ä½œï¼Œç”šè‡³æ··åˆä¸¤ç§æ–¹æ³•ï¼› é€‰æ‹©ç‰¹å¾ï¼šä½¿ç”¨ä¸åŒçš„ç‰¹å¾æ„é€ æ–¹æ³•ï¼Œæ¥ä»å¤šä¸ªå±‚é¢æ¥åˆ¤æ–­è¿™ä¸ªç‰¹å¾çš„é€‰æ‹©æ˜¯å¦åˆé€‚ï¼› è®¡ç®—æ¨¡å‹ï¼šé€šè¿‡æ¨¡å‹è®¡ç®—å¾—åˆ°æ¨¡å‹åœ¨è¯¥ç‰¹å¾ä¸Šæ‰€æå‡çš„å‡†ç¡®ç‡ã€‚ ä¸Šçº¿æµ‹è¯•ï¼šé€šè¿‡åœ¨çº¿æµ‹è¯•çš„æ•ˆæœæ¥åˆ¤æ–­ç‰¹å¾æ˜¯å¦æœ‰æ•ˆã€‚å‚è€ƒæ–‡ç« ","categories":[{"name":"Scklearn","slug":"Scklearn","permalink":"http://www.wortyby.com/categories/Scklearn/"}],"tags":[{"name":"ç‰¹å¾","slug":"ç‰¹å¾","permalink":"http://www.wortyby.com/tags/ç‰¹å¾/"}]},{"title":"åŸºäºSpark GraphXï¼Œå¼ƒGBDTå’ŒLRç”¨FM","slug":"åŸºäºSpark GraphXï¼Œå¼ƒGBDTå’ŒLRç”¨FM","date":"2018-11-07T08:54:30.000Z","updated":"2018-11-07T08:54:30.000Z","comments":true,"path":"2018/11/07/åŸºäºSpark GraphXï¼Œå¼ƒGBDTå’ŒLRç”¨FM/","link":"","permalink":"http://www.wortyby.com/2018/11/07/åŸºäºSpark GraphXï¼Œå¼ƒGBDTå’ŒLRç”¨FM/","excerpt":"","text":"ä¸–çºªä½³ç¼˜æ¨èåœºæ™¯å…ˆè¯´ä¸€ä¸‹æˆ‘ä»¬çš„æ¨èåœºæ™¯ã€‚æˆ‘ä»¬ä½¿ç”¨æ¨èçš„åœºæ™¯è·Ÿç”µå½±ã€å•†å“æ¨èæœ‰å¾ˆå¤§çš„ä¸åŒï¼Œå•†å“çš„æ¨èå¯èƒ½åªè€ƒè™‘åˆ°è½¬åŒ–å°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬è¦è€ƒè™‘æ¨èé“¾çš„æ›´é•¿ä¸€äº›ã€‚æˆ‘ä»¬çš„æƒ…å†µï¼šç”¨æˆ·ç™»å½•ç½‘ç«™ï¼Œç®—æ³•æ¨èå‡ºç”¨æˆ·å¯èƒ½æ„Ÿå…´è¶£çš„äººï¼Œç”¨æˆ·å‘ä¿¡ï¼Œæ”¶ä¿¡ç”¨æˆ·çœ‹ä¿¡ã€‚æœ€å¤§çš„ä¸åŒç‚¹åœ¨äºï¼Œæˆ‘ä»¬çš„itemä¹Ÿæ˜¯äººï¼Œè®¾è®¡ç®—æ³•æ—¶ä¹Ÿè¦è€ƒè™‘itemçš„æ„Ÿå—ã€‚æ‹¿äºšé©¬é€Šæ¥ç±»æ¯”ï¼Œäºšé©¬é€Šå¯èƒ½åªéœ€è¦è€ƒè™‘æŠŠä¸€æœ¬ä¹¦æ¨èç»™æŸä¸ªäººï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘è¿™æœ¬ä¹¦æ˜¯ä¸æ˜¯æƒ³è¢«æ¨èç»™è¿™ä¸ªäººã€‚ä¸¾ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬åªæ˜¯æƒ³æé«˜ç”·æ€§ç”¨æˆ·å‘ä¿¡ï¼Œæˆ‘ä»¬åªéœ€è¦ç»™æ‰€æœ‰äººæ¨èç¾å¥³ï¼Œè¿™æ ·å‘ä¿¡é‡ä¸€å®šä¼šæš´æ¶¨ã€‚ä½†æ˜¯è¿™æ ·åšä¼šå¼•å‘å¾ˆå¤šé—®é¢˜ï¼š1)ç¾å¥³ä¸€å¤©ä¸å¯èƒ½è¯»ä¸Šåƒå°ä¿¡ï¼›2)ç¾å¥³å¯¹äºä¸€äº›æ¡ä»¶ä¸å¥½çš„ç”·æ€§æ ¹æœ¬æ²¡å…´è¶£ï¼›ï¼“)éç¾å¥³æ”¶ä¸åˆ°ä¿¡ã€‚æ‰€ä»¥æ— è®ºæ˜¯åœ¨äº§ç”Ÿå€™é€‰ï¼Œè¿˜æ˜¯åœ¨æ’åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½è¦åŒæ—¶è€ƒè™‘userå’Œitemã€‚ä»¥ä¸Šæ˜¯æˆ‘ä»¬åœ¨æ¨èåœºæ™¯ä¸Šæ¯”è¾ƒç‰¹æ®Šçš„åœ°æ–¹ã€‚ åŸºäºå›¾ç®—æ³•äº§ç”Ÿå€™é€‰é›†ä¸‹é¢æˆ‘ä¸»è¦è¯´ä¸¤ä¸ªä¸»é¢˜ï¼Œå…ˆè¯´æˆ‘ä»¬å¦‚ä½•äº§ç”Ÿæ¨èã€‚ä»Šå¤©ä¸»è¦è¯´ä¸€ä¸‹åŸºäºå›¾çš„ç®—æ³•ï¼Œæˆ‘ä»¬çš„å›¾ç®—æ³•æ˜¯åœ¨Sparkä¸Šå®ç°çš„ï¼Œä½¿ç”¨ç”¨æˆ·å†å²å‘ä¿¡æ•°æ®ï¼Œè®¡ç®—å¾—åˆ°ç”¨æˆ·çš„æ¨èåˆ—è¡¨ã€‚ï¼ˆä¸–çºªä½³ç¼˜å¯¹Sparkçš„ç†è§£ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ï¼šä¸–çºªä½³ç¼˜å´é‡‘é¾™ï¼šSparkä»‹ç»â€”â€”ç¼–è¾‘æ³¨ï¼‰æˆ‘ä»¬çš„æ•°æ®å¾ˆç¨€ç–ï¼Œåœ¨å›¾ç®—æ³•ä¸­ï¼Œå¯¹äºæ•°æ®æ¯”è¾ƒå¤šçš„ç”¨æˆ·ä½¿ç”¨ä¸€è·³èŠ‚ç‚¹ï¼Œå¯¹äºæ•°æ®å°‘çš„ç”¨æˆ·ä½¿ç”¨äºŒè·³ç”šè‡³ä¸‰è·³èŠ‚ç‚¹çš„æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å¼€CFä¸­è®¡ç®—ç›¸ä¼¼åº¦çš„é—®é¢˜ï¼Œå¯¹æ•°æ®å°‘çš„ç”¨æˆ·ä¹Ÿèƒ½äº§ç”Ÿè¶³å¤Ÿå¤šçš„æ¨èã€‚å½“æ—¶é‡åˆ°çš„ä¸»è¦é—®é¢˜æ˜¯æ•°æ®ï¼šä¸€æ˜¯æ•°æ®å¤ªå¤§ï¼ŒäºŒæ˜¯æ•°æ®è´¨é‡ä¸é«˜ã€‚å¯¹é‚£äº›å‡ºåº¦ï¼ˆå‘ä¿¡ï¼‰å’Œå…¥åº¦ï¼ˆæ”¶ä¿¡ï¼‰å¾ˆå¤šçš„ç‚¹éƒ½è¦æƒ³åŠæ³•è¿›è¡ŒæŠ½æ ·ï¼Œå¦åˆ™ä¼šåœ¨è®¡ç®—æ—¶ä¼šè€—å°½å†…å­˜ã€‚æŠ½æ ·æ—¶ä¹Ÿå°½é‡æé«˜æ•°æ®è´¨é‡ã€‚å¯¹äºæ”¶ä¿¡å¾ˆå¤šçš„ç”¨æˆ·ï¼ŒæŠ½æ ·æ–¹æ³•å¾ˆç®€å•ï¼Œç•™ä¸‹ç”¨æˆ·çœ‹äº†çš„ä¿¡ï¼Œå»æ‰æ²¡çœ‹è¿‡çš„ã€‚å¯¹äºå‘ä¿¡çš„æŠ½æ ·ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åªç•™ä¸‹è¢«çœ‹è¿‡çš„ä¿¡ï¼Œä½†æ˜¯ç§æ–¹æ³•æœ‰ä¸€ç‚¹è®²ä¸é€šï¼Œå› ä¸ºçœ‹ä¸çœ‹ä¿¡æ˜¯ç«™åœ¨itemçš„è§’åº¦è€ƒè™‘çš„ï¼Œå¯¹å‘ä¿¡æŠ½æ ·ï¼Œåº”è¯¥ç«™åœ¨userçš„è§’åº¦ã€‚æˆ‘ä»¬å°è¯•äº†ç›´æ¥æ‰”æ‰å‘ä¿¡è¿‡å¤šçš„ç”¨æˆ·ï¼ŒéšæœºæŠ½æ ·ï¼Œä¿ç•™æœ€è¿‘æ•°æ®å‡ ç§æ–¹æ³•ã€‚ä½†æ˜¯è¿™æ ·çš„æ–¹æ³•éƒ½æ˜¯å¾ˆç›²ç›®çš„ã€‚å¯¹äºå‘ä¿¡è€Œè¨€ï¼Œæœ€ä¸»è¦çš„åº¦é‡åº”è¯¥æ˜¯ï¼šå‘ä¿¡é‚£ä¸€åˆ»ï¼Œç”¨æˆ·æ˜¯ä¸æ˜¯è®¤çœŸçš„ã€‚å¦‚æœç”¨æˆ·å‘ä¿¡æ˜¯å¾ˆéšæ„çš„ï¼Œæ²¡æœ‰ç»è¿‡ç­›é€‰ï¼Œé‚£è¿™ä¸ªæ•°æ®å…¶å®æ²¡æœ‰å¤šå¤§æ„ä¹‰ã€‚è§£å†³è¿™ä¸ªé—®é¢˜å½“ç„¶ä¹Ÿå¯ä»¥åšä¸ªæ¨¡å‹ï¼Œä½†æ˜¯å¤ªå¤æ‚äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼šæ ¹æ®ç”¨æˆ·çš„å‘ä¿¡é—´éš”åˆ¤æ–­ï¼Œæ¯”å¦‚è¿™å°ä¿¡ä¸ä¸Šä¸€å°ä¿¡æ—¶é—´é—´éš”10sä»¥ä¸Šï¼Œæˆ‘ä»¬å°±è®¤ä¸ºç”¨æˆ·åœ¨ç”¨å¿ƒçš„å‘ä¿¡ï¼Œä¿ç•™è¿™ä¸ªæ•°æ®ï¼Œå¦åˆ™æ‰”æ‰ã€‚æ–¹æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯æœ€ç»ˆçº¿ä¸Šçš„æ•ˆæœå´å¾ˆå¥½ã€‚æˆ‘å–äº†ä¸€ä¸ªå‘ä¿¡å¾ˆéšæ„çš„ç”¨æˆ·æ•°æ®ï¼Œç»Ÿè®¡äº†æ”¶ä¿¡äººåœ¨æŸä¸ªç»´åº¦çš„åˆ†å¸ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä»¥ä¸‹åˆ™æ˜¯ä¸€ä¸ªè®¤çœŸå‘ä¿¡çš„ç”¨æˆ·ï¼Œåˆ¤æ–­æ ‡å‡†å°±æ˜¯åˆšæ‰è¯´çš„æ—¶é—´é—´éš”ã€‚å¯ä»¥æ˜æ˜¾çœ‹å‡ºæ¥ï¼Œè®¤çœŸå‘ä¿¡çš„ç”¨æˆ·ï¼Œåªç»™ç¬¦åˆè‡ªå·±è¦æ±‚çš„äººå‘ä¿¡ï¼Œæ‰€ä»¥åˆ†å¸ƒä¼šæ›´é›†ä¸­ä¸€äº›ã€‚ä½†æ˜¯ä¸è®¤çœŸçš„ç”¨æˆ·ï¼Œåˆ†å¸ƒå°±å¾ˆæ•£äº†ã€‚ æ’åºç®—æ³•çš„å®ç°ç¬¬äºŒä¸ªä¸»é¢˜ï¼Œè¯´ä¸€ä¸‹æ’åºã€‚ä¸»è¦æ˜¯å¯¹ä¸Šè¾¹äº§ç”Ÿçš„å€™é€‰é›†æ’åºåæŠŠæœ€ç»ˆç»“æœå±•ç¤ºç»™ç”¨æˆ·ã€‚ç”¨åˆ°çš„ç®—æ³•ä¹Ÿæ˜¯CTRé¢„æµ‹ä¸­å¸¸ç”¨åˆ°çš„LRã€FMã€GBDTç­‰ã€‚å‰è¾¹è¯´è¿‡ï¼Œæˆ‘ä»¬é™¤äº†è¦è€ƒè™‘userå‘ä¿¡ï¼Œè¿˜è¦è€ƒè™‘itemä¼šä¸ä¼šçœ‹ä¿¡ï¼Œç”šè‡³itemä¼šä¸ä¼šå›ä¿¡ã€‚å› æ­¤ä¸€æ¬¡æ’åºé€šå¸¸ä¼šç»„åˆå¥½å‡ ä¸ªæ¨¡å‹ï¼šç‚¹å‡»æ¨¡å‹é¢„æµ‹userä»å±•ç¤ºé‡Œç‚¹itemçš„æ¦‚ç‡ï¼Œå‘ä¿¡æ¨¡å‹é¢„æµ‹å‘ä¿¡æ¦‚ç‡ï¼Œè¯»ä¿¡æ¨¡å‹é¢„æµ‹itemè¯»ä¿¡æ¦‚ç‡ã€‚ç„¶åå¯¹è¿™å‡ ç§æ¦‚ç‡åšä¸ªç»„åˆåå¾—åˆ°æœ€ç»ˆçš„æƒé‡å€¼ã€‚ç”¨åˆ°çš„å·¥å…·ï¼Œæ•°æ®æ€ä¹ˆå¤„ç†ï¼Œéƒ½è·Ÿå¤§å®¶ä¸€æ ·ï¼Œæ²¡ä»€ä¹ˆè¦è¯´çš„ï¼Œè¿™é‡Œé‡ç‚¹æä¸€ä¸ªæˆ‘ä»¬ç”¨åˆ°çš„è¯„ä¼°æ–¹æ³•ã€‚å¤§è‡´å°±æ˜¯ä¸Šå›¾è¿™æ¡æ›²çº¿ï¼Œæ¨ªåº§æ ‡æ˜¯é¢„æµ‹æ¦‚ç‡çš„ä¸€ä¸ªåŒºé—´ï¼Œçºµåº§æ ‡æ˜¯åœ¨è¿™ä¸ªåŒºé—´å†…çœŸå®å€¼çš„å¹³å‡ã€‚æ¯”å¦‚å›¾ä¸­(0.45, 0.46)çš„ç‚¹ï¼Œè®¡ç®—æ–¹æ³•æ˜¯ï¼šå–æ‰€æœ‰é¢„æµ‹å€¼åœ¨[0.445, 0.455)çš„çœŸå®å€¼ï¼Œè®°ä¸ºXï¼›avg(X)ä¸ºçºµåº§æ ‡å€¼ï¼›è¿™æ¡æ›²çº¿æœ€å®Œç¾çš„æƒ…å†µåº”è¯¥æ˜¯åªæœ‰(0, 0)ï¼Œ(1, 1)ç‚¹æœ‰å€¼ï¼Œå½“ç„¶ç®—æ³•ä¸å¯èƒ½åšåˆ°è¿™æ ·ã€‚æ¬¡å¥½çš„æƒ…å†µï¼Œç”»å‡ºæ¥çš„çº¿åº”è¯¥ä¸ y=x é‡åˆã€‚ä¹‹å‰è¯´è¿‡ï¼Œæˆ‘ä»¬çš„æ’åºæ˜¯æŠŠå¤šä¸ªç®—æ³•å‡ºæ¥çš„æ¦‚ç‡å€¼ä½œç»„åˆï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªç®—æ³•çš„æ•ˆæœé™¤äº†è¦æ±‚æ’åºæ­£ç¡®ï¼Œè¿˜å¸Œæœ›é¢„æµ‹çš„æ¦‚ç‡å€¼ä¹Ÿå°½é‡æ¥è¿‘çœŸå®å€¼ã€‚ROCã€NDCG å¯ä»¥å¾ˆå¥½çš„åº¦é‡æ’åºï¼Œä½†æ˜¯æ²¡æ³•åº¦é‡çœŸå®å€¼ä¸é¢„æµ‹å€¼çš„åå·®ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ç‰¹åˆ«å…³æ³¨è¿™æ¡çº¿ã€‚ ç»éªŒå¿ƒå¾—æœ€åè¯´ä¸€ä¸‹æˆ‘ä»¬å‡ æ¬¡ç®—æ³•å°è¯•æ—¶é‡åˆ°çš„é—®é¢˜ã€‚1.æµ‹è¯•Facebookè®ºæ–‡ä¸­æåˆ°çš„ç”¨GBDTæå–ç‰¹å¾çš„æ–¹æ³•ã€‚å½“æ—¶ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠç»™LRçš„ç‰¹å¾ä½œä¸ºGBDTçš„ç‰¹å¾ï¼Œç„¶åæŠŠå¾—åˆ°çš„å¶å­èŠ‚ç‚¹ä½œä¸ºç‰¹å¾ï¼Œä¸åŸæ¥çš„ç‰¹å¾ç»„åˆåˆ°ä¸€èµ·å†æ‰”ç»™LRã€‚ï¼ˆå¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼šCTRé¢„ä¼°ä¸­GBDTä¸LRèåˆæ–¹æ¡ˆâ€”â€”ç¼–è¾‘æ³¨ï¼‰çº¿ä¸‹æ•ˆæœå’Œçº¿ä¸Šæ•ˆæœéƒ½æœ‰æå‡ï¼Œæˆ‘ä»¬æ¨å¹¿äº†è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å‘ç°å…¶ä¸­ä¸€ä¸ªæ¨¡å‹æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚æ’æŸ¥é—®é¢˜çš„æ—¶å€™å‘ç°ï¼Œè¿™ä¸ªæ¨¡å‹å¯¹æ‰€æœ‰ç‰¹å¾ä½œäº†ç¦»æ•£åŒ–ï¼Œå‡ºæ¥çš„ç‰¹å¾å€¼å…¨éƒ¨é0å³1ã€‚GBDTæœ¬æ¥å°±æ˜¯ä¸ªæ ‘æ¨¡å‹ï¼Œèƒ½å¾ˆå¥½çš„å¤„ç†éçº¿æ€§ç‰¹å¾ï¼Œä½¿ç”¨ç¦»æ•£åŒ–åçš„ç‰¹å¾åè€Œæ²¡ä»€ä¹ˆæ•ˆæœã€‚è€Œä¸”å¯¹äºè¿™ç§åªæœ‰0ã€1å€¼çš„æƒ…å†µï¼ŒGBDTå‡ºç°äº†ä¸æ”¶æ•›çš„ç°è±¡ã€‚2.ä¸åŒçš„åœºæ™¯ï¼Œä½¿ç”¨ä¸åŒçš„ç®—æ³•ã€‚LRæ˜¯æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„ï¼Œæ‰€ä»¥åœ¨åšç‚¹å‡»æ¨¡å‹æ—¶ï¼Œè‡ªç„¶ä¹Ÿæ˜¯å…ˆä¸Šäº†LRï¼Œä½†æ˜¯çº¿ä¸Šæ•ˆæœå¹¶ä¸å¥½ã€‚åæ¥ä¸ŠFMï¼Œæ•ˆæœå´å¥½çš„å‡ºå¥‡ã€‚å¦‚æœç™»å½•è¿‡æˆ‘ä»¬çš„ç½‘ç«™ï¼Œå¾ˆå®¹æ˜“å‘ç°åŸå› ï¼šå±•ç¤ºçš„åœºæ™¯ï¼Œåªèƒ½çœ‹åˆ°å¤´åƒã€åœ°åŒºã€å¹´é¾„ç­‰å‡ ä¸ªå±æ€§ï¼ŒLRä½¿ç”¨äº†å¤§é‡ç”¨æˆ·çœ‹ä¸åˆ°çš„ç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾å¯¹äºæ¨¡å‹æ¥è¯´æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚Thatâ€™s allï¼Œæˆ‘ä»Šå¤©åˆ†äº«å°±åˆ°è¿™é‡Œäº†ã€‚ Q&amp;Aé—®ï¼šèƒ½å¦å†è¯¦ç»†ä»‹ç»ä¸€ä¸‹æ¨èç³»ç»Ÿæ‰€é‡‡ç”¨çš„å·¥å…·ï¼Ÿç­”ï¼šRçš„è¯ï¼Œæˆ‘ä»¬ä¸»è¦ç”¨Liblinearï¼›FMä¸»è¦ç”¨SVDFeatureï¼›æ•°æ®ä¸»è¦æ”¾Hiveï¼›Redisã€Memcacheå’ŒMongoDBéƒ½ä¼šç”¨åˆ°ï¼›å®æ—¶è®¡ç®—ï¼Œä¼šå¯¹æ¥Kafkaã€‚é—®ï¼šä¸å®æ—¶è®¡ç®—å¯ä»¥å—ï¼Ÿå“ªäº›æ–¹é¢æ˜¯éœ€è¦å®æ—¶è®¡ç®—ï¼Ÿç­”ï¼šæœ€ä¸»è¦çš„è®¡ç®—ï¼Œè¿˜æ˜¯ç¦»çº¿ç®—å¥½çš„ã€‚æ¯”å¦‚å®æ—¶çš„æ’åºï¼Œå› ä¸ºæ¨èåˆ—è¡¨åŠ¨æ€ç”Ÿæˆï¼Œæ’åºåªèƒ½åšæˆå®æ—¶çš„ã€‚é—®ï¼šè¯·é—®ä¸»è¦çš„ç®—æ³•ç”¨å¾—ä»€ä¹ˆè¯­è¨€å¼€å‘çš„ï¼Ÿç­”ï¼šçº¿ä¸ŠJavaï¼Œçº¿ä¸‹çš„ä»£ç å°±å¾ˆéšæ„äº†ï¼ŒPython/Java/Shell/Hiveï¼Œä»€ä¹ˆæ–¹ä¾¿ç”¨ä»€ä¹ˆã€‚é—®ï¼šåšç®—æ³•æ—¶ï¼Œä½ è§‰çš„æœ€å¤§çš„éšœç¢æ˜¯å•¥ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›éšœç¢ï¼Ÿå¯ä»¥è°ˆè°ˆå…·ä½“å®ç°ä¸Šé‡åˆ°çš„ä¸€äº›å›°éš¾ã€‚ç­”ï¼šå¾ˆå¤šæ—¶å€™ï¼Œä¸€ä¸ªæ¨¡å‹æ•ˆæœä¸å¥½ï¼Œä½†æ˜¯å´ä¸çŸ¥é“ä»å“ªé‡Œç€æ‰‹æ”¹è¿›ã€‚ä¸çŸ¥é“åŠ ä»€ä¹ˆæ ·çš„ç‰¹å¾ä¼šæœ‰æ•ˆï¼Œæ¢æ¨¡å‹ä¹Ÿæ²¡æœ‰æ•ˆæœï¼Œè¯•è¿‡äº†èƒ½æƒ³åˆ°çš„æ‰€æœ‰æ–¹æ³•ã€‚é—®ï¼šå¯¹æ•°å­¦è¦æ±‚é«˜å—ï¼Ÿç­”ï¼šæˆ‘è‡ªå·±ä¸»è¦åšå¼€å‘å·¥ä½œï¼Œæ•°å­¦æœ‰è¦æ±‚ï¼Œä½†æ˜¯ä¸æ˜¯é‚£ä¹ˆé«˜ï¼Œèƒ½çœ‹æ‡‚è®ºæ–‡å°±å¥½ã€‚é—®ï¼šæ¨è€å¸ˆï¼Œä½ ä»¬å¯¹ç”¨æˆ·çš„ä¹ æƒ¯æœ‰ç ”ç©¶å—ï¼Ÿå¦‚ä½•åšçš„ï¼Ÿç­”ï¼šç”¨æˆ·ä¹ æƒ¯ï¼Œæˆ‘ä»¬ä¸»è¦ä¼šç»Ÿè®¡ä¸€äº›æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·ç»å¸¸ç»™å¤šå°‘å²çš„äººå‘ä¿¡ï¼Œç„¶åæŠŠè¿™ä¸ªç»Ÿè®¡ä½œä¸ºç‰¹å¾æ”¾åˆ°æ¨¡å‹é‡Œã€‚é—®ï¼šè¯·é—®ä¸‹ï¼Œåœ¨ä½¿ç”¨ç®—æ³•çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹äºå¯¹åº”ç®—æ³•çš„å…·ä½“æ¨æ¼”è¿‡ç¨‹ä½ ä»¬éœ€è¦å…¨éƒ¨ç†è§£é€ä¹ˆã€‚æ„Ÿè§‰æœ‰æ—¶å€™ä¸€ä¸ªç®—æ³•å¯¹æ•°å­¦çš„è¦æ±‚å¥½é«˜å•Šï¼Œæƒ³ç†æ¸…ç¼˜ç”±éš¾åº¦è›®å¤§çš„ã€‚ç­”ï¼šä¸éœ€è¦å…¨éƒ¨ç†è§£é€ï¼Œè‡³å°‘æˆ‘çœ‹äº†å¾ˆå¤šéEMçš„æ¨å¯¼ï¼Œç°åœ¨æ¨ï¼Œæˆ‘è¿˜æ˜¯ä¸ä¼šã€‚ä½†æ˜¯æˆ‘çŸ¥é“EMæ¨å¯¼å¤§æ¦‚æ€ä¹ˆå›äº‹ã€‚é—®ï¼šä¸€èˆ¬ä½ ä»¬æ€ä¹ˆæ ·ä»ä¸ºè§£å†³æŸä¸ªé—®é¢˜ï¼Œè€Œé€‰æ‹©éœ€è¦åˆ©ç”¨å“ªäº›ç»´åº¦ï¼Œç„¶åå‡ºå‘å»æ„å»ºæ¨¡å‹çš„ï¼Ÿç­”ï¼šè¿™ä¸ªä¸»è¦è¿˜æ˜¯ä¸ªäººç»éªŒï¼Œåšçš„å¤šäº†ï¼Œå¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°æœ€æœ‰æ•ˆçš„ç‰¹å¾ã€‚é—®ï¼šæ¨¡å‹æ˜¯åŸºäºå·²æœ‰çš„ä¸€äº›æ–‡ç« çš„è¿˜æ˜¯åœ¨å®éªŒè¿‡ç¨‹ä¸­æ”¹è¿›çš„ï¼Œæœ‰ä¸“é—¨çš„ç®—æ³•éƒ¨ï¼Ÿç­”ï¼šæ¨¡å‹ä¸»è¦è¿˜æ˜¯åŸºäºå·²æœ‰çš„ï¼Œé™¤éå¾ˆä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€è¦ï¼Œå¦åˆ™å¾ˆå°‘å»æ”¹ã€‚é—®ï¼šä¸€äº›å¸¸ç”¨ç®—æ³•çš„æ¨å¯¼ï¼Œç‰¹æ€§ï¼Œç”¨æ³•éƒ½çš„çŸ¥é“å—ï¼Ÿç­”ï¼šå¸¸ç”¨ç®—æ³•è‚¯å®šæ˜¯è¦çŸ¥é“çš„ã€‚é—®ï¼šæ¨è€å¸ˆï¼Œä½ åˆšåˆšå­¦ä¹ çš„æ—¶å€™ï¼Œä»å“ªä¸ªç®€å•ç¤ºä¾‹æˆ–è€…æ–‡æ¡£å…¥æ‰‹çš„ï¼Ÿç­”ï¼šã€Šé›†ä½“æ™ºæ…§ç¼–ç¨‹ã€‹ã€‚é—®ï¼šèƒ½å¦ä»‹ç»ä½³ç¼˜çš„æ¨èç›®å‰çš„å®é™…æ•ˆæœï¼Œä¸‹ä¸€æ­¥çš„æ”¹è¿›æ–¹å‘ï¼Ÿç­”ï¼šåˆ†ç®—æ³•å’Œåœºæ™¯ï¼Œæ•´ä½“ä¸Šçœ‹ï¼Œå¦‚æœåŸæ¥ä»€ä¹ˆç®—æ³•éƒ½æ²¡æœ‰ï¼Œå¯èƒ½ä¼šæœ‰50%å·¦å³çš„æå‡ã€‚ä¸‹ä¸€æ­¥çš„æ–¹å‘ï¼Œä¸»è¦æ˜¯å…·ä½“ç»†åˆ†ç”¨æˆ·ï¼Œæˆ–è€…ä»å…¶å®ƒç»´åº¦ç»†åˆ†ç®—æ³•ã€‚ä¹‹å‰çš„åªå…³æ³¨äº†æŒ‰åœºæ™¯ç»†åˆ†ï¼Œä»¥åç»†åˆ†çš„ç»´åº¦ä¼šæ‹“å®½äº›ã€‚é—®ï¼šè¯·é—®æ‚¨è®¤ä¸ºåº”å±Šç”Ÿåº”è¯¥æ€æ ·å¾€æœºå™¨å­¦ä¹ æ–¹å‘å‘å±•å‘¢ï¼Ÿç­”ï¼šç¯å¢ƒæ˜¯æœ€é‡è¦çš„ï¼Œå¦‚æœçœŸæƒ³åšï¼Œæ‰¾ä¸ªçœŸæ­£åšè¿™ä¸ªçš„å…¬å¸ã€‚æˆ‘ä¸€ç›´æƒ³åšæ¸¸æˆï¼Œåˆ°ç°åœ¨éƒ½æ²¡åšæˆ[Smile]ã€‚åŸæ–‡é“¾æ¥å‚è€ƒæ–‡ç« ","categories":[{"name":"Spark","slug":"Spark","permalink":"http://www.wortyby.com/categories/Spark/"}],"tags":[{"name":"FM","slug":"FM","permalink":"http://www.wortyby.com/tags/FM/"},{"name":"Graph","slug":"Graph","permalink":"http://www.wortyby.com/tags/Graph/"},{"name":"LR","slug":"LR","permalink":"http://www.wortyby.com/tags/LR/"},{"name":"GBDT","slug":"GBDT","permalink":"http://www.wortyby.com/tags/GBDT/"},{"name":"æ•°æ®ç‰¹å¾å°‘çš„çŠ¶å†µ","slug":"æ•°æ®ç‰¹å¾å°‘çš„çŠ¶å†µ","permalink":"http://www.wortyby.com/tags/æ•°æ®ç‰¹å¾å°‘çš„çŠ¶å†µ/"}]},{"title":"Custom Email Alerts in Airflow","slug":"Custom Email Alerts in Airflow","date":"2018-11-06T09:14:44.000Z","updated":"2018-11-06T09:14:44.000Z","comments":true,"path":"2018/11/06/Custom Email Alerts in Airflow/","link":"","permalink":"http://www.wortyby.com/2018/11/06/Custom Email Alerts in Airflow/","excerpt":"","text":"Apache Airflow is great for coordinating automated jobs, and it provides a simple interface for sending email alerts when these jobs fail. Typically, one can request these emails by setting email_on_failure to True in your operators.These email alerts work great, but I wanted to include additional links in them (I wanted to include a link to my spark cluster which can be grabbed from the Databricks Operator). Hereâ€™s how I created a custom email alert on job failure.First, I set email_on_failure to False and use the operatorsâ€™s on_failure_callback. I give on_failure_callback the function described below.12345678910111213141516171819from airflow.utils.email import send_emaildef notify_email(contextDict, **kwargs): &quot;&quot;&quot;Send custom email alerts.&quot;&quot;&quot; # email title. title = &quot;Airflow alert: &#123;task_name&#125; Failed&quot;.format(**contextDict) # email contents body = &quot;&quot;&quot; Hi Everyone, &lt;br&gt; &lt;br&gt; There&apos;s been an error in the &#123;task_name&#125; job.&lt;br&gt; &lt;br&gt; Forever yours,&lt;br&gt; Airflow bot &lt;br&gt; &quot;&quot;&quot;.format(**contextDict) send_email(&apos;you_email@address.com&apos;, title, body)send_email is a function imported from Airflow. contextDict is a dictionary given to the callback function on error. Importantly, contextDict contains lots of relevant information. This includes the Task Instance (key=â€™tiâ€™) and Operator Instance (key=â€™taskâ€™) associated with your error. I was able to use the Operator Instance, to grab the relevant clusterâ€™s address and I included this address in my email (this exact code is not present here).To use the notify_email, I set on_failure_callback equal to notify_email.I write out a short example airflow dag below.1234567891011121314151617181920212223from airflow.models import DAGfrom airflow.operators import PythonOperatorfrom airflow.utils.dates import days_agoargs = &#123; &apos;owner&apos;: &apos;me&apos;, &apos;description&apos;: &apos;my_example&apos;, &apos;start_date&apos;: days_ago(1)&#125;# run every day at 12:05 UTCdag = DAG(dag_id=&apos;example_dag&apos;, default_args=args, schedule_interval=&apos;0 5 * * *&apos;)def print_hello(): return &apos;hello!&apos;py_task = PythonOperator(task_id=&apos;example&apos;, python_callable=print_hello, on_failure_callback=notify_email, dag=dag)py_taskNote where set on_failure_callback equal to notify_email in the PythonOperator.Hope you find this helpful! Donâ€™t hesitate to reach out if you have a question.","categories":[{"name":"workflow","slug":"workflow","permalink":"http://www.wortyby.com/categories/workflow/"}],"tags":[{"name":"airflow","slug":"airflow","permalink":"http://www.wortyby.com/tags/airflow/"},{"name":"Email","slug":"Email","permalink":"http://www.wortyby.com/tags/Email/"},{"name":"é€šçŸ¥","slug":"é€šçŸ¥","permalink":"http://www.wortyby.com/tags/é€šçŸ¥/"}]},{"title":"airflowä¹‹DAGsè¯¦è§£","slug":"airflowä¹‹DAGsè¯¦è§£","date":"2018-11-05T08:24:01.000Z","updated":"2018-11-05T08:24:01.000Z","comments":true,"path":"2018/11/05/airflowä¹‹DAGsè¯¦è§£/","link":"","permalink":"http://www.wortyby.com/2018/11/05/airflowä¹‹DAGsè¯¦è§£/","excerpt":"","text":"å‰è¨€å¯åŠ¨dagè°ƒåº¦å™¨, æ³¨æ„å¯åŠ¨è°ƒåº¦å™¨, å¹¶ä¸æ„å‘³ç€dagä¼šè¢«é©¬ä¸Šè§¦å‘, dagè§¦å‘éœ€è¦ç¬¦åˆå®ƒè‡ªå·±çš„scheduleè§„åˆ™å¦‚æœç¼ºçœäº† END_DATE å‚æ•°, END_DATE ç­‰åŒäºSTART_DATE.ä½¿ç”¨ DummyOperator æ¥æ±‡èšåˆ†æ”¯ä½¿ç”¨ ShortCircuitOperator/BranchPythonOperator åšåˆ†æ”¯ä½¿ç”¨ SubDagOperator åµŒå…¥ä¸€ä¸ªå­dagä½¿ç”¨ TriggerDagRunOperator ç›´æ¥ trigger å¦ä¸€ä¸ªdagåœ¨åˆ›å»º MyBashOperator çš„å®ä¾‹æ—¶å€™, ä¸ºon_failure_callback å’Œon_success_callback å‚æ•°è®¾ç½®ä¸¤ä¸ªå›è°ƒå‡½æ•°, æˆ‘ä»¬åœ¨å›è°ƒå‡½æ•°ä¸­, å°†successæˆ–failedçŠ¶æ€è®°å½•åˆ°è‡ªå·±çš„è¡¨ä¸­.DAGçš„schedule_intervalå‚æ•°è®¾ç½®æˆNone, è¡¨æ˜è¿™ä¸ªDAGå§‹ç»ˆæ˜¯ç”±å¤–éƒ¨è§¦å‘ã€‚å¦‚æœå°†default_argså­—å…¸ä¼ é€’ç»™DAGï¼ŒDAGå°†ä¼šå°†å­—å…¸åº”ç”¨äºå…¶å†…éƒ¨çš„ä»»ä½•Operatorä¸Šã€‚è¿™å¾ˆå®¹æ˜“çš„å°†å¸¸ç”¨å‚æ•°åº”ç”¨äºå¤šä¸ªOperatorï¼Œè€Œæ— éœ€å¤šæ¬¡é”®å…¥ã€‚1234567default_args=dict( start_date=datetime(2016, 1, 1), owner=&apos;Airflow&apos;)dag = DAG(&apos;my_dag&apos;, default_args=default_args)op = DummyOperator(task_id=&apos;dummy&apos;, dag=dag)print(op.owner) # Airflow Airflow å‘½ä»¤initdbï¼Œåˆå§‹åŒ–å…ƒæ•°æ®DBï¼Œå…ƒæ•°æ®åŒ…æ‹¬äº†DAGæœ¬èº«çš„ä¿¡æ¯ã€è¿è¡Œä¿¡æ¯ç­‰ï¼›resetdbï¼Œæ¸…ç©ºå…ƒæ•°æ®DBï¼›list_dagsï¼Œåˆ—å‡ºæ‰€æœ‰DAGï¼›list_tasksï¼Œåˆ—å‡ºæŸDAGçš„æ‰€æœ‰taskï¼›testï¼Œæµ‹è¯•æŸtaskçš„è¿è¡ŒçŠ¶å†µï¼›backfillï¼Œæµ‹è¯•æŸDAGåœ¨è®¾å®šçš„æ—¥æœŸåŒºé—´çš„è¿è¡ŒçŠ¶å†µï¼›webserverï¼Œå¼€å¯webserveræœåŠ¡ï¼›schedulerï¼Œç”¨äºç›‘æ§ä¸è§¦å‘DAGã€‚12345678910111213141516171819202122$ cd $&#123;AIRFLOW_HOME&#125;/dags $ python test_import.py # ä¿è¯ä»£ç æ— è¯­æ³•é”™è¯¯ $ airflow list_dags # æŸ¥çœ‹dagæ˜¯å¦æˆåŠŸåŠ è½½ airflow list_tasks test_import_dag â€“tree # æŸ¥çœ‹dagçš„æ ‘å½¢ç»“æ„æ˜¯å¦æ­£ç¡® $ airflow test test_import_dag \\ test_import_task 2016-3-7 # æµ‹è¯•å…·ä½“çš„dagçš„æŸä¸ªtaskåœ¨æŸä¸ªæ—¶é—´çš„è¿è¡Œæ˜¯å¦æ­£å¸¸ $ airflow backfill test_import_dag -s 2016-3-4 \\ -e 2016-3-7 # å¯¹dagè¿›è¡ŒæŸæ®µæ—¶é—´å†…çš„å®Œæ•´æµ‹è¯•# print the list of active DAGsairflow list_dags# prints the list of tasks the &quot;tutorial&quot; dag_idairflow list_tasks tutorial# prints the hierarchy of tasks in the tutorial DAGairflow list_tasks tutorial --tree ä½¿ç”¨supervisordè¿›è¡Œdeamonairflowæœ¬èº«æ²¡æœ‰deamonæ¨¡å¼ï¼Œæ‰€ä»¥ç›´æ¥ç”¨supervisordå°±okäº†ï¼Œæˆ‘ä»¬åªè¦å†™4è¡Œä»£ç 12345[program:airflow_web]command=/home/kimi/env/athena/bin/airflow webserver -p 8080 [program:airflow_scheduler]command=/home/kimi/env/athena/bin/airflow schedulerè¯·æ³¨æ„ï¼Œairflow testå‘½ä»¤åœ¨æœ¬åœ°è¿è¡Œä»»åŠ¡å®ä¾‹ï¼Œå°†å…¶æ—¥å¿—è¾“å‡ºåˆ°stdoutï¼ˆå±å¹•ä¸Šï¼‰ï¼Œä¸ä¼šå½±å“ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”ä¸ä¼šå°†çŠ¶æ€ï¼ˆè¿è¡Œï¼ŒæˆåŠŸï¼Œå¤±è´¥ï¼Œâ€¦ï¼‰å‘é€åˆ°æ•°æ®åº“ã€‚ å®ƒåªæ˜¯å…è®¸ç®€å•çš„æµ‹è¯•å•ä¸ªä»»åŠ¡å®ä¾‹ã€‚å¦‚æœä½¿ç”¨depends_on_past = Trueï¼Œåˆ™å•ä¸ªä»»åŠ¡å®ä¾‹å°†å–å†³äºä¸Šä¸€ä¸ªä»»åŠ¡å®ä¾‹çš„æˆåŠŸä¸å¦ï¼Œå¦‚æœæŒ‡å®šæœ¬èº«çš„start_dateï¼Œåˆ™å¿½ç•¥æ­¤ä¾èµ–å…³ç³»12# start your backfill on a date rangeairflow backfill tutorial -s 2015-06-01 -e 2015-06-07 é€šè¿‡Xcom åœ¨ task ä¹‹é—´ä¼ å‚å¯ä»¥ç›´æ¥ä½¿ç”¨jinjaæ¨¡æ¿è¯­è¨€ï¼Œåœ¨ æ¨¡æ¿å˜é‡***ti.xcom_push | ti.xcom_pull*** ä¸­è°ƒç”¨tiçš„ xcom_push å’Œ xcom_pull æ–¹æ³•ï¼Œä¸‹é¢çš„ä¾‹å­ä¸º t1 ä½¿ç”¨ xcom_push æ¨å‡ºäº†ä¸€ä¸ª kvï¼Œt2 é€šè¿‡ taskid å’Œ key æ¥æ¥æ”¶.12345678910111213dag = DAG( dag_id=&apos;xcomtest&apos;, default_args=default_args, schedule_interval=&apos;*/2 * ** *&apos;) t1 = BashOperator( task_id=&apos;xcom&apos;, bash_command=&apos;&apos;&apos;&apos;&apos;&#123;&#123; ti.xcom_push(key=&apos;aaa&apos;, value=&apos;bbb&apos;) &#125;&#125;&apos;&apos;&apos;, dag=dag) t2 = BashOperator( task_id=&apos;xcom2&apos;, bash_command=&apos;&apos;&apos;&apos;&apos;echo&quot;&#123;&#123; ti.xcom_pull(key=&apos;aaa&apos;, task_ids=&apos;xcom&apos;) &#125;&#125;&quot; &apos;&apos;&apos;, dag=dag) t2.set_upstream(t1)airflow æä¾›äº†å¾ˆå¤š Macros Variablesï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ jinja æ¨¡æ¿è¯­è¨€è°ƒç”¨å®å˜é‡12345678910111213templated_command = &quot;&quot;&quot;echo &quot;dag_run:&#123;&#123; dag_run &#125;&#125;&quot;echo &quot;run_id:&#123;&#123; run_id &#125;&#125;&quot;echo &quot;execution_date:&#123;&#123; execution_date &#125;&#125;&quot;echo &quot;ts:&#123;&#123; ts &#125;&#125;&quot;echo &quot;ti:&#123;&#123; ti &#125;&#125;&quot;sleep 3&quot;&quot;&quot; t1 = BashOperator( task_id=&apos;xcom&apos;, bash_command=templated_command, dag=dag)execution_date å¹¶ä¸æ˜¯ task çš„çœŸæ­£æ‰§è¡Œæ—¶é—´ï¼Œè€Œæ˜¯ä¸Šä¸€å‘¨æœŸ task çš„æ‰§è¡Œæ—¶é—´ã€‚æˆ‘ä»¬åœ¨ airflow ä¸Šçœ‹åˆ°ä¸€ä¸ªä»»åŠ¡æ˜¯ 6am æ‰§è¡Œçš„ï¼Œè€Œä¸” interval=4hours ï¼Œé‚£ä¹ˆexecution_date çš„å€¼æ˜¯ 2amï¼Œè€Œä¸æ˜¯ 6amæš‚æ—¶æ— æ³• ***hold***æˆ–***pause***æŸä¸ªtaskï¼Œåªæ”¯æŒä»¥ dag ä¸ºå•ä½ pauseå½“ä½¿ç”¨BashOperatoræ—¶ï¼Œcommandéœ€è¦è°ƒç”¨è„šæœ¬æ—¶ï¼Œè„šæœ¬åéœ€è¦æœ‰ä¸ªç©ºæ ¼ï¼Œå¦åˆ™æŠ¥é”™ï¼Œæš‚æ—¶ä¸æ¸…æ¥šåŸå› ï¼Œä½†åŠ ç©ºæ ¼åå¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œå¦‚ä¸‹ä¾‹ï¼Œrun.shåéœ€åŠ ç©ºæ ¼1234t1 = BashOperator( task_id=&apos;process_rankinglist&apos;, bash_command=&apos;/home/rankinglist_processor/run.sh &apos;, dag=dag)Airflowä¸ºOperatoræä¾›è®¸å¤šå¸¸è§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ï¼šBashOperator - æ‰§è¡Œbashå‘½ä»¤PythonOperator - è°ƒç”¨ä»»æ„çš„Pythonå‡½æ•°EmailOperator - å‘é€é‚®ä»¶HTTPOperator - å‘é€ HTTP è¯·æ±‚SqlOperator - æ‰§è¡Œ SQL å‘½ä»¤Sensor - ç­‰å¾…ä¸€å®šæ—¶é—´ï¼Œæ–‡ä»¶ï¼Œæ•°æ®åº“è¡Œï¼ŒS3é”®ç­‰â€¦é™¤äº†è¿™äº›åŸºæœ¬çš„æ„å»ºå—ä¹‹å¤–ï¼Œè¿˜æœ‰æ›´å¤šçš„ç‰¹å®šOperator:DockerOperatorï¼ŒHiveOperatorï¼ŒS3FileTransferOperatorï¼ŒPrestoToMysqlOperatorï¼ŒSlackOperator å®airflow æ‰§è¡Œçš„å‘½ä»¤æˆ–è¿™ç§æ¶ˆæ¯æ˜¯æ”¯æŒ jinja2 æ¨¡æ¿è¯­è¨€ï¼›æ˜¯ä¸€ç§å®ï¼Œè¡¨ç¤ºå½“å‰çš„æ—¥æœŸï¼Œå½¢å¦‚2016-12-16ï¼Œæ”¯æŒçš„å®åœ¨https://airflow.incubator.apache.org/code.html#macros å·¥ä½œæµéƒ¨ç½²ç›¸å…³ å…³äºairflowçš„ç¯å¢ƒå˜é‡çš„è®¾ç½®åœ¨BashOperatorçš„env(dictç±»å‹)å‚æ•°ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨å£°æ˜DAGæ—¶çš„default_argsä¸­æ·»åŠ envçš„å£°æ˜ï¼Œä½†éœ€è¦æ³¨æ„ï¼Œå¦‚æœè®¾ç½®äº†envï¼Œairflowå°±ä¸å†è®¿é—®ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®çš„envä¸€å®šè¦åŒ…å«ç¨‹åºè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œå¦åˆ™ä¼šå‡ºé”™123456import oslocal_env = os.environlocal_env[&apos;PATH&apos;] = os.environ[&apos;PATH&apos;] + &quot;:&quot; + Variable.get(&apos;PATH&apos;)local_env[&apos;JAVA_HOME&apos;] = Variable.get(&apos;JAVA_HOME&apos;) åœ¨dagçš„default_argsä¸­æ·»åŠ &apos;env&apos;:dict(local_env) mark_successmark_successå½“taskæ‰§è¡Œå®Œæˆï¼Œä½†åªæ˜¯è¿”å›å€¼ä¸ºå¤±è´¥çš„æ—¶å€™ï¼Œå¯ä»¥ä¸rerunè¯¥taskï¼Œè€Œæ˜¯marksuccessï¼Œç„¶åç»§ç»­æ‰§è¡Œä¸‹é¢çš„taskUIä¸­çš„æ“ä½œæš‚æ—¶æœªæˆåŠŸï¼Œç‚¹å‡»æ€»æ˜¯æç¤ºâ€œNo task instances to markas successful â€ï¼Œç›®å‰å¯ä»¥é€šè¿‡å¼ºåˆ¶rerunä¸‹ä¸€ä¸ªtaskï¼Œä½¿ä¸‹ä¸€ä¸ªtaskæˆåŠŸï¼Œè™½ç„¶å¤±è´¥çš„taskçš„çŠ¶æ€æœªæ”¹å˜ï¼Œä½†å·²ç»ä¸å½±å“ä¸‹é¢çš„taskæ‰§è¡Œå¼ºåˆ¶rerunçš„å‘½ä»¤ä¸ºairflowrun -f -i dag_id task_id execute_time returnåœ¨UIç•Œé¢ä¸­clearæŸä¸ªtaskï¼Œåˆ™airflowä¼šè‡ªåŠ¨rerunè¯¥taskå½“ä½¿ç”¨runæŒ‰é’®æ—¶ï¼Œè¦æ±‚ä½¿ç”¨CeleryExecutoræ‰å¯æ‰§è¡Œï¼Œå› éœ€è¦ä½¿ç”¨redisæ•°æ®åº“ï¼Œæ•…æš‚æ—¶æœªå°è¯• å‘½ä»¤ç›¸å…³testï¼š ç”¨äºæµ‹è¯•ç‰¹å®šçš„æŸä¸ªtaskï¼Œä¸éœ€è¦ä¾èµ–æ»¡è¶³run: ç”¨äºæ‰§è¡Œç‰¹å®šçš„æŸä¸ªtaskï¼Œéœ€è¦ä¾èµ–æ»¡è¶³backfill: æ‰§è¡ŒæŸä¸ªDAGï¼Œä¼šè‡ªåŠ¨è§£æä¾èµ–å…³ç³»ï¼ŒæŒ‰ä¾èµ–é¡ºåºæ‰§è¡Œunpause: å°†ä¸€ä¸ªDAGå¯åŠ¨ä¸ºä¾‹è¡Œä»»åŠ¡ï¼Œé»˜è®¤æ˜¯å…³çš„ï¼Œæ‰€ä»¥ç¼–å†™å®ŒDAGæ–‡ä»¶åä¸€å®šè¦æ‰§è¡Œè¿™å’Œè¦å‘½ä»¤ï¼Œç›¸åå‘½ä»¤ä¸ºpausescheduler: è¿™æ˜¯æ•´ä¸ª airflow çš„è°ƒåº¦ç¨‹åºï¼Œä¸€èˆ¬æ˜¯åœ¨åå°å¯åŠ¨clear: æ¸…é™¤ä¸€äº›ä»»åŠ¡çš„çŠ¶æ€ï¼Œè¿™æ ·ä¼šè®©scheduleræ¥æ‰§è¡Œé‡è·‘å‰é¢çš„è„šæœ¬é‡Œç”¨åˆ°äº†å˜é‡ï¼Œæ¯ä¸ªDAGåœ¨æ‰§è¡Œæ—¶éƒ½ä¼šä¼ å…¥ä¸€ä¸ªå…·ä½“çš„æ—¶é—´ï¼ˆdatetimeå¯¹è±¡ï¼‰ï¼Œ è¿™ä¸ªdså°±ä¼šåœ¨ render å‘½ä»¤æ—¶è¢«æ›¿æ¢æˆå¯¹åº”çš„æ—¶é—´ã€‚è¿™é‡Œè¦ç‰¹åˆ«å¼ºè°ƒä¸€ä¸‹ï¼Œ å¯¹äºå‘¨æœŸä»»åŠ¡ï¼Œairflowä¼ å…¥çš„æ—¶é—´æ˜¯ä¸Šä¸€ä¸ªå‘¨æœŸçš„æ—¶é—´ï¼ˆåˆ’é‡ç‚¹ï¼‰ï¼Œæ¯”å¦‚ä½ çš„ä»»åŠ¡æ˜¯æ¯å¤©æ‰§è¡Œï¼Œ é‚£ä¹ˆä»Šå¤©ä¼ å…¥çš„æ˜¯æ˜¨å¤©çš„æ—¥æœŸï¼Œå¦‚æœæ˜¯å‘¨ä»»åŠ¡ï¼Œé‚£ä¼ å…¥çš„æ˜¯ä¸Šä¸€å‘¨ä»Šå¤©çš„å€¼ ExecutorSequentialExecutorï¼šè¡¨ç¤ºå•è¿›ç¨‹é¡ºåºæ‰§è¡Œï¼Œé€šå¸¸åªç”¨äºæµ‹è¯•LocalExecutorï¼šè¡¨ç¤ºå¤šè¿›ç¨‹æœ¬åœ°æ‰§è¡Œï¼Œå®ƒç”¨pythonçš„å¤šè¿›ç¨‹åº“ä»è€Œè¾¾åˆ°å¤šè¿›ç¨‹è·‘ä»»åŠ¡çš„æ•ˆæœã€‚CeleryExecutorï¼šè¡¨ç¤ºä½¿ç”¨celeryä½œä¸ºæ‰§è¡Œå™¨ï¼Œåªè¦é…ç½®äº†celeryï¼Œå°±å¯ä»¥åˆ†å¸ƒå¼åœ°å¤šæœºè·‘ä»»åŠ¡ï¼Œä¸€èˆ¬ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚sql_alchemy_conn ï¼šè¿™ä¸ªé…ç½®è®©ä½ æŒ‡å®š airflow çš„å…ƒä¿¡æ¯ç”¨ä½•ç§æ–¹å¼å­˜å‚¨ï¼Œé»˜è®¤ç”¨sqliteï¼Œå¦‚æœè¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œæ¨èä½¿ç”¨ mysqlã€‚smtp ï¼šå¦‚æœä½ éœ€è¦é‚®ä»¶é€šçŸ¥æˆ–ç”¨åˆ° EmailOperator çš„è¯ï¼Œéœ€è¦é…ç½®å‘ä¿¡çš„ smtp æœåŠ¡å™¨ è§¦å‘æ¡ä»¶æ¡ä»¶ä¸€è§¦å‘æ¡ä»¶æœ‰ä¸¤ä¸ªç»´åº¦, ä»¥T1&amp;T2-&gt;T3 è¿™æ ·çš„dagä¸ºä¾‹:ä¸€ä¸ªç»´åº¦æ˜¯: è¦æ ¹æ®dagä¸Šæ¬¡è¿è¡ŒT3çš„çŠ¶æ€ç¡®å®šæœ¬æ¬¡T3æ˜¯å¦è¢«è°ƒç”¨, ç”±DAGçš„default_args.depends_on_pastå‚æ•°æ§åˆ¶, ä¸ºTrueæ—¶, åªæœ‰ä¸Šæ¬¡T3è¿è¡ŒæˆåŠŸ, è¿™æ¬¡T3æ‰ä¼šè¢«è§¦å‘æ¡ä»¶äºŒå¦ä¸€ä¸ªç»´åº¦æ˜¯: è¦æ ¹æ®å‰ç½®T1å’ŒT2çš„çŠ¶æ€ç¡®å®šæœ¬æ¬¡T3æ˜¯å¦è¢«è°ƒç”¨,ç”±T3.trigger_ruleå‚æ•°æ§åˆ¶, æœ‰ä¸‹é¢6ç§æƒ…å½¢, ç¼ºçœæ˜¯all_success.all_success: (default) all parents have succeededall_failed: all parents are in a failed or upstream_failed stateall_done: all parents are done with their executionone_failed: fires as soon as at least one parent has failed, it does not wait for all parents to be doneone_success: fires as soon as at least one parent succeeds, it does not wait for all parents to be donedummy: dependencies are just for show, trigger at will å·¥ç¨‹ä»£ç å®è·µç›¸å…³ ä¸šåŠ¡åˆ†æ”¯å¤„ç†airflowæœ‰ä¸¤ä¸ªåŸºäºPythonOperatorçš„Operatoræ¥æ”¯æŒdagåˆ†æ”¯åŠŸèƒ½.ShortCircuitOperator, ç”¨æ¥å®ç°æµç¨‹çš„åˆ¤æ–­. Taskéœ€è¦åŸºäºShortCircuitOperator, å¦‚æœæœ¬Taskè¿”å›ä¸ºFalseçš„è¯, å…¶ä¸‹æ¸¸Taskå°†è¢«skip; å¦‚æœä¸ºTrueçš„è¯, å…¶ä¸‹æ¸¸Taskå°†ä¼šè¢«æ­£å¸¸æ‰§è¡Œ. å°¤å…¶é€‚åˆç”¨åœ¨å…¶ä¸‹æ¸¸éƒ½æ˜¯å•çº¿èŠ‚ç‚¹çš„åœºæ™¯.BranchPythonOperator, ç”¨æ¥å®ç°Caseåˆ†æ”¯. Taskéœ€è¦åŸºäºBranchPythonOperator, airflowä¼šæ ¹æ®æœ¬taskçš„è¿”å›å€¼(è¿”å›å€¼æ˜¯æŸä¸ªä¸‹æ¸¸taskçš„id),æ¥ç¡®å®šå“ªä¸ªä¸‹æ¸¸Taskå°†è¢«æ‰§è¡Œ, å…¶ä»–ä¸‹æ¸¸Taskå°†è¢«skip. connection è¡¨æˆ‘ä»¬çš„Taskå¾€å¾€éœ€è¦é€šè¿‡jdbc/ftp/http/webhdfsæ–¹å¼è®¿é—®å…¶ä»–èµ„æº, ä¸€èˆ¬åœ°è®¿é—®èµ„æºæ—¶å€™éƒ½éœ€è¦ä¸€äº›ç­¾è¯, airflowå…è®¸æˆ‘ä»¬å°†è¿™äº›connectionä»¥åŠé‰´è¯å­˜æ”¾åœ¨connectionè¡¨ä¸­. å¯ä»¥ç°åœ¨WebUIçš„Admin-&gt;Connectionsç®¡ç†è¿™äº›è¿æ¥, åœ¨ä»£ç ä¸­ä½¿ç”¨è¿™äº›è¿æ¥.MySQL åº”è¯¥ä½¿ç”¨ mysqlclient åŒ…, æˆ‘ç®€å•è¯•äº†mysql-connector-python æœ‰æŠ¥é”™LocalExecutor å’Œ CeleryExecutor éƒ½å¯ç”¨äºç”Ÿäº§ç¯å¢ƒ, CeleryExecutor å°†ä½¿ç”¨ Celery ä½œä¸ºTaskæ‰§è¡Œçš„å¼•æ“, æ‰©å±•æ€§å¾ˆå¥½, å½“ç„¶é…ç½®ä¹Ÿæ›´å¤æ‚, éœ€è¦å…ˆsetup Celeryçš„backend(åŒ…æ‹¬RabbitMQ, Redis)ç­‰. å…¶å®çœŸæ­£è¦æ±‚æ‰©å±•æ€§çš„åœºæ™¯å¹¶ä¸å¤š, æ‰€ä»¥LocalExecutor æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„é€‰æ‹©äº†.é…ç½®OSç¯å¢ƒå˜é‡ AIRFLOW_HOME, AIRFLOW_HOMEç¼ºçœä¸º ~/airflowè¿è¡Œä¸‹é¢å‘½ä»¤åˆå§‹åŒ–ä¸€ä¸ªSqlite backend DB, å¹¶ç”Ÿæˆairflow.cfgæ–‡ä»¶your_python ${AIRFLOW_HOME}\\bin\\airflow initdbå¦‚æœéœ€è¦ä¿®æ”¹backend DBç±»å‹, ä¿®æ”¹$AIRFLOW_HOME/airflow.cfgæ–‡ä»¶ sql_alchemy_connå, ç„¶åé‡æ–°è¿è¡Œ airflow initdb .å®˜æ–¹æ¨èä½¿ç”¨MySQL/PostgreSQLåšDB Server.æœ‰ä¸‹é¢3ä¸ªå‚æ•°ç”¨äºæ§åˆ¶Taskçš„å¹¶å‘åº¦parallelism, ä¸€ä¸ªExecutoråŒæ—¶è¿è¡Œtaskå®ä¾‹çš„ä¸ªæ•°dag_concurrency, ä¸€ä¸ªdagä¸­æŸä¸ªtaskåŒæ—¶è¿è¡Œçš„å®ä¾‹ä¸ªæ•°max_active_runs_per_dag: ä¸€ä¸ªdagåŒæ—¶å¯åŠ¨çš„å®ä¾‹ä¸ªæ•°start_date æœ‰ç‚¹ç‰¹åˆ«ï¼Œå¦‚æœä½ è®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆairflowå°±ä¼šä»start_dateå¼€å§‹ä»¥ schedule_interval çš„è§„åˆ™å¼€å§‹æ‰§è¡Œï¼Œä¾‹å¦‚è®¾ç½®æˆ3å¤©å‰æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆåœ¨è°ƒåº¦æ­£å¸¸å¯åŠ¨æ—¶ï¼Œå°±ä¼šç«‹å³è°ƒåº¦ 24*3 æ¬¡ï¼Œä½†æ³¨æ„ï¼Œè„šæœ¬æ‰§è¡Œç¯å¢ƒçš„æ—¶é—´è¿˜æ˜¯å½“å‰çš„ç³»ç»Ÿæ—¶é—´ï¼Œè€Œä¸ä¼šè¯´çœŸæ˜¯æŠŠç³»ç»Ÿæ—¶é—´æ¨¡æ‹Ÿæˆ3å¤©å‰ï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™ä¸ªåŠŸèƒ½åº”ç”¨åœºæ™¯æ¯”è¾ƒå¥½é™ã€‚ DAGç›®å½•å®šä¹‰ä»¥åŠéƒ¨åˆ†airflow.cfg å­—æ®µé…ç½®dags_folderç›®å½•æ”¯æŒå­ç›®å½•å’Œè½¯è¿æ¥ï¼Œå› æ­¤ä¸åŒçš„dagå¯ä»¥åˆ†é—¨åˆ«ç±»çš„å­˜å‚¨èµ·æ¥schedule_interval=timedelta(minutes=1) æˆ–è€… crontabæ ¼å¼1crontabæ ¼å¼çš„ä»‹ç»2sql_alchemy_conn = mysql://ct:152108@localhost/airflowå¯¹åº”å­—æ®µè§£é‡Šå¦‚ä¸‹ï¼š dialect+driver://username:password@host:port/databaseå½“é‡åˆ°ä¸ç¬¦åˆå¸¸ç†çš„æƒ…å†µæ—¶è€ƒè™‘æ¸…ç©º airflow backendçš„æ•°æ®åº“, å¯ä½¿ç”¨ airflow resetdb æ¸…ç©ºã€‚åˆ é™¤dagæ–‡ä»¶åï¼Œwebserverä¸­å¯èƒ½è¿˜ä¼šå­˜åœ¨ç›¸åº”ä¿¡æ¯ï¼Œè¿™æ—¶éœ€è¦é‡å¯webserverå¹¶åˆ·æ–°ç½‘é¡µã€‚å…³é—­webserver:1ps -ef|grep -Ei &apos;(airflow-webserver)&apos;| grep master | awk &apos;&#123;print $2&#125;&apos;|xargs -i kill &#123;&#125;ç•Œé¢çš„æ—¶å€™çœ‹èµ·æ¥æ¯”è¾ƒè›‹ç–¼ï¼Œ utc-0çš„æ—¶é—´ï¼Œä¿®æ”¹â€¦/python2.7/site-packages/airflow/www/templates/admin/master.htmlå¦‚ä¸‹**(æ³¨é‡Šæ‰UCTSecondsï¼Œæ–°å¢ä¸€è¡ŒUTCSeconds)ï¼Œ è¿™æ ·æ—¶é—´å°±æ˜¯æœ¬åœ°æ—¶é—´äº†**ã€‚ éƒ¨ç½²ç›¸å…³ éªŒè¯ä»¥åŠå¼€å¯è°ƒåº¦éªŒè¯è„šæœ¬æ˜¯å¦æœ‰é—®é¢˜ï¼špython xxx.pyçœ‹æ˜¯å¦èƒ½æŸ¥è¯¢å‡ºæ–°å¢çš„dagså—:airflow list_dagså¯åŠ¨schedule ï¼šairflow scheduler æ³¨æ„ç‚¹è¿™é‡Œæœ‰çš„ start_date æœ‰ç‚¹ç‰¹åˆ«ï¼Œå¦‚æœä½ è®¾ç½®äº†è¿™ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆairflowå°±ä¼šä»start_dateå¼€å§‹ä»¥ schedule_interval çš„è§„åˆ™å¼€å§‹æ‰§è¡Œï¼Œä¾‹å¦‚è®¾ç½®æˆ3å¤©å‰æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆåœ¨è°ƒåº¦æ­£å¸¸å¯åŠ¨æ—¶ï¼Œå°±ä¼šç«‹å³è°ƒåº¦ 24*3 æ¬¡ï¼Œä½†æ³¨æ„ï¼Œè„šæœ¬æ‰§è¡Œç¯å¢ƒçš„æ—¶é—´è¿˜æ˜¯å½“å‰çš„ç³»ç»Ÿæ—¶é—´ï¼Œè€Œä¸ä¼šè¯´çœŸæ˜¯æŠŠç³»ç»Ÿæ—¶é—´æ¨¡æ‹Ÿæˆ3å¤©å‰ï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™ä¸ªåŠŸèƒ½åº”ç”¨åœºæ™¯æ¯”è¾ƒå¥½é™åœ¨centos6.8ä¸Šè£…ç‰¹åˆ«é¡ºåˆ©ï¼ˆè¿è¡Œæ—¶è²Œä¼¼ä¸€åˆ‡éƒ½æ­£å¸¸ï¼Œå°±æ˜¯ä»»åŠ¡ä¸€ç›´å¤„äºrunningçŠ¶æ€â€”debugäº†ä¸€ç•ªæºä»£ç ï¼Œ å‘ç°å†…å­˜è¦å¿…éœ€å¤Ÿå¤§ï¼Œå‘ç°å¿…éœ€ç”¨érootèº«ä»½è¿è¡Œairflow worker, åŠ¡å¿…ä¿è¯æ ¸æ•°å¤Ÿç”¨ï¼Œå¦åˆ™éœ€è¦è°ƒä½dag_concurrency, max_active_runs_per_dag,max_threads,parallelism, å¦åˆ™workerå‡ºç°è«åå…¶å¦™çš„é—®é¢˜)airflowè·‘ç€è·‘ç€å°±æŒ‚äº†ï¼Œä¸€çœ‹å†…å­˜è¿˜å¤Ÿç”¨ï¼ˆå¯èƒ½éœ€è¦ä¸è¦é’±çš„åŠ å†…å­˜ï¼‰ï¼Œå¦‚æœä½ åˆ°å¤„æ‰¾ä¸åˆ°æƒ³è¦çš„é”™è¯¯æ—¥å¿—ã€‚é‚£ä¹ˆçœ‹çœ‹AIRFLOW_HOMEä¸‹é¢æ˜¯ä¸æ˜¯è«åå…¶å¦™çš„å¤šäº†å‡ ä¸ª .err/.out çš„æ–‡ä»¶ï¼Œè¿›å»çœ‹çœ‹ä¼šæœ‰æ”¶è·ã€‚åœ¨éœ€è¦è¿è¡Œä½œä¸šçš„æœºå™¨ä¸Šçš„å®‰è£…airflow airflow[celery] celery[redis] æ¨¡å—å,å¯åŠ¨airflow workerå³å¯.è¿™æ ·ä½œä¸šå°±èƒ½è¿è¡Œåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Š. æ¨¡å—ä¾èµ–å®‰è£…å®‰è£…ä¸»æ¨¡å—[airflow@airflow ~]1$ pip install apache-airflowå®‰è£…æ•°æ®åº“æ¨¡å—ã€å¯†ç æ¨¡å—[airflow@airflow ~]1$ pip install &quot;apache-airflow[postgres,password]&quot;åŸæ–‡é“¾æ¥airflow FAQairflow ä¹‹DAGSè¯¦è§£","categories":[{"name":"ä»»åŠ¡è°ƒåº¦","slug":"ä»»åŠ¡è°ƒåº¦","permalink":"http://www.wortyby.com/categories/ä»»åŠ¡è°ƒåº¦/"}],"tags":[{"name":"Airflow","slug":"Airflow","permalink":"http://www.wortyby.com/tags/Airflow/"},{"name":"DAG","slug":"DAG","permalink":"http://www.wortyby.com/tags/DAG/"},{"name":"operators","slug":"operators","permalink":"http://www.wortyby.com/tags/operators/"},{"name":"Sensor","slug":"Sensor","permalink":"http://www.wortyby.com/tags/Sensor/"}]},{"title":"æœåŠ¡å™¨ Log æ¸…ç†ä»»åŠ¡æ„å»º","slug":"æœåŠ¡å™¨ Log æ¸…ç†ä»»åŠ¡æ„å»º","date":"2018-11-05T05:23:15.000Z","updated":"2018-11-05T05:23:15.000Z","comments":true,"path":"2018/11/05/æœåŠ¡å™¨ Log æ¸…ç†ä»»åŠ¡æ„å»º/","link":"","permalink":"http://www.wortyby.com/2018/11/05/æœåŠ¡å™¨ Log æ¸…ç†ä»»åŠ¡æ„å»º/","excerpt":"","text":"æœåŠ¡å™¨è¿è¡Œçš„å„ç§å„æ ·çš„ç¨‹åºï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šå°†å…¶æ—¥å¿—è®°å½•è¾“å‡ºåˆ°æ–‡ä»¶ä¸­è¿›è¡Œè®°å½•ä¿å­˜ã€‚æ—¢ç„¶æ˜¯ç¨‹åºè¿è¡Œï¼Œå°±ä¼šæœ‰æˆåŠŸä¸å¤±è´¥ï¼ŒæˆåŠŸçš„æ‰§è¡Œç¨‹åºï¼Œæˆ‘ä»¬ä¸åšè¿‡å¤šè®¨è®ºï¼Œæˆ‘ä»¬å°±å…ˆè°ˆè°ˆç¨‹åºæ‰§è¡Œå¤±è´¥çš„æ—¶å€™çš„æ—¥å¿—å¤„ç†ï¼Œä¸ºäº†é¿å…ç¨‹åºæ‰§è¡Œå¤±è´¥ï¼Œä¸šåŠ¡å¼€å‘ä¸çŸ¥é“ï¼Œä»¥åŠç¨‹åºæ—¥å¿—è¿‡å¤§çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆæ€ä¹ˆå¤„ç†è¿™ä¸ªcaseã€‚å…ˆä¸Šä»£ç ï¼Œåˆ†åˆ«ä»é…ç½®ç¯å¢ƒï¼Œæ‰§è¡Œå‘¨æœŸçš„è®¾å®šä»¥åŠå·¥ç¨‹ç»“æ„æ€è·¯ä¸Šé¢æ¥è¿›è¡Œåˆ†æã€‚ é…ç½®ç¯å¢ƒé€šè¿‡ .INI æ–‡ä»¶æ¥è¿›è¡Œ æ¸…ç†å‘¨æœŸçš„é…ç½®ï¼Œä»¥åŠPython ç‰ˆæœ¬æ¥æ‰§è¡Œè„šæœ¬çš„è®¾å®šã€‚ä»¥åŠlog å­˜æ”¾è®°å½•çš„è·¯å¾„ä¿å­˜ï¼Œä¸šåŠ¡å¼€å‘é‚®ç®±è®¾å®š12345678910111213141516171819202122232425262728293031rom airflow import DAGfrom airflow.operators import BashOperatorfrom datetime import datetime, timedeltaimport ConfigParserconfig = ConfigParser.ConfigParser()config.read(&apos;/etc/conf.ini&apos;)WORK_DIR = config.get(&apos;dir_conf&apos;, &apos;work_dir&apos;)OUTPUT_DIR = config.get(&apos;dir_conf&apos;, &apos;log_output&apos;)PYTHON_ENV = config.get(&apos;dir_conf&apos;, &apos;python_env&apos;)default_args = &#123; &apos;owner&apos;: &apos;airflow&apos;, &apos;depends_on_past&apos;: False, &apos;start_date&apos;: datetime.today() - timedelta(days=1), &apos;retries&apos;: 2, &apos;retry_delay&apos;: timedelta(minutes=15),&#125;dag = DAG(&apos;daily_process&apos;, default_args=default_args, schedule_interval=timedelta(days=1))templated_command = &quot;echo &apos;single&apos; | &#123;python_env&#125;/python &#123;work_dir&#125;/mr/LogMR.py&quot;\\ .format(python_env=PYTHON_ENV, work_dir=WORK_DIR) + &quot; --start_date &#123;&#123; ds &#125;&#125;&quot;task = BashOperator( task_id=&apos;process_log&apos;, bash_command=templated_command, dag=dag) ä»€ä¹ˆæ˜¯ ETL ETL å®šä¹‰ETL æ˜¯å¸¸ç”¨çš„æ•°æ®å¤„ç†ï¼Œåœ¨ä»¥å‰çš„å…¬å¸é‡Œï¼ŒETL å·®ä¸å¤šæ˜¯æ•°æ®å¤„ç†çš„åŸºç¡€ï¼Œè¦æ±‚éå¸¸ç¨³å®šï¼Œå®¹é”™ç‡é«˜ï¼Œè€Œä¸”èƒ½å¤Ÿå¾ˆå¥½çš„ç›‘æ§ã€‚ETLçš„å…¨ç§°æ˜¯ Extractï¼ŒTransformï¼ŒLoadï¼Œ ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å°†ä¹±ä¸ƒå…«ç³Ÿçš„æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œç„¶åæ”¾åˆ°å‚¨å­˜ç©ºé—´ä¸Šã€‚å¯ä»¥æ˜¯SQLçš„ä¹Ÿå¯ä»¥æ˜¯NoSQLçš„ï¼Œè¿˜å¯ä»¥ç›´æ¥å­˜æˆfileçš„æ¨¡å¼ã€‚ä¸€å¼€å§‹æˆ‘çš„è®¾è®¡æ€è·¯æ˜¯ï¼Œç”¨å‡ ä¸ªcron jobå’Œceleryæ¥handleæ‰€æœ‰çš„å¤„ç†ï¼Œç„¶åå°†æˆ‘ä»¬çš„logæ–‡ä»¶å­˜åœ¨hdfsï¼Œè¿˜æœ‰ä¸€äº›æ•°æ®å­˜åœ¨mysqlï¼Œå¤§æ¦‚æ¯å¤©è·‘ä¸€æ¬¡ã€‚æ ¸å¿ƒæ˜¯èƒ½å¤Ÿscaleï¼Œç¨³å®šï¼Œå®¹é”™ï¼Œroll backã€‚æˆ‘ä»¬çš„data warehouseå°±æ”¾åœ¨äº‘ä¸Šï¼Œå°±ç®€å•å¤„ç†äº†ã€‚æœ‰äº†è‡ªå·±çš„ETLç³»ç»Ÿæˆ‘è§‰å¾—å°±å¾ˆå®‰å¿ƒäº†ï¼Œä»¥åèƒ½å¤Ÿåšæ•°æ®å¤„ç†å’Œæœºå™¨å­¦ä¹ æ–¹é¢å°±ç›¸å¯¹æ–¹ä¾¿ä¸€äº›ã€‚ é—®é¢˜æ¥äº†ä¸€å¼€å§‹æˆ‘è®¾è®¡çš„æ€è·¯å’ŒUberä¸€å¼€å§‹çš„ETLå¾ˆåƒï¼Œå› ä¸ºæˆ‘è§‰å¾—å¾ˆæ–¹ä¾¿ã€‚ä½†æ˜¯æˆ‘å‘è§‰ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œæˆ‘ä¸€ä¸ªäººå¿™ä¸è¿‡æ¥ã€‚é¦–å…ˆï¼Œè¦è‡³å°‘å†™ä¸ªå‰ç«¯UIæ¥ç›‘æ§cron jobï¼Œä½†æ˜¯å¸‚é¢ä¸Šçš„éƒ½å¾ˆå·®ã€‚å…¶æ¬¡ï¼Œå®¹é”™çš„autorestartå†™èµ·æ¥å¾ˆè´¹åŠ²ï¼Œå¯èƒ½æ˜¯æˆ‘è‡ªå·±æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªå¥½çš„å¤„ç†æ–¹æ³•ã€‚æœ€åéƒ¨ç½²çš„æ—¶å€™ç›¸å½“éº»çƒ¦ï¼Œå¦‚æœè¦å†™å¥½è¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä¸€ä¸ªäººçš„è¯è¦è‡³å°‘ä¸€ä¸ªæœˆçš„æ—¶é—´ï¼Œå¯èƒ½è¿˜ä¸æ˜¯ç‰¹åˆ«robustã€‚åœ¨å°è¯•å†™äº†2ä¸¤å¤©çš„ä¸€äº›ç¢ç‰‡å¤„ç†çš„è„šæœ¬ä¹‹åæˆ‘å‘è§‰æ—¶é—´æ‹–äº†å®åœ¨å¤ªä¹…äº†ã€‚æœ€ç»ˆé€‰æ‹©ä½¿ç”¨ Airbnbçš„ airflow å·¥å…·è¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚ é€šçŸ¥æœºåˆ¶é€šè¿‡é‚®ä»¶å°†ç¨‹åºlog é‡Œçš„é”™è¯¯ä¿¡æ¯æˆªå–å‡ºæ¥ï¼Œå‘é€ç»™ä¸šåŠ¡å¼€å‘æ–¹ã€‚ éƒ¨ç½²æ–¹å¼ ä½¿ç”¨supervisord è¿›è¡Œdeamonç”±äº airflow æœ¬èº«æ²¡æœ‰deamon æ¨¡å¼ï¼Œæ‰€ä»¥ç›´æ¥ç”¨supervisord å°±OKäº†ï¼Œæˆ‘ä»¬åªå†™4è¡Œä»£ç ã€‚12345[program:airflow_web]command=/home/kimi/env/athena/bin/airflow webserver -p 8080[program:airflow_scheduler]command=/home/kimi/env/athena/bin/airflow scheduler","categories":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"http://www.wortyby.com/categories/æœåŠ¡å™¨/"}],"tags":[{"name":"Log å¤„ç†","slug":"Log-å¤„ç†","permalink":"http://www.wortyby.com/tags/Log-å¤„ç†/"},{"name":"tmpwatch","slug":"tmpwatch","permalink":"http://www.wortyby.com/tags/tmpwatch/"}]},{"title":"é˜¿é‡Œå’¨è¯¢","slug":"é˜¿é‡Œå’¨è¯¢","date":"2018-11-03T07:23:14.000Z","updated":"2018-11-03T07:23:14.000Z","comments":true,"path":"2018/11/03/é˜¿é‡Œå’¨è¯¢/","link":"","permalink":"http://www.wortyby.com/2018/11/03/é˜¿é‡Œå’¨è¯¢/","excerpt":"","text":"æƒ³é—®çš„é—®é¢˜å¤§ç±»å¦‚ä¸‹ ç¯å¢ƒå•æœºor å®¹å™¨åŒ–?å»ºè®®æˆ‘ä»¬è¿™ä½“é‡çš„å…¬å¸è¯¥é‡‡ç”¨ä»€ä¹ˆæ¨¡å¼éƒ¨ç½²æ›´ç»æµåˆç®—ï¼Œå°±å¯æ‹“å±•æ–¹ä¾¿è¿ç»´æ–¹é¢æ¥è¯´ã€‚ è¿ç»´èµ„æºåˆç†è¯„ä¼°å„ä¸ªç»„ä»¶çš„è¿ç»´æ‰‹å†Œåˆ†äº« å¼€å‘æŠ€æœ¯æ ˆ;ç®—æ³•åº“ä»¥åŠç®—æ³•é€‰ç”¨æ ‡å‡†;å…³è”æœç´¢æ€ä¹ˆé€šè¿‡æ•°æ®ç»“æ„å®ç°çš„ï¼Œæ˜¯é€šè¿‡å›¾èŠ‚ç‚¹ç½‘ç»œçš„é¡¶ç‚¹å‘é‡ç›¸ä¼¼?é˜¿é‡Œçš„æ¨èå¼•æ“å¤§æ¦‚çš„æ¶æ„è®¾è®¡åˆ†äº«ï¼Ÿå¤©çŒ«çš„é¦–é¡µæ¨èä¸ä¸ªäººå¸æˆ·æ¨èåˆ—è¡¨ï¼Œå‘ˆç°çš„ä¸åŒå†…å®¹å°±æ˜¯ç®€å•çš„ä»¥æ¨èè§„åˆ™ä¸åŒï¼Ÿæ•°æ®ä»“åº“ä¸ç”¨æˆ·ç”»åƒå¹³å°åœ¨æ¨èä¸æœç´¢å¹³å°çš„è§’è‰²å®šä½ä»¥åŠåŠŸèƒ½å®šä¹‰ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰è¿™ä¸ªä¸œè¥¿ï¼Œæ€ä¹ˆåˆç†çš„æ„å»ºè¿™ä¸ªä½“ç³»ï¼Œç»™ä¸ªå»ºè®®ï¼Ÿæœç´¢ä¸æ¨èçš„æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼Œå¯ä»¥ç®€å•åˆ†äº«ï¼Ÿ åˆ†æè¯„ä¼°æ€ä¹ˆè¯„åˆ¤ä¸€ä¸ªæ¨èæˆ–æœç´¢ç»“æœçš„å¥½åï¼Œå³æ¨èä¸æœç´¢çš„è¯„ä»·æ ‡å‡†ä½“ç³»;é€šè¿‡ä»€ä¹ˆæªæ–½æˆ–ä»€ä¹ˆæ–¹å¼è¿›è¡Œåˆ†ææ˜¯å¦è¾¾åˆ°è¿™ä¸ªè¯„ä»·æ ‡å‡†ã€‚ä»‹ç»ä»€ä¹ˆæ˜¯OLAPä»¥åŠç°æœ‰äº§å“Data VaultData Vault çŸ¥ä¹ä¸“æ ETLæ–°å…´è¶‹åŠ¿","categories":[{"name":"å’¨è¯¢å­¦ä¹ ","slug":"å’¨è¯¢å­¦ä¹ ","permalink":"http://www.wortyby.com/categories/å’¨è¯¢å­¦ä¹ /"}],"tags":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/tags/æ¨è/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://www.wortyby.com/tags/ç®—æ³•/"},{"name":"OLAP","slug":"OLAP","permalink":"http://www.wortyby.com/tags/OLAP/"}]},{"title":"HBaseæœ€ä½³å®è·µ","slug":"HBaseæœ€ä½³å®è·µï¼è¯»æ€§èƒ½ä¼˜åŒ–ç­–ç•¥","date":"2018-11-01T03:06:04.000Z","updated":"2018-11-01T03:06:04.000Z","comments":true,"path":"2018/11/01/HBaseæœ€ä½³å®è·µï¼è¯»æ€§èƒ½ä¼˜åŒ–ç­–ç•¥/","link":"","permalink":"http://www.wortyby.com/2018/11/01/HBaseæœ€ä½³å®è·µï¼è¯»æ€§èƒ½ä¼˜åŒ–ç­–ç•¥/","excerpt":"","text":"ä»»ä½•ç³»ç»Ÿéƒ½ä¼šæœ‰å„ç§å„æ ·çš„é—®é¢˜ï¼Œæœ‰äº›æ˜¯ç³»ç»Ÿæœ¬èº«è®¾è®¡é—®é¢˜ï¼Œæœ‰äº›å´æ˜¯ä½¿ç”¨å§¿åŠ¿é—®é¢˜ã€‚HBaseä¹Ÿä¸€æ ·ï¼Œåœ¨çœŸå®ç”Ÿäº§çº¿ä¸Šå¤§å®¶æˆ–å¤šæˆ–å°‘éƒ½ä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œæœ‰äº›æ˜¯HBaseè¿˜éœ€è¦å®Œå–„çš„ï¼Œæœ‰äº›æ˜¯æˆ‘ä»¬ç¡®å®å¯¹å®ƒäº†è§£å¤ªå°‘ã€‚æ€»ç»“èµ·æ¥ï¼Œå¤§å®¶é‡åˆ°çš„ä¸»è¦é—®é¢˜æ— éæ˜¯Full GCå¼‚å¸¸å¯¼è‡´å®•æœºé—®é¢˜ã€RITé—®é¢˜ã€å†™ååé‡å¤ªä½ä»¥åŠè¯»å»¶è¿Ÿè¾ƒå¤§ã€‚Full GCé—®é¢˜ä¹‹å‰åœ¨ä¸€äº›æ–‡ç« é‡Œé¢å·²ç»è®²è¿‡å®ƒçš„æ¥é¾™å»è„‰ï¼Œä¸»è¦çš„è§£å†³æ–¹æ¡ˆç›®å‰ä¸»è¦æœ‰ä¸¤æ–¹é¢éœ€è¦æ³¨æ„ï¼Œä¸€æ–¹é¢éœ€è¦æŸ¥çœ‹GCæ—¥å¿—ç¡®è®¤æ˜¯å“ªç§Full GCï¼Œæ ¹æ®Full GCç±»å‹å¯¹JVMå‚æ•°è¿›è¡Œè°ƒä¼˜ï¼Œå¦ä¸€æ–¹é¢éœ€è¦ç¡®è®¤æ˜¯å¦å¼€å¯äº†BucketCacheçš„offheapæ¨¡å¼ï¼Œå»ºè®®ä½¿ç”¨LRUBlockCacheçš„ç«¥é‹å°½å¿«è½¬ç§»åˆ°BucketCacheæ¥ã€‚å½“ç„¶æˆ‘ä»¬è¿˜æ˜¯å¾ˆæœŸå¾…å®˜æ–¹2.0.0ç‰ˆæœ¬å‘å¸ƒçš„æ›´å¤šoffheapæ¨¡å—ã€‚RITé—®é¢˜ï¼Œæˆ‘ç›¸ä¿¡æ›´å¤šæ˜¯å› ä¸ºæˆ‘ä»¬å¯¹å…¶ä¸äº†è§£ï¼Œå…·ä½“åŸç†å¯ä»¥æˆ³è¿™é‡Œï¼Œè§£å†³æ–¹æ¡ˆç›®å‰æœ‰ä¸¤ä¸ªï¼Œä¼˜å…ˆæ˜¯ä½¿ç”¨å®˜æ–¹æä¾›çš„HBCKè¿›è¡Œä¿®å¤ï¼ˆHBCKæœ¬äººä¸€ç›´æƒ³æ‹¿å‡ºæ¥åˆ†äº«ï¼Œä½†æ˜¯ç›®å‰æ¡ˆä¾‹è¿˜ä¸å¤šï¼Œç­‰åé¢æœ‰æ›´å¤šæ¡ˆä¾‹çš„è¯å†æ‹¿å‡ºæ¥è¯´ï¼‰ï¼Œä½¿ç”¨ä¹‹åè¿˜æ˜¯è§£å†³ä¸äº†çš„è¯å°±éœ€è¦æ‰‹åŠ¨ä¿®å¤æ–‡ä»¶æˆ–è€…å…ƒæ•°æ®è¡¨ã€‚è€Œå¯¹äºå†™ååé‡å¤ªä½ä»¥åŠè¯»å»¶è¿Ÿå¤ªå¤§çš„ä¼˜åŒ–é—®é¢˜ï¼Œç¬”è€…ä¹Ÿå’Œå¾ˆå¤šæœ‹å‹è¿›è¡Œè¿‡æ¢è®¨ï¼Œè¿™ç¯‡æ–‡ç« å°±ä»¥è¯»å»¶è¿Ÿä¼˜åŒ–ä¸ºæ ¸å¿ƒå†…å®¹å±•å¼€ï¼Œå…·ä½“åˆ†æHBaseè¿›è¡Œè¯»å»¶è¿Ÿä¼˜åŒ–çš„é‚£äº›å¥—è·¯ï¼Œä»¥åŠè¿™äº›å¥—è·¯ä¹‹åçš„å…·ä½“åŸç†ã€‚å¸Œæœ›å¤§å®¶åœ¨çœ‹å®Œä¹‹åèƒ½å¤Ÿç»“åˆè¿™äº›å¥—è·¯å‰–æè‡ªå·±çš„ç³»ç»Ÿã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¯»è¯·æ±‚å»¶è¿Ÿè¾ƒå¤§é€šå¸¸å­˜åœ¨ä¸‰ç§åœºæ™¯ï¼Œåˆ†åˆ«ä¸ºï¼šä»…æœ‰æŸä¸šåŠ¡å»¶è¿Ÿè¾ƒå¤§ï¼Œé›†ç¾¤å…¶ä»–ä¸šåŠ¡éƒ½æ­£å¸¸æ•´ä¸ªé›†ç¾¤æ‰€æœ‰ä¸šåŠ¡éƒ½åæ˜ å»¶è¿Ÿè¾ƒå¤§æŸä¸ªä¸šåŠ¡èµ·æ¥ä¹‹åé›†ç¾¤å…¶ä»–éƒ¨åˆ†ä¸šåŠ¡å»¶è¿Ÿè¾ƒå¤§è¿™ä¸‰ç§åœºæ™¯æ˜¯è¡¨è±¡ï¼Œé€šå¸¸æŸä¸šåŠ¡ååº”å»¶è¿Ÿå¼‚å¸¸ï¼Œé¦–å…ˆéœ€è¦æ˜ç¡®å…·ä½“æ˜¯å“ªç§åœºæ™¯ï¼Œç„¶åé’ˆå¯¹æ€§è§£å†³é—®é¢˜ã€‚ä¸‹å›¾æ˜¯å¯¹è¯»ä¼˜åŒ–æ€è·¯çš„ä¸€ç‚¹æ€»ç»“ï¼Œä¸»è¦åˆ†ä¸ºå››ä¸ªæ–¹é¢ï¼šå®¢æˆ·ç«¯ä¼˜åŒ–ã€æœåŠ¡å™¨ç«¯ä¼˜åŒ–ã€åˆ—æ—è®¾è®¡ä¼˜åŒ–ä»¥åŠHDFSç›¸å…³ä¼˜åŒ–ï¼Œä¸‹é¢æ¯ä¸€ä¸ªå°ç‚¹éƒ½ä¼šæŒ‰ç…§åœºæ™¯åˆ†ç±»ï¼Œæ–‡ç« æœ€åè¿›è¡Œå½’çº³æ€»ç»“ã€‚ä¸‹é¢åˆ†åˆ«è¿›è¡Œè¯¦ç»†è®²è§£ï¼šHBaseå®¢æˆ·ç«¯ä¼˜åŒ–å’Œå¤§å¤šæ•°ç³»ç»Ÿä¸€æ ·ï¼Œå®¢æˆ·ç«¯ä½œä¸ºä¸šåŠ¡è¯»å†™çš„å…¥å£ï¼Œå§¿åŠ¿ä½¿ç”¨ä¸æ­£ç¡®é€šå¸¸ä¼šå¯¼è‡´æœ¬ä¸šåŠ¡è¯»å»¶è¿Ÿè¾ƒé«˜å®é™…ä¸Šå­˜åœ¨ä¸€äº›ä½¿ç”¨å§¿åŠ¿çš„æ¨èç”¨æ³•ï¼Œè¿™é‡Œä¸€èˆ¬éœ€è¦å…³æ³¨å››ä¸ªé—®é¢˜ï¼šscanç¼“å­˜æ˜¯å¦è®¾ç½®åˆç†ï¼Ÿä¼˜åŒ–åŸç†ï¼šåœ¨è§£é‡Šè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦è§£é‡Šä»€ä¹ˆæ˜¯scanç¼“å­˜ï¼Œé€šå¸¸æ¥è®²ä¸€æ¬¡scanä¼šè¿”å›å¤§é‡æ•°æ®ï¼Œå› æ­¤å®¢æˆ·ç«¯å‘èµ·ä¸€æ¬¡scanè¯·æ±‚ï¼Œå®é™…å¹¶ä¸ä¼šä¸€æ¬¡å°±å°†æ‰€æœ‰æ•°æ®åŠ è½½åˆ°æœ¬åœ°ï¼Œè€Œæ˜¯åˆ†æˆå¤šæ¬¡RPCè¯·æ±‚è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·è®¾è®¡ä¸€æ–¹é¢æ˜¯å› ä¸ºå¤§é‡æ•°æ®è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œå¸¦å®½ä¸¥é‡æ¶ˆè€—è¿›è€Œå½±å“å…¶ä»–ä¸šåŠ¡ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿæœ‰å¯èƒ½å› ä¸ºæ•°æ®é‡å¤ªå¤§å¯¼è‡´æœ¬åœ°å®¢æˆ·ç«¯å‘ç”ŸOOMã€‚åœ¨è¿™æ ·çš„è®¾è®¡ä½“ç³»ä¸‹ç”¨æˆ·ä¼šé¦–å…ˆåŠ è½½ä¸€éƒ¨åˆ†æ•°æ®åˆ°æœ¬åœ°ï¼Œç„¶åéå†å¤„ç†ï¼Œå†åŠ è½½ä¸‹ä¸€éƒ¨åˆ†æ•°æ®åˆ°æœ¬åœ°å¤„ç†ï¼Œå¦‚æ­¤å¾€å¤ï¼Œç›´è‡³æ‰€æœ‰æ•°æ®éƒ½åŠ è½½å®Œæˆã€‚æ•°æ®åŠ è½½åˆ°æœ¬åœ°å°±å­˜æ”¾åœ¨scanç¼“å­˜ä¸­ï¼Œé»˜è®¤100æ¡æ•°æ®å¤§å°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé»˜è®¤çš„scanç¼“å­˜è®¾ç½®å°±å¯ä»¥æ­£å¸¸å·¥ä½œçš„ã€‚ä½†æ˜¯åœ¨ä¸€äº›å¤§scanï¼ˆä¸€æ¬¡scanå¯èƒ½éœ€è¦æŸ¥è¯¢å‡ ä¸‡ç”šè‡³å‡ åä¸‡è¡Œæ•°æ®ï¼‰æ¥è¯´ï¼Œæ¯æ¬¡è¯·æ±‚100æ¡æ•°æ®æ„å‘³ç€ä¸€æ¬¡scanéœ€è¦å‡ ç™¾ç”šè‡³å‡ åƒæ¬¡RPCè¯·æ±‚ï¼Œè¿™ç§äº¤äº’çš„ä»£ä»·æ— ç–‘æ˜¯å¾ˆå¤§çš„ã€‚å› æ­¤å¯ä»¥è€ƒè™‘å°†scanç¼“å­˜è®¾ç½®å¢å¤§ï¼Œæ¯”å¦‚è®¾ä¸º500æˆ–è€…1000å°±å¯èƒ½æ›´åŠ åˆé€‚ã€‚ç¬”è€…ä¹‹å‰åšè¿‡ä¸€æ¬¡è¯•éªŒï¼Œåœ¨ä¸€æ¬¡scanæ‰«æ10w+æ¡æ•°æ®é‡çš„æ¡ä»¶ä¸‹ï¼Œå°†scanç¼“å­˜ä»100å¢åŠ åˆ°1000ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½scanè¯·æ±‚çš„æ€»ä½“å»¶è¿Ÿï¼Œå»¶è¿ŸåŸºæœ¬é™ä½äº†25%å·¦å³ã€‚ä¼˜åŒ–å»ºè®®ï¼šå¤§scanåœºæ™¯ä¸‹å°†scanç¼“å­˜ä»100å¢å¤§åˆ°500æˆ–è€…1000ï¼Œç”¨ä»¥å‡å°‘RPCæ¬¡æ•°getè¯·æ±‚æ˜¯å¦å¯ä»¥ä½¿ç”¨æ‰¹é‡è¯·æ±‚ï¼Ÿä¼˜åŒ–åŸç†ï¼šHBaseåˆ†åˆ«æä¾›äº†å•æ¡getä»¥åŠæ‰¹é‡getçš„APIæ¥å£ï¼Œä½¿ç”¨æ‰¹é‡getæ¥å£å¯ä»¥å‡å°‘å®¢æˆ·ç«¯åˆ°RegionServerä¹‹é—´çš„RPCè¿æ¥æ•°ï¼Œæé«˜è¯»å–æ€§èƒ½ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰¹é‡getè¯·æ±‚è¦ä¹ˆæˆåŠŸè¿”å›æ‰€æœ‰è¯·æ±‚æ•°æ®ï¼Œè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ã€‚ä¼˜åŒ–å»ºè®®ï¼šä½¿ç”¨æ‰¹é‡getè¿›è¡Œè¯»å–è¯·æ±‚è¯·æ±‚æ˜¯å¦å¯ä»¥æ˜¾ç¤ºæŒ‡å®šåˆ—æ—æˆ–è€…åˆ—ï¼Ÿä¼˜åŒ–åŸç†ï¼šHBaseæ˜¯å…¸å‹çš„åˆ—æ—æ•°æ®åº“ï¼Œæ„å‘³ç€åŒä¸€åˆ—æ—çš„æ•°æ®å­˜å‚¨åœ¨ä¸€èµ·ï¼Œä¸åŒåˆ—æ—çš„æ•°æ®åˆ†å¼€å­˜å‚¨åœ¨ä¸åŒçš„ç›®å½•ä¸‹ã€‚å¦‚æœä¸€ä¸ªè¡¨æœ‰å¤šä¸ªåˆ—æ—ï¼Œåªæ˜¯æ ¹æ®Rowkeyè€Œä¸æŒ‡å®šåˆ—æ—è¿›è¡Œæ£€ç´¢çš„è¯ä¸åŒåˆ—æ—çš„æ•°æ®éœ€è¦ç‹¬ç«‹è¿›è¡Œæ£€ç´¢ï¼Œæ€§èƒ½å¿…ç„¶ä¼šæ¯”æŒ‡å®šåˆ—æ—çš„æŸ¥è¯¢å·®å¾ˆå¤šï¼Œå¾ˆå¤šæƒ…å†µä¸‹ç”šè‡³ä¼šæœ‰2å€ï½3å€çš„æ€§èƒ½æŸå¤±ã€‚ä¼˜åŒ–å»ºè®®ï¼šå¯ä»¥æŒ‡å®šåˆ—æ—æˆ–è€…åˆ—è¿›è¡Œç²¾ç¡®æŸ¥æ‰¾çš„å°½é‡æŒ‡å®šæŸ¥æ‰¾ç¦»çº¿æ‰¹é‡è¯»å–è¯·æ±‚æ˜¯å¦è®¾ç½®ç¦æ­¢ç¼“å­˜ï¼Ÿä¼˜åŒ–åŸç†ï¼šé€šå¸¸ç¦»çº¿æ‰¹é‡è¯»å–æ•°æ®ä¼šè¿›è¡Œä¸€æ¬¡æ€§å…¨è¡¨æ‰«æï¼Œä¸€æ–¹é¢æ•°æ®é‡å¾ˆå¤§ï¼Œå¦ä¸€æ–¹é¢è¯·æ±‚åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚è¿™ç§åœºæ™¯ä¸‹å¦‚æœä½¿ç”¨scané»˜è®¤è®¾ç½®ï¼Œå°±ä¼šå°†æ•°æ®ä»HDFSåŠ è½½å‡ºæ¥ä¹‹åæ”¾åˆ°ç¼“å­˜ã€‚å¯æƒ³è€ŒçŸ¥ï¼Œå¤§é‡æ•°æ®è¿›å…¥ç¼“å­˜å¿…å°†å…¶ä»–å®æ—¶ä¸šåŠ¡çƒ­ç‚¹æ•°æ®æŒ¤å‡ºï¼Œå…¶ä»–ä¸šåŠ¡ä¸å¾—ä¸ä»HDFSåŠ è½½ï¼Œè¿›è€Œä¼šé€ æˆæ˜æ˜¾çš„è¯»å»¶è¿Ÿæ¯›åˆºä¼˜åŒ–å»ºè®®ï¼šç¦»çº¿æ‰¹é‡è¯»å–è¯·æ±‚è®¾ç½®ç¦ç”¨ç¼“å­˜ï¼Œscan.setBlockCache(false)HBaseæœåŠ¡å™¨ç«¯ä¼˜åŒ–ä¸€èˆ¬æœåŠ¡ç«¯ç«¯é—®é¢˜ä¸€æ—¦å¯¼è‡´ä¸šåŠ¡è¯»è¯·æ±‚å»¶è¿Ÿè¾ƒå¤§çš„è¯ï¼Œé€šå¸¸æ˜¯é›†ç¾¤çº§åˆ«çš„ï¼Œå³æ•´ä¸ªé›†ç¾¤çš„ä¸šåŠ¡éƒ½ä¼šåæ˜ è¯»å»¶è¿Ÿè¾ƒå¤§ã€‚å¯ä»¥ä»4ä¸ªæ–¹é¢å…¥æ‰‹ï¼šè¯»è¯·æ±‚æ˜¯å¦å‡è¡¡ï¼Ÿä¼˜åŒ–åŸç†ï¼šæç«¯æƒ…å†µä¸‹å‡å¦‚æ‰€æœ‰çš„è¯»è¯·æ±‚éƒ½è½åœ¨ä¸€å°RegionServerçš„æŸå‡ ä¸ªRegionä¸Šï¼Œè¿™ä¸€æ–¹é¢ä¸èƒ½å‘æŒ¥æ•´ä¸ªé›†ç¾¤çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œå¦ä¸€æ–¹é¢åŠ¿å¿…é€ æˆæ­¤å°RegionServerèµ„æºä¸¥é‡æ¶ˆè€—ï¼ˆæ¯”å¦‚IOè€—å°½ã€handlerè€—å°½ç­‰ï¼‰ï¼Œè½åœ¨è¯¥å°RegionServerä¸Šçš„å…¶ä»–ä¸šåŠ¡ä¼šå› æ­¤å—åˆ°å¾ˆå¤§çš„æ³¢åŠã€‚å¯è§ï¼Œè¯»è¯·æ±‚ä¸å‡è¡¡ä¸ä»…ä¼šé€ æˆæœ¬èº«ä¸šåŠ¡æ€§èƒ½å¾ˆå·®ï¼Œè¿˜ä¼šä¸¥é‡å½±å“å…¶ä»–ä¸šåŠ¡ã€‚å½“ç„¶ï¼Œå†™è¯·æ±‚ä¸å‡è¡¡ä¹Ÿä¼šé€ æˆç±»ä¼¼çš„é—®é¢˜ï¼Œå¯è§è´Ÿè½½ä¸å‡è¡¡æ˜¯HBaseçš„å¤§å¿Œã€‚è§‚å¯Ÿç¡®è®¤ï¼šè§‚å¯Ÿæ‰€æœ‰RegionServerçš„è¯»è¯·æ±‚QPSæ›²çº¿ï¼Œç¡®è®¤æ˜¯å¦å­˜åœ¨è¯»è¯·æ±‚ä¸å‡è¡¡ç°è±¡ä¼˜åŒ–å»ºè®®ï¼šRowKeyå¿…é¡»è¿›è¡Œæ•£åˆ—åŒ–å¤„ç†ï¼ˆæ¯”å¦‚MD5æ•£åˆ—ï¼‰ï¼ŒåŒæ—¶å»ºè¡¨å¿…é¡»è¿›è¡Œé¢„åˆ†åŒºå¤„ç†BlockCacheæ˜¯å¦è®¾ç½®åˆç†ï¼Ÿä¼˜åŒ–åŸç†ï¼šBlockCacheä½œä¸ºè¯»ç¼“å­˜ï¼Œå¯¹äºè¯»æ€§èƒ½æ¥è¯´è‡³å…³é‡è¦ã€‚é»˜è®¤æƒ…å†µä¸‹BlockCacheå’ŒMemstoreçš„é…ç½®ç›¸å¯¹æ¯”è¾ƒå‡è¡¡ï¼ˆå„å 40%ï¼‰ï¼Œå¯ä»¥æ ¹æ®é›†ç¾¤ä¸šåŠ¡è¿›è¡Œä¿®æ­£ï¼Œæ¯”å¦‚è¯»å¤šå†™å°‘ä¸šåŠ¡å¯ä»¥å°†BlockCacheå æ¯”è°ƒå¤§ã€‚å¦ä¸€æ–¹é¢ï¼ŒBlockCacheçš„ç­–ç•¥é€‰æ‹©ä¹Ÿå¾ˆé‡è¦ï¼Œä¸åŒç­–ç•¥å¯¹è¯»æ€§èƒ½æ¥è¯´å½±å“å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œä½†æ˜¯å¯¹GCçš„å½±å“å´ç›¸å½“æ˜¾è‘—ï¼Œå°¤å…¶BucketCacheçš„offheapæ¨¡å¼ä¸‹GCè¡¨ç°å¾ˆä¼˜è¶Šã€‚å¦å¤–ï¼ŒHBase 2.0å¯¹offheapçš„æ”¹é€ ï¼ˆHBASE-11425ï¼‰å°†ä¼šä½¿HBaseçš„è¯»æ€§èƒ½å¾—åˆ°2ï½4å€çš„æå‡ï¼ŒåŒæ—¶GCè¡¨ç°ä¼šæ›´å¥½ï¼è§‚å¯Ÿç¡®è®¤ï¼šè§‚å¯Ÿæ‰€æœ‰RegionServerçš„ç¼“å­˜æœªå‘½ä¸­ç‡ã€é…ç½®æ–‡ä»¶ç›¸å…³é…ç½®é¡¹ä¸€çº§GCæ—¥å¿—ï¼Œç¡®è®¤BlockCacheæ˜¯å¦å¯ä»¥ä¼˜åŒ–ä¼˜åŒ–å»ºè®®ï¼šJVMå†…å­˜é…ç½®é‡ &lt; 20Gï¼ŒBlockCacheç­–ç•¥é€‰æ‹©LRUBlockCacheï¼›å¦åˆ™é€‰æ‹©BucketCacheç­–ç•¥çš„offheapæ¨¡å¼ï¼›æœŸå¾…HBase 2.0çš„åˆ°æ¥ï¼HFileæ–‡ä»¶æ˜¯å¦å¤ªå¤šï¼Ÿä¼˜åŒ–åŸç†ï¼šHBaseè¯»å–æ•°æ®é€šå¸¸é¦–å…ˆä¼šåˆ°Memstoreå’ŒBlockCacheä¸­æ£€ç´¢ï¼ˆè¯»å–æœ€è¿‘å†™å…¥æ•°æ®&amp;çƒ­ç‚¹æ•°æ®ï¼‰ï¼Œå¦‚æœæŸ¥æ‰¾ä¸åˆ°å°±ä¼šåˆ°æ–‡ä»¶ä¸­æ£€ç´¢ã€‚HBaseçš„ç±»LSMç»“æ„ä¼šå¯¼è‡´æ¯ä¸ªstoreåŒ…å«å¤šæ•°HFileæ–‡ä»¶ï¼Œæ–‡ä»¶è¶Šå¤šï¼Œæ£€ç´¢æ‰€éœ€çš„IOæ¬¡æ•°å¿…ç„¶è¶Šå¤šï¼Œè¯»å–å»¶è¿Ÿä¹Ÿå°±è¶Šé«˜ã€‚æ–‡ä»¶æ•°é‡é€šå¸¸å–å†³äºCompactionçš„æ‰§è¡Œç­–ç•¥ï¼Œä¸€èˆ¬å’Œä¸¤ä¸ªé…ç½®å‚æ•°æœ‰å…³ï¼šhbase.hstore.compactionThresholdå’Œhbase.hstore.compaction.max.sizeï¼Œå‰è€…è¡¨ç¤ºä¸€ä¸ªstoreä¸­çš„æ–‡ä»¶æ•°è¶…è¿‡å¤šå°‘å°±åº”è¯¥è¿›è¡Œåˆå¹¶ï¼Œåè€…è¡¨ç¤ºå‚æ•°åˆå¹¶çš„æ–‡ä»¶å¤§å°æœ€å¤§æ˜¯å¤šå°‘ï¼Œè¶…è¿‡æ­¤å¤§å°çš„æ–‡ä»¶ä¸èƒ½å‚ä¸åˆå¹¶ã€‚è¿™ä¸¤ä¸ªå‚æ•°ä¸èƒ½è®¾ç½®å¤ªâ€™æ¾â€™ï¼ˆå‰è€…ä¸èƒ½è®¾ç½®å¤ªå¤§ï¼Œåè€…ä¸èƒ½è®¾ç½®å¤ªå°ï¼‰ï¼Œå¯¼è‡´Compactionåˆå¹¶æ–‡ä»¶çš„å®é™…æ•ˆæœä¸æ˜æ˜¾ï¼Œè¿›è€Œå¾ˆå¤šæ–‡ä»¶å¾—ä¸åˆ°åˆå¹¶ã€‚è¿™æ ·å°±ä¼šå¯¼è‡´HFileæ–‡ä»¶æ•°å˜å¤šã€‚è§‚å¯Ÿç¡®è®¤ï¼šè§‚å¯ŸRegionServerçº§åˆ«ä»¥åŠRegionçº§åˆ«çš„storefileæ•°ï¼Œç¡®è®¤HFileæ–‡ä»¶æ˜¯å¦è¿‡å¤šä¼˜åŒ–å»ºè®®ï¼šhbase.hstore.compactionThresholdè®¾ç½®ä¸èƒ½å¤ªå¤§ï¼Œé»˜è®¤æ˜¯3ä¸ªï¼›è®¾ç½®éœ€è¦æ ¹æ®Regionå¤§å°ç¡®å®šï¼Œé€šå¸¸å¯ä»¥ç®€å•çš„è®¤ä¸ºhbase.hstore.compaction.max.size = RegionSize / hbase.hstore.compactionThresholdCompactionæ˜¯å¦æ¶ˆè€—ç³»ç»Ÿèµ„æºè¿‡å¤šï¼Ÿä¼˜åŒ–åŸç†ï¼šCompactionæ˜¯å°†å°æ–‡ä»¶åˆå¹¶ä¸ºå¤§æ–‡ä»¶ï¼Œæé«˜åç»­ä¸šåŠ¡éšæœºè¯»æ€§èƒ½ï¼Œä½†æ˜¯ä¹Ÿä¼šå¸¦æ¥IOæ”¾å¤§ä»¥åŠå¸¦å®½æ¶ˆè€—é—®é¢˜ï¼ˆæ•°æ®è¿œç¨‹è¯»å–ä»¥åŠä¸‰å‰¯æœ¬å†™å…¥éƒ½ä¼šæ¶ˆè€—ç³»ç»Ÿå¸¦å®½ï¼‰ã€‚æ­£å¸¸é…ç½®æƒ…å†µä¸‹Minor Compactionå¹¶ä¸ä¼šå¸¦æ¥å¾ˆå¤§çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—ï¼Œé™¤éå› ä¸ºé…ç½®ä¸åˆç†å¯¼è‡´Minor Compactionå¤ªè¿‡é¢‘ç¹ï¼Œæˆ–è€…Regionè®¾ç½®å¤ªå¤§æƒ…å†µä¸‹å‘ç”ŸMajor Compactionã€‚è§‚å¯Ÿç¡®è®¤ï¼šè§‚å¯Ÿç³»ç»ŸIOèµ„æºä»¥åŠå¸¦å®½èµ„æºä½¿ç”¨æƒ…å†µï¼Œå†è§‚å¯ŸCompactioné˜Ÿåˆ—é•¿åº¦ï¼Œç¡®è®¤æ˜¯å¦ç”±äºCompactionå¯¼è‡´ç³»ç»Ÿèµ„æºæ¶ˆè€—è¿‡å¤šä¼˜åŒ–å»ºè®®ï¼šï¼ˆ1ï¼‰Minor Compactionè®¾ç½®ï¼šhbase.hstore.compactionThresholdè®¾ç½®ä¸èƒ½å¤ªå°ï¼Œåˆä¸èƒ½è®¾ç½®å¤ªå¤§ï¼Œå› æ­¤å»ºè®®è®¾ç½®ä¸º5ï½6ï¼›hbase.hstore.compaction.max.size = RegionSize / hbase.hstore.compactionThresholdï¼ˆ2ï¼‰Major Compactionè®¾ç½®ï¼šå¤§Regionè¯»å»¶è¿Ÿæ•æ„Ÿä¸šåŠ¡ï¼ˆ 100Gä»¥ä¸Šï¼‰é€šå¸¸ä¸å»ºè®®å¼€å¯è‡ªåŠ¨Major Compactionï¼Œæ‰‹åŠ¨ä½å³°æœŸè§¦å‘ã€‚å°Regionæˆ–è€…å»¶è¿Ÿä¸æ•æ„Ÿä¸šåŠ¡å¯ä»¥å¼€å¯Major Compactionï¼Œä½†å»ºè®®é™åˆ¶æµé‡ï¼›ï¼ˆ3ï¼‰æœŸå¾…æ›´å¤šçš„ä¼˜ç§€Compactionç­–ç•¥ï¼Œç±»ä¼¼äºstripe-compactionå°½æ—©æä¾›ç¨³å®šæœåŠ¡HBaseåˆ—æ—è®¾è®¡ä¼˜åŒ–HBaseåˆ—æ—è®¾è®¡å¯¹è¯»æ€§èƒ½å½±å“ä¹Ÿè‡³å…³é‡è¦ï¼Œå…¶ç‰¹ç‚¹æ˜¯åªå½±å“å•ä¸ªä¸šåŠ¡ï¼Œå¹¶ä¸ä¼šå¯¹æ•´ä¸ªé›†ç¾¤äº§ç”Ÿå¤ªå¤§å½±å“ã€‚åˆ—æ—è®¾è®¡ä¸»è¦ä»ä¸¤ä¸ªæ–¹é¢æ£€æŸ¥ï¼šBloomfilteræ˜¯å¦è®¾ç½®ï¼Ÿæ˜¯å¦è®¾ç½®åˆç†ï¼Ÿä¼˜åŒ–åŸç†ï¼šBloomfilterä¸»è¦ç”¨æ¥è¿‡æ»¤ä¸å­˜åœ¨å¾…æ£€ç´¢RowKeyæˆ–è€…Row-Colçš„HFileæ–‡ä»¶ï¼Œé¿å…æ— ç”¨çš„IOæ“ä½œã€‚å®ƒä¼šå‘Šè¯‰ä½ åœ¨è¿™ä¸ªHFileæ–‡ä»¶ä¸­æ˜¯å¦å¯èƒ½å­˜åœ¨å¾…æ£€ç´¢çš„KVï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±å¯ä»¥ä¸ç”¨æ¶ˆè€—IOæ‰“å¼€æ–‡ä»¶è¿›è¡Œseekã€‚å¾ˆæ˜¾ç„¶ï¼Œé€šè¿‡è®¾ç½®Bloomfilterå¯ä»¥æå‡éšæœºè¯»å†™çš„æ€§èƒ½ã€‚Bloomfilterå–å€¼æœ‰ä¸¤ä¸ªï¼Œrowä»¥åŠrowcolï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡æ¥ç¡®å®šå…·ä½“ä½¿ç”¨å“ªç§ã€‚å¦‚æœä¸šåŠ¡å¤§å¤šæ•°éšæœºæŸ¥è¯¢ä»…ä»…ä½¿ç”¨rowä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼ŒBloomfilterä¸€å®šè¦è®¾ç½®ä¸ºrowï¼Œå¦åˆ™å¦‚æœå¤§å¤šæ•°éšæœºæŸ¥è¯¢ä½¿ç”¨row+cfä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼ŒBloomfilteréœ€è¦è®¾ç½®ä¸ºrowcolã€‚å¦‚æœä¸ç¡®å®šä¸šåŠ¡æŸ¥è¯¢ç±»å‹ï¼Œè®¾ç½®ä¸ºrowã€‚ä¼˜åŒ–å»ºè®®ï¼šä»»ä½•ä¸šåŠ¡éƒ½åº”è¯¥è®¾ç½®Bloomfilterï¼Œé€šå¸¸è®¾ç½®ä¸ºrowå°±å¯ä»¥ï¼Œé™¤éç¡®è®¤ä¸šåŠ¡éšæœºæŸ¥è¯¢ç±»å‹ä¸ºrow+cfï¼Œå¯ä»¥è®¾ç½®ä¸ºrowcolHDFSç›¸å…³ä¼˜åŒ–HDFSä½œä¸ºHBaseæœ€ç»ˆæ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œé€šå¸¸ä¼šä½¿ç”¨ä¸‰å‰¯æœ¬ç­–ç•¥å­˜å‚¨HBaseæ•°æ®æ–‡ä»¶ä»¥åŠæ—¥å¿—æ–‡ä»¶ã€‚ä»HDFSçš„è§’åº¦æœ›ä¸Šå±‚çœ‹ï¼ŒHBaseå³æ˜¯å®ƒçš„å®¢æˆ·ç«¯ï¼ŒHBaseé€šè¿‡è°ƒç”¨å®ƒçš„å®¢æˆ·ç«¯è¿›è¡Œæ•°æ®è¯»å†™æ“ä½œï¼Œå› æ­¤HDFSçš„ç›¸å…³ä¼˜åŒ–ä¹Ÿä¼šå½±å“HBaseçš„è¯»å†™æ€§èƒ½ã€‚è¿™é‡Œä¸»è¦å…³æ³¨å¦‚ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼šShort-Circuit Local ReadåŠŸèƒ½æ˜¯å¦å¼€å¯ï¼Ÿä¼˜åŒ–åŸç†ï¼šå½“å‰HDFSè¯»å–æ•°æ®éƒ½éœ€è¦ç»è¿‡DataNodeï¼Œå®¢æˆ·ç«¯ä¼šå‘DataNodeå‘é€è¯»å–æ•°æ®çš„è¯·æ±‚ï¼ŒDataNodeæ¥å—åˆ°è¯·æ±‚ä¹‹åä»ç¡¬ç›˜ä¸­å°†æ–‡ä»¶è¯»å‡ºæ¥ï¼Œå†é€šè¿‡TPCå‘é€ç»™å®¢æˆ·ç«¯ã€‚Short Circuitç­–ç•¥å…è®¸å®¢æˆ·ç«¯ç»•è¿‡DataNodeç›´æ¥è¯»å–æœ¬åœ°æ•°æ®ã€‚ï¼ˆå…·ä½“åŸç†å‚è€ƒæ­¤å¤„ï¼‰ä¼˜åŒ–å»ºè®®ï¼šå¼€å¯Short Circuit Local ReadåŠŸèƒ½ï¼Œå…·ä½“é…ç½®æˆ³è¿™é‡ŒHedged ReadåŠŸèƒ½æ˜¯å¦å¼€å¯ï¼Ÿä¼˜åŒ–åŸç†ï¼šHBaseæ•°æ®åœ¨HDFSä¸­ä¸€èˆ¬éƒ½ä¼šå­˜å‚¨ä¸‰ä»½ï¼Œè€Œä¸”ä¼˜å…ˆä¼šé€šè¿‡Short-Circuit Local ReadåŠŸèƒ½å°è¯•æœ¬åœ°è¯»ã€‚ä½†æ˜¯åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°å› ä¸ºç£ç›˜é—®é¢˜æˆ–è€…ç½‘ç»œé—®é¢˜å¼•èµ·çš„çŸ­æ—¶é—´æœ¬åœ°è¯»å–å¤±è´¥ï¼Œä¸ºäº†åº”å¯¹è¿™ç±»é—®é¢˜ï¼Œç¤¾åŒºå¼€å‘è€…æå‡ºäº†è¡¥å¿é‡è¯•æœºåˆ¶ â€“ Hedged Readã€‚è¯¥æœºåˆ¶åŸºæœ¬å·¥ä½œåŸç†ä¸ºï¼šå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªæœ¬åœ°è¯»ï¼Œä¸€æ—¦ä¸€æ®µæ—¶é—´ä¹‹åè¿˜æ²¡æœ‰è¿”å›ï¼Œå®¢æˆ·ç«¯å°†ä¼šå‘å…¶ä»–DataNodeå‘é€ç›¸åŒæ•°æ®çš„è¯·æ±‚ã€‚å“ªä¸€ä¸ªè¯·æ±‚å…ˆè¿”å›ï¼Œå¦ä¸€ä¸ªå°±ä¼šè¢«ä¸¢å¼ƒã€‚ä¼˜åŒ–å»ºè®®ï¼šå¼€å¯Hedged ReadåŠŸèƒ½ï¼Œå…·ä½“é…ç½®å‚è€ƒè¿™é‡Œæ•°æ®æœ¬åœ°ç‡æ˜¯å¦å¤ªä½ï¼Ÿæ•°æ®æœ¬åœ°ç‡ï¼šHDFSæ•°æ®é€šå¸¸å­˜å‚¨ä¸‰ä»½ï¼Œå‡å¦‚å½“å‰RegionAå¤„äºNode1ä¸Šï¼Œæ•°æ®aå†™å…¥çš„æ—¶å€™ä¸‰å‰¯æœ¬ä¸º(Node1,Node2,Node3)ï¼Œæ•°æ®bå†™å…¥ä¸‰å‰¯æœ¬æ˜¯(Node1,Node4,Node5)ï¼Œæ•°æ®cå†™å…¥ä¸‰å‰¯æœ¬(Node1,Node3,Node5)ï¼Œå¯ä»¥çœ‹å‡ºæ¥æ‰€æœ‰æ•°æ®å†™å…¥æœ¬åœ°Node1è‚¯å®šä¼šå†™ä¸€ä»½ï¼Œæ•°æ®éƒ½åœ¨æœ¬åœ°å¯ä»¥è¯»åˆ°ï¼Œå› æ­¤æ•°æ®æœ¬åœ°ç‡æ˜¯100%ã€‚ç°åœ¨å‡è®¾RegionAè¢«è¿ç§»åˆ°äº†Node2ä¸Šï¼Œåªæœ‰æ•°æ®aåœ¨è¯¥èŠ‚ç‚¹ä¸Šï¼Œå…¶ä»–æ•°æ®ï¼ˆbå’Œcï¼‰è¯»å–åªèƒ½è¿œç¨‹è·¨èŠ‚ç‚¹è¯»ï¼Œæœ¬åœ°ç‡å°±ä¸º33%ï¼ˆå‡è®¾aï¼Œbå’Œcçš„æ•°æ®å¤§å°ç›¸åŒï¼‰ã€‚ä¼˜åŒ–åŸç†ï¼šæ•°æ®æœ¬åœ°ç‡å¤ªä½å¾ˆæ˜¾ç„¶ä¼šäº§ç”Ÿå¤§é‡çš„è·¨ç½‘ç»œIOè¯·æ±‚ï¼Œå¿…ç„¶ä¼šå¯¼è‡´è¯»è¯·æ±‚å»¶è¿Ÿè¾ƒé«˜ï¼Œå› æ­¤æé«˜æ•°æ®æœ¬åœ°ç‡å¯ä»¥æœ‰æ•ˆä¼˜åŒ–éšæœºè¯»æ€§èƒ½ã€‚æ•°æ®æœ¬åœ°ç‡ä½çš„åŸå› ä¸€èˆ¬æ˜¯å› ä¸ºRegionè¿ç§»ï¼ˆè‡ªåŠ¨balanceå¼€å¯ã€RegionServerå®•æœºè¿ç§»ã€æ‰‹åŠ¨è¿ç§»ç­‰ï¼‰,å› æ­¤ä¸€æ–¹é¢å¯ä»¥é€šè¿‡é¿å…Regionæ— æ•…è¿ç§»æ¥ä¿æŒæ•°æ®æœ¬åœ°ç‡ï¼Œå¦ä¸€æ–¹é¢å¦‚æœæ•°æ®æœ¬åœ°ç‡å¾ˆä½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ‰§è¡Œmajor_compactæå‡æ•°æ®æœ¬åœ°ç‡åˆ°100%ã€‚ä¼˜åŒ–å»ºè®®ï¼šé¿å…Regionæ— æ•…è¿ç§»ï¼Œæ¯”å¦‚å…³é—­è‡ªåŠ¨balanceã€RSå®•æœºåŠæ—¶æ‹‰èµ·å¹¶è¿å›é£˜èµ°çš„Regionç­‰ï¼›åœ¨ä¸šåŠ¡ä½å³°æœŸæ‰§è¡Œmajor_compactæå‡æ•°æ®æœ¬åœ°ç‡HBaseè¯»æ€§èƒ½ä¼˜åŒ–å½’çº³åœ¨æœ¬æ–‡å¼€å§‹çš„æ—¶å€™æåˆ°è¯»å»¶è¿Ÿè¾ƒå¤§æ— éä¸‰ç§å¸¸è§çš„è¡¨è±¡ï¼Œå•ä¸ªä¸šåŠ¡æ…¢ã€é›†ç¾¤éšæœºè¯»æ…¢ä»¥åŠæŸä¸ªä¸šåŠ¡éšæœºè¯»ä¹‹åå…¶ä»–ä¸šåŠ¡å—åˆ°å½±å“å¯¼è‡´éšæœºè¯»å»¶è¿Ÿå¾ˆå¤§ã€‚äº†è§£å®Œå¸¸è§çš„å¯èƒ½å¯¼è‡´è¯»å»¶è¿Ÿè¾ƒå¤§çš„ä¸€äº›é—®é¢˜ä¹‹åï¼Œæˆ‘ä»¬å°†è¿™äº›é—®é¢˜è¿›è¡Œå¦‚ä¸‹å½’ç±»ï¼Œè¯»è€…å¯ä»¥åœ¨çœ‹åˆ°ç°è±¡ä¹‹ååœ¨å¯¹åº”çš„é—®é¢˜åˆ—è¡¨ä¸­è¿›è¡Œå…·ä½“å®šä½ï¼šhbase2hbase3hbase4HBaseè¯»æ€§èƒ½ä¼˜åŒ–æ€»ç»“æ€§èƒ½ä¼˜åŒ–æ˜¯ä»»ä½•ä¸€ä¸ªç³»ç»Ÿéƒ½ä¼šé‡åˆ°çš„è¯é¢˜ï¼Œæ¯ä¸ªç³»ç»Ÿä¹Ÿéƒ½æœ‰è‡ªå·±çš„ä¼˜åŒ–æ–¹å¼ã€‚ HBaseä½œä¸ºåˆ†å¸ƒå¼KVæ•°æ®åº“ï¼Œä¼˜åŒ–ç‚¹åˆæ ¼å¤–ä¸åŒï¼Œæ›´å¤šå¾—èå…¥äº†åˆ†å¸ƒå¼ç‰¹æ€§ä»¥åŠå­˜å‚¨ç³»ç»Ÿä¼˜åŒ–ç‰¹æ€§ã€‚æ–‡ä¸­æ€»ç»“äº†è¯»ä¼˜åŒ–çš„åŸºæœ¬çªç ´ç‚¹ï¼Œæœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹è¿˜æœ›æŒ‡æ­£ï¼Œæœ‰è¡¥å……çš„ä¹Ÿå¯ä»¥ä¸€èµ·æ¢è®¨äº¤æµï¼HBase æŸ¥è¯¢ä¼˜åŒ–åŸæ–‡é“¾æ¥","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"HBase","slug":"HBase","permalink":"http://www.wortyby.com/tags/HBase/"}]},{"title":"ç”¨æˆ·ç”»åƒçš„æ¨ªç©ºå‡ºä¸–","slug":"ç”¨æˆ·ç”»åƒçš„æ¨ªç©ºå‡ºä¸–-","date":"2018-11-01T02:23:57.000Z","updated":"2018-11-01T02:23:57.000Z","comments":true,"path":"2018/11/01/ç”¨æˆ·ç”»åƒçš„æ¨ªç©ºå‡ºä¸–-/","link":"","permalink":"http://www.wortyby.com/2018/11/01/ç”¨æˆ·ç”»åƒçš„æ¨ªç©ºå‡ºä¸–-/","excerpt":"","text":"ç³»ç»Ÿåº”è¯¥åŒ…å«åŸºæœ¬çš„åé¦ˆå’Œå“åº”ï¼Œä¹Ÿå¯èƒ½åŒ…å«æŸäº›åˆºæ¿€ï¼Œå…ˆä¸è°ˆç”¨æˆ·ç”»åƒã€‚ä»åè¯è§£é‡Šè¯´èµ·ä¸‰ä¸ªæ¦‚å¿µ ï¼Œåé¦ˆï¼Œå“åº”ï¼Œåˆºæ¿€ æ¦‚å¿µå®šä¹‰:åé¦ˆ: å®šä¹‰ä¸ºç”¨æˆ·åœ¨é˜¿åŸºç±³å¾·çš„æ‰€æœ‰ä¿¡æ¯è¾“å…¥;æ¯”å¦‚æ”¶å¬ï¼Œç‚¹å‡»ï¼Œå„ç§çœ‹çš„è§çš„æ“ä½œã€‚å“åº”: é’ˆå¯¹ç”¨æˆ·çš„åé¦ˆè¾“å‡ºå¯¹åº”çš„äº‹ä»¶å“åº”;æ¯”å¦‚ ç”¨æˆ·æ”¶å¬çš„æµçŠ¶æ€ç¨³ä¸ç¨³å®šç­‰ç­‰ï¼Œæ”¶å¬çš„éŸ³é¢‘æ˜¯å¦å­˜åœ¨ï¼ŒèŠ‚ç›®æ˜¯å¦ä¸‹çº¿ï¼Œç­‰ç­‰åˆºæ¿€: ä¸ºäº†å¾—åˆ°æŸäº›ç‰¹å®šçš„å“åº”ï¼Œå¯èƒ½éœ€è¦é’ˆå¯¹åé¦ˆ åŠ ä¸Š ä¸€äº›å¤„ç† ;æ¯”å¦‚ï¼Œæˆ‘å¸Œæœ›ç»™ 20-30 å²çš„å¹³å°ç”¨æˆ·ï¼Œæ¨èä¸€äº›ç¬¦åˆè¯¥å¹´é¾„æ®µçš„ä¿¡æ¯ï¼Œç„¶åé€šè¿‡å“åº”çœ‹æ•ˆæœã€‚å¯èƒ½æ¶‰åŠåˆ°ä¸€äº›æ•°æ®ETL æ“ä½œæ‰€ä»¥ä¸€ä¸ªé€šç”¨çš„ç³»ç»Ÿæ˜¯åŸºæœ¬åŒ…å« åé¦ˆå’Œå“åº”çš„ï¼Œä½†æ˜¯ä¸ä¼šåŒ…å«ç€ç”¨æˆ·ç”»åƒã€‚çœ‹ä½ é‚®ä»¶å›å¤çš„æ˜¯å¸®åŠ©åšå„ç§è¿è¥æ‰‹æ®µã€‚é‚£ä¹ˆç”¨æˆ·ç”»åƒæ˜¯ä»€ä¹ˆå‘¢ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯ä¸€ä¸ªåˆ†ææ‰‹æ®µï¼Ÿä»æ¦‚å¿µçŒè¾“ä¸Šï¼Œæ˜¯æ²¡å•¥å¤§é—®é¢˜çš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¦‚æœè¦åšè¿™ä»¶äº‹æƒ…ï¼Œå¯èƒ½å…‰çŸ¥é“æ¦‚å¿µè¿˜ä¸å¤Ÿï¼Œè¦çŸ¥é“æ€ä¹ˆåšï¼Œè¿˜è¦å‰–æå®ƒã€‚é€šè¿‡å’ŒåŒäº‹è®¨è®ºå‡ æ¬¡ä¹‹åç§ä¸‹è®¤ä¸ºï¼Œç”¨æˆ·ç”»åƒå°±æ˜¯ä¸€ä¸ªæ•°æ®ç²¾ç»†åŒ–ç»´åº¦çš„æ•°æ®é›†åˆï¼Œå°±æ˜¯ä¸€ä¸ªæ•°æ®ä»“åº“ï¼Œè¿™æ˜¯ä¸ªäººæ„è§ï¼Œå¯èƒ½è¿˜æœ‰ä¸åˆ°ä½çš„åœ°æ–¹ã€‚åƒä½ åˆ†äº«çš„é™„ä»¶ï¼Œå„ç§å„æ ·çš„æ•ˆæœï¼Œæˆ‘ç»Ÿä¸€éƒ½æ˜¯å½’ç±»åˆ°ç”¨æˆ·å“åº”é‡Œã€‚ä½†æ˜¯è®¡ç®—æœºçš„å„ç§å„æ ·çš„ä¿¡æ¯èƒ½å¤Ÿè¢«ç”µå­æ¶ˆè´¹æ‰ï¼Œæ˜¯éœ€è¦æ•°å­—ä¿¡å·å¤„ç†çš„ï¼Œè€Œä¸æ˜¯å¤„ç†ä»€ä¹ˆ ç”·/å¥³ æ ‡ç­¾ã€‚æ‰€ä»¥æˆ‘æ˜¨å¤©è¯´ä»–ä»¬çš„é‚®ä»¶éƒ½æ˜¯è™šçš„ï¼Œå› ä¸ºä»–ä»¬åªè®² åé¦ˆ å’Œ å“åº”ï¼Œæœ€é‡è¦çš„ è½¬æ¢ ä¸è®²ã€‚å°±åƒå­¦ç”Ÿé—®è€å¸ˆï¼Œä¸ºä»€ä¹ˆä¸‰è§’å‡½æ•°æ•°å­¦è¡¨è¾¾å¼å¯ä»¥è¡¨ç¤ºä¿¡å·ï¼Œè€å¸ˆè¯´ï¼Œé€šè¿‡é‡‡é›†å™¨é‡‡é›†åˆ°æŠ½æ ·æ•°æ®ï¼Œç»è¿‡ä¸€ä¸ªç³»ç»Ÿè½¬åŒ–ï¼Œè¾“å‡ºçš„å°±æ˜¯ä¸‰è§’å‡½æ•°ä¿¡å·äº†ï¼Œä¸ç»™ä½ è®²è¿™ä¸ªç³»ç»Ÿè½¬åŒ–çš„é»‘ç›’ï¼Œæˆ‘æƒ³é‚£äº›æƒ³çŸ¥é“é»‘ç›’åŸç†çš„å­¦ç”Ÿå¿ƒé‡Œæœ‰æƒ³æ³•å§ã€‚æ‰€ä»¥æˆ‘è§‰å¾—ç”¨æˆ·ç”»åƒçš„å®šä¹‰æ˜¯ç”¨æˆ·ç”»åƒ:å°† â€œåé¦ˆâ€ è¿›ç³»ç»Ÿçš„æ•°æ®ï¼Œç»è¿‡å„ç§å„æ ·çš„é¢„å¤„ç†ï¼Œæ–¹ä¾¿ä¾› â€œå“åº”â€ ä½¿ç”¨çš„ä¸€ä¸ªè½¬åŒ–è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å°† æ–‡æœ¬/éŸ³é¢‘/è§†é¢‘æ•°æ®ï¼Œé€šè¿‡å„ç§sql æ“ä½œï¼Œç»„åˆæ›´æ–°æ”¾åˆ° æ•°æ®åº“ï¼Œå½“å“åº”éœ€è¦å„ç§å„æ ·çš„æ ‡ç­¾éœ€æ±‚çš„æ—¶å€™ï¼Œç›´æ¥é€šè¿‡å„ç§å„æ ·çš„sql è¯­å¥è¿›è¡ŒæŠ½ç¦»ã€‚æˆ‘ä»¬å†ç»™æ¯ä¸ªåŠŸèƒ½éœ€æ±‚çš„sql è¿›è¡Œå¦å­˜ä¸ºçš„ä¿å­˜ ä¸º â€œæ ‡ç­¾â€ï¼Œè¿™ä¸ª æ ‡ç­¾å¯ä»¥æ˜¯ç®€å•çš„åŸºæœ¬ç”¨æˆ·ä¿¡æ¯è·å–ï¼Œä¹Ÿå¯ä»¥æ˜¯å„ç§å„æ ·çš„å¤–éƒ¨å®šåˆ¶åŒ–è¿è¥éœ€æ±‚ã€‚è€Œå„ç§å„æ ·çš„è½¬åŒ–ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å„ç§sql è¯­å¥ç»„åˆã€‚é€šä¿—åœ°è®²ç”¨æˆ·ç”»åƒæ˜¯ä¸Šé¢åé¦ˆå’Œåˆºæ¿€ ä¹‹åçš„ä¸€ä¸ªè®°å¿†æš‚å­˜ï¼Œç­‰å¾…ç€å„ç§æ ‡ç­¾è¯·æ±‚ï¼Œå°†å…¶è¾“å‡ºåˆ°æœ€ç»ˆçš„å‘ˆç°èŠ‚ç‚¹ï¼Œæ¯”å¦‚excelï¼Œwebï¼Œcsvï¼Œç­‰ç­‰æ ¼å¼ã€‚****ï¼Œè®©æ™®ç½—å¤§ä¼—ç”¨æˆ·èƒ½å¤Ÿå¥½å¥½æ¥å—ã€‚æ‰€ä»¥ï¼Œæˆ‘è§‰å¾—ç›®å‰æˆ‘ä»¬æ—¢ç„¶ç”¨æ•°æ®åº“çš„è¯ï¼Œæœ¬è´¨å°±æ˜¯ä¸€ä¸ª&quot;sqlè¯­å¥ æŸ¥è¯¢â€ ç®¡ç†ç³»ç»Ÿï¼Œæ²¡ä»€ä¹ˆå¤§èŠ±å¤´ã€‚ä»¥ä¸Šæ˜¯ä¸ªäººè§è§£ï¼Œå¯èƒ½æœ‰çœ¼å…‰ç‹­çª„ï¼Œæ²¡çœ‹è§çš„åœ°æ–¹ã€‚","categories":[{"name":"ç”¨æˆ·ç”»åƒ","slug":"ç”¨æˆ·ç”»åƒ","permalink":"http://www.wortyby.com/categories/ç”¨æˆ·ç”»åƒ/"}],"tags":[{"name":"ç³»ç»Ÿ","slug":"ç³»ç»Ÿ","permalink":"http://www.wortyby.com/tags/ç³»ç»Ÿ/"}]},{"title":"ç†è§£ç´¢å¼•ï¼šHBaseä»‹ç»å’Œæ¶æ„","slug":"ç†è§£ç´¢å¼•ï¼šHBaseä»‹ç»å’Œæ¶æ„","date":"2018-10-30T08:33:33.000Z","updated":"2018-10-30T08:33:33.000Z","comments":true,"path":"2018/10/30/ç†è§£ç´¢å¼•ï¼šHBaseä»‹ç»å’Œæ¶æ„/","link":"","permalink":"http://www.wortyby.com/2018/10/30/ç†è§£ç´¢å¼•ï¼šHBaseä»‹ç»å’Œæ¶æ„/","excerpt":"","text":"æœ€è¿‘æœ‰ä¸ªéœ€æ±‚ï¼Œè¦ä¿®æ”¹ç°æœ‰å­˜å‚¨ç»“æ„ï¼Œæ¶‰åŠæŸ¥è¯¢æ¡ä»¶å’ŒæŸ¥è¯¢æ•ˆç‡çš„è€ƒé‡ï¼Œçœ‹äº†å‡ ç¯‡ç´¢å¼•å’ŒHBaseç›¸å…³çš„æ–‡ç« ï¼Œå›å¿†äº†ç›¸å…³çŸ¥è¯†ï¼Œç»“åˆé¡¹ç›®éœ€æ±‚ï¼Œè¯´è¯´è‡ªå·±çš„ç†è§£å’Œæ€»ç»“ã€‚å‰å‡ ç¯‡æ–‡ç« é‡ç‚¹ä»‹ç»MySQLç´¢å¼•ç›¸å…³çš„çŸ¥è¯†ï¼Œä»ç´¢å¼•ä¼˜ç‚¹ã€ç´¢å¼•ç»“æ„æ¼”åŒ–è¿‡ç¨‹ï¼Œåˆ°SQLæŸ¥è¯¢è¿‡ç¨‹ã€æ‰§è¡Œè®¡åˆ’ï¼Œå†åˆ°æœ€åçš„ç´¢å¼•ä¼˜åŒ–ï¼Œé”™è¿‡çš„æœ‹å‹å¯ä»¥å›é¡¾ä¸‹å‰å‡ ç¯‡æ–‡ç« ï¼šç´¢å¼•ç»“æ„å’Œæ•°æ®å®šä½è¿‡ç¨‹æŸ¥è¯¢è¿‡ç¨‹å’Œé«˜çº§æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’è¯¦ç»†ä»‹ç»ç´¢å¼•ä¼˜åŒ–åé¢ä¼šå¼€å§‹ä»‹ç»HBaseç´¢å¼•ç›¸å…³çš„ï¼Œå’ŒMySQLå¯¹æ¯”ä¸‹ï¼Œä»¥åŠ æ·±å¯¹ç´¢å¼•çš„ç†è§£ï¼Œæœ¬ç¯‡å…ˆä»‹ç»ä¸‹HBaseï¼Œå®ƒçš„ä¸€äº›ç‰¹æ€§å’Œæ•´ä½“æ¶æ„ï¼Œä¸ºåé¢ä»‹ç»ç´¢å¼•åšå‡†å¤‡ï¼Œé€šè¿‡ä»‹ç»ï¼Œä½ ä¼šäº†è§£åˆ°ï¼šä¸ºä»€ä¹ˆä¼šå‡ºç°HBaseHBaseçš„ç‰¹æ€§HBaseçš„æ•´ä½“æ¶æ„éƒ¨åˆ†å†…å®¹æ‘˜å½•äº†å‡ ä¸ªåšå‹çš„æ–‡ç« ï¼Œæœ€åä¼šç»™å‡ºæ–‡ç« é“¾æ¥ï¼Œæ„Ÿè°¢ä»–ä»¬çš„ç²¾å½©åˆ†æã€‚ ä¸ºä»€ä¹ˆä¼šå‡ºç° HBaseä»»ä½•ä¸€ä¸ªæŠ€æœ¯çš„å‡ºç°éƒ½æ˜¯æœ‰åŸå› çš„ï¼Œäº†è§£å®ƒä¸ºä»€ä¹ˆå‡ºç°ï¼Œä»¥åŠå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œæ›´æœ‰åŠ©äºç†è§£å®ƒçš„ç‰¹æ€§å’Œè®¾è®¡æ€æƒ³ã€‚ MySQL ç“¶åŠ²MySQLæ˜¯ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ï¼Œæœ‰å¾ˆé«˜çš„æ•°æ®ä¸€è‡´æ€§å’ŒæŒä¹…æ€§ä¿è¯ï¼Œå½“è®¿é—®é‡ç‰¹åˆ«é«˜æ—¶ï¼Œç‰¹åˆ«æ˜¯å†™å…¥æ“ä½œï¼Œä¼šæœ‰å¾ˆå¤§çš„Oæ€§èƒ½ç“¶é¢ˆã€‚è™½ç„¶å¯ä»¥é€šè¿‡ä¸»ä»è¯»å†™åˆ†ç¦»ã€åˆ†åº“åˆ†è¡¨çš„æ–¹å¼è§£å†³ï¼Œä½†éšç€æ•°æ®é‡ä¸æ–­å¢å¤§ã€å¹¶å‘ä¸æ–­å¢é«˜ï¼ŒMySQLåº”ç”¨å¼€å‘è¶Šæ¥è¶Šå¤æ‚ï¼Œä¹Ÿè¶Šæ¥è¶Šå…·æœ‰æŠ€æœ¯æŒ‘æˆ˜æ€§ã€‚å¦å¤–ï¼Œåˆ†è¡¨åˆ†åº“çš„è§„åˆ™çš„è®¾å®šéƒ½æ˜¯éœ€è¦ç»éªŒçš„ï¼Œè™½ç„¶æœ‰ Cobarã€MyCatã€Sharding-JDBCã€TDDLã€DBProxy ä¸­é—´ä»¶å±‚æ¥å±è”½å¼€å‘è€…çš„å¤æ‚æ€§ï¼Œä½†æ˜¯é¿å…ä¸äº†æ•´ä¸ªæ¶æ„çš„å¤æ‚æ€§ã€‚åˆ†åº“åˆ†è¡¨çš„å­åº“åˆ°ä¸€å®šé˜¶æ®µåˆé¢ä¸´æ‰©å±•é—®é¢˜ï¼Œéœ€æ±‚çš„å˜æ›´å¯èƒ½åˆéœ€è¦ä¸€ç§æ–°çš„ shardingã€‚MySQLçš„æ‰©å±•æ€§å·®ã€å¤§æ•°æ®ä¸‹IOå‹åŠ›å¤§ã€è¡¨ç»“æ„æ›´æ”¹å›°éš¾ï¼Œæ­£æ˜¯MySQLå¼€å‘äººå‘˜é¢ä¸´çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯MySQLçš„ç“¶é¢ˆã€‚è™½ç„¶æœ‰è¿™äº›ç“¶é¢ˆï¼Œä½†å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚ç‰¹åˆ«é«˜çš„ä¸šåŠ¡ï¼Œè¿˜æ˜¯è¦ä½¿ç”¨å®ƒï¼Œä½†æ˜¯æœ‰çš„åº”ç”¨åœºæ™¯ä¸éœ€è¦å¤ªé«˜çš„ä¸€è‡´æ€§ï¼Œåœ¨å¤§æ•°æ®é‡ã€é«˜å¹¶å‘çš„ä¸šåŠ¡ä¸­ï¼Œå¯ä»¥é€‰æ‹©å…¶ä»–å­˜å‚¨æ–¹æ¡ˆã€‚ NoSQL çš„å‡ºç°NoSQLæ•°æ®åº“ç§ç±»ç¹å¤šï¼Œä½†æ˜¯ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹éƒ½æ˜¯å»æ‰å…³ç³»æ•°æ®åº“çš„å…³ç³»å‹ç‰¹æ€§ï¼Œæ•°æ®ä¹‹é—´æ— å…³ç³»ï¼Œè¿™æ ·å°±éå¸¸å®¹æ˜“æ‰©å±•ã€‚ NOSQLæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼šæ¨¡å¼è‡ªç”±: ä¸åƒä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“éœ€è¦å®šä¹‰æ•°æ®åº“ã€æ•°æ®è¡¨ç­‰ç»“æ„æ‰å¯ä»¥å­˜å–æ•°æ®ï¼Œæ•°æ®è¡¨ä¸­çš„æ¯ä¸€æ¡è®°å½•éƒ½å¯èƒ½æœ‰ä¸åŒçš„å±æ€§å’Œæ ¼å¼ï¼›é€†èŒƒå¼: å»é™¤çº¦æŸï¼Œé™ä½äº‹åŠ¡è¦æ±‚ï¼Œæ›´åˆ©äºæ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨ï¼Œä¸MySQLèŒƒå¼ç›¸åï¼›å¤šåˆ†åŒºå­˜å‚¨: å­˜å‚¨åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¾ˆå¥½åœ°è¿›è¡Œæ°´å¹³æ‰©å±•ï¼Œæé«˜æ•°æ®çš„è¯»ã€å†™æ€§èƒ½ï¼›å¤šå‰¯æœ¬å¼‚æ­¥å¤åˆ¶: ä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œä¼šä¿å­˜æ•°æ®çš„å¤šä¸ªå‰¯æœ¬;å¼¹æ€§å¯æ‰©å±•: å¯ä»¥åœ¨ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€çš„å¢åˆ èŠ‚ç‚¹ï¼Œæ•°æ®è‡ªåŠ¨å¹³è¡¡ç§»åŠ¨ï¼Œä¸éœ€è¦äººå·¥çš„å¹²é¢„æ“ä½œï¼›è½¯äº‹åŠ¡ï¼šäº‹åŠ¡æ˜¯å…³ç³»å‹æ•°æ®åº“çš„ä¸€ä¸ªç‰¹ç‚¹ï¼ŒNoSQLæ•°æ®åº“ä¸èƒ½å®Œå…¨æ»¡è¶³äº‹åŠ¡çš„ACIDç‰¹æ€§ï¼Œä½†æ˜¯èƒ½ä¿è¯äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ï¼› NOSQLæœ‰ä¸€äº›ç†è®ºæ”¯æŒ:CAPç†è®º: å°±æ˜¯å¹³è¡¡ä¸€è‡´æ€§ã€å¯ç”¨æ€§ã€åˆ†åŒºå®¹é”™æ€§ï¼Œå› ä¸ºæœ€å¤šåªèƒ½åŒæ—¶å®ç°2ä¸ªï¼Œéœ€è¦åšå¹³è¡¡å–èˆï¼›BASEæ¨¡å‹: Basically Availble åŸºæœ¬å¯ç”¨ï¼ŒSoft state çŠ¶æ€å¯ä»¥æœ‰ä¸€æ®µæ—¶é—´ä¸åŒæ­¥ï¼ŒEventual Consistency æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸ä¿è¯åœ¨ä»»æ„æ—¶åˆ»ä»»æ„èŠ‚ç‚¹ä¸Šçš„åŒä¸€ä»½æ•°æ®éƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯éšç€æ—¶é—´çš„è¿ç§»ï¼Œä¸åŒèŠ‚ç‚¹ä¸Šçš„åŒä¸€ä»½æ•°æ®æ€»æ˜¯åœ¨å‘è¶‹åŒçš„æ–¹å‘å˜åŒ–ï¼›æ”¾ä¸Šç½‘ä¸Šçš„ä¸€å¼ å›¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒæ•°æ®åº“æµ‹è¯•ç‚¹ä¸åŒï¼šä¸Šå›¾ä¹Ÿæ ¹æ®é¢œè‰²åŒºåˆ†äº†ä¸åŒçš„æ•°æ®æ¨¡å‹ï¼Œè¿™é‡Œç®€å•æ€»ç»“ä¸‹ã€‚å…³ç³»å‹æ•°æ®åº“ï¼šä¸€ç›´åœ¨ä»‹ç»çš„MySQLï¼Œå°±ä¸è¯´äº†ï¼›é”®å€¼ï¼šå†…å®¹ç¼“å­˜ï¼Œä¸»è¦ç”¨äºå¤„ç†å¤§é‡æ•°æ®çš„é«˜è®¿é—®è´Ÿè½½ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å¿«ï¼Œä½†æ•°æ®æ— ç»“æ„åŒ–ï¼Œé€šå¸¸åªè¢«å½“ä½œå­—ç¬¦ä¸²æˆ–è€…äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚Redisã€MemcacheDBï¼›åˆ—å­˜å‚¨æ•°æ®åº“ï¼šåˆ†å¸ƒå¼çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒæŒ‰åˆ—å­˜å‚¨ï¼Œé’ˆå¯¹æŸä¸€åˆ—æˆ–è€…æŸå‡ åˆ—çš„æŸ¥è¯¢æœ‰éå¸¸å¤§çš„IOä¼˜åŠ¿ï¼Œä»¥åˆ—ç°‡å¼å­˜å‚¨ï¼Œå°†åŒä¸€åˆ—æ•°æ®å­˜åœ¨ä¸€èµ·ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å¿«ï¼Œå¯æ‰©å±•æ€§å¼ºï¼Œæ›´å®¹æ˜“è¿›è¡Œåˆ†å¸ƒå¼æ‰©å±•ï¼Œä½†åŠŸèƒ½ç›¸å¯¹å±€é™ï¼Œæ¯”å¦‚BigTableã€HBaseã€Cassandraï¼›æ–‡æ¡£å‹æ•°æ®åº“ï¼šå­˜å‚¨ç±»ä¼¼JSONæ ¼å¼çš„å†…å®¹ï¼Œå¯å¯¹æŸäº›å­—æ®µå»ºç«‹ç´¢å¼•åŠŸèƒ½ï¼Œæ˜¯æœ€åƒå…³ç³»å‹çš„æ•°æ®åº“ï¼ŒKey-Valueå¯¹åº”çš„é”®å€¼å¯¹ï¼ŒValueä¸ºç»“æ„åŒ–æ•°æ®ï¼Œæ•°æ®ç»“æ„è¦æ±‚ä¸ä¸¥æ ¼ï¼Œè¡¨ç»“æ„å¯å˜ï¼Œä½†æŸ¥è¯¢æ€§èƒ½ä¸é«˜ï¼Œè€Œä¸”ç¼ºä¹ç»Ÿä¸€çš„æŸ¥è¯¢è¯­æ³•ï¼Œæ¯”å¦‚MongoDBã€CouchDBï¼› HBase äº§ç”ŸèƒŒæ™¯ä¸Šé¢æåˆ°ï¼Œéšç€æ•°æ®è§„æ¨¡è¶Šæ¥è¶Šå¤§ï¼Œå¤§é‡ä¸šåŠ¡åœºæ™¯å¼€å§‹è€ƒè™‘æ•°æ®å­˜å‚¨çš„æ°´å¹³æ‰©å±•ï¼Œæµ·é‡æ•°æ®é‡å­˜å‚¨æˆä¸ºæå‡åº”ç”¨æ€§èƒ½çš„ç“¶é¢ˆï¼Œå•å°æœºå™¨æ— æ³•è´Ÿè½½æµ·é‡çš„æ•°æ®å¤„ç†ï¼Œéšä¹‹è€Œæ¥çš„å‡ºç°äº†å¾ˆå¤šçš„åˆ†å¸ƒå¼å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼ŒHBaseå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚HBaseï¼ï¼DataBase on Hadoopï¼ŒåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šé¢å»ºç«‹çš„æ•°æ®åº“ï¼ŒHBaseæ˜¯é¢å‘åˆ—çš„å¼€æºæ•°æ®åº“ã€‚å¼€æºå›¢é˜Ÿæ ¹æ®2008å¹´Googleå‘å¸ƒäº†ä¸€ç¯‡å…³äºGoogleæœç´¢å¼•æ“BigTableçš„æ ¸å¿ƒæ€æƒ³çš„è®ºæ–‡ï¼Œå®ç°äº†åŸºäºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„åˆ—æ•°æ®åº“ã€‚éšååŠ å…¥ApacheåŸºé‡‘ä¼šï¼Œæˆä¸ºHadoopç”Ÿæ€åœˆä¸­çš„é¡¶çº§é¡¹ç›®è¢«å¤§å®¶ç†ŸçŸ¥ã€‚ HBase çš„ç‰¹æ€§é«˜æ€§èƒ½HBaseä¸­å­˜å‚¨äº†ä¸€å¥—HDFSçš„ç´¢å¼•ï¼Œé€šè¿‡è¡¨åï¼&gt;è¡Œå¥ï¼&gt;åˆ—æ—ï¼&gt;åˆ—é™å®šç¬¦ï¼&gt;æ—¶é—´ç‰ˆæœ¬è¿™ä¸€å¥—ç´¢å¼•æ¥å®šä½æ•°æ®çš„ä½ç½®ï¼ŒHBaseä¸ºæ¯ä¸€åˆ—æ•°æ®ç»´æŠ¤äº†ä¸€å¥—ç´¢å¼•è§„åˆ™ï¼Œå¯¹äºå…·ä½“æŸä¸€å…·ä½“æ¡æ•°æ®çš„æŸ¥è¯¢å¯ä»¥éå¸¸å¿«é€Ÿçš„é€šè¿‡Bï¼‹æ ‘å®šä½æ•°æ®å­˜å‚¨ä½ç½®å¹¶å°†å…¶å–å‡ºã€‚å¦å¤–ï¼ŒHBaseé€šå¸¸ä»¥é›†ç¾¤éƒ¨ç½²ï¼Œæ•°æ®è¢«åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹å­˜å‚¨ï¼Œå½“å®¢æˆ·ç«¯å‘èµ·æŸ¥è¯¢è¯·æ±‚çš„æ—¶å€™ï¼Œé›†ç¾¤é‡Œé¢å¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œæ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œæœ€åå°†ä¸åŒèŠ‚ç‚¹çš„æŸ¥è¯¢ç»“æœè¿›è¡Œåˆå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæé«˜IOæ€§èƒ½ã€‚é«˜å¯ç”¨HBaseé›†ç¾¤ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å®•æœºéƒ½ä¸ä¼šå¯¼è‡´é›†ç¾¤ç˜«ç—ªã€‚è¿™å–å†³äºä¸¤æ–¹é¢åŸå› :ç¬¬ä¸€æ–¹é¢ï¼ŒZooKeeperè§£å†³äº†HBaseä¸­å¿ƒåŒ–é—®é¢˜ï¼›å¦ä¸€æ–¹é¢ï¼ŒHBaseå°†æ•°æ®å­˜æ”¾åœ¨HDFSä¸Šé¢ï¼ŒHDFSçš„æ•°æ®å†—ä½™å­˜æ”¾åœ¨ä¸åŒèŠ‚ç‚¹ï¼Œä¸€ä¸ªèŠ‚ç‚¹ç˜«ç—ªå¯ä»å…¶ä»–èŠ‚ç‚¹å–å¾—æ•°æ®ï¼Œä¿è¯äº†HBaseçš„é«˜å¯ç”¨ã€‚æ˜“æ‰©å±•Hbaseçš„æ‰©å±•æ€§ä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯åŸºäºä¸Šå±‚å¤„ç†èƒ½RegionServerçš„æ‰©å±•ï¼Œä¸€ä¸ªæ˜¯åŸºäºå­˜å‚¨çš„æ‰©å±•HDFSã€‚æ— æ¨¡å¼ä½¿ç”¨HBaseä¸éœ€è¦é¢„å…ˆå®šä¹‰è¡¨ä¸­æœ‰å¤šå°‘åˆ—ï¼Œä¹Ÿä¸éœ€è¦å®šä¹‰æ¯ä¸€åˆ—å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼ŒHBaseåœ¨éœ€è¦çš„æ—¶å€™å¯ä»¥åŠ¨æ€å¢åŠ åˆ—å’ŒæŒ‡å®šå­˜å‚¨æ•°æ®ç±»å‹ã€‚ HBase çš„æ•´ä½“æ¶æ„Hbaseåœ¨æ•´ä¸ªHadoopç”Ÿæ€åœˆçš„åœ°ä½å¦‚ä¸‹å›¾ï¼š äº†è§£å‡ ä¸ªæ¦‚å¿µrowkey: Rowkeyçš„æ¦‚å¿µå’Œmysqlä¸­çš„ä¸»é”®ç›¸ä¼¼ï¼ŒHbaseä½¿ç”¨Rowkeyæ¥å”¯ä¸€çš„åŒºåˆ†æŸä¸€è¡Œçš„æ•°æ®ï¼›region: å’ŒMySQLçš„åˆ†åŒºæˆ–è€…åˆ†ç‰‡å·®ä¸å¤šï¼ŒHbaseä¼šå°†ä¸€ä¸ªå¤§è¡¨çš„æ•°æ®åŸºäºRowkeyçš„ä¸åŒèŒƒå›´åˆ†é…åˆ°ä¸é€šçš„Regionä¸­ï¼Œæ¯ä¸ªRegionè´Ÿè´£ä¸€å®šèŒƒå›´çš„æ•°æ®è®¿é—®å’Œå­˜å‚¨ï¼›timestamp: timestampå¯¹Hbaseæ¥è¯´è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒæ˜¯å®ç°Hbaseå¤šç‰ˆæœ¬çš„å…³é”®ï¼Œåœ¨å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰æŒ‡å®šå¯¹åº”çš„timestampï¼ŒHbaseä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªtimestampï¼Œtimestampå’ŒæœåŠ¡å™¨æ—¶é—´ä¿æŒä¸€è‡´ã€‚ç›¸åŒrowkeyçš„æ•°æ®æŒ‰ç…§timestampå€’åºæ’åˆ—ï¼Œé»˜è®¤æŸ¥è¯¢çš„æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå¯ä»¥æŒ‡å®štimestampçš„å€¼æ¥è¯»å–æ—§ç‰ˆæœ¬çš„æ•°æ®ã€‚ å†…éƒ¨åŸºæœ¬ç»„æˆHbaseçš„æ•´ä½“ä¸»è¦ç”±zookeeperï¼ŒHmasterï¼ŒHRegionServerï¼ŒHdfsæ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œç”±è¿™å››éƒ¨åˆ†å…±åŒå®Œæˆæ•°æ®çš„è¯»å–ä¸å†™å…¥ã€‚ä¸åŒèŒƒå›´çš„æ•°æ®è¢«åˆ’åˆ†åˆ°ä¸åŒåœ°æ–¹ï¼Œç§°ä¸ºHRegionï¼Œä¸åŒçš„HRegionè¢«æ”¾åœ¨ä¸åŒçš„ä¸»æœºä¸Šï¼Œå½“æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ï¼Œåªè¦æ ¹æ®rowkeyå…ˆæ‰¾åˆ°æ•°æ®åœ¨é‚£ä¸ªèŒƒå›´çš„HRegionä¸­ï¼Œå°±å¯ä»¥ç›´æ¥åˆ°é‚£ä¸ªHRegionä¸­æ‰¾åˆ°æ•°æ®ï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”ä¼ ç»Ÿçš„æ•°æ®åº“å¿«å¾ˆå¤šã€‚ æ•´ä½“ç»“æ„ HMateråœ¨Region Splitåï¼Œè´Ÿè´£æ–°Regionçš„åˆ†é…ï¼›æ–°æœºå™¨åŠ å…¥æ—¶ï¼Œç®¡ç†HRegion Serverçš„è´Ÿè½½å‡è¡¡ï¼Œè°ƒæ•´Regionåˆ†å¸ƒï¼›åœ¨HRegion Serverå®•æœºåï¼Œè´Ÿè´£å¤±æ•ˆHRegion Server ä¸Šçš„Regionsè¿ç§»ï¼› Region ServerRegion serverç»´æŠ¤Masteråˆ†é…ç»™å®ƒçš„regionï¼Œå¤„ç†å¯¹è¿™äº›regionçš„IOè¯·æ±‚ï¼›HRegion Serverç®¡ç†äº†å¾ˆå¤štableçš„åˆ†åŒºï¼Œä¹Ÿå°±æ˜¯regionï¼› ZookeeperZooKeeperä¸ºHBaseé›†ç¾¤æä¾›åè°ƒæœåŠ¡ï¼Œå®ƒç®¡ç†ç€HMasterå’ŒHRegionServerçš„çŠ¶æ€(available/aliveç­‰)ï¼Œå¹¶ä¸”ä¼šåœ¨å®ƒä»¬å®•æœºæ—¶é€šçŸ¥ç»™HMasterï¼›zookeeperä¸­ç®¡ç†ç€hbaseçš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚-root-çš„ä½ç½®æ‰€åœ¨ï¼› HDFSæ•°æ®æ–‡ä»¶çš„å­˜æ”¾å¤„ï¼Œç”±äºå…¶æœ¬èº«çš„åˆ†å¸ƒå¼å­˜å‚¨æœºåˆ¶ï¼Œæ‰€ä»¥æ•°æ®æ–‡ä»¶å¾ˆå®‰å…¨ï¼›hadoopçš„datanodeæœ€å¥½å’Œregionåœ¨åŒä¸€ä¸»æœºä¸Šï¼Œæ–¹ä¾¿è¯»å–æ•°æ®ï¼Œå°½é‡é¿å…ç½‘ç»œæ•°æ®ä¼ è¾“ï¼›è¿™ç¯‡ä¸»è¦æ˜¯ä¸ªå¼•å­ï¼Œä¸‹ä¸€ç¯‡é‡ç‚¹ä»‹ç»ä¸‹HBaseä¸­çš„ç´¢å¼•ï¼Œä»¥åŠè®¾è®¡rowkeyçš„ä¸€äº›åŸåˆ™å’ŒæŠ€å·§ã€‚åŸæ–‡é“¾æ¥ å‚è€ƒæ–‡ç« å¤§å¹¶å‘å¤§æ•°é‡ä¸­çš„MYSQLç“¶é¢ˆä¸NOSQLä»‹ç»NoSQLä½ çŸ¥å¤šå°‘ï¼Ÿå¤§æ•°æ®Hadoopä¹‹HBaseè®¤è¯†HbaseæŠ€æœ¯è¯¦ç»†å­¦ä¹ ç¬”è®°Hbaseçš„æ¶æ„ç®€å•è§£æ","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"HBase","slug":"HBase","permalink":"http://www.wortyby.com/tags/HBase/"},{"name":"æ¶æ„","slug":"æ¶æ„","permalink":"http://www.wortyby.com/tags/æ¶æ„/"}]},{"title":"Learning To Rank ç ”ç©¶ä¸åº”ç”¨","slug":"Learning To Rank ç ”ç©¶ä¸åº”ç”¨","date":"2018-10-23T12:26:13.000Z","updated":"2018-10-23T12:26:13.000Z","comments":true,"path":"2018/10/23/Learning To Rank ç ”ç©¶ä¸åº”ç”¨/","link":"","permalink":"http://www.wortyby.com/2018/10/23/Learning To Rank ç ”ç©¶ä¸åº”ç”¨/","excerpt":"","text":"Learning To Rank ç ”ç©¶ä¸åº”ç”¨åŸæ–‡é“¾æ¥tensorflowäº¤äº’ç¨€ç–çŸ©é˜µè¿ç®—å¦‚ä½•åœ¨ spark åˆ†å¸ƒå¼çŸ©é˜µå®ç°ååŒè¿‡æ»¤æ¨èï¼ŸKylinçš„cubeæ¨¡å‹Apache Kylinå®‰è£…éƒ¨ç½²Deep Learning for NLP Best PracticesITç˜¾ç¤¾åŒºäº§å“æ•°æ®ä½“ç³»å»ºè®¾åŸºç¡€ï¼šä¸€ä¸ªäº§å“çš„æ•°æ®ä½“ç³»å»ºè®¾ä¿¡æ¯çš„åˆ†å¸ƒç‡å·ç§¯ç½‘ç»œç†è§£cnn ä¸º NLP å‡†å¤‡word2vec æ•°å­¦åŸç†ç†è§£","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/tags/æ¨è/"},{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://www.wortyby.com/tags/æ·±åº¦å­¦ä¹ /"}]},{"title":"ç¨€ç–çŸ©é˜µCompressed Sparse Row (CSR)å­˜å‚¨åŸç†","slug":"CSRå­˜å‚¨åŸç†","date":"2018-10-23T12:19:55.000Z","updated":"2018-10-23T12:19:55.000Z","comments":true,"path":"2018/10/23/CSRå­˜å‚¨åŸç†/","link":"","permalink":"http://www.wortyby.com/2018/10/23/CSRå­˜å‚¨åŸç†/","excerpt":"","text":"ä¸ºäº†è§£å†³é€šè¿‡one-hot è½¬åŒ–ä¹‹åï¼Œäº§ç”Ÿçš„é«˜ç»´æ•°æ®å­˜å‚¨é—®é¢˜ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ–°çš„å­˜å‚¨è¿‡ç¨‹è§å›¾ åŸç†å›¾ åŸç†è§£æé€šè¿‡å°†çŸ©é˜µçš„4x4çš„æ•°æ®å­˜å‚¨ä¸ºåªæœ‰ä¸‰è¡Œçš„ç»“æ„ä½“æ•°æ®çš„è¿‡ç¨‹æœ¬è´¨æ˜¯å°†æ•°æ®ä¸ä¸ºé›¶çš„æ•°æ®å­˜æ”¾å¥½å…·ä½“æ¥è¯´å°±æ˜¯ indptræœ€åä¸€ä¸ªæ•°å­—ä»£è¡¨data æ•°æ®ä¸€å…±æœ‰å‡ ä¸ªéé›¶å€¼ï¼Œå³æœ‰æ•ˆæ•°æ®ä½æ•°å…¶ä½™çš„æ•°å­—ä»£è¡¨çš„æ˜¯çŸ©é˜µä¸­çš„æ¯è¡Œçš„éé›¶æ•°æ®åœ¨ data(value) å­—æ®µé‡Œçš„çš„ç´¢å¼•å€¼,æ¯”å¦‚ &quot;1&quot;ä»£è¡¨çš„æ˜¯ çŸ©é˜µ ç¬¬é›¶è¡Œçš„ç¬¬é›¶ä¸ªæ•°æ®ï¼Œæ‰€ä»¥ row offsets = 0,ç»“åˆindices é‡Œçš„ç´¢å¼•ï¼Œå¯ä»¥å‡†ç¡®çš„è¿˜åŸå‡º çŸ©é˜µçš„æ•°æ®å½¢å¼ã€‚ indicesæ¯ä¸ªæ•°å­—ä»£è¡¨çš„æ˜¯data(value)å¯¹åº”çš„éé›¶æ•°æ®åœ¨çŸ©é˜µä¸­çš„å¯¹åº”çš„åˆ—ç´¢å¼•ï¼Œæ¯”å¦‚ &quot;7&quot;ä»£è¡¨çš„æ˜¯ çŸ©é˜µ ç¬¬é›¶è¡Œçš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œæ‰€ä»¥ indices = 1 dataçŸ©é˜µé‡Œçš„æ‰€æœ‰éé›¶æ•°æ®ç»“åˆ indptr å’Œ indices 2é¡¹æ•°æ®è¿›è¡Œè¿˜åŸæˆ matrix åŸç†å®ç°ä»£ç 12345678910111213141516171819# coding: utf-8from scipy.sparse.csr import csr_matrix docs = [[&quot;hello&quot;, &quot;world&quot;, &quot;hello&quot;], [&quot;goodbye&quot;, &quot;cruel&quot;, &quot;world&quot;]]indptr = [0] # å­˜æ”¾çš„æ˜¯è¡Œåç§»é‡indices = [] # å­˜æ”¾çš„æ˜¯dataä¸­å…ƒç´ å¯¹åº”çš„åˆ—ç¼–å·ï¼ˆåˆ—ç¼–å·å¯é‡å¤ï¼‰data = [] # å­˜æ”¾çš„æ˜¯é0æ•°æ®å…ƒç´ vocabulary = &#123;&#125; # keyæ˜¯wordè¯æ±‡ï¼Œvalueæ˜¯åˆ—ç¼–å·for d in docs: # éå†æ¯ä¸ªæ–‡æ¡£ for term in d: # éå†æ–‡æ¡£çš„æ¯ä¸ªè¯æ±‡term # setdefaultå¦‚æœtermä¸å­˜åœ¨ï¼Œåˆ™å°†æ–°termå’Œä»–çš„åˆ— # ç¼–å·len(vocabulary)åŠ å…¥åˆ°è¯å…¸ä¸­ï¼Œè¿”å›ä»–çš„ç¼–å·ï¼› # å¦‚æœtermå­˜åœ¨ï¼Œåˆ™ä¸å¡«åŠ ï¼Œè¿”å›å·²å­˜åœ¨çš„ç¼–å· index = vocabulary.setdefault(term, len(vocabulary)) indices.append(index) data.append(1) indptr.append(len(indices))# csr_matrixå¯ä»¥å°†åŒä¸€ä¸ªè¯æ±‡æ¬¡æ•°æ±‚å’Œcsr_matrix((data, indices, indptr), dtype=int).toarray()","categories":[{"name":"ç¼–ç ","slug":"ç¼–ç ","permalink":"http://www.wortyby.com/categories/ç¼–ç /"}],"tags":[{"name":"å­˜å‚¨","slug":"å­˜å‚¨","permalink":"http://www.wortyby.com/tags/å­˜å‚¨/"}]},{"title":"æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ€»ç»“","slug":"æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ€»ç»“ ","date":"2018-10-15T05:31:31.000Z","updated":"2018-10-15T05:31:31.000Z","comments":true,"path":"2018/10/15/æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ€»ç»“ /","link":"","permalink":"http://www.wortyby.com/2018/10/15/æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ€»ç»“ /","excerpt":"","text":"æ·±åº¦å­¦ä¹ åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨æ€»ç»“åŸæ–‡é“¾æ¥","categories":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/categories/æ¨è/"}],"tags":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/tags/æ¨è/"},{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://www.wortyby.com/tags/æ·±åº¦å­¦ä¹ /"}]},{"title":"æŸ¥è¯¢è¯-ç«™ç‚¹ç›¸å…³æ€§è®¡ç®—","slug":"æŸ¥è¯¢è¯-ç«™ç‚¹ç›¸å…³æ€§è®¡ç®—","date":"2018-10-15T05:19:38.000Z","updated":"2018-10-15T05:19:38.000Z","comments":true,"path":"2018/10/15/æŸ¥è¯¢è¯-ç«™ç‚¹ç›¸å…³æ€§è®¡ç®—/","link":"","permalink":"http://www.wortyby.com/2018/10/15/æŸ¥è¯¢è¯-ç«™ç‚¹ç›¸å…³æ€§è®¡ç®—/","excerpt":"","text":"å¼•è¨€åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ã€æ–‡æœ¬æŒ–æ˜ä¸­ï¼Œå¸¸å¸¸ä½¿ç”¨è¯å‘é‡ä½œä¸ºå•è¯ï¼ˆWordï¼‰å†…åœ¨å«ä¹‰çš„è¡¨è¾¾ï¼Œä»ä¼ ç»Ÿçš„å‘é‡è¡¨è¾¾åˆ°è¿‘å‡ å¹´çš„è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰è¡¨è¾¾ï¼Œè¯å‘é‡å·²ç»ä½œä¸ºä¸€ç§æ–‡æœ¬çš„å¸¸ç”¨ç‰¹å¾å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚ç±»ä¼¼çš„ï¼Œä¸€äº›ç ”ç©¶è€…å¸Œæœ›é€šè¿‡ç½‘ç»œç»“æ„ä¸­çš„è¿æ¥å…³ç³»ï¼Œå¾—åˆ°ç½‘ç»œä¸­é¡¶ç‚¹ï¼ˆvertexï¼‰çš„å‘é‡è¡¨ç¤ºï¼Œä½œä¸ºåŸºæœ¬ç‰¹å¾åº”ç”¨åˆ°èšç±»ã€åˆ†ç±»ç­‰ä»»åŠ¡ä¸Šã€‚æœ€è¿‘åœ¨ç ”ç©¶å›¾ç‰‡æœç´¢ä¸­å…³äºqueryå’Œsiteçš„å…³ç³»æ—¶ï¼Œå¸Œæœ›èƒ½é€šè¿‡å®ƒä»¬çš„è¿æ¥å…³ç³»å¾—åˆ°embeddingå‘é‡ä½œä¸ºç‰¹å¾ã€‚æœ¬æ–‡æ€»ç»“äº†5ç§è¿‘å‡ å¹´å¸¸ç”¨çš„å°†ç½‘ç»œç»“æ„ä¸­èŠ‚ç‚¹è½¬åŒ–ä¸ºèŠ‚ç‚¹å‘é‡çš„æ–¹æ³•ï¼Œä¸åŒç ”ç©¶è€…å¯¹è¿™ä¸€é—®é¢˜çš„å‘½åæœ‰å‡ºå…¥ï¼Œå¦‚node2vectorï¼Œgraph representationï¼Œnetwork embeddingç­‰ï¼Œä½†å®è´¨ä¸Šæ˜¯åŒä¸€ä¸ªé—®é¢˜ã€‚æ¥ä¸‹æ¥æœ¬æ–‡å¯¹deepwalkã€lineã€DNGRã€SDNEã€node2vectoräº”ç§æ–¹æ³•åˆ†åˆ«åšä»‹ç»ã€‚ DeepwalkDeepwalkæ¥æºäºã€ŠDeepWalk: Online Learning of Social Representationsã€‹è¿™ç¯‡è®ºæ–‡ï¼Œå®ƒçš„æ€æƒ³éå¸¸ç®€å•ï¼Œä¸»è¦å€Ÿé‰´äº†word2vecï¼Œå°†ç½‘ç»œç»“æ„é€šè¿‡Random walkçš„æ–¹å¼ï¼Œè½¬æ¢ä¸ºç±»ä¼¼â€œsentenceâ€çš„èŠ‚ç‚¹åºåˆ—çš„å½¢å¼ã€‚Word2Vecæ˜¯Mikolovå¸¦é¢†Googleç ”å‘çš„ç”¨æ¥äº§ç”Ÿè¯åµŒå…¥è¡¨è¾¾çš„æ¨¡å‹ï¼Œå…¶ä¸­åˆåŒ…æ‹¬skip-grams æˆ–continuous-bag-of-wordsï¼ˆCBOWï¼‰ä¸¤ç§æ–¹å¼ã€‚Word2Vecç›¸å…³ä»‹ç»å¾ˆå¤šï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°ã€‚åœ¨deepwalkçš„è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä¸ºäº†è¯´æ˜ç½‘ç»œç»“æ„ä¸­çš„èŠ‚ç‚¹å’Œæ–‡æœ¬ä¸­çš„è¯å…·æœ‰å¯æ¯”æ€§ï¼Œä½œè€…æ ¹æ®å¯¹ç¤¾äº¤ç½‘ç»œçš„å›¾å’ŒWikipediaä¸­çš„æ–‡æœ¬è¿›è¡Œåˆ†åˆ«ç»Ÿè®¡ï¼Œå‘ç°éƒ½éµå¾ªzipfâ€™så®šå¾‹ï¼Œè¯´æ˜è¯å’Œç»è¿‡Random walkåå›¾çš„èŠ‚ç‚¹ï¼Œå…·æœ‰ç›¸ä¼¼çš„ç‰¹æ€§ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå°†ç½‘ç»œç»“æ„è½¬åŒ–ä¸ºâ€œsentenceâ€åºåˆ—åï¼Œä»¥é€šè¿‡word2vecä¸­çš„Skip-gramæ¨¡å‹æˆ–è€…CBOWæ¨¡å‹ï¼Œè®­ç»ƒå¾—åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„å‘é‡è¡¨ç¤ºå½¢å¼ï¼Œè¿›è€Œå¯ä»¥ç”¨ä½™å¼¦è·ç¦»æˆ–è€…æ¬§å¼è·ç¦»æ¥æ±‚å¾—ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚è¿™ç¯‡è®ºæ–‡é‡‡ç”¨äº†Skip-gramæ¨¡å‹ã€‚Deepwalkç®—æ³•æè¿°ï¼Œè§ä¸‹å›¾ã€‚å¯¹å›¾Gï¼Œéšæœºé‡‡æ ·1ä¸ªèŠ‚ç‚¹vï¼Œç„¶åä»¥æ­¤ä¸ºèµ·ç‚¹è¿ç»­é‡‡æ ·ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§è·¯å¾„é•¿åº¦tï¼Œå†é€šè¿‡Skip-gramæ¥æ›´æ–°å‚æ•°ã€‚Deepwalkå®ç°å¾ˆç®€å•ï¼Œåœ¨ç½‘ç»œç»“æ„ä¸Šä¸»è¦è€ƒè™‘èŠ‚ç‚¹é—´æ˜¯å¦å­˜åœ¨è¿æ¥çš„è¾¹ï¼Œä½†æ˜¯æ•ˆæœç¨³å®šï¼Œåœ¨è¯„æµ‹æ•°æ®ä¸Šå–å¾—äº†å¾ˆä¸é”™çš„æ•ˆæœï¼Œä¸”ä»£ç å¥å£®ã€‚åœ¨åº”ç”¨ä¸Šdeepwalkæ”¯æŒdirected/undirectedç½‘ç»œï¼ŒåŸå§‹ä»£ç ä¸æ”¯æŒå¸¦æƒé‡çš„ç½‘ç»œç»“æ„ã€‚Deepwalkå·¥å…·åŒ…åœ°å€ï¼šdeepwalk LINELINEæ¨¡å‹æºäºè®ºæ–‡ã€ŠLINE: Large-scale Information Network Embeddingã€‹ï¼Œè¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸¤ä¸ªè§„åˆ™ï¼ˆorderï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡æ–‡ä¸­çš„ç¤ºä¾‹æ¥å…·ä½“ç†è§£è¿™ä¸¤ç§è§„åˆ™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºç½‘ç»œï¼šè¿™ä¸ªç½‘ç»œç»“æ„ä¸­ï¼Œå¯¹5ã€6ã€7ä¸‰ä¸ªèŠ‚ç‚¹è€Œè¨€ï¼Œæ ¹æ®first-orderæ¥è¯´6ã€7èŠ‚ç‚¹æ›´ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬æœ‰ä¸€æ¡ç›´æ¥ç›¸è¿çš„è¾¹ï¼›æ ¹æ®second-orderæ¥è¯´5ã€6èŠ‚ç‚¹æ›´ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬æœ‰å››ä¸ªå…¬å…±é‚»å±…èŠ‚ç‚¹ã€‚æ ¹æ®è¿™ä¸¤ç§è®¡ç®—ç›¸ä¼¼æ€§çš„è§„åˆ™ï¼Œè®ºæ–‡ä½œè€…ç›¸åº”çš„æå‡ºäº†ä¸¤ç§è®­ç»ƒèŠ‚ç‚¹å‘é‡çš„ç®—æ³•ã€‚First-orderï¼šè¿™ç§æ–¹æ³•ä¸»è¦è€ƒè™‘ä¸¤ä¸ªèŠ‚ç‚¹é—´çš„æ²¡æœ‰æ–¹å‘(undirected)çš„è¾¹ï¼Œç”¨è¡¨ç¤ºèŠ‚ç‚¹å‘é‡ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ä¸‹é¢çš„å¼å­è®¡ç®—èŠ‚ç‚¹å’Œçš„è”åˆæ¦‚ç‡ï¼šæ ¹æ®ç»éªŒï¼Œåœ¨ç½‘ç»œç»“æ„ä¸­å’Œè”åˆåˆ†å¸ƒçš„ç»éªŒæ¦‚ç‡å¯ä»¥è¡¨ç¤ºä¸ºï¼Œå…¶ä¸­ï¼Œæ¨¡å‹çš„ç›®æ ‡å‡½æ•°å°±æ˜¯å¸Œæœ›ä¼˜åŒ–ä¸¤ç§è”åˆæ¦‚ç‡çš„è·ç¦»å…¶ä¸­å‡½æ•°è¡¨ç¤ºä¸¤ç§åˆ†å¸ƒçš„â€œè·ç¦»â€ï¼Œè®ºæ–‡ä¸­é€‰ç”¨äº†KLæ•£åº¦æ¥è¡¡é‡ã€‚æ­¤æ—¶ï¼Œç›®æ ‡å‡½æ•°è½¬åŒ–ä¸ºSecond-orderï¼šç”±äºç¬¬äºŒè§„åˆ™ç€é‡è€ƒè™‘é‚»å±…èŠ‚ç‚¹å¯¹ä¸­å¿ƒèŠ‚ç‚¹çš„è¡¨è¾¾ï¼Œç±»ä¼¼äºæ–‡æœ¬ä¸­ä¸Šä¸‹æ–‡å¯¹ä¸­å¿ƒè¯çš„è¡¨è¾¾ï¼Œä¸Šä¸‹æ–‡ä¸€è‡´æ—¶ä¸¤ä¸ªä¸­å¿ƒè¯å°±ææœ‰å¯èƒ½ç›¸ä¼¼ï¼Œå› æ­¤åœ¨ç¬¬äºŒè§„åˆ™ä¸­å¯¹æœ‰å‘(directed)è¾¹ï¼Œå®šä¹‰äº†èŠ‚ç‚¹é—´çš„ç”Ÿæˆæ¦‚ç‡ï¼šæ ¹æ®ç»éªŒï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“èŠ‚ç‚¹ç”ŸæˆèŠ‚ç‚¹çš„æ¦‚ç‡ä¸ºï¼Œå…¶ä¸­è¡¨ç¤ºèŠ‚ç‚¹æŒ‡å‘æ‰€æœ‰è¾¹çš„æƒé‡å’Œã€‚é‚£ä¹ˆæ¨¡å‹çš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼šåŒæ ·é€‚ç”¨KLæ•£åº¦å®šä¹‰è·ç¦»ï¼Œä¸”ä½¿ï¼Œæ¶ˆå»å¸¸æ•°é¡¹ï¼Œå¯ä»¥ä½¿ç›®æ ‡å‡½æ•°è½¬åŒ–ä¸ºï¼šåœ¨Second-orderçš„ç›®æ ‡ç”Ÿæˆæ¦‚ç‡å‡½æ•°ä¸­å¯ä»¥å‘ç°ï¼Œå½“éœ€è¦è®¡ç®—èŠ‚ç‚¹iåˆ°èŠ‚ç‚¹jçš„è½¬ç§»æ¦‚ç‡æ—¶ï¼Œéœ€è¦è®¡ç®—æ‰€æœ‰å’ŒèŠ‚ç‚¹iç›¸é‚»èŠ‚ç‚¹çš„å†…ç§¯ï¼Œè¿™æ ·æ˜æ˜¾ä¼šæå¤§å¢åŠ æ±‚è§£è¿‡ç¨‹ä¸­çš„è®¡ç®—é‡ã€‚è®ºæ–‡ä½œè€…é‡‡ç”¨è´Ÿé‡‡æ ·ï¼ˆnegative samplingï¼‰çš„æ–¹æ³•å¯¹ç”Ÿæˆæ¦‚ç‡è¿›è¡Œæ›¿æ¢ï¼Œå¦‚ä¸‹é¢å¼å­æ‰€ç¤ºï¼šå…¶ä¸­æ˜¯sigmoidå‡½æ•°ï¼Œæ˜¯è´Ÿé‡‡æ ·çš„æ ·æœ¬ä¸ªæ•°ã€‚æ˜¯ä¸€ä¸ªè¡¨ç¤ºè´Ÿæ ·æœ¬åˆ†å¸ƒçš„å‚æ•°ï¼Œå…·ä½“å¯å‚çœ‹è®ºæ–‡ã€‚å‘æ•£æ€è€ƒï¼šæœ¬æ–‡ä½œè€…åœ¨è¿™ä¸¤ç§æ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œæå‡ºäº†ä¸€äº›å…·ä½“é—®é¢˜ä¸Šè¿›è¡Œè®¨è®ºã€‚ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ç½‘ç»œèŠ‚ç‚¹ä¸­ä½ç»´åº¦èŠ‚ç‚¹åº”è¯¥æ€æ ·è®­ç»ƒï¼Ÿä½ç»´åº¦èŠ‚ç‚¹æŒ‡çš„æ˜¯æŸäº›èŠ‚ç‚¹çš„â€œé‚»å±…èŠ‚ç‚¹â€å¤ªå°‘ï¼Œè¿™æ ·å¯ä¾›å…¶é‡‡é›†çš„æ ·æœ¬å°±å¾ˆå°‘ã€‚åœ¨è¿™äº›èŠ‚ç‚¹ä¸Šå­¦ä¹ åˆ°çš„ç‰¹å¾å°±å¾ˆå¼±ã€‚ä¸ºäº†å¢åŠ å…¶ä¿¡æ¯çš„ä¸°å¯Œæ€§ï¼Œä½œè€…å°è¯•ä½¿ç”¨æ„å»ºé‚»æ¥è¾¹çš„æ–¹å¼ä¸°å¯Œç½‘ç»œç»“æ„ï¼Œä¸»è¦æ€æƒ³æ˜¯å‡å¦‚å­˜åœ¨ä¸´è¾¹ ã€ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç¡®å®šå‡ºçš„æƒé‡ã€‚å…¬å¼å¦‚ä¸‹ï¼šç¬¬äºŒä¸ªé—®é¢˜æ˜¯é’ˆå¯¹ä¸€ä¸ªç½‘ç»œç»“æ„è®­ç»ƒå®Œæ¯•åï¼Œå¦‚ä½•æ·»åŠ å…¥æ–°çš„èŠ‚ç‚¹ï¼Ÿè¿™æ˜¯ä¸€ä¸ªåº”ç”¨æ€§å¾ˆå¼ºçš„é—®é¢˜ï¼Œå…¶æœ¬è´¨æ˜¯è¦è€ƒè™‘å¦‚ä½•ä¸é‡æ–°æ•´åˆå…¨å±€ä¿¡æ¯è€Œå¾—åˆ°æ–°åŠ å…¥èŠ‚ç‚¹åœ¨è¿™ä¸ªç©ºé—´ç»´åº¦çš„å‘é‡è¡¨è¾¾ã€‚åœ¨Word2Vecä¸­å°±å¯ä»¥å®ç°åœ¨è®­ç»ƒç»“æœçš„åŸºç¡€ä¸Šï¼ŒåŠ å…¥æ–°çš„è¯­æ–™ç»§ç»­ä¼˜åŒ–ã€‚åœ¨è¿™é‡Œï¼Œä½œè€…æå‡ºäº†ä¸€ä¸ªç®€å•çš„ä¼˜åŒ–ç›®æ ‡ï¼Œåœ¨ä¸æ”¹å˜åŸå§‹ç½‘ç»œä¸­èŠ‚ç‚¹å‘é‡çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æ–°èŠ‚ç‚¹çš„è¿æ¥å…³ç³»å¯¹æ–°èŠ‚ç‚¹è¿›è¡Œä¼˜åŒ–ã€‚ä¸¤ç§è§„åˆ™çš„ä¼˜åŒ–ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼šä¸¤ä¸ªç›®æ ‡å‡½æ•°è¾ƒæ˜“ç†è§£ï¼Œä¸å†èµ˜è¿°ã€‚é™¤äº†ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ï¼Œä½œè€…è¿˜å¯¹è¿™ä¸¤ç§å‘é‡çš„ç»“åˆé—®é¢˜åšäº†æ€è€ƒã€‚æ¯•ç«Ÿè¿™ä¸¤ç§æ–¹æ³•éƒ½æŒºä¸é”™ï¼Œå¦‚æœèƒ½ç»“åˆèµ·æ¥å­¦å‡ºæ¥ä¸€å¥—ç»¼åˆçš„å‘é‡æŒ‰ç†è¯´æ•ˆæœåº”è¯¥æ›´å¥½å•Šã€‚ä¸è¿‡å¾ˆé—æ†¾çš„æ˜¯ç”±äºè¿™ä¸¤ä¸ªæ–¹æ³•çš„å‡ºå‘ç‚¹ä¸ä¸€æ ·ï¼Œå¾ˆéš¾æŠŠä¸¤ç§ç®—æ³•ç»“åˆèµ·æ¥å­¦ä¹ ã€‚ä½†æ˜¯å´æœ‰ä¸€ç§ç®€å•ç²—æš´çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨ä¸¤ç§è§„åˆ™åˆ†åˆ«è®­ç»ƒï¼Œæœ€åç›´æ¥æŠŠä¸¤ä¸ªå‘é‡æ‹¼æ¥èµ·æ¥ã€‚æ•ˆæœåœ¨å…·ä½“ä»»åŠ¡ä¸Šè§ä»è§æ™ºå§ï¼Œæˆ‘åœ¨è‡ªå·±çš„ä»»åŠ¡ä¸Šè¯•éªŒè¿‡ï¼Œåè€Œæ¯”å•ç‹¬çš„æ•ˆæœè¿˜å·®ä¸€ç‚¹ï¼Œä¹Ÿæ˜¯å¾ˆä¸è§£ã€‚æœ‰å…´è¶£çš„ç«¥é‹å¯ä»¥å†ç ”ç©¶ç ”ç©¶ï¼Œæ²¡å‡†å°±èƒ½æä¸€ç¯‡ä¸é”™çš„è®ºæ–‡å‡ºæ¥ã€‚LINEå·¥å…·åŒ…ï¼šLINE Node2VectorNode2Vectorç®—æ³•æºäºè®ºæ–‡ã€Šnode2vec: Scalable Feature Learning for Networksã€‹ï¼Œè¿™ç¯‡è®ºæ–‡å¯ä»¥çœ‹ä½œæ˜¯deepwalkçš„å‡çº§ç‰ˆã€‚æ•´ä½“ä¸Šæ¥çœ‹ï¼ŒNode2Vectoråœ¨deepwalkçš„åŸºç¡€ä¸Šæ”¹å˜äº†èŠ‚ç‚¹æ¸¸èµ°çš„æ–¹å¼ï¼Œè€ƒè™‘äº†æ›´å¤šçš„ä¿¡æ¯ï¼Œdeepwalkåœ¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„é€‰æ‹©ä¸Šåªæ˜¯å¯¹å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹ä¸­randomé€‰æ‹©ä¸€ä¸ªï¼Œè€Œæœ¬æ–‡æ–¹æ³•å°±æ›´å¤æ‚äº›ï¼Œåœ¨ä¸€äº›è¯„æµ‹ä¸Šä¹Ÿå–å¾—äº†æ›´å¥½çš„æ•ˆæœã€‚ä¸‹é¢å°±å…·ä½“çœ‹ä¸€ä¸‹Node2Vecçš„å®ç°æ–¹æ³•ã€‚è®ºæ–‡ä½œè€…é¦–å…ˆæå‡ºäº†ç½‘ç»œèŠ‚ç‚¹é—´æ¸¸èµ°ï¼ˆé‡‡æ ·ï¼‰çš„ä¸¤ç§æ–¹å¼ï¼šBreadth-first Samplingï¼ˆBFSï¼‰å’ŒDepth-first Samplingï¼ˆDFSï¼‰ï¼Œå…¶å®æœ‰ç‚¹ç±»ä¼¼å¸¸è¯´çš„å¹¿æœå’Œæ·±æœã€‚æˆ‘ä»¬ç”¨è®ºæ–‡ä¸­çš„ä¸€å¼ å›¾æ¥è¯´æ˜è¿™ä¸¤ç§é‡‡æ ·æ–¹å¼ï¼šç›¸ä¿¡ä¸Šé¢è¿™å¼ å›¾å·²ç»ç›´è§‚çš„è§£é‡Šäº†BFSå’ŒDFSï¼Œä¸å†ç»†è¯´ã€‚è¿™ä¸¤ç§é‡‡æ ·æ–¹å¼é£æ ¼ä¸åŒï¼Œä½†å„æœ‰åƒç§‹ï¼Œéƒ½æŒºç¬¦åˆæˆ‘ä»¬çš„è®¤çŸ¥ï¼Œè®ºæ–‡ä½œè€…è§‰å¾—åº”è¯¥æŠŠä¸¤ç§é‡‡æ ·æ–¹å¼ç»“åˆèµ·æ¥å•Šï¼Œè¿™æ ·å²‚ä¸æ˜¯å¾ˆç‰›é€¼ï¼Ÿä½†æ˜¯æ€æ ·ç»“åˆæ˜¯ä¸€ä¸ªå¤§é—®é¢˜ã€‚ä¸ç€æ€¥ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªå›¾ï¼Œè¿™æ˜¯ä½œè€…è®ºæ–‡ä¸­çš„ä¸€å¼ å›¾ï¼šè¿™ç§å›¾å……åˆ†è¯´æ˜è®ºæ–‡ä½œè€…å¦‚ä½•å°†ä¸¤ç§æ¸¸èµ°æ–¹å¼ç»“åˆèµ·æ¥çš„ã€‚åœ¨deepwalkä¸­ï¼Œä¸€æ¡walkåºåˆ—ä»èŠ‚ç‚¹èµ°åˆ°èŠ‚ç‚¹ï¼Œæ¥ä¸‹æ¥å¾€å“ªé‡Œèµ°å‘¢ï¼Ÿå°±æ˜¯ä»éšæœºé€‰ä¸€ä¸ªï¼Œç„¶åä¾æ¬¡ç±»æ¨çš„å¾€ä¸‹èµ°ã€‚ä½†åœ¨Node2Vectorä¸­ä½œè€…å°†å››ä¸ªèŠ‚ç‚¹å…±åˆ†ä¸º3ç±»ï¼Œå¯¹å½“å‰èŠ‚ç‚¹(cur_node)æ¥è¯´ï¼ŒèŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹(pre_node)ï¼Œæ˜¯cur_nodeå’Œpre_nodeåŒæ—¶è¿æ¥çš„èŠ‚ç‚¹ï¼Œæ˜¯å…¶ä»–é‚»å±…èŠ‚ç‚¹ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å°†è¿™ä¸‰ç±»èŠ‚ç‚¹æŒ‰ç…§DFSå’ŒBFSçš„ç†è®ºå»åˆ†æï¼Œæ¯”å¦‚å†å¾€æƒ³//èµ°å°±æ˜¯DFSï¼Œå¾€/èµ°å°±æ˜¯BFSï¼Œæ€»è€Œè¨€ä¹‹è¿™äº›éƒ½å¯ä»¥ç®—æ˜¯ç‰©ç†æ„ä¹‰ä¸Šçš„è§£é‡Šå§ã€‚ä¸ºäº†å®ç°è¿™ç§ç»“åˆçš„æ¸¸èµ°æ–¹å¼ï¼Œä½œè€…å®šä¹‰äº†ã€ä¸¤ä¸ªå‚æ•°ï¼Œå°†è¿™ä¸‰ç±»èŠ‚ç‚¹çš„æ¦‚ç‡å€¼åˆ†åˆ«å®šä¹‰ä¸ºã€ã€ï¼Œå‚æ•°ã€æ˜¯ä½œä¸ºå‚æ•°ä¼ å…¥çš„ã€‚æ ¹æ®ç½‘ç»œç»“æ„çš„ä¸åŒç‰¹ç‚¹ï¼Œå¯ä»¥è°ƒæ•´ã€æ¥å®ç°å¯¹ä¸åŒé‡‡æ ·æ–¹å¼çš„åçˆ±ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šåˆ°è¿™é‡Œï¼Œé’ˆå¯¹èŠ‚ç‚¹tèƒ½æ¥è¯´ï¼Œæˆ‘ä»¬å¾—åˆ°äº†èƒ½è½¬ç§»åˆ°ä¸åŒç±»åˆ«èŠ‚ç‚¹çš„æ¦‚ç‡ï¼Œå¸¸è§„åšæ³•æ˜¯å½’ä¸€åŒ–ä¹‹åæŒ‰ç…§æ¦‚ç‡éšæœºé€‰å–ï¼Œä½†è¿™ç¯‡è®ºæ–‡å¹¶æ²¡æœ‰ç›´æ¥è¿™æ ·åšï¼Œè€Œæ˜¯é€‰ç”¨äº†Aliasç®—æ³•è¿›è¡ŒæŠ½æ ·ã€‚Aliasç®—æ³•ç›¸æ¯”è¾ƒäºç›´æ¥æŠ½æ ·æ–¹æ³•æ•ˆç‡ä¸Šè¦é«˜ä¸€äº›ï¼Œæ•ˆæœä¸Šè§ä»è§æ™ºï¼Œè¿™é‡Œä¸å†å…·ä½“ä»‹ç»ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°èŠ‚ç‚¹åºåˆ—ï¼Œå·²ç»å®Œæˆäº†æ•´ä¸ªç®—æ³•çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå› ä¸ºæ¥ä¸‹æ¥å°±æ˜¯ç›´æ¥ç”¨word2vecå¯¹èŠ‚ç‚¹åºåˆ—è¿›è¡Œè®­ç»ƒï¼ˆå¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆä»»æ€§ï¼‰å°±å¥½äº†ã€‚å¦å¤–ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”±äºåœ¨next_nodeçš„é€‰æ‹©ä¸Šéœ€è¦&lt;pre_node, cur_node&gt;ä¸¤ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œå› æ­¤åœ¨åˆå§‹çš„è½¬ç§»æ¦‚ç‡ç©ºé—´å¤æ‚åº¦ä¸Šå°±æ˜¯deepwalkçš„å¹³æ–¹ã€‚å½“èŠ‚ç‚¹ä¸ªæ•°è¾ƒå¤šçš„æ—¶å€™å¯èƒ½å‡ºç°out of memoryã€‚å½“ç„¶ï¼Œä¹Ÿç”±äºè¿™ç§æ¸¸èµ°æ–¹å¼çš„å¤æ‚æ€§ï¼Œåœ¨ç½‘ç»œèŠ‚ç‚¹çš„ä¸ªæ•°è¾ƒå°‘æ—¶ï¼Œnode2vecçš„æ•ˆæœæ•´ä½“ä¸Šè¦ä¼˜äºdeepwalkï¼Œä½†åœ¨èŠ‚ç‚¹å¤šåˆ°å¯èƒ½å½±å“ç©ºé—´é™åˆ¶æ—¶ï¼Œdeepwalkæ•ˆæœæ›´ä¼˜ã€‚Node2vecæºç ï¼šnode2vec SDNESNDEæ–¹æ³•æºäºè®ºæ–‡ã€ŠStructural Deep Network Embeddingã€‹ï¼Œè¿™ç¯‡è®ºæ–‡ä»Auto-encoderæ–¹æ³•ä¸Šè¿›è¡Œæ”¹è¿›ï¼Œä»è€Œå®ç°å¯¹ç½‘ç»œèŠ‚ç‚¹çš„embeddingã€‚Auto-encoderæ–¹æ³•ï¼Œç®€å•æ¥è¯´å¯ä»¥ç®—æ˜¯ä¸€ç§é™ç»´çš„æ–¹æ³•ï¼Œåœ¨å›¾ç‰‡åº”ç”¨ä¸Šæ¯”è¾ƒå¤šï¼Œå°†åŸå§‹çš„é«˜ç»´å‘é‡åœ¨å°½å¯èƒ½é¿å…ä¿¡æ¯ä¸¢å¤±çš„æƒ…å†µä¸‹é™ç»´å¾—åˆ°ç›®æ ‡ç»´åº¦çš„å‘é‡ã€‚Auto-encoderçš„ç½‘ç»œç»“æ„å¤§è‡´å¦‚ä¸‹ï¼šAuto-encoderç®—æ³•ä¸»è¦è¾¾åˆ°çš„æ˜¯ä¸€ä¸ªâ€œé™ç»´â€çš„ç›®çš„ï¼Œå¹¶ä¸èƒ½å­¦ä¹ å‡ºè¡¨ç¤ºèŠ‚ç‚¹å…³ç³»çš„embeddingè¡¨è¾¾ã€‚åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…é€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åŠ å…¥èŠ‚ç‚¹ä¿¡æ¯ä½¿å¾—å­¦ä¹ å‡ºçš„å‘é‡èƒ½è¿‡è¡¨ç¤ºå‡ºèŠ‚ç‚¹çš„å†…åœ¨å…³ç³»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»ä¸‹SDNEï¼Œå…ˆç»™å‡ºä¸‹é¢è¿™å¹…å›¾ï¼Œæè¿°äº†æ•´ä¸ªSDNEçš„ç½‘ç»œç»“æ„ï¼šç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸‹Auto-encoderï¼Œå°±æ˜¯ä¸Šå›¾ä¸­çš„å·¦è¾¹éƒ¨åˆ†ï¼Œç»™å®šä¸€ä¸ªåŸå§‹çš„å‡ºå…¥å‘é‡ï¼Œå¯ä»¥å¾—åˆ°ï¼šé€šè¿‡decoderçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç»ˆè¾“å‡ºï¼Œç›®æ ‡å‡½æ•°æ˜¯æœ€å°åŒ–è¾“å…¥å’Œè¾“å‡ºçš„è¯¯å·®ï¼šç¬¬äºŒæ­¥ï¼Œå¯¹Auto-encoderç®—æ³•åŠ å…¥æƒ©ç½šå› å­ã€‚åœ¨å›¾ç‰‡çš„è‡ªç¼–ç ä¸­ï¼Œç”±äºåŸå§‹è¾“å…¥çš„æ¯ä¸€ç»´åº¦éƒ½ä¸ä¸º0ï¼Œä½†æ˜¯åœ¨ç½‘ç»œç»“æ„ä¸­ï¼Œæˆ‘ä»¬å°†èŠ‚ç‚¹å’Œå…¶ä»–èŠ‚ç‚¹çš„å…³ç³»ï¼ˆ0ã€1å…³ç³»/æƒé‡å…³ç³»ï¼‰ä½œä¸ºè¯¥èŠ‚ç‚¹çš„åŸå§‹è¾“å…¥ã€‚å¯¹ä¸€äº›èŠ‚ç‚¹å¤šã€è¿æ¥å°‘çš„ç½‘ç»œç»“æ„è€Œè¨€ï¼ŒåŸå§‹è¾“å…¥ååˆ†ç¨€ç–ï¼Œè¿™ä¼šå¯¼è‡´encode/decodeåçš„å‘é‡æ›´è¶‹å‘é›¶å‘é‡ã€‚å› æ­¤å°†ç›®æ ‡å‡½æ•°æ”¹ä¸ºå¦‚ä¸‹ï¼šå…¶ä¸­ï¼Œè¡¨ç¤ºHadamardä¹˜æ³•,ï¼Œå¦‚æœï¼Œåˆ™,å¦åˆ™ã€‚ç¬¬ä¸‰æ­¥ï¼Œå­¦ä¹ èŠ‚ç‚¹é—´çš„å…³ç³»ä¿¡æ¯ã€‚è¿™æ˜¯è¿™ç¯‡è®ºæ–‡åœ¨Auto-encoderè¾ƒå¤§çš„æ”¹è¿›åº”ç”¨ã€‚ä½œè€…è®¤ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ç›´æ¥ç›¸è¿çš„æ—¶å€™ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„çŸ­å¤„å‘é‡yå°±åº”è¯¥æ›´ç›¸ä¼¼ã€‚åŸºäºè¿™ä¸ªç›®æ ‡ï¼Œèƒ½å¤Ÿå¾—åˆ°å¦‚ä¸‹losså‡½æ•°ï¼šå…¶ä¸­å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å›ºå®šç»´åº¦çš„æœ€ç»ˆå‘é‡ã€‚æœ€ç»ˆï¼ŒåŸºäºä»¥ä¸Šè¿™äº›ï¼Œä½œè€…ç»™å‡ºäº†æœ€ç»ˆçš„ç›®æ ‡å‡½æ•°ï¼šå‰ä¸¤é¡¹åœ¨åœ¨ä¸Šé¢å·²ç»è§£é‡Šè¿‡ï¼Œæœ€åä¸€é¡¹æ˜¯ä¸ªæ­£åˆ™åŒ–é¡¹é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œå®šä¹‰å¦‚ä¸‹ï¼šå…³äºæ±‚è§£è¿‡ç¨‹ä¸å†å…·ä½“é˜è¿°ã€‚ä»¥ä¸Šå°±æ˜¯SDNEçš„æ¨¡å‹æ¡†æ¶ã€‚ DNGRNDGRç®—æ³•æ¥æºäºè®ºæ–‡ã€ŠDeep Neural Networks for Learning Graph Representationsã€‹ï¼Œè¿™ç¯‡è®ºæ–‡å’ŒSDNEç®—æ³•æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œéƒ½åº”ç”¨äº†auto-encoderï¼Œä½†åœ¨å¦‚ä½•å­¦ä¹ èŠ‚ç‚¹é—´è¿æ¥ä¿¡æ¯çš„æ–¹æ³•ä¸Šå´å¦è¾Ÿè¹Šå¾„ã€‚SDNEä¸ºäº†å­¦ä¹ åˆ°é‚»æ¥èŠ‚ç‚¹çš„ç›¸ä¼¼ä¿¡æ¯ï¼Œåœ¨ç›®æ ‡å‡½æ•°ä¸­åŠ å…¥ä¸­é—´ç»“æœçš„losså‡½æ•°ï¼ˆå…·ä½“è§ä¸Šæ–‡ï¼‰ï¼Œè€Œæœ¬æ–‡åˆ™æ ¹æ®é‚»æ¥ä¿¡æ¯æ”¹å˜æ¯ä¸ªèŠ‚ç‚¹çš„åŸå§‹è¡¨è¾¾ï¼Œä½œä¸ºè‡ªç¼–ç æ¨¡å‹çš„è¾“å…¥ã€‚ç”±äºè¾“å…¥å‘é‡æœ¬èº«å°±å«æœ‰ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼Œå› æ­¤ç»è¿‡â€œå‹ç¼©â€åçš„å‘é‡ä¹Ÿèƒ½è¡¨è¾¾èŠ‚ç‚¹å…³ç³»ã€‚å…·ä½“æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ä»‹ç»ã€‚ç¬¬ä¸€æ­¥ï¼Œé€šè¿‡random surfingæ¨¡å‹å¾—åˆ°æ¦‚ç‡å…±ç°çŸ©é˜µã€‚ä½œè€…è®¤ä¸ºå°†ç½‘ç»œèŠ‚ç‚¹è½¬åŒ–ä¸ºåºåˆ—å¯èƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚åºåˆ—é•¿åº¦ï¼Œé‡‡æ ·æ¬¡æ•°ï¼Œè¿™äº›éƒ½ä¸å¥½ç¡®å®šã€‚æ ¹æ®PageRankç®—æ³•çš„å¯å‘ï¼Œä½œè€…å¸Œæœ›é€šè¿‡æ¦‚ç‡è½¬ç§»çŸ©é˜µ/é‚»æ¥çŸ©é˜µAå­¦ä¹ åˆ°ç½‘ç»œç»“æ„ä¿¡æ¯ã€‚ç”±äºæ­¥éª¤è¾ƒä¸ºç®€å•ä¸”ä¾¿äºç†è§£ï¼Œæ­¤å¤„ç›´æ¥é€šè¿‡matlabä»£ç æ¥è¯´æ˜:å…¶ä¸­Aæ˜¯åŸå§‹é‚»æ¥/æ¦‚ç‡è½¬ç§»çŸ©é˜µï¼Œalphaæ˜¯å¹³æ»‘å‚æ•°ï¼Œå†³å®šèŠ‚ç‚¹æ˜¯å¦éœ€è¦è½¬ç§»ã€‚P0å’ŒMçŸ©é˜µåˆå§‹åˆ†åˆ«æ˜¯å•ä½çŸ©é˜µå’Œå…¨0çŸ©é˜µï¼ŒMæ˜¯æœ€ç»ˆäº§å‡ºç»“æœã€‚ScaleSimMatæ˜¯å¯¹çŸ©é˜µè¿›è¡Œä¸»å¯¹è§’çº¿ç½®0åï¼Œå¯¹æ¯åˆ—è¿›è¡Œå½’ä¸€åŒ–ã€‚ç¬¬äºŒæ­¥æ˜¯å¾—åˆ°PPMIçŸ©é˜µï¼Œå¯¹ä¸Šæ­¥å¾—åˆ°çš„çŸ©é˜µè¿›è¡Œå¤„ç†ã€‚å…¶ä¸­PMI(pointwise mutual informationï¼Œç‚¹äº’ä¿¡æ¯)å®šä¹‰å¦‚ä¸‹ï¼šåœ¨PMIçš„åŸºç¡€ä¸Šï¼Œå¯¹å€¼ä¸ºè´Ÿçš„å…ƒç´ ï¼Œå…¨éƒ¨ç½®ä¸º0ï¼Œå¾—åˆ°PPMIçŸ©é˜µã€‚ç¬¬ä¸‰æ­¥æ˜¯è¿›è¡Œè‡ªç¼–ç ï¼Œè®ºæ–‡ä½œè€…ä½¿ç”¨äº†SDAE(stacked denoising autoencoders)ç¼–ç ã€‚SDAEå’ŒAEçš„å·®è·ä¸å¤§ï¼Œä¸»è¦åŒºåˆ«æ˜¯åœ¨è®­ç»ƒä¹‹å‰å¯¹inputå‘é‡è¿›è¡Œäº†å®¹é”™å¤„ç†ï¼Œå…·ä½“åšæ³•æ˜¯æŒ‰ç…§ä¸€å®šçš„æ–¹å¼å¯¹inputå‘é‡ä¸­çš„å°‘éƒ¨åˆ†å…ƒç´ ç½®0ï¼Œè¿™æ ·å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šå¯¹è¾“å…¥å‘é‡çš„ä¾èµ–ç¨‹åº¦ï¼Œæé«˜æ•´ä½“çš„å­¦ä¹ æ•ˆæœã€‚å…·ä½“encode/decodeçš„è¿‡ç¨‹å’ŒAEåŸºæœ¬ä¸€è‡´ï¼Œå¯ä»¥åœ¨SDNEæ–¹æ³•ä¸­çœ‹åˆ°ã€‚DNGRæ–¹æ³•åœ¨ç¼–ç ä¹‹å‰ï¼Œé€šè¿‡è½¬ç§»çŸ©é˜µå­¦ä¹ åˆ°èŠ‚ç‚¹é—´çš„è¿æ¥ä¿¡æ¯ï¼Œå’ŒSDNEæœ‰å…±é€šä¹‹å¤„ã€‚ä½†åœ¨å®é™…åº”ç”¨è¿‡ç¨‹ä¸­å´ä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œå¯ä»¥åœ¨ä¸Šåˆ—æ­¥éª¤ä¸­çœ‹åˆ°éœ€è¦è¿›è¡ŒçŸ©é˜µè¿ç®—ï¼Œå½“ç½‘ç»œèŠ‚ç‚¹å¾ˆå¤šæ—¶ï¼Œå°±è¦é¢ä¸´å¤§å‹çŸ©é˜µçš„è¿ç®—é—®é¢˜ï¼Œéœ€è¦å•ç‹¬å°†çŸ©é˜µè¿ç®—éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼Œåˆ©ç”¨Hadoopç­‰æ–¹å¼è¿ç®—ï¼ˆä¸»è¦æ˜¯å¤§å‹çŸ©é˜µçš„å­˜å‚¨ï¼‰ã€‚ç¬”è€…å°è¯•ä¸€èˆ¬è¶…è¿‡5WèŠ‚ç‚¹ååŸºæœ¬å•æœºæ˜¯éš¾ä»¥ç›´æ¥å®ç°çš„ï¼Œå› æ­¤åœ¨å·¥ä¸šå®ç°ä¸Šè¿˜éœ€è¦å…·ä½“æ”¹è¿›ç®—æ³•ã€‚DNGRå·¥å…·åŒ…ï¼šDNGRï¼ˆmatlabï¼‰ DNGR-Keras(python) å®è·µåœ¨å®é™…å·¥ä½œä¸­ï¼Œè€ƒè™‘åˆ°æ•ˆç‡å’Œæ€§èƒ½ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé€‰æ‹©æœ€ç®€å•çš„æ¨¡å‹è¿›è¡Œå°è¯•ï¼Œå› æ­¤æˆ‘ä»¬é€‰ç”¨Deepwalkä½œä¸ºæˆ‘ä»¬æ¢ç´¢queryå’Œsiteç›¸å…³æ€§çš„é¦–é€‰æ¨¡å‹ã€‚æ•°æ®æ¥æºï¼šä»Useræœç´¢æ—¥å¿—ä¸­ï¼Œéšæœºé€‰æ‹©60W queryï¼Œæ‰“å‹è‡³æœç‹—å›¾ç‰‡æœç´¢ï¼Œçˆ¬å–é¦–é¡µç»“æœã€‚å¯ä»¥å¾—åˆ°å¤§çº¦60w * 24 å¯¹queryå’Œsiteçš„å…³ç³»(å›¾ç‰‡ç»“æœé¡µé¦–é¡µæœ‰24å¼ )ã€‚æ•°æ®ç”Ÿæˆï¼šé€šè¿‡queryå’Œsiteçš„é“¾æ¥å…³ç³»ï¼Œç”ŸæˆåŸºäºquery-siteçš„äºŒéƒ¨å›¾ï¼Œå†é€šè¿‡é‚»æ¥è¡¨çš„å½¢å¼ï¼Œå°†äºŒéƒ¨å›¾è¡¨ç¤ºå‡ºæ¥ã€‚å¦‚ä¸‹å¦‚æ‰€ç¤ºï¼šå‘é‡ç”Ÿæˆï¼šå°†è¿™ä¸ªå¤„ç†åçš„æ–‡ä»¶ä½œä¸ºDeepwalkçš„è¾“å…¥ï¼Œä¹‹åå°±å¯ä»¥é€šè¿‡ç±»ä¼¼word2vecçš„æ–¹å¼æ˜¾ç¤ºæ•ˆæœäº†ã€‚æœªç™»å½•queryå¤„ç†ï¼šå¯èƒ½ä½ å·²ç»å‘ç°ï¼Œä¸Šé¢ç”Ÿæˆçš„å‘é‡ï¼ŒåªåŒ…å«é€‰å–çš„é‚£äº›queryå’Œsiteï¼Œå¤§çº¦21Wqueryå’Œ40Wsiteï¼Œé’ˆå¯¹æœªç™»å½•çš„siteï¼Œæˆ‘ä»¬è®¤ä¸ºå¾ˆå¯èƒ½ç«™ç‚¹å¤ªå°æˆ–è€…æœ‰æ˜¯åƒåœ¾ç«™ç‚¹ï¼Œå¯¹æ•´ä½“æ•ˆæœå½±å“ä¸å¤§ï¼Œå› æ­¤å¿½ç•¥ä¸è®¡ã€‚è¿™é‡Œä¸»è¦é’ˆå¯¹æœªç™»å½•çš„queryè¿›è¡Œå¤„ç†ã€‚æœ€ç›´æ¥çš„æƒ³æ³•ï¼Œå½“ä¸€ä¸ªæ–°çš„queryåˆ°æ¥æ—¶ï¼Œæ˜¯å¦å¯ä»¥ä»å·²çŸ¥queryä¸­æ‰¾åˆ°ä¸€ä¸ªè¯­ä¹‰æœ€ç›¸è¿‘çš„queryæ¥è¡¨ç¤ºè¿™ä¸ªæœªç™»å½•queryå‘¢ï¼Ÿç„¶è€Œï¼Œè¿™ä¸ªæ–¹æ³•å±€é™æ€§ä¹Ÿå¾ˆå¤§ï¼Œå¾ˆéš¾ä¿è¯å·²çŸ¥queryçš„è¯­ä¹‰éƒ½èƒ½è¦†ç›–åˆ°ã€‚é‚£ä¹ˆè¿›ä¸€æ­¥åœ°æ€è€ƒï¼Œæ˜¯å¦æˆ‘ä»¬å¯ä»¥é€šè¿‡queryä½œä¸ºæ¡¥æ¢ï¼Œå­¦ä¹ siteç©ºé—´å’Œæ–‡æœ¬ç©ºé—´çš„ä¸€ä¸ªæ˜ å°„å…³ç³»å‘¢ï¼Ÿæœ‰äº†è¿™ä¸ªå…³ç³»ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†æ–‡æœ¬ç©ºé—´çš„queryæ˜ å°„åˆ°siteç©ºé—´ï¼Œè¿›è€Œå¯ä»¥å’Œsiteè®¡ç®—ç›¸ä¼¼åº¦äº†ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº† DSSM (Deep Structured Semantic Model)æ¥å­¦ä¹ ä¸åŒè¯­ä¹‰ç©ºé—´çš„å…³ç³»ã€‚è¿™æ ·ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªqueryï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è·å–ä¸å…¶ç›¸å…³çš„siteä¿¡æ¯äº†ã€‚Demoå±•ç¤ºï¼šä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿï¼Œæˆ‘ä»¬æ­å»ºäº†ä¸€ä¸ªDemoè§‚å¯Ÿæ•ˆæœã€‚å¯ä»¥çœ‹åˆ°ï¼Œæœ‰æ˜æ˜¾å›¾ç‰‡æ„å›¾çš„queryæˆ–è€…å‚ç›´ç±»ç«™ç‚¹æ•ˆæœéƒ½ä¸é”™ï¼Œä½†æ˜¯æ¯”å¦‚http://nipic.comè¿™ç§ç»¼åˆç±»çš„ç«™ç‚¹ï¼Œå¯¹åº”çš„queryç§ç±»ä¹Ÿæ¯”è¾ƒå¤šï¼Œæ•ˆæœå¹¶ä¸ç†æƒ³ã€‚ å°ç»“ï¼šä»¥ä¸Šäº”ç§æ–¹æ³•ä¸­ï¼Œæ•´ä½“æ¥è¯´deepwalkå’Œnode2vectorä¸€è„‰ç›¸æ‰¿ï¼ŒDNGRå’ŒSDNEå¼‚æ›²åŒå·¥ï¼ŒLINEåœ¨æ²¡æœ‰ç›´æ¥å€ŸåŠ©ç°æˆå·¥å…·ï¼Œä½†æ€æƒ³ä¸Šå’Œå‰é¢ä¸¤ç§æ–¹æ³•æ›´æ¥è¿‘ã€‚ä»æ•ˆæœä¸Šæ¥è¯´ï¼Œdeepwalkåœ¨å¤§å‹ç½‘ç»œä¸Šæ¯”å°ç½‘ç»œä¸Šæ•ˆæœè¦å¥½ï¼Œæºäºå…¶å®Œå…¨éšæœºçš„æ¸¸èµ°æ–¹å¼éœ€è¦å¤§æ•°æ®ä½åŸºç¡€ï¼Œåœ¨å°å‹ç½‘ç»œä¸Š node2vector æ¯” deepwalk æ•ˆæœæ•´ä½“å¥½ä¸€äº›ã€‚åœ¨å…·ä½“åº”ç”¨ä¸Š, deepwalk å’Œ LINE å¯¹å¤§æ•°æ®çš„é€‚åº”æ€§æ›´å¥½ï¼Œå…¶ä½™ä¸‰ç§æ–¹æ³•åŸå§‹ä»£ç å¯¹å¤§å‹ç½‘ç»œï¼ˆèŠ‚ç‚¹&gt;5Wï¼‰éš¾ä»¥å®ç°ï¼Œéœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼æ”¹è¿›ã€‚åŸæ–‡é“¾æ¥","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"æ¦‚ç‡è®º","slug":"æ¦‚ç‡è®º","permalink":"http://www.wortyby.com/tags/æ¦‚ç‡è®º/"},{"name":"çº¿æ€§ä»£æ•°","slug":"çº¿æ€§ä»£æ•°","permalink":"http://www.wortyby.com/tags/çº¿æ€§ä»£æ•°/"},{"name":"æœç´¢","slug":"æœç´¢","permalink":"http://www.wortyby.com/tags/æœç´¢/"},{"name":"å…³è”å…³ç³»","slug":"å…³è”å…³ç³»","permalink":"http://www.wortyby.com/tags/å…³è”å…³ç³»/"}]},{"title":"ä¸»æˆåˆ†åˆ†æ(PCA)å’Œå¥‡å¼‚å€¼åˆ†è§£(SVD)","slug":"ä¸»æˆåˆ†åˆ†æ(PCA)å’Œå¥‡å¼‚å€¼åˆ†è§£(SVD)","date":"2018-10-12T06:00:24.000Z","updated":"2018-10-12T06:00:24.000Z","comments":true,"path":"2018/10/12/ä¸»æˆåˆ†åˆ†æ(PCA)å’Œå¥‡å¼‚å€¼åˆ†è§£(SVD)/","link":"","permalink":"http://www.wortyby.com/2018/10/12/ä¸»æˆåˆ†åˆ†æ(PCA)å’Œå¥‡å¼‚å€¼åˆ†è§£(SVD)/","excerpt":"","text":"å¼•å­ç‰¹å¾æŠ½å–çš„ç›®æ ‡æ˜¯æ ¹æ®åŸå§‹çš„dä¸ªç‰¹å¾çš„ç»„åˆå½¢æˆkä¸ªæ–°çš„ç‰¹å¾ï¼Œå³å°†æ•°æ®ä»dç»´ç©ºé—´æ˜ å°„åˆ°kç»´ç©ºé—´ã€‚ åœ¨æ–‡æœ¬åˆ†æé¢†åŸŸå¸¸ç”¨çš„é™ç»´æ–¹æ³•æ˜¯ä¸»æˆåˆ†åˆ†æï¼ˆPrincipalComponent Analysis, PCAï¼‰å’Œå¥‡å¼‚å€¼åˆ†è§£ï¼ˆSingular ValueDecompositionï¼Œ SVDï¼‰ã€‚åœ¨ä¸‹æ–‡çš„å™è¿°ä¸­ï¼Œå°†æ²¿è¢­æœºå™¨å­¦ä¹ çš„å¸¸ç”¨ç¬¦å·ï¼Œä½¿ç”¨xè¡¨ç¤ºä¸€ä¸ªåˆ—å‘é‡ï¼Œå®ƒæ˜¯æ ·æœ¬xåœ¨dç»´ç©ºé—´ä¸­çš„ç‚¹ã€‚è€Œç”±nä¸ªæ ·æœ¬æ„æˆçš„æ•°æ®é›†å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªdÃ—nçš„çŸ©é˜µX PCAPCAèƒŒåçš„æ•°å­¦åŸºç¡€æ˜¯ç‰¹å¾å€¼åˆ†æï¼Œå³Î£v=Î»v,væ˜¯ç‰¹å¾å‘é‡ï¼ŒÎ»æ˜¯ç‰¹å¾å€¼ã€‚PCAçš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–æ•°æ®é—´ç´¯ç§¯æ–¹å·®ã€‚ PCA ä¸€èˆ¬è¿‡ç¨‹æ˜¯å»é™¤å¹³å‡å€¼:means;è®¡ç®—Xçš„åæ–¹å·®çŸ©é˜µ Î£;è®¡ç®— Î£ çš„ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼(ç‰¹å¾å‘é‡ç”¨åˆ—å‘é‡ v_dÃ—1 è¡¨ç¤º)ï¼›å°†ç‰¹å¾å€¼ä»å¤§åˆ°å°æ’åºï¼›ä¿ç•™æœ€ä¸Šé¢çš„kä¸ªç‰¹å¾å‘é‡ï¼ˆè¿™kä¸ªç‰¹å¾å‘é‡ä¿è¯äº†æ•°æ®æ˜ å°„åˆ°ç‰¹å¾å€¼æœ€å¤§çš„ç‰¹å¾å‘é‡çš„æ–¹å‘æ—¶ï¼Œæ•°æ®é—´çš„ç´¯ç§¯æ–¹å·®æœ€å¤§ï¼Œæ•°æ®æ˜ å°„åˆ°ç¬¬äºŒå¤§çš„ç‰¹å¾å‘é‡æ—¶ï¼Œæ•°æ®é—´çš„ç´¯ç§¯æ–¹å·®æ¬¡ä¹‹ï¼Œä¸”ç‰¹å¾å‘é‡ä¹‹é—´ä¿æŒæ­£äº¤ï¼‰æ„æˆçš„ç‰¹å¾å‘é‡çŸ©é˜µ V_dÃ—k;å°†æ•°æ®è½¬æ¢åˆ°ä¸Šè¿°kä¸ªç‰¹å¾å‘é‡æ„å»ºçš„æ–°ç©ºé—´ä¸­V^T*X=A_kÃ—n +means,Aæ˜¯ä¸€ä¸ªkÃ—nçš„çŸ©é˜µï¼‰ SVDSVDå°†åŸå§‹çš„æ•°æ®é›†Xåˆ†è§£æˆä¸‰ä¸ªçŸ©é˜µUï¼ŒÎ£å’ŒV^T:X_dÃ—n=U_dÃ—dÎ£_dÃ—nV^T_nÃ—nå…¶ä¸­æ˜¯å¯¹è§’çŸ©é˜µï¼Œå¯¹è§’å…ƒç´ æˆä¸ºå¥‡å¼‚å€¼ï¼Œè¿™äº›å¥‡å¼‚å€¼æ˜¯çŸ©é˜µX*X^Tç‰¹å¾å€¼çš„å¹³æ–¹æ ¹ã€‚å°†å¥‡å¼‚å€¼ä»å¤§åˆ°å°æ’åºåï¼Œè‹¥è®¾å®šæ–°ç©ºé—´çš„ç»´åº¦ä¸ºkï¼ˆkV^T_kÃ—nå’ŒU_dÃ—kã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"ç‰¹å¾å·¥ç¨‹","slug":"ç‰¹å¾å·¥ç¨‹","permalink":"http://www.wortyby.com/tags/ç‰¹å¾å·¥ç¨‹/"},{"name":"ç‰¹å¾å‘é‡","slug":"ç‰¹å¾å‘é‡","permalink":"http://www.wortyby.com/tags/ç‰¹å¾å‘é‡/"},{"name":"çº¿æ€§ä»£æ•°","slug":"çº¿æ€§ä»£æ•°","permalink":"http://www.wortyby.com/tags/çº¿æ€§ä»£æ•°/"},{"name":"PCA","slug":"PCA","permalink":"http://www.wortyby.com/tags/PCA/"},{"name":"SVD","slug":"SVD","permalink":"http://www.wortyby.com/tags/SVD/"}]},{"title":"PCA çš„æ•°å­¦åŸç†","slug":"PCAçš„æ•°å­¦åŸç†","date":"2018-10-12T05:46:26.000Z","updated":"2018-10-12T05:46:26.000Z","comments":true,"path":"2018/10/12/PCAçš„æ•°å­¦åŸç†/","link":"","permalink":"http://www.wortyby.com/2018/10/12/PCAçš„æ•°å­¦åŸç†/","excerpt":"","text":"å¼•å­çŸ©é˜µç›¸ä¹˜æœ¬è´¨æ˜¯è¿›è¡Œé™ç»´å˜æ¢;çº¿æ€§å˜æ¢æ˜¯æ±‚å¾—å°½å¯èƒ½çš„ä¸ç›¸å…³ä¿¡æ¯æ¥æœ€å¤§è¡¨å¾åŸå§‹ä¿¡æ¯çš„è¿‡ç¨‹;åŸºç¡€è§£ç³»æ˜¯ç”¨æ¥å°†çº¿æ€§ç›¸å…³çš„ç‰¹å¾è¿›è¡Œçº¿æ€§æ— å…³å˜æ¢çš„æ•°å­¦å·¥å…·ã€‚ä½†å‘é‡ç»„çš„åŸºç¡€è§£ç³»ä¸å”¯ä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½å°½å¯èƒ½ç‹¬ç«‹çš„ç‰¹å¾å‘é‡ç»„ï¼Œå°±éœ€è¦å€ŸåŠ© æ–¹å·®ä¸åæ–¹å·® æ¥è¿›è¡Œåˆ†æç‰¹å¾å‘é‡åˆ†å¸ƒçŠ¶å†µï¼Œä»è€Œæ‰¾åˆ°èƒ½å°½å¯èƒ½è¡¨å¾å‘é‡ç»„çš„åŸºç¡€è§£ç³»ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ PCA?å¯¹äºé«˜é˜¶ç›¸å…³æ€§æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘ kernel PCA ã€‚æœ‰äº†ä¸Šé¢è°ˆåˆ°çš„æ•°å­¦èƒŒæ™¯ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥è°ˆè°ˆPCA(Principal Component Analysis)çš„æ•°å­¦åŸç†ã€‚ PCA çš„æ•°å­¦åŸç†PCAï¼ˆPrincipal Component Analysisï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„æ•°æ®åˆ†ææ–¹æ³•ã€‚PCAé€šè¿‡çº¿æ€§å˜æ¢å°†åŸå§‹æ•°æ®å˜æ¢ä¸ºä¸€ç»„å„ç»´åº¦çº¿æ€§æ— å…³çš„è¡¨ç¤ºï¼Œå¯ç”¨äºæå–æ•°æ®çš„ä¸»è¦ç‰¹å¾åˆ†é‡ï¼Œå¸¸ç”¨äºé«˜ç»´æ•°æ®çš„é™ç»´ã€‚ç½‘ä¸Šå…³äºPCAçš„æ–‡ç« æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¤§å¤šæ•°åªæè¿°äº†PCAçš„åˆ†æè¿‡ç¨‹ï¼Œè€Œæ²¡æœ‰è®²è¿°å…¶ä¸­çš„åŸç†ã€‚è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ä»‹ç»PCAçš„åŸºæœ¬æ•°å­¦åŸç†ï¼Œå¸®åŠ©è¯»è€…äº†è§£PCAçš„å·¥ä½œæœºåˆ¶æ˜¯ä»€ä¹ˆã€‚å½“ç„¶æˆ‘å¹¶ä¸æ‰“ç®—æŠŠæ–‡ç« å†™æˆçº¯æ•°å­¦æ–‡ç« ï¼Œè€Œæ˜¯å¸Œæœ›ç”¨ç›´è§‚å’Œæ˜“æ‡‚çš„æ–¹å¼å™è¿°PCAçš„æ•°å­¦åŸç†ï¼Œæ‰€ä»¥æ•´ä¸ªæ–‡ç« ä¸ä¼šå¼•å…¥ä¸¥æ ¼çš„æ•°å­¦æ¨å¯¼ã€‚å¸Œæœ›è¯»è€…åœ¨çœ‹å®Œè¿™ç¯‡æ–‡ç« åèƒ½æ›´å¥½çš„æ˜ç™½PCAçš„å·¥ä½œåŸç†ã€‚ æ•°æ®çš„å‘é‡è¡¨ç¤ºåŠé™ç»´é—®é¢˜ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨æ•°æ®æŒ–æ˜å’Œæœºå™¨å­¦ä¹ ä¸­ï¼Œæ•°æ®è¢«è¡¨ç¤ºä¸ºå‘é‡ã€‚ä¾‹å¦‚æŸä¸ªæ·˜å®åº—2012å¹´å…¨å¹´çš„æµé‡åŠäº¤æ˜“æƒ…å†µå¯ä»¥çœ‹æˆä¸€ç»„è®°å½•çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸€å¤©çš„æ•°æ®æ˜¯ä¸€æ¡è®°å½•ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š(æ—¥æœŸ, æµè§ˆé‡, è®¿å®¢æ•°, ä¸‹å•æ•°, æˆäº¤æ•°, æˆäº¤é‡‘é¢)å…¶ä¸­â€œæ—¥æœŸâ€æ˜¯ä¸€ä¸ªè®°å½•æ ‡å¿—è€Œéåº¦é‡å€¼ï¼Œè€Œæ•°æ®æŒ–æ˜å…³å¿ƒçš„å¤§å¤šæ˜¯åº¦é‡å€¼ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬å¿½ç•¥æ—¥æœŸè¿™ä¸ªå­—æ®µåï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ç»„è®°å½•ï¼Œæ¯æ¡è®°å½•å¯ä»¥è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªäº”ç»´å‘é‡ï¼Œå…¶ä¸­ä¸€æ¡çœ‹èµ·æ¥å¤§çº¦æ˜¯è¿™ä¸ªæ ·å­:(500,240,25,13,2312.15)Tæ³¨æ„è¿™é‡Œæˆ‘ç”¨äº†è½¬ç½®ï¼Œå› ä¸ºä¹ æƒ¯ä¸Šä½¿ç”¨åˆ—å‘é‡è¡¨ç¤ºä¸€æ¡è®°å½•ï¼ˆåé¢ä¼šçœ‹åˆ°åŸå› ï¼‰ï¼Œæœ¬æ–‡åé¢ä¹Ÿä¼šéµå¾ªè¿™ä¸ªå‡†åˆ™ã€‚ä¸è¿‡ä¸ºäº†æ–¹ä¾¿æœ‰æ—¶æˆ‘ä¼šçœç•¥è½¬ç½®ç¬¦å·ï¼Œä½†æˆ‘ä»¬è¯´åˆ°å‘é‡é»˜è®¤éƒ½æ˜¯æŒ‡åˆ—å‘é‡ã€‚æˆ‘ä»¬å½“ç„¶å¯ä»¥å¯¹è¿™ä¸€ç»„äº”ç»´å‘é‡è¿›è¡Œåˆ†æå’ŒæŒ–æ˜ï¼Œä¸è¿‡æˆ‘ä»¬çŸ¥é“ï¼Œå¾ˆå¤šæœºå™¨å­¦ä¹ ç®—æ³•çš„å¤æ‚åº¦å’Œæ•°æ®çš„ç»´æ•°æœ‰ç€å¯†åˆ‡å…³ç³»ï¼Œç”šè‡³ä¸ç»´æ•°å‘ˆæŒ‡æ•°çº§å…³è”ã€‚å½“ç„¶ï¼Œè¿™é‡ŒåŒºåŒºäº”ç»´çš„æ•°æ®ï¼Œä¹Ÿè®¸è¿˜æ— æ‰€è°“ï¼Œä½†æ˜¯å®é™…æœºå™¨å­¦ä¹ ä¸­å¤„ç†æˆåƒä¸Šä¸‡ç”šè‡³å‡ åä¸‡ç»´çš„æƒ…å†µä¹Ÿå¹¶ä¸ç½•è§ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœºå™¨å­¦ä¹ çš„èµ„æºæ¶ˆè€—æ˜¯ä¸å¯æ¥å—çš„ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»å¯¹æ•°æ®è¿›è¡Œé™ç»´ã€‚é™ç»´å½“ç„¶æ„å‘³ç€ä¿¡æ¯çš„ä¸¢å¤±ï¼Œä¸è¿‡é‰´äºå®é™…æ•°æ®æœ¬èº«å¸¸å¸¸å­˜åœ¨çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•åœ¨é™ç»´çš„åŒæ—¶å°†ä¿¡æ¯çš„æŸå¤±å°½é‡é™ä½ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æŸå­¦ç±æ•°æ®æœ‰ä¸¤åˆ—Må’ŒFï¼Œå…¶ä¸­Måˆ—çš„å–å€¼æ˜¯å¦‚ä½•æ­¤å­¦ç”Ÿä¸ºç”·æ€§å–å€¼1ï¼Œä¸ºå¥³æ€§å–å€¼0ï¼›è€ŒFåˆ—æ˜¯å­¦ç”Ÿä¸ºå¥³æ€§å–å€¼1ï¼Œç”·æ€§å–å€¼0ã€‚æ­¤æ—¶å¦‚æœæˆ‘ä»¬ç»Ÿè®¡å…¨éƒ¨å­¦ç±æ•°æ®ï¼Œä¼šå‘ç°å¯¹äºä»»ä½•ä¸€æ¡è®°å½•æ¥è¯´ï¼Œå½“Mä¸º1æ—¶Få¿…å®šä¸º0ï¼Œåä¹‹å½“Mä¸º0æ—¶Få¿…å®šä¸º1ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†Mæˆ–Få»æ‰å®é™…ä¸Šæ²¡æœ‰ä»»ä½•ä¿¡æ¯çš„æŸå¤±ï¼Œå› ä¸ºåªè¦ä¿ç•™ä¸€åˆ—å°±å¯ä»¥å®Œå…¨è¿˜åŸå¦ä¸€åˆ—ã€‚å½“ç„¶ä¸Šé¢æ˜¯ä¸€ä¸ªæç«¯çš„æƒ…å†µï¼Œåœ¨ç°å®ä¸­ä¹Ÿè®¸ä¸ä¼šå‡ºç°ï¼Œä¸è¿‡ç±»ä¼¼çš„æƒ…å†µè¿˜æ˜¯å¾ˆå¸¸è§çš„ã€‚ä¾‹å¦‚ä¸Šé¢æ·˜å®åº—é“ºçš„æ•°æ®ï¼Œä»ç»éªŒæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œâ€œæµè§ˆé‡â€å’Œâ€œè®¿å®¢æ•°â€å¾€å¾€å…·æœ‰è¾ƒå¼ºçš„ç›¸å…³å…³ç³»ï¼Œè€Œâ€œä¸‹å•æ•°â€å’Œâ€œæˆäº¤æ•°â€ä¹Ÿå…·æœ‰è¾ƒå¼ºçš„ç›¸å…³å…³ç³»ã€‚è¿™é‡Œæˆ‘ä»¬éæ­£å¼çš„ä½¿ç”¨â€œç›¸å…³å…³ç³»â€è¿™ä¸ªè¯ï¼Œå¯ä»¥ç›´è§‚ç†è§£ä¸ºâ€œå½“æŸä¸€å¤©è¿™ä¸ªåº—é“ºçš„æµè§ˆé‡è¾ƒé«˜ï¼ˆæˆ–è¾ƒä½ï¼‰æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¾ˆå¤§ç¨‹åº¦ä¸Šè®¤ä¸ºè¿™å¤©çš„è®¿å®¢æ•°ä¹Ÿè¾ƒé«˜ï¼ˆæˆ–è¾ƒä½ï¼‰â€ã€‚åé¢çš„ç« èŠ‚ä¸­æˆ‘ä»¬ä¼šç»™å‡ºç›¸å…³æ€§çš„ä¸¥æ ¼æ•°å­¦å®šä¹‰ã€‚è¿™ç§æƒ…å†µè¡¨æ˜ï¼Œå¦‚æœæˆ‘ä»¬åˆ é™¤æµè§ˆé‡æˆ–è®¿å®¢æ•°å…¶ä¸­ä¸€ä¸ªæŒ‡æ ‡ï¼Œæˆ‘ä»¬åº”è¯¥æœŸå¾…å¹¶ä¸ä¼šä¸¢å¤±å¤ªå¤šä¿¡æ¯ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ é™¤ä¸€ä¸ªï¼Œä»¥é™ä½æœºå™¨å­¦ä¹ ç®—æ³•çš„å¤æ‚åº¦ã€‚ä¸Šé¢ç»™å‡ºçš„æ˜¯é™ç»´çš„æœ´ç´ æ€æƒ³æè¿°ï¼Œå¯ä»¥æœ‰åŠ©äºç›´è§‚ç†è§£é™ç»´çš„åŠ¨æœºå’Œå¯è¡Œæ€§ï¼Œä½†å¹¶ä¸å…·æœ‰æ“ä½œæŒ‡å¯¼æ„ä¹‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åˆ°åº•åˆ é™¤å“ªä¸€åˆ—æŸå¤±çš„ä¿¡æ¯æ‰æœ€å°ï¼Ÿäº¦æˆ–æ ¹æœ¬ä¸æ˜¯å•çº¯åˆ é™¤å‡ åˆ—ï¼Œè€Œæ˜¯é€šè¿‡æŸäº›å˜æ¢å°†åŸå§‹æ•°æ®å˜ä¸ºæ›´å°‘çš„åˆ—ä½†åˆä½¿å¾—ä¸¢å¤±çš„ä¿¡æ¯æœ€å°ï¼Ÿåˆ°åº•å¦‚ä½•åº¦é‡ä¸¢å¤±ä¿¡æ¯çš„å¤šå°‘ï¼Ÿå¦‚ä½•æ ¹æ®åŸå§‹æ•°æ®å†³å®šå…·ä½“çš„é™ç»´æ“ä½œæ­¥éª¤ï¼Ÿè¦å›ç­”ä¸Šé¢çš„é—®é¢˜ï¼Œå°±è¦å¯¹é™ç»´é—®é¢˜è¿›è¡Œæ•°å­¦åŒ–å’Œå½¢å¼åŒ–çš„è®¨è®ºã€‚è€ŒPCAæ˜¯ä¸€ç§å…·æœ‰ä¸¥æ ¼æ•°å­¦åŸºç¡€å¹¶ä¸”å·²è¢«å¹¿æ³›é‡‡ç”¨çš„é™ç»´æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä¸ä¼šç›´æ¥æè¿°PCAï¼Œè€Œæ˜¯é€šè¿‡é€æ­¥åˆ†æé—®é¢˜ï¼Œè®©æˆ‘ä»¬ä¸€èµ·é‡æ–°â€œå‘æ˜â€ä¸€éPCAã€‚ å‘é‡çš„è¡¨ç¤ºåŠåŸºå˜æ¢æ—¢ç„¶æˆ‘ä»¬é¢å¯¹çš„æ•°æ®è¢«æŠ½è±¡ä¸ºä¸€ç»„å‘é‡ï¼Œé‚£ä¹ˆä¸‹é¢æœ‰å¿…è¦ç ”ç©¶ä¸€äº›å‘é‡çš„æ•°å­¦æ€§è´¨ã€‚è€Œè¿™äº›æ•°å­¦æ€§è´¨å°†æˆä¸ºåç»­å¯¼å‡ºPCAçš„ç†è®ºåŸºç¡€ã€‚ å†…ç§¯ä¸æŠ•å½±ä¸‹é¢å…ˆæ¥çœ‹ä¸€ä¸ªé«˜ä¸­å°±å­¦è¿‡çš„å‘é‡è¿ç®—ï¼šå†…ç§¯ã€‚ä¸¤ä¸ªç»´æ•°ç›¸åŒçš„å‘é‡çš„å†…ç§¯è¢«å®šä¹‰ä¸ºï¼š(a1,a2,,an)T(b1,b2,,bn)T=a1b1+a2b2++anbnå†…ç§¯è¿ç®—å°†ä¸¤ä¸ªå‘é‡æ˜ å°„ä¸ºä¸€ä¸ªå®æ•°ã€‚å…¶è®¡ç®—æ–¹å¼éå¸¸å®¹æ˜“ç†è§£ï¼Œä½†æ˜¯å…¶æ„ä¹‰å¹¶ä¸æ˜æ˜¾ã€‚ä¸‹é¢æˆ‘ä»¬åˆ†æå†…ç§¯çš„å‡ ä½•æ„ä¹‰ã€‚å‡è®¾Aå’ŒBæ˜¯ä¸¤ä¸ªnç»´å‘é‡ï¼Œæˆ‘ä»¬çŸ¥é“nç»´å‘é‡å¯ä»¥ç­‰ä»·è¡¨ç¤ºä¸ºnç»´ç©ºé—´ä¸­çš„ä¸€æ¡ä»åŸç‚¹å‘å°„çš„æœ‰å‘çº¿æ®µï¼Œä¸ºäº†ç®€å•èµ·è§æˆ‘ä»¬å‡è®¾Aå’ŒBå‡ä¸ºäºŒç»´å‘é‡ï¼Œåˆ™A=(x1,y1)B=(x2,y2)åˆ™åœ¨äºŒç»´å¹³é¢ä¸ŠAå’ŒBå¯ä»¥ç”¨ä¸¤æ¡å‘è‡ªåŸç‚¹çš„æœ‰å‘çº¿æ®µè¡¨ç¤ºï¼Œè§ä¸‹å›¾ï¼šå¥½ï¼Œç°åœ¨æˆ‘ä»¬ä»Aç‚¹å‘Bæ‰€åœ¨ç›´çº¿å¼•ä¸€æ¡å‚çº¿ã€‚æˆ‘ä»¬çŸ¥é“å‚çº¿ä¸Bçš„äº¤ç‚¹å«åšAåœ¨Bä¸Šçš„æŠ•å½±ï¼Œå†è®¾Aä¸Bçš„å¤¹è§’æ˜¯aï¼Œåˆ™æŠ•å½±çš„çŸ¢é‡é•¿åº¦ä¸º|A|cos(a)å…¶ä¸­|A|=x12+y12æ˜¯å‘é‡Açš„æ¨¡ï¼Œä¹Ÿå°±æ˜¯Açº¿æ®µçš„æ ‡é‡é•¿åº¦ã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬ä¸“é—¨åŒºåˆ†äº†çŸ¢é‡é•¿åº¦å’Œæ ‡é‡é•¿åº¦ï¼Œæ ‡é‡é•¿åº¦æ€»æ˜¯å¤§äºç­‰äº0ï¼Œå€¼å°±æ˜¯çº¿æ®µçš„é•¿åº¦ï¼›è€ŒçŸ¢é‡é•¿åº¦å¯èƒ½ä¸ºè´Ÿï¼Œå…¶ç»å¯¹å€¼æ˜¯çº¿æ®µé•¿åº¦ï¼Œè€Œç¬¦å·å–å†³äºå…¶æ–¹å‘ä¸æ ‡å‡†æ–¹å‘ç›¸åŒæˆ–ç›¸åã€‚åˆ°è¿™é‡Œè¿˜æ˜¯çœ‹ä¸å‡ºå†…ç§¯å’Œè¿™ä¸œè¥¿æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä¸è¿‡å¦‚æœæˆ‘ä»¬å°†å†…ç§¯è¡¨ç¤ºä¸ºå¦ä¸€ç§æˆ‘ä»¬ç†Ÿæ‚‰çš„å½¢å¼ï¼šAB=|A||B|cos(a)ç°åœ¨äº‹æƒ…ä¼¼ä¹æ˜¯æœ‰ç‚¹çœ‰ç›®äº†ï¼šAä¸Bçš„å†…ç§¯ç­‰äºAåˆ°Bçš„æŠ•å½±é•¿åº¦ä¹˜ä»¥Bçš„æ¨¡ã€‚å†è¿›ä¸€æ­¥ï¼Œå¦‚æœæˆ‘ä»¬å‡è®¾Bçš„æ¨¡ä¸º1ï¼Œå³è®©|B|=1é‚£ä¹ˆå°±å˜æˆäº†ï¼šAB=|A|cos(a)ä¹Ÿå°±æ˜¯è¯´ï¼Œè®¾å‘é‡Bçš„æ¨¡ä¸º1ï¼Œåˆ™Aä¸Bçš„å†…ç§¯å€¼ç­‰äºAå‘Bæ‰€åœ¨ç›´çº¿æŠ•å½±çš„çŸ¢é‡é•¿åº¦ï¼è¿™å°±æ˜¯å†…ç§¯çš„ä¸€ç§å‡ ä½•è§£é‡Šï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç¬¬ä¸€ä¸ªé‡è¦ç»“è®ºã€‚åœ¨åé¢çš„æ¨å¯¼ä¸­ï¼Œå°†åå¤ä½¿ç”¨è¿™ä¸ªç»“è®ºã€‚ åŸºä¸‹é¢æˆ‘ä»¬ç»§ç»­åœ¨äºŒç»´ç©ºé—´å†…è®¨è®ºå‘é‡ã€‚ä¸Šæ–‡è¯´è¿‡ï¼Œä¸€ä¸ªäºŒç»´å‘é‡å¯ä»¥å¯¹åº”äºŒç»´ç¬›å¡å°”ç›´è§’åæ ‡ç³»ä¸­ä»åŸç‚¹å‡ºå‘çš„ä¸€ä¸ªæœ‰å‘çº¿æ®µã€‚ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªå‘é‡ï¼šåœ¨ä»£æ•°è¡¨ç¤ºæ–¹é¢ï¼Œæˆ‘ä»¬ç»å¸¸ç”¨çº¿æ®µç»ˆç‚¹çš„ç‚¹åæ ‡è¡¨ç¤ºå‘é‡ï¼Œä¾‹å¦‚ä¸Šé¢çš„å‘é‡å¯ä»¥è¡¨ç¤ºä¸º(3,2)ï¼Œè¿™æ˜¯æˆ‘ä»¬å†ç†Ÿæ‚‰ä¸è¿‡çš„å‘é‡è¡¨ç¤ºã€‚ä¸è¿‡æˆ‘ä»¬å¸¸å¸¸å¿½ç•¥ï¼Œåªæœ‰ä¸€ä¸ª(3,2)æœ¬èº«æ˜¯ä¸èƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºä¸€ä¸ªå‘é‡çš„ã€‚æˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹ï¼Œè¿™é‡Œçš„3å®é™…è¡¨ç¤ºçš„æ˜¯å‘é‡åœ¨xè½´ä¸Šçš„æŠ•å½±å€¼æ˜¯3ï¼Œåœ¨yè½´ä¸Šçš„æŠ•å½±å€¼æ˜¯2ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å…¶å®éšå¼å¼•å…¥äº†ä¸€ä¸ªå®šä¹‰ï¼šä»¥xè½´å’Œyè½´ä¸Šæ­£æ–¹å‘é•¿åº¦ä¸º1çš„å‘é‡ä¸ºæ ‡å‡†ã€‚é‚£ä¹ˆä¸€ä¸ªå‘é‡(3,2)å®é™…æ˜¯è¯´åœ¨xè½´æŠ•å½±ä¸º3è€Œyè½´çš„æŠ•å½±ä¸º2ã€‚æ³¨æ„æŠ•å½±æ˜¯ä¸€ä¸ªçŸ¢é‡ï¼Œæ‰€ä»¥å¯ä»¥ä¸ºè´Ÿã€‚æ›´æ­£å¼çš„è¯´ï¼Œå‘é‡(x,y)å®é™…ä¸Šè¡¨ç¤ºçº¿æ€§ç»„åˆï¼šx(1,0)T+y(0,1)Tä¸éš¾è¯æ˜æ‰€æœ‰äºŒç»´å‘é‡éƒ½å¯ä»¥è¡¨ç¤ºä¸ºè¿™æ ·çš„çº¿æ€§ç»„åˆã€‚æ­¤å¤„(1,0)å’Œ(0,1)å«åšäºŒç»´ç©ºé—´ä¸­çš„ä¸€ç»„åŸºã€‚æ‰€ä»¥ï¼Œè¦å‡†ç¡®æè¿°å‘é‡ï¼Œé¦–å…ˆè¦ç¡®å®šä¸€ç»„åŸºï¼Œç„¶åç»™å‡ºåœ¨åŸºæ‰€åœ¨çš„å„ä¸ªç›´çº¿ä¸Šçš„æŠ•å½±å€¼ï¼Œå°±å¯ä»¥äº†ã€‚åªä¸è¿‡æˆ‘ä»¬ç»å¸¸çœç•¥ç¬¬ä¸€æ­¥ï¼Œè€Œé»˜è®¤ä»¥(1,0)å’Œ(0,1)ä¸ºåŸºã€‚æˆ‘ä»¬ä¹‹æ‰€ä»¥é»˜è®¤é€‰æ‹©(1,0)å’Œ(0,1)ä¸ºåŸºï¼Œå½“ç„¶æ˜¯æ¯”è¾ƒæ–¹ä¾¿ï¼Œå› ä¸ºå®ƒä»¬åˆ†åˆ«æ˜¯xå’Œyè½´æ­£æ–¹å‘ä¸Šçš„å•ä½å‘é‡ï¼Œå› æ­¤å°±ä½¿å¾—äºŒç»´å¹³é¢ä¸Šç‚¹åæ ‡å’Œå‘é‡ä¸€ä¸€å¯¹åº”ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä½†å®é™…ä¸Šä»»ä½•ä¸¤ä¸ªçº¿æ€§æ— å…³çš„äºŒç»´å‘é‡éƒ½å¯ä»¥æˆä¸ºä¸€ç»„åŸºï¼Œæ‰€è°“çº¿æ€§æ— å…³åœ¨äºŒç»´å¹³é¢å†…å¯ä»¥ç›´è§‚è®¤ä¸ºæ˜¯ä¸¤ä¸ªä¸åœ¨ä¸€æ¡ç›´çº¿ä¸Šçš„å‘é‡ã€‚ä¾‹å¦‚ï¼Œ(1,1)å’Œ(-1,1)ä¹Ÿå¯ä»¥æˆä¸ºä¸€ç»„åŸºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›åŸºçš„æ¨¡æ˜¯1ï¼Œå› ä¸ºä»å†…ç§¯çš„æ„ä¹‰å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœåŸºçš„æ¨¡æ˜¯1ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ–¹ä¾¿çš„ç”¨å‘é‡ç‚¹ä¹˜åŸºè€Œç›´æ¥è·å¾—å…¶åœ¨æ–°åŸºä¸Šçš„åæ ‡äº†ï¼å®é™…ä¸Šï¼Œå¯¹åº”ä»»ä½•ä¸€ä¸ªå‘é‡æˆ‘ä»¬æ€»å¯ä»¥æ‰¾åˆ°å…¶åŒæ–¹å‘ä¸Šæ¨¡ä¸º1çš„å‘é‡ï¼Œåªè¦è®©ä¸¤ä¸ªåˆ†é‡åˆ†åˆ«é™¤ä»¥æ¨¡å°±å¥½äº†ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢çš„åŸºå¯ä»¥å˜ä¸º(12,12)å’Œ (12,12)ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³è·å¾—(3,2)åœ¨æ–°åŸºä¸Šçš„åæ ‡ï¼Œå³åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šçš„æŠ•å½±çŸ¢é‡å€¼ï¼Œé‚£ä¹ˆæ ¹æ®å†…ç§¯çš„å‡ ä½•æ„ä¹‰ï¼Œæˆ‘ä»¬åªè¦åˆ†åˆ«è®¡ç®—(3,2)å’Œä¸¤ä¸ªåŸºçš„å†…ç§¯ï¼Œä¸éš¾å¾—åˆ°æ–°çš„åæ ‡ä¸º(52,12)ä¸‹å›¾ç»™å‡ºäº†æ–°çš„åŸºä»¥åŠ(3,2)åœ¨æ–°åŸºä¸Šåæ ‡å€¼çš„ç¤ºæ„å›¾ï¼šå¦å¤–è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åˆ—ä¸¾çš„ä¾‹å­ä¸­åŸºæ˜¯æ­£äº¤çš„ï¼ˆå³å†…ç§¯ä¸º0ï¼Œæˆ–ç›´è§‚è¯´ç›¸äº’å‚ç›´ï¼‰ï¼Œä½†å¯ä»¥æˆä¸ºä¸€ç»„åŸºçš„å”¯ä¸€è¦æ±‚å°±æ˜¯çº¿æ€§æ— å…³ï¼Œéæ­£äº¤çš„åŸºä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¸è¿‡å› ä¸ºæ­£äº¤åŸºæœ‰è¾ƒå¥½çš„æ€§è´¨ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨çš„åŸºéƒ½æ˜¯æ­£äº¤çš„ã€‚ åŸºå˜æ¢çš„çŸ©é˜µè¡¨ç¤ºä¸‹é¢æˆ‘ä»¬æ‰¾ä¸€ç§ç®€ä¾¿çš„æ–¹å¼æ¥è¡¨ç¤ºåŸºå˜æ¢ã€‚è¿˜æ˜¯æ‹¿ä¸Šé¢çš„ä¾‹å­ï¼Œæƒ³ä¸€ä¸‹ï¼Œå°†(3,2)å˜æ¢ä¸ºæ–°åŸºä¸Šçš„åæ ‡ï¼Œå°±æ˜¯ç”¨(3,2)ä¸ç¬¬ä¸€ä¸ªåŸºåšå†…ç§¯è¿ç®—ï¼Œä½œä¸ºç¬¬ä¸€ä¸ªæ–°çš„åæ ‡åˆ†é‡ï¼Œç„¶åç”¨(3,2)ä¸ç¬¬äºŒä¸ªåŸºåšå†…ç§¯è¿ç®—ï¼Œä½œä¸ºç¬¬äºŒä¸ªæ–°åæ ‡çš„åˆ†é‡ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çŸ©é˜µç›¸ä¹˜çš„å½¢å¼ç®€æ´çš„è¡¨ç¤ºè¿™ä¸ªå˜æ¢ï¼š(1/21/21/21/2)(32)=(5/21/2)å¤ªæ¼‚äº®äº†ï¼å…¶ä¸­çŸ©é˜µçš„ä¸¤è¡Œåˆ†åˆ«ä¸ºä¸¤ä¸ªåŸºï¼Œä¹˜ä»¥åŸå‘é‡ï¼Œå…¶ç»“æœåˆšå¥½ä¸ºæ–°åŸºçš„åæ ‡ã€‚å¯ä»¥ç¨å¾®æ¨å¹¿ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰mä¸ªäºŒç»´å‘é‡ï¼Œåªè¦å°†äºŒç»´å‘é‡æŒ‰åˆ—æ’æˆä¸€ä¸ªä¸¤è¡Œmåˆ—çŸ©é˜µï¼Œç„¶åç”¨â€œåŸºçŸ©é˜µâ€ä¹˜ä»¥è¿™ä¸ªçŸ©é˜µï¼Œå°±å¾—åˆ°äº†æ‰€æœ‰è¿™äº›å‘é‡åœ¨æ–°åŸºä¸‹çš„å€¼ã€‚ä¾‹å¦‚(1,1)ï¼Œ(2,2)ï¼Œ(3,3)ï¼Œæƒ³å˜æ¢åˆ°åˆšæ‰é‚£ç»„åŸºä¸Šï¼Œåˆ™å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š(1/21/21/21/2)(123123)=(2/24/26/2000)äºæ˜¯ä¸€ç»„å‘é‡çš„åŸºå˜æ¢è¢«å¹²å‡€çš„è¡¨ç¤ºä¸ºçŸ©é˜µçš„ç›¸ä¹˜ã€‚ä¸€èˆ¬çš„ï¼Œå¦‚æœæˆ‘ä»¬æœ‰Mä¸ªNç»´å‘é‡ï¼Œæƒ³å°†å…¶å˜æ¢ä¸ºç”±Rä¸ªNç»´å‘é‡è¡¨ç¤ºçš„æ–°ç©ºé—´ä¸­ï¼Œé‚£ä¹ˆé¦–å…ˆå°†Rä¸ªåŸºæŒ‰è¡Œç»„æˆçŸ©é˜µAï¼Œç„¶åå°†å‘é‡æŒ‰åˆ—ç»„æˆçŸ©é˜µBï¼Œé‚£ä¹ˆä¸¤çŸ©é˜µçš„ä¹˜ç§¯ABå°±æ˜¯å˜æ¢ç»“æœï¼Œå…¶ä¸­ABçš„ç¬¬måˆ—ä¸ºAä¸­ç¬¬måˆ—å˜æ¢åçš„ç»“æœã€‚æ•°å­¦è¡¨ç¤ºä¸ºï¼š(p1p2pR)(a1a2aM)=(p1a1p1a2p1aMp2a1p2a2p2aMpRa1pRa2pRaM)å…¶ä¸­piæ˜¯ä¸€ä¸ªè¡Œå‘é‡ï¼Œè¡¨ç¤ºç¬¬iä¸ªåŸºï¼Œajæ˜¯ä¸€ä¸ªåˆ—å‘é‡ï¼Œè¡¨ç¤ºç¬¬jä¸ªåŸå§‹æ•°æ®è®°å½•ã€‚ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡ŒRå¯ä»¥å°äºNï¼Œè€ŒRå†³å®šäº†å˜æ¢åæ•°æ®çš„ç»´æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€Nç»´æ•°æ®å˜æ¢åˆ°æ›´ä½ç»´åº¦çš„ç©ºé—´ä¸­å»ï¼Œå˜æ¢åçš„ç»´åº¦å–å†³äºåŸºçš„æ•°é‡ã€‚å› æ­¤è¿™ç§çŸ©é˜µç›¸ä¹˜çš„è¡¨ç¤ºä¹Ÿå¯ä»¥è¡¨ç¤ºé™ç»´å˜æ¢ã€‚æœ€åï¼Œä¸Šè¿°åˆ†æåŒæ—¶ç»™çŸ©é˜µç›¸ä¹˜æ‰¾åˆ°äº†ä¸€ç§ç‰©ç†è§£é‡Šï¼šä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜çš„æ„ä¹‰æ˜¯å°†å³è¾¹çŸ©é˜µä¸­çš„æ¯ä¸€åˆ—åˆ—å‘é‡å˜æ¢åˆ°å·¦è¾¹çŸ©é˜µä¸­æ¯ä¸€è¡Œè¡Œå‘é‡ä¸ºåŸºæ‰€è¡¨ç¤ºçš„ç©ºé—´ä¸­å»ã€‚æ›´æŠ½è±¡çš„è¯´ï¼Œä¸€ä¸ªçŸ©é˜µå¯ä»¥è¡¨ç¤ºä¸€ç§çº¿æ€§å˜æ¢ã€‚å¾ˆå¤šåŒå­¦åœ¨å­¦çº¿æ€§ä»£æ•°æ—¶å¯¹çŸ©é˜µç›¸ä¹˜çš„æ–¹æ³•æ„Ÿåˆ°å¥‡æ€ªï¼Œä½†æ˜¯å¦‚æœæ˜ç™½äº†çŸ©é˜µç›¸ä¹˜çš„ç‰©ç†æ„ä¹‰ï¼Œå…¶åˆç†æ€§å°±ä¸€ç›®äº†ç„¶äº†ã€‚ åæ–¹å·®çŸ©é˜µåŠä¼˜åŒ–ç›®æ ‡ä¸Šé¢æˆ‘ä»¬è®¨è®ºäº†é€‰æ‹©ä¸åŒçš„åŸºå¯ä»¥å¯¹åŒæ ·ä¸€ç»„æ•°æ®ç»™å‡ºä¸åŒçš„è¡¨ç¤ºï¼Œè€Œä¸”å¦‚æœåŸºçš„æ•°é‡å°‘äºå‘é‡æœ¬èº«çš„ç»´æ•°ï¼Œåˆ™å¯ä»¥è¾¾åˆ°é™ç»´çš„æ•ˆæœã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰å›ç­”ä¸€ä¸ªæœ€æœ€å…³é”®çš„é—®é¢˜ï¼šå¦‚ä½•é€‰æ‹©åŸºæ‰æ˜¯æœ€ä¼˜çš„ã€‚æˆ–è€…è¯´ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ç»„Nç»´å‘é‡ï¼Œç°åœ¨è¦å°†å…¶é™åˆ°Kç»´ï¼ˆKå°äºNï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©Kä¸ªåŸºæ‰èƒ½æœ€å¤§ç¨‹åº¦ä¿ç•™åŸæœ‰çš„ä¿¡æ¯ï¼Ÿè¦å®Œå…¨æ•°å­¦åŒ–è¿™ä¸ªé—®é¢˜éå¸¸ç¹æ‚ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ç§éå½¢å¼åŒ–çš„ç›´è§‚æ–¹æ³•æ¥çœ‹è¿™ä¸ªé—®é¢˜ã€‚ä¸ºäº†é¿å…è¿‡äºæŠ½è±¡çš„è®¨è®ºï¼Œæˆ‘ä»¬ä»ä»¥ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å±•å¼€ã€‚å‡è®¾æˆ‘ä»¬çš„æ•°æ®ç”±äº”æ¡è®°å½•ç»„æˆï¼Œå°†å®ƒä»¬è¡¨ç¤ºæˆçŸ©é˜µå½¢å¼ï¼š(1124213344)å…¶ä¸­æ¯ä¸€åˆ—ä¸ºä¸€æ¡æ•°æ®è®°å½•ï¼Œè€Œä¸€è¡Œä¸ºä¸€ä¸ªå­—æ®µã€‚ä¸ºäº†åç»­å¤„ç†æ–¹ä¾¿ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ¯ä¸ªå­—æ®µå†…æ‰€æœ‰å€¼éƒ½å‡å»å­—æ®µå‡å€¼ï¼Œå…¶ç»“æœæ˜¯å°†æ¯ä¸ªå­—æ®µéƒ½å˜ä¸ºå‡å€¼ä¸º0ï¼ˆè¿™æ ·åšçš„é“ç†å’Œå¥½å¤„åé¢ä¼šçœ‹åˆ°ï¼‰ã€‚æˆ‘ä»¬çœ‹ä¸Šé¢çš„æ•°æ®ï¼Œç¬¬ä¸€ä¸ªå­—æ®µå‡å€¼ä¸º2ï¼Œç¬¬äºŒä¸ªå­—æ®µå‡å€¼ä¸º3ï¼Œæ‰€ä»¥å˜æ¢å(1102020011)æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹äº”æ¡æ•°æ®åœ¨å¹³é¢ç›´è§’åæ ‡ç³»å†…çš„æ ·å­ï¼šç°åœ¨é—®é¢˜æ¥äº†ï¼šå¦‚æœæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸€ç»´æ¥è¡¨ç¤ºè¿™äº›æ•°æ®ï¼Œåˆå¸Œæœ›å°½é‡ä¿ç•™åŸå§‹çš„ä¿¡æ¯ï¼Œä½ è¦å¦‚ä½•é€‰æ‹©ï¼Ÿé€šè¿‡ä¸Šä¸€èŠ‚å¯¹åŸºå˜æ¢çš„è®¨è®ºæˆ‘ä»¬çŸ¥é“ï¼Œè¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯è¦åœ¨äºŒç»´å¹³é¢ä¸­é€‰æ‹©ä¸€ä¸ªæ–¹å‘ï¼Œå°†æ‰€æœ‰æ•°æ®éƒ½æŠ•å½±åˆ°è¿™ä¸ªæ–¹å‘æ‰€åœ¨ç›´çº¿ä¸Šï¼Œç”¨æŠ•å½±å€¼è¡¨ç¤ºåŸå§‹è®°å½•ã€‚è¿™æ˜¯ä¸€ä¸ªå®é™…çš„äºŒç»´é™åˆ°ä¸€ç»´çš„é—®é¢˜ã€‚é‚£ä¹ˆå¦‚ä½•é€‰æ‹©è¿™ä¸ªæ–¹å‘ï¼ˆæˆ–è€…è¯´åŸºï¼‰æ‰èƒ½å°½é‡ä¿ç•™æœ€å¤šçš„åŸå§‹ä¿¡æ¯å‘¢ï¼Ÿä¸€ç§ç›´è§‚çš„çœ‹æ³•æ˜¯ï¼šå¸Œæœ›æŠ•å½±åçš„æŠ•å½±å€¼å°½å¯èƒ½åˆ†æ•£ã€‚ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹å‡ºå¦‚æœå‘xè½´æŠ•å½±ï¼Œé‚£ä¹ˆæœ€å·¦è¾¹çš„ä¸¤ä¸ªç‚¹ä¼šé‡å åœ¨ä¸€èµ·ï¼Œä¸­é—´çš„ä¸¤ä¸ªç‚¹ä¹Ÿä¼šé‡å åœ¨ä¸€èµ·ï¼Œäºæ˜¯æœ¬èº«å››ä¸ªå„ä¸ç›¸åŒçš„äºŒç»´ç‚¹æŠ•å½±ååªå‰©ä¸‹ä¸¤ä¸ªä¸åŒçš„å€¼äº†ï¼Œè¿™æ˜¯ä¸€ç§ä¸¥é‡çš„ä¿¡æ¯ä¸¢å¤±ï¼ŒåŒç†ï¼Œå¦‚æœå‘yè½´æŠ•å½±æœ€ä¸Šé¢çš„ä¸¤ä¸ªç‚¹å’Œåˆ†å¸ƒåœ¨xè½´ä¸Šçš„ä¸¤ä¸ªç‚¹ä¹Ÿä¼šé‡å ã€‚æ‰€ä»¥çœ‹æ¥xå’Œyè½´éƒ½ä¸æ˜¯æœ€å¥½çš„æŠ•å½±é€‰æ‹©ã€‚æˆ‘ä»¬ç›´è§‚ç›®æµ‹ï¼Œå¦‚æœå‘é€šè¿‡ç¬¬ä¸€è±¡é™å’Œç¬¬ä¸‰è±¡é™çš„æ–œçº¿æŠ•å½±ï¼Œåˆ™äº”ä¸ªç‚¹åœ¨æŠ•å½±åè¿˜æ˜¯å¯ä»¥åŒºåˆ†çš„ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ç”¨æ•°å­¦æ–¹æ³•è¡¨è¿°è¿™ä¸ªé—®é¢˜ã€‚ æ–¹å·®ä¸Šæ–‡è¯´åˆ°ï¼Œæˆ‘ä»¬å¸Œæœ›æŠ•å½±åæŠ•å½±å€¼å°½å¯èƒ½åˆ†æ•£ï¼Œè€Œè¿™ç§åˆ†æ•£ç¨‹åº¦ï¼Œå¯ä»¥ç”¨æ•°å­¦ä¸Šçš„æ–¹å·®æ¥è¡¨è¿°ã€‚æ­¤å¤„ï¼Œä¸€ä¸ªå­—æ®µçš„æ–¹å·®å¯ä»¥çœ‹åšæ˜¯æ¯ä¸ªå…ƒç´ ä¸å­—æ®µå‡å€¼çš„å·®çš„å¹³æ–¹å’Œçš„å‡å€¼ï¼Œå³ï¼šVar(a)=1mâˆ‘i=1m(aiÎ¼)2ç”±äºä¸Šé¢æˆ‘ä»¬å·²ç»å°†æ¯ä¸ªå­—æ®µçš„å‡å€¼éƒ½åŒ–ä¸º0äº†ï¼Œå› æ­¤æ–¹å·®å¯ä»¥ç›´æ¥ç”¨æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œé™¤ä»¥å…ƒç´ ä¸ªæ•°è¡¨ç¤ºï¼šVar(a)=1mâˆ‘i=1mai2äºæ˜¯ä¸Šé¢çš„é—®é¢˜è¢«å½¢å¼åŒ–è¡¨è¿°ä¸ºï¼šå¯»æ‰¾ä¸€ä¸ªä¸€ç»´åŸºï¼Œä½¿å¾—æ‰€æœ‰æ•°æ®å˜æ¢ä¸ºè¿™ä¸ªåŸºä¸Šçš„åæ ‡è¡¨ç¤ºåï¼Œæ–¹å·®å€¼æœ€å¤§ã€‚ åæ–¹å·®å¯¹äºä¸Šé¢äºŒç»´é™æˆä¸€ç»´çš„é—®é¢˜æ¥è¯´ï¼Œæ‰¾åˆ°é‚£ä¸ªä½¿å¾—æ–¹å·®æœ€å¤§çš„æ–¹å‘å°±å¯ä»¥äº†ã€‚ä¸è¿‡å¯¹äºæ›´é«˜ç»´ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ã€‚è€ƒè™‘ä¸‰ç»´é™åˆ°äºŒç»´é—®é¢˜ã€‚ä¸ä¹‹å‰ç›¸åŒï¼Œé¦–å…ˆæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªæ–¹å‘ä½¿å¾—æŠ•å½±åæ–¹å·®æœ€å¤§ï¼Œè¿™æ ·å°±å®Œæˆäº†ç¬¬ä¸€ä¸ªæ–¹å‘çš„é€‰æ‹©ï¼Œç»§è€Œæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒä¸ªæŠ•å½±æ–¹å‘ã€‚å¦‚æœæˆ‘ä»¬è¿˜æ˜¯å•çº¯åªé€‰æ‹©æ–¹å·®æœ€å¤§çš„æ–¹å‘ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªæ–¹å‘ä¸ç¬¬ä¸€ä¸ªæ–¹å‘åº”è¯¥æ˜¯â€œå‡ ä¹é‡åˆåœ¨ä¸€èµ·â€ï¼Œæ˜¾ç„¶è¿™æ ·çš„ç»´åº¦æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå› æ­¤ï¼Œåº”è¯¥æœ‰å…¶ä»–çº¦æŸæ¡ä»¶ã€‚ä»ç›´è§‚ä¸Šè¯´ï¼Œè®©ä¸¤ä¸ªå­—æ®µå°½å¯èƒ½è¡¨ç¤ºæ›´å¤šçš„åŸå§‹ä¿¡æ¯ï¼Œæˆ‘ä»¬æ˜¯ä¸å¸Œæœ›å®ƒä»¬ä¹‹é—´å­˜åœ¨ï¼ˆçº¿æ€§ï¼‰ç›¸å…³æ€§çš„ï¼Œå› ä¸ºç›¸å…³æ€§æ„å‘³ç€ä¸¤ä¸ªå­—æ®µä¸æ˜¯å®Œå…¨ç‹¬ç«‹ï¼Œå¿…ç„¶å­˜åœ¨é‡å¤è¡¨ç¤ºçš„ä¿¡æ¯ã€‚æ•°å­¦ä¸Šå¯ä»¥ç”¨ä¸¤ä¸ªå­—æ®µçš„åæ–¹å·®è¡¨ç¤ºå…¶ç›¸å…³æ€§ï¼Œç”±äºå·²ç»è®©æ¯ä¸ªå­—æ®µå‡å€¼ä¸º0ï¼Œåˆ™ï¼šCov(a,b)=1mâˆ‘i=1maibiå¯ä»¥çœ‹åˆ°ï¼Œåœ¨å­—æ®µå‡å€¼ä¸º0çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªå­—æ®µçš„åæ–¹å·®ç®€æ´çš„è¡¨ç¤ºä¸ºå…¶å†…ç§¯é™¤ä»¥å…ƒç´ æ•°mã€‚å½“åæ–¹å·®ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸¤ä¸ªå­—æ®µå®Œå…¨ç‹¬ç«‹ã€‚ä¸ºäº†è®©åæ–¹å·®ä¸º0ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬äºŒä¸ªåŸºæ—¶åªèƒ½åœ¨ä¸ç¬¬ä¸€ä¸ªåŸºæ­£äº¤çš„æ–¹å‘ä¸Šé€‰æ‹©ã€‚å› æ­¤æœ€ç»ˆé€‰æ‹©çš„ä¸¤ä¸ªæ–¹å‘ä¸€å®šæ˜¯æ­£äº¤çš„ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†é™ç»´é—®é¢˜çš„ä¼˜åŒ–ç›®æ ‡ï¼šå°†ä¸€ç»„Nç»´å‘é‡é™ä¸ºKç»´ï¼ˆKå¤§äº0ï¼Œå°äºNï¼‰ï¼Œå…¶ç›®æ ‡æ˜¯é€‰æ‹©Kä¸ªå•ä½ï¼ˆæ¨¡ä¸º1ï¼‰æ­£äº¤åŸºï¼Œä½¿å¾—åŸå§‹æ•°æ®å˜æ¢åˆ°è¿™ç»„åŸºä¸Šåï¼Œå„å­—æ®µä¸¤ä¸¤é—´åæ–¹å·®ä¸º0ï¼Œè€Œå­—æ®µçš„æ–¹å·®åˆ™å°½å¯èƒ½å¤§ï¼ˆåœ¨æ­£äº¤çš„çº¦æŸä¸‹ï¼Œå–æœ€å¤§çš„Kä¸ªæ–¹å·®ï¼‰ã€‚ åæ–¹å·®çŸ©é˜µä¸Šé¢æˆ‘ä»¬å¯¼å‡ºäº†ä¼˜åŒ–ç›®æ ‡ï¼Œä½†æ˜¯è¿™ä¸ªç›®æ ‡ä¼¼ä¹ä¸èƒ½ç›´æ¥ä½œä¸ºæ“ä½œæŒ‡å—ï¼ˆæˆ–è€…è¯´ç®—æ³•ï¼‰ï¼Œå› ä¸ºå®ƒåªè¯´è¦ä»€ä¹ˆï¼Œä½†æ ¹æœ¬æ²¡æœ‰è¯´æ€ä¹ˆåšã€‚æ‰€ä»¥æˆ‘ä»¬è¦ç»§ç»­åœ¨æ•°å­¦ä¸Šç ”ç©¶è®¡ç®—æ–¹æ¡ˆã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œæœ€ç»ˆè¦è¾¾åˆ°çš„ç›®çš„ä¸å­—æ®µå†…æ–¹å·®åŠå­—æ®µé—´åæ–¹å·®æœ‰å¯†åˆ‡å…³ç³»ã€‚å› æ­¤æˆ‘ä»¬å¸Œæœ›èƒ½å°†ä¸¤è€…ç»Ÿä¸€è¡¨ç¤ºï¼Œä»”ç»†è§‚å¯Ÿå‘ç°ï¼Œä¸¤è€…å‡å¯ä»¥è¡¨ç¤ºä¸ºå†…ç§¯çš„å½¢å¼ï¼Œè€Œå†…ç§¯åˆä¸çŸ©é˜µç›¸ä¹˜å¯†åˆ‡ç›¸å…³ã€‚äºæ˜¯æˆ‘ä»¬æ¥äº†çµæ„Ÿï¼šå‡è®¾æˆ‘ä»¬åªæœ‰aå’Œbä¸¤ä¸ªå­—æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å®ƒä»¬æŒ‰è¡Œç»„æˆçŸ©é˜µX:X=(a1a2amb1b2bm)ç„¶åæˆ‘ä»¬ç”¨Xä¹˜ä»¥Xçš„è½¬ç½®ï¼Œå¹¶ä¹˜ä¸Šç³»æ•°1/m1mXXT=(1mâˆ‘i=1mai21mâˆ‘i=1maibi1mâˆ‘i=1maibi1mâˆ‘i=1mbi2)å¥‡è¿¹å‡ºç°äº†ï¼è¿™ä¸ªçŸ©é˜µå¯¹è§’çº¿ä¸Šçš„ä¸¤ä¸ªå…ƒç´ åˆ†åˆ«æ˜¯ä¸¤ä¸ªå­—æ®µçš„æ–¹å·®ï¼Œè€Œå…¶å®ƒå…ƒç´ æ˜¯aå’Œbçš„åæ–¹å·®ã€‚ä¸¤è€…è¢«ç»Ÿä¸€åˆ°äº†ä¸€ä¸ªçŸ©é˜µçš„ã€‚æ ¹æ®çŸ©é˜µç›¸ä¹˜çš„è¿ç®—æ³•åˆ™ï¼Œè¿™ä¸ªç»“è®ºå¾ˆå®¹æ˜“è¢«æ¨å¹¿åˆ°ä¸€èˆ¬æƒ…å†µï¼šè®¾æˆ‘ä»¬æœ‰mä¸ªnç»´æ•°æ®è®°å½•ï¼Œå°†å…¶æŒ‰åˆ—æ’æˆnä¹˜mçš„çŸ©é˜µXï¼Œè®¾C=1mXXTåˆ™Cæ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼Œå…¶å¯¹è§’çº¿åˆ†åˆ«ä¸ªå„ä¸ªå­—æ®µçš„æ–¹å·®ï¼Œè€Œç¬¬iè¡Œjåˆ—å’Œjè¡Œiåˆ—å…ƒç´ ç›¸åŒï¼Œè¡¨ç¤ºiå’Œjä¸¤ä¸ªå­—æ®µçš„åæ–¹å·®ã€‚ åæ–¹å·®çŸ©é˜µå¯¹è§’åŒ–æ ¹æ®ä¸Šè¿°æ¨å¯¼ï¼Œæˆ‘ä»¬å‘ç°è¦è¾¾åˆ°ä¼˜åŒ–ç›®å‰ï¼Œç­‰ä»·äºå°†åæ–¹å·®çŸ©é˜µå¯¹è§’åŒ–ï¼šå³é™¤å¯¹è§’çº¿å¤–çš„å…¶å®ƒå…ƒç´ åŒ–ä¸º0ï¼Œå¹¶ä¸”åœ¨å¯¹è§’çº¿ä¸Šå°†å…ƒç´ æŒ‰å¤§å°ä»ä¸Šåˆ°ä¸‹æ’åˆ—ï¼Œè¿™æ ·æˆ‘ä»¬å°±è¾¾åˆ°äº†ä¼˜åŒ–ç›®çš„ã€‚è¿™æ ·è¯´å¯èƒ½è¿˜ä¸æ˜¯å¾ˆæ˜æ™°ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥çœ‹ä¸‹åŸçŸ©é˜µä¸åŸºå˜æ¢åçŸ©é˜µåæ–¹å·®çŸ©é˜µçš„å…³ç³»ï¼šè®¾åŸå§‹æ•°æ®çŸ©é˜µXå¯¹åº”çš„åæ–¹å·®çŸ©é˜µä¸ºCï¼Œè€ŒPæ˜¯ä¸€ç»„åŸºæŒ‰è¡Œç»„æˆçš„çŸ©é˜µï¼Œè®¾Y=PXï¼Œåˆ™Yä¸ºXå¯¹PåšåŸºå˜æ¢åçš„æ•°æ®ã€‚è®¾Yçš„åæ–¹å·®çŸ©é˜µä¸ºDï¼Œæˆ‘ä»¬æ¨å¯¼ä¸€ä¸‹Dä¸Cçš„å…³ç³»ï¼šD=1mYYT=1m(PX)(PX)T=1mPXXTPT=P(1mXXT)PT=PCPTç°åœ¨äº‹æƒ…å¾ˆæ˜ç™½äº†ï¼æˆ‘ä»¬è¦æ‰¾çš„Pä¸æ˜¯åˆ«çš„ï¼Œè€Œæ˜¯èƒ½è®©åŸå§‹åæ–¹å·®çŸ©é˜µå¯¹è§’åŒ–çš„Pã€‚æ¢å¥è¯è¯´ï¼Œä¼˜åŒ–ç›®æ ‡å˜æˆäº†å¯»æ‰¾ä¸€ä¸ªçŸ©é˜µPï¼Œæ»¡è¶³PCPTæ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œå¹¶ä¸”å¯¹è§’å…ƒç´ æŒ‰ä»å¤§åˆ°å°ä¾æ¬¡æ’åˆ—ï¼Œé‚£ä¹ˆPçš„å‰Kè¡Œå°±æ˜¯è¦å¯»æ‰¾çš„åŸºï¼Œç”¨Pçš„å‰Kè¡Œç»„æˆçš„çŸ©é˜µä¹˜ä»¥Xå°±ä½¿å¾—Xä»Nç»´é™åˆ°äº†Kç»´å¹¶æ»¡è¶³ä¸Šè¿°ä¼˜åŒ–æ¡ä»¶ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬ç¦»â€œå‘æ˜â€PCAè¿˜æœ‰ä»…ä¸€æ­¥ä¹‹é¥ï¼ç°åœ¨æ‰€æœ‰ç„¦ç‚¹éƒ½èšç„¦åœ¨äº†åæ–¹å·®çŸ©é˜µå¯¹è§’åŒ–é—®é¢˜ä¸Šï¼Œæœ‰æ—¶ï¼Œæˆ‘ä»¬çœŸåº”è¯¥æ„Ÿè°¢æ•°å­¦å®¶çš„å…ˆè¡Œï¼Œå› ä¸ºçŸ©é˜µå¯¹è§’åŒ–åœ¨çº¿æ€§ä»£æ•°é¢†åŸŸå·²ç»å±äºè¢«ç©çƒ‚äº†çš„ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™åœ¨æ•°å­¦ä¸Šæ ¹æœ¬ä¸æ˜¯é—®é¢˜ã€‚ç”±ä¸Šæ–‡çŸ¥é“ï¼Œåæ–¹å·®çŸ©é˜µCæ˜¯ä¸€ä¸ªæ˜¯å¯¹ç§°çŸ©é˜µï¼Œåœ¨çº¿æ€§ä»£æ•°ä¸Šï¼Œå®å¯¹ç§°çŸ©é˜µæœ‰ä¸€ç³»åˆ—éå¸¸å¥½çš„æ€§è´¨ï¼šå®å¯¹ç§°çŸ©é˜µä¸åŒç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡å¿…ç„¶æ­£äº¤ã€‚è®¾ç‰¹å¾å‘é‡Î»é‡æ•°ä¸ºrï¼Œåˆ™å¿…ç„¶å­˜åœ¨rä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡å¯¹åº”äºÎ»ï¼Œå› æ­¤å¯ä»¥å°†è¿™rä¸ªç‰¹å¾å‘é‡å•ä½æ­£äº¤åŒ–ã€‚ç”±ä¸Šé¢ä¸¤æ¡å¯çŸ¥ï¼Œä¸€ä¸ªnè¡Œnåˆ—çš„å®å¯¹ç§°çŸ©é˜µä¸€å®šå¯ä»¥æ‰¾åˆ°nä¸ªå•ä½æ­£äº¤ç‰¹å¾å‘é‡ï¼Œè®¾è¿™nä¸ªç‰¹å¾å‘é‡ä¸ºe1,e2,,enï¼Œæˆ‘ä»¬å°†å…¶æŒ‰åˆ—ç»„æˆçŸ©é˜µï¼šE=(e1e2en)åˆ™å¯¹åæ–¹å·®çŸ©é˜µCæœ‰å¦‚ä¸‹ç»“è®ºï¼šETCE=Î›=(Î»1Î»2Î»n)å…¶ä¸­Î›ä¸ºå¯¹è§’çŸ©é˜µï¼Œå…¶å¯¹è§’å…ƒç´ ä¸ºå„ç‰¹å¾å‘é‡å¯¹åº”çš„ç‰¹å¾å€¼ï¼ˆå¯èƒ½æœ‰é‡å¤ï¼‰ã€‚ä»¥ä¸Šç»“è®ºä¸å†ç»™å‡ºä¸¥æ ¼çš„æ•°å­¦è¯æ˜ï¼Œå¯¹è¯æ˜æ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å‚è€ƒçº¿æ€§ä»£æ•°ä¹¦ç±å…³äºâ€œå®å¯¹ç§°çŸ©é˜µå¯¹è§’åŒ–â€çš„å†…å®¹ã€‚åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†éœ€è¦çš„çŸ©é˜µPï¼šP=ETPæ˜¯åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡å•ä½åŒ–åæŒ‰è¡Œæ’åˆ—å‡ºçš„çŸ©é˜µï¼Œå…¶ä¸­æ¯ä¸€è¡Œéƒ½æ˜¯Cçš„ä¸€ä¸ªç‰¹å¾å‘é‡ã€‚å¦‚æœè®¾PæŒ‰ç…§Î›ä¸­ç‰¹å¾å€¼çš„ä»å¤§åˆ°å°ï¼Œå°†ç‰¹å¾å‘é‡ä»ä¸Šåˆ°ä¸‹æ’åˆ—ï¼Œåˆ™ç”¨Pçš„å‰Kè¡Œç»„æˆçš„çŸ©é˜µä¹˜ä»¥åŸå§‹æ•°æ®çŸ©é˜µXï¼Œå°±å¾—åˆ°äº†æˆ‘ä»¬éœ€è¦çš„é™ç»´åçš„æ•°æ®çŸ©é˜µYã€‚è‡³æ­¤æˆ‘ä»¬å®Œæˆäº†æ•´ä¸ªPCAçš„æ•°å­¦åŸç†è®¨è®ºã€‚åœ¨ä¸‹é¢çš„ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†ç»™å‡ºPCAçš„ä¸€ä¸ªå®ä¾‹ã€‚ ç®—æ³•åŠå®ä¾‹ä¸ºäº†å·©å›ºä¸Šé¢çš„ç†è®ºï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€èŠ‚ç»™å‡ºä¸€ä¸ªå…·ä½“çš„PCAå®ä¾‹ã€‚ PCAç®—æ³•æ€»ç»“ä¸€ä¸‹PCAçš„ç®—æ³•æ­¥éª¤ï¼šè®¾æœ‰mæ¡nç»´æ•°æ®ã€‚å°†åŸå§‹æ•°æ®æŒ‰åˆ—ç»„æˆnè¡Œmåˆ—çŸ©é˜µXå°†Xçš„æ¯ä¸€è¡Œï¼ˆä»£è¡¨ä¸€ä¸ªå±æ€§å­—æ®µï¼‰è¿›è¡Œé›¶å‡å€¼åŒ–ï¼Œå³å‡å»è¿™ä¸€è¡Œçš„å‡å€¼æ±‚å‡ºåæ–¹å·®çŸ©é˜µC=1mXXTæ±‚å‡ºåæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼åŠå¯¹åº”çš„ç‰¹å¾å‘é‡å°†ç‰¹å¾å‘é‡æŒ‰å¯¹åº”ç‰¹å¾å€¼å¤§å°ä»ä¸Šåˆ°ä¸‹æŒ‰è¡Œæ’åˆ—æˆçŸ©é˜µï¼Œå–å‰kè¡Œç»„æˆçŸ©é˜µPY=PX å³ä¸ºé™ç»´åˆ°kç»´åçš„æ•°æ® å®ä¾‹è¿™é‡Œä»¥ä¸Šæ–‡æåˆ°çš„(1102020011)ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨PCAæ–¹æ³•å°†è¿™ç»„äºŒç»´æ•°æ®å…¶é™åˆ°ä¸€ç»´ã€‚å› ä¸ºè¿™ä¸ªçŸ©é˜µçš„æ¯è¡Œå·²ç»æ˜¯é›¶å‡å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥æ±‚åæ–¹å·®çŸ©é˜µï¼šC=15(1102020011)(1210002101)=(65454565)ç„¶åæ±‚å…¶ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œå…·ä½“æ±‚è§£æ–¹æ³•ä¸å†è¯¦è¿°ï¼Œå¯ä»¥å‚è€ƒç›¸å…³èµ„æ–™ã€‚æ±‚è§£åç‰¹å¾å€¼ä¸ºï¼šÎ»1=2,Î»2=2/5å…¶å¯¹åº”çš„ç‰¹å¾å‘é‡åˆ†åˆ«æ˜¯ï¼šc1(11),c2(11)å…¶ä¸­å¯¹åº”çš„ç‰¹å¾å‘é‡åˆ†åˆ«æ˜¯ä¸€ä¸ªé€šè§£ï¼Œc1å’Œc2å¯å–ä»»æ„å®æ•°ã€‚é‚£ä¹ˆæ ‡å‡†åŒ–åçš„ç‰¹å¾å‘é‡ä¸ºï¼š(1/21/2),(1/21/2)å› æ­¤æˆ‘ä»¬çš„çŸ©é˜µPæ˜¯ï¼šP=(1/21/21/21/2)å¯ä»¥éªŒè¯åæ–¹å·®çŸ©é˜µCçš„å¯¹è§’åŒ–ï¼šPCPT=(1/21/21/21/2)(6/54/54/56/5)(1/21/21/21/2)=(2002/5)æœ€åæˆ‘ä»¬ç”¨Pçš„ç¬¬ä¸€è¡Œä¹˜ä»¥æ•°æ®çŸ©é˜µï¼Œå°±å¾—åˆ°äº†é™ç»´åçš„è¡¨ç¤ºï¼šY=(1/21/2)(1102020011)=(3/21/203/21/2)é™ç»´æŠ•å½±ç»“æœå¦‚ä¸‹å›¾ï¼š è¿›ä¸€æ­¥è®¨è®ºæ ¹æ®ä¸Šé¢å¯¹PCAçš„æ•°å­¦åŸç†çš„è§£é‡Šï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ä¸€äº›PCAçš„èƒ½åŠ›å’Œé™åˆ¶ã€‚PCAæœ¬è´¨ä¸Šæ˜¯å°†æ–¹å·®æœ€å¤§çš„æ–¹å‘ä½œä¸ºä¸»è¦ç‰¹å¾ï¼Œå¹¶ä¸”åœ¨å„ä¸ªæ­£äº¤æ–¹å‘ä¸Šå°†æ•°æ®â€œç¦»ç›¸å…³â€ï¼Œä¹Ÿå°±æ˜¯è®©å®ƒä»¬åœ¨ä¸åŒæ­£äº¤æ–¹å‘ä¸Šæ²¡æœ‰ç›¸å…³æ€§ã€‚å› æ­¤ï¼ŒPCAä¹Ÿå­˜åœ¨ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚å®ƒå¯ä»¥å¾ˆå¥½çš„è§£é™¤çº¿æ€§ç›¸å…³ï¼Œä½†æ˜¯å¯¹äºé«˜é˜¶ç›¸å…³æ€§å°±æ²¡æœ‰åŠæ³•äº†ï¼Œå¯¹äºå­˜åœ¨é«˜é˜¶ç›¸å…³æ€§çš„æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘Kernel PCAï¼Œé€šè¿‡Kernelå‡½æ•°å°†éçº¿æ€§ç›¸å…³è½¬ä¸ºçº¿æ€§ç›¸å…³ï¼Œå…³äºè¿™ç‚¹å°±ä¸å±•å¼€è®¨è®ºäº†ã€‚å¦å¤–ï¼ŒPCAå‡è®¾æ•°æ®å„ä¸»ç‰¹å¾æ˜¯åˆ†å¸ƒåœ¨æ­£äº¤æ–¹å‘ä¸Šï¼Œå¦‚æœåœ¨éæ­£äº¤æ–¹å‘ä¸Šå­˜åœ¨å‡ ä¸ªæ–¹å·®è¾ƒå¤§çš„æ–¹å‘ï¼ŒPCAçš„æ•ˆæœå°±å¤§æ‰“æŠ˜æ‰£äº†ã€‚æœ€åéœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒPCAæ˜¯ä¸€ç§æ— å‚æ•°æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯è¯´é¢å¯¹åŒæ ·çš„æ•°æ®ï¼Œå¦‚æœä¸è€ƒè™‘æ¸…æ´—ï¼Œè°æ¥åšç»“æœéƒ½ä¸€æ ·ï¼Œæ²¡æœ‰ä¸»è§‚å‚æ•°çš„ä»‹å…¥ï¼Œæ‰€ä»¥PCAä¾¿äºé€šç”¨å®ç°ï¼Œä½†æ˜¯æœ¬èº«æ— æ³•ä¸ªæ€§åŒ–çš„ä¼˜åŒ–ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©æœ‹å‹ä»¬äº†è§£PCAçš„æ•°å­¦ç†è®ºåŸºç¡€å’Œå®ç°åŸç†ï¼Œå€Ÿæ­¤äº†è§£PCAçš„é€‚ç”¨åœºæ™¯å’Œé™åˆ¶ï¼Œä»è€Œæ›´å¥½çš„ä½¿ç”¨è¿™ä¸ªç®—æ³•ã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"ç‰¹å¾å·¥ç¨‹","slug":"ç‰¹å¾å·¥ç¨‹","permalink":"http://www.wortyby.com/tags/ç‰¹å¾å·¥ç¨‹/"},{"name":"ç‰¹å¾å‘é‡","slug":"ç‰¹å¾å‘é‡","permalink":"http://www.wortyby.com/tags/ç‰¹å¾å‘é‡/"},{"name":"æ¦‚ç‡è®º","slug":"æ¦‚ç‡è®º","permalink":"http://www.wortyby.com/tags/æ¦‚ç‡è®º/"},{"name":"çº¿æ€§ä»£æ•°","slug":"çº¿æ€§ä»£æ•°","permalink":"http://www.wortyby.com/tags/çº¿æ€§ä»£æ•°/"}]},{"title":"Apache Kylin Cube é«˜çº§è®¾ç½®","slug":"Apache Kylin Cube é«˜çº§è®¾ç½®","date":"2018-10-12T01:47:42.000Z","updated":"2018-10-12T01:47:42.000Z","comments":true,"path":"2018/10/12/Apache Kylin Cube é«˜çº§è®¾ç½®/","link":"","permalink":"http://www.wortyby.com/2018/10/12/Apache Kylin Cube é«˜çº§è®¾ç½®/","excerpt":"","text":"å¼•å­éšç€ç»´åº¦æ•°ç›®çš„å¢åŠ ï¼ŒCuboid çš„æ•°é‡ä¼šçˆ†ç‚¸å¼åœ°å¢é•¿ã€‚ä¸ºäº†ç¼“è§£ Cube çš„æ„å»ºå‹åŠ›ï¼ŒApache Kylin å¼•å…¥äº†ä¸€ç³»åˆ—çš„é«˜çº§è®¾ç½®ï¼Œå¸®åŠ©ç”¨æˆ·ç­›é€‰å‡ºçœŸæ­£éœ€è¦çš„ Cuboidã€‚è¿™äº›é«˜çº§è®¾ç½®åŒ…æ‹¬èšåˆç»„ï¼ˆAggregation Groupï¼‰ã€è”åˆç»´åº¦ï¼ˆJoint Dimensionï¼‰ã€å±‚çº§ç»´åº¦ï¼ˆHierachy Dimensionï¼‰å’Œå¿…è¦ç»´åº¦ï¼ˆMandatory Dimensionï¼‰ç­‰ã€‚â€ä¼—æ‰€å‘¨çŸ¥ï¼ŒApache Kylin çš„ä¸»è¦å·¥ä½œå°±æ˜¯ä¸ºæºæ•°æ®æ„å»º N ä¸ªç»´åº¦çš„ Cubeï¼Œå®ç°èšåˆçš„é¢„è®¡ç®—ã€‚ç†è®ºä¸Šè€Œè¨€ï¼Œæ„å»º N ä¸ªç»´åº¦çš„ Cube ä¼šç”Ÿæˆ 2N ä¸ª Cuboidï¼Œ å¦‚å›¾ 1 æ‰€ç¤ºï¼Œæ„å»ºä¸€ä¸ª 4 ä¸ªç»´åº¦ï¼ˆAï¼ŒBï¼ŒC, Dï¼‰çš„ Cubeï¼Œéœ€è¦ç”Ÿæˆ 16 ä¸ªCuboidã€‚å›¾1éšç€ç»´åº¦æ•°ç›®çš„å¢åŠ  Cuboid çš„æ•°é‡ä¼šçˆ†ç‚¸å¼åœ°å¢é•¿ï¼Œä¸ä»…å ç”¨å¤§é‡çš„å­˜å‚¨ç©ºé—´è¿˜ä¼šå»¶é•¿ Cube çš„æ„å»ºæ—¶é—´ã€‚ä¸ºäº†ç¼“è§£ Cube çš„æ„å»ºå‹åŠ›ï¼Œå‡å°‘ç”Ÿæˆçš„ Cuboid æ•°ç›®ï¼ŒApache Kylin å¼•å…¥äº†ä¸€ç³»åˆ—çš„é«˜çº§è®¾ç½®ï¼Œå¸®åŠ©ç”¨æˆ·ç­›é€‰å‡ºçœŸæ­£éœ€è¦çš„ Cuboidã€‚è¿™äº›é«˜çº§è®¾ç½®åŒ…æ‹¬ èšåˆç»„ï¼ˆAggregation Groupï¼‰ã€è”åˆç»´åº¦ï¼ˆJoint Dimensionï¼‰ã€**å±‚çº§ç»´åº¦ï¼ˆHierachy Dimensionï¼‰å’Œå¿…è¦ç»´åº¦ï¼ˆMandatory Dimensionï¼‰**ç­‰ï¼Œæœ¬ç³»åˆ—å°†æ·±å…¥è®²è§£è¿™äº›é«˜çº§è®¾ç½®çš„å«ä¹‰åŠå…¶é€‚ç”¨çš„åœºæ™¯ã€‚ èšåˆç»„ï¼ˆAggregation Groupï¼‰**ç”¨æˆ·æ ¹æ®è‡ªå·±å…³æ³¨çš„ç»´åº¦ç»„åˆï¼Œå¯ä»¥åˆ’åˆ†å‡ºè‡ªå·±å…³æ³¨çš„ç»„åˆå¤§ç±»ï¼Œè¿™äº›å¤§ç±»åœ¨ Apache Kylin é‡Œé¢è¢«ç§°ä¸ºèšåˆç»„ã€‚**ä¾‹å¦‚å›¾ 1 ä¸­å±•ç¤ºçš„ Cubeï¼Œå¦‚æœç”¨æˆ·ä»…ä»…å…³æ³¨ç»´åº¦ AB ç»„åˆå’Œç»´åº¦ CD ç»„åˆï¼Œé‚£ä¹ˆè¯¥ Cube åˆ™å¯ä»¥è¢«åˆ†åŒ–æˆä¸¤ä¸ªèšåˆç»„ï¼Œåˆ†åˆ«æ˜¯èšåˆç»„ AB å’Œèšåˆç»„ CDã€‚å¦‚å›¾ 2 æ‰€ç¤ºï¼Œç”Ÿæˆçš„ Cuboid æ•°ç›®ä» 16 ä¸ªç¼©å‡æˆäº† 8 ä¸ªã€‚å›¾2ç”¨æˆ·å…³å¿ƒçš„èšåˆç»„ä¹‹é—´å¯èƒ½åŒ…å«ç›¸åŒçš„ç»´åº¦ï¼Œä¾‹å¦‚èšåˆç»„ ABC å’Œèšåˆç»„ BCD éƒ½åŒ…å«ç»´åº¦ B å’Œç»´åº¦ Cã€‚è¿™äº›èšåˆç»„ä¹‹é—´ä¼šè¡ç”Ÿå‡ºç›¸åŒçš„ Cuboidï¼Œä¾‹å¦‚èšåˆç»„ ABC ä¼šäº§ç”Ÿ Cuboid BCï¼Œèšåˆç»„ BCD ä¹Ÿä¼šäº§ç”Ÿ Cuboid BCã€‚è¿™äº› Cuboidä¸ä¼šè¢«é‡å¤ç”Ÿæˆï¼Œä¸€ä»½ Cuboid ä¸ºè¿™äº›èšåˆç»„æ‰€å…±æœ‰ï¼Œå¦‚å›¾ 3 æ‰€ç¤ºã€‚å›¾3æœ‰äº†èšåˆç»„ç”¨æˆ·å°±å¯ä»¥ç²—ç²’åº¦åœ°å¯¹ Cuboid è¿›è¡Œç­›é€‰ï¼Œè·å–è‡ªå·±æƒ³è¦çš„ç»´åº¦ç»„åˆã€‚ èšåˆç»„åº”ç”¨å®ä¾‹å‡è®¾åˆ›å»ºä¸€ä¸ªäº¤æ˜“æ•°æ®çš„ Cubeï¼Œå®ƒåŒ…å«äº†ä»¥ä¸‹ä¸€äº›ç»´åº¦ï¼šé¡¾å®¢ ID buyer_id äº¤æ˜“æ—¥æœŸ cal_dtã€ä»˜æ¬¾çš„æ–¹å¼ pay_type å’Œä¹°å®¶æ‰€åœ¨çš„åŸå¸‚ cityã€‚æœ‰æ—¶å€™ï¼Œåˆ†æå¸ˆéœ€è¦é€šè¿‡åˆ†ç»„èšåˆ cityã€cal_dt å’Œ pay_type æ¥è·çŸ¥ä¸åŒæ¶ˆè´¹æ–¹å¼åœ¨ä¸åŒåŸå¸‚çš„åº”ç”¨æƒ…å†µï¼›æœ‰æ—¶å€™ï¼Œåˆ†æå¸ˆéœ€è¦é€šè¿‡èšåˆ city ã€cal_dt å’Œ buyer_idï¼Œæ¥æŸ¥çœ‹é¡¾å®¢åœ¨ä¸åŒåŸå¸‚çš„æ¶ˆè´¹è¡Œä¸ºã€‚åœ¨ä¸Šè¿°çš„å®ä¾‹ä¸­ï¼Œæ¨èå»ºç«‹ä¸¤ä¸ªèšåˆç»„ï¼ŒåŒ…å«çš„ç»´åº¦å’Œæ–¹å¼å¦‚å›¾ 4 ï¼šå›¾4èšåˆç»„ 1ï¼š [cal_dt, city, pay_type]èšåˆç»„ 2ï¼š [cal_dt, city, buyer_id]åœ¨ä¸è€ƒè™‘å…¶ä»–å¹²æ‰°å› ç´ çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„èšåˆç»„å°†èŠ‚çœä¸å¿…è¦çš„ 3 ä¸ª Cuboid: [pay_type, buyer_id]ã€[city, pay_type, buyer_id] å’Œ [cal_dt, pay_type, buyer_id] ç­‰ï¼ŒèŠ‚çœäº†å­˜å‚¨èµ„æºå’Œæ„å»ºçš„æ‰§è¡Œæ—¶é—´ã€‚ Case 1:1SELECT cal_dt, city, pay_type, count(*) FROM table GROUP BY cal_dt, city, pay_typeåˆ™å°†ä» Cuboid [cal_dt, city, pay_type] ä¸­è·å–æ•°æ®ã€‚ Case2:1SELECT cal_dt, city, buy_id, count(*) FROM table GROUP BY cal_dt, city, buyer_idåˆ™å°†ä» Cuboid [cal_dt, city, pay_type] ä¸­è·å–æ•°æ®ã€‚ Case3 å¦‚æœæœ‰ä¸€æ¡ä¸å¸¸ç”¨çš„æŸ¥è¯¢:1SELECT pay_type, buyer_id, count(*) FROM table GROUP BY pay_type, buyer_idåˆ™æ²¡æœ‰ç°æˆçš„å®Œå…¨åŒ¹é…çš„ Cuboidã€‚æ­¤æ—¶ï¼ŒApache Kylin ä¼šé€šè¿‡åœ¨çº¿è®¡ç®—çš„æ–¹å¼ï¼Œä»ç°æœ‰çš„ Cuboid ä¸­è®¡ç®—å‡ºæœ€ç»ˆç»“æœã€‚ è”åˆç»´åº¦ï¼ˆJoint Dimensionï¼‰ç”¨æˆ·æœ‰æ—¶å¹¶ä¸å…³å¿ƒç»´åº¦ä¹‹é—´å„ç§ç»†èŠ‚çš„ç»„åˆæ–¹å¼ï¼Œä¾‹å¦‚ç”¨æˆ·çš„æŸ¥è¯¢è¯­å¥ä¸­ä»…ä»…ä¼šå‡ºç° group by A, B, Cï¼Œè€Œä¸ä¼šå‡ºç° group by A, B æˆ–è€… group by C ç­‰ç­‰è¿™äº›ç»†åŒ–çš„ç»´åº¦ç»„åˆã€‚è¿™ä¸€ç±»é—®é¢˜å°±æ˜¯è”åˆç»´åº¦æ‰€è§£å†³çš„é—®é¢˜ã€‚ä¾‹å¦‚å°†ç»´åº¦ Aã€B å’Œ C å®šä¹‰ä¸ºè”åˆç»´åº¦ï¼ŒApache Kylin å°±ä»…ä»…ä¼šæ„å»º Cuboid ABCï¼Œè€Œ Cuboid ABã€BCã€A ç­‰ç­‰Cuboid éƒ½ä¸ä¼šè¢«ç”Ÿæˆã€‚æœ€ç»ˆçš„ Cube ç»“æœå¦‚å›¾5æ‰€ç¤ºï¼ŒCuboid æ•°ç›®ä» 16 å‡å°‘åˆ° 4ã€‚å›¾5 è”åˆç»´åº¦åº”ç”¨å®ä¾‹å‡è®¾åˆ›å»ºä¸€ä¸ªäº¤æ˜“æ•°æ®çš„Cubeï¼Œå®ƒå…·æœ‰å¾ˆå¤šæ™®é€šçš„ç»´åº¦ï¼Œåƒæ˜¯äº¤æ˜“æ—¥æœŸ cal_dtï¼Œäº¤æ˜“çš„åŸå¸‚ cityï¼Œé¡¾å®¢æ€§åˆ« sex_id å’Œæ”¯ä»˜ç±»å‹ pay_type ç­‰ã€‚åˆ†æå¸ˆå¸¸ç”¨çš„åˆ†ææ–¹æ³•ä¸ºé€šè¿‡æŒ‰ç…§äº¤æ˜“æ—¶é—´ã€äº¤æ˜“åœ°ç‚¹å’Œé¡¾å®¢æ€§åˆ«æ¥èšåˆï¼Œè·å–ä¸åŒåŸå¸‚ç”·å¥³é¡¾å®¢é—´ä¸åŒçš„æ¶ˆè´¹åå¥½ï¼Œä¾‹å¦‚åŒæ—¶èšåˆäº¤æ˜“æ—¥æœŸ cal_dtã€äº¤æ˜“çš„åŸå¸‚ city å’Œé¡¾å®¢æ€§åˆ« sex_id æ¥åˆ†ç»„ã€‚åœ¨ä¸Šè¿°çš„å®ä¾‹ä¸­ï¼Œæ¨èåœ¨å·²æœ‰çš„èšåˆç»„ä¸­å»ºç«‹ä¸€ç»„è”åˆç»´åº¦ï¼ŒåŒ…å«çš„ç»´åº¦å’Œç»„åˆæ–¹å¼å¦‚å›¾6ï¼šå›¾6èšåˆç»„ï¼š[cal_dt, city, sex_idï¼Œpay_type]è”åˆç»´åº¦ï¼š [cal_dt, city, sex_id] Case 1ï¼š1SELECT cal_dt, city, sex_id, count(*) FROM table GROUP BY cal_dt, city, sex_idåˆ™å®ƒå°†ä»Cuboid [cal_dt, city, sex_id]ä¸­è·å–æ•°æ® Case2å¦‚æœæœ‰ä¸€æ¡ä¸å¸¸ç”¨çš„æŸ¥è¯¢ï¼š1SELECT cal_dt, city, count(*) FROM table GROUP BY cal_dt, cityåˆ™æ²¡æœ‰ç°æˆçš„å®Œå…¨åŒ¹é…çš„ Cuboidï¼ŒApache Kylin ä¼šé€šè¿‡åœ¨çº¿è®¡ç®—çš„æ–¹å¼ï¼Œä»ç°æœ‰çš„ Cuboid ä¸­è®¡ç®—å‡ºæœ€ç»ˆç»“æœã€‚ å±‚çº§ç»´åº¦ï¼ˆHierarchy Dimensionï¼‰ç”¨æˆ·é€‰æ‹©çš„ç»´åº¦ä¸­å¸¸å¸¸ä¼šå‡ºç°å…·æœ‰å±‚çº§å…³ç³»çš„ç»´åº¦ã€‚ä¾‹å¦‚å¯¹äºå›½å®¶ï¼ˆcountryï¼‰ã€çœä»½ï¼ˆprovinceï¼‰å’ŒåŸå¸‚ï¼ˆcityï¼‰è¿™ä¸‰ä¸ªç»´åº¦ï¼Œä»ä¸Šè€Œä¸‹æ¥è¯´å›½å®¶ï¼çœä»½ï¼åŸå¸‚ä¹‹é—´åˆ†åˆ«æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·å¯¹äºè¿™ä¸‰ä¸ªç»´åº¦çš„æŸ¥è¯¢å¯ä»¥å½’ç±»ä¸ºä»¥ä¸‹ä¸‰ç±»:group by countrygroup by country, provinceï¼ˆç­‰åŒäºgroup by provinceï¼‰group by country, province, cityï¼ˆç­‰åŒäº group by country, city æˆ–è€…group by cityï¼‰ä»¥å›¾7æ‰€ç¤ºçš„ Cube ä¸ºä¾‹ï¼Œå‡è®¾ç»´åº¦ A ä»£è¡¨å›½å®¶ï¼Œç»´åº¦ B ä»£è¡¨çœä»½ï¼Œç»´åº¦ C ä»£è¡¨åŸå¸‚ï¼Œé‚£ä¹ˆABC ä¸‰ä¸ªç»´åº¦å¯ä»¥è¢«è®¾ç½®ä¸ºå±‚çº§ç»´åº¦ï¼Œç”Ÿæˆçš„Cube å¦‚å›¾7æ‰€ç¤ºã€‚å›¾7ä¾‹å¦‚ï¼ŒCuboid [A,C,D]=Cuboid[A, B, C, D]ï¼ŒCuboid[B, D]=Cuboid[A, B, D]ï¼Œå› è€Œ Cuboid[A, C, D] å’Œ Cuboid[B, D] å°±ä¸å¿…é‡å¤å­˜å‚¨ã€‚å›¾8å±•ç¤ºäº† Kylin æŒ‰ç…§å‰æ–‡çš„æ–¹æ³•å°†å†—ä½™çš„Cuboid å‰ªæä»è€Œå½¢æˆå›¾ 2 çš„ Cube ç»“æ„ï¼ŒCuboid æ•°ç›®ä» 16 å‡å°åˆ° 8ã€‚å›¾8 å±‚çº§ç»´åº¦åº”ç”¨å®ä¾‹å‡è®¾ä¸€ä¸ªäº¤æ˜“æ•°æ®çš„ Cubeï¼Œå®ƒå…·æœ‰å¾ˆå¤šæ™®é€šçš„ç»´åº¦ï¼Œåƒæ˜¯äº¤æ˜“çš„åŸå¸‚ cityï¼Œäº¤æ˜“çš„çœ provinceï¼Œäº¤æ˜“çš„å›½å®¶ countryï¼Œ å’Œæ”¯ä»˜ç±»å‹ pay_typeç­‰ã€‚åˆ†æå¸ˆå¯ä»¥é€šè¿‡æŒ‰ç…§äº¤æ˜“åŸå¸‚ã€äº¤æ˜“çœä»½ã€äº¤æ˜“å›½å®¶å’Œæ”¯ä»˜ç±»å‹æ¥èšåˆï¼Œè·å–ä¸åŒå±‚çº§çš„åœ°ç†ä½ç½®æ¶ˆè´¹è€…çš„æ”¯ä»˜åå¥½ã€‚åœ¨ä¸Šè¿°çš„å®ä¾‹ä¸­ï¼Œå»ºè®®åœ¨å·²æœ‰çš„èšåˆç»„ä¸­å»ºç«‹ä¸€ç»„å±‚çº§ç»´åº¦ï¼ˆå›½å®¶countryï¼çœprovinceï¼åŸå¸‚cityï¼‰ï¼ŒåŒ…å«çš„ç»´åº¦å’Œç»„åˆæ–¹å¼å¦‚å›¾9ï¼šå›¾9èšåˆç»„ï¼š[country, province, cityï¼Œpay_type]å±‚çº§ç»´åº¦ï¼š [country, province, city] Case 1 å½“åˆ†æå¸ˆæƒ³ä»åŸå¸‚ç»´åº¦è·å–æ¶ˆè´¹åå¥½æ—¶ï¼š1SELECT city, pay_type, count(*) FROM table GROUP BY city, pay_typeåˆ™å®ƒå°†ä» Cuboid [country, province, city, pay_type] ä¸­è·å–æ•°æ®ã€‚ Case 2 å½“åˆ†æå¸ˆæƒ³ä»çœçº§ç»´åº¦è·å–æ¶ˆè´¹åå¥½æ—¶ï¼š1SELECT province, pay_type, count(*) FROM table GROUP BY province, pay_typeåˆ™å®ƒå°†ä»Cuboid [country, province, pay_type] ä¸­è·å–æ•°æ®ã€‚ Case 3 å½“åˆ†æå¸ˆæƒ³ä»å›½å®¶ç»´åº¦è·å–æ¶ˆè´¹åå¥½æ—¶ï¼š1SELECT country, pay_type, count(*) FROM table GROUP BY country, pay_typeåˆ™å®ƒå°†ä»Cuboid [country, pay_type] ä¸­è·å–æ•°æ®ã€‚ Case 4 å¦‚æœåˆ†æå¸ˆæƒ³è·å–ä¸åŒç²’åº¦åœ°ç†ç»´åº¦çš„èšåˆç»“æœæ—¶ï¼šæ— ä¸€ä¾‹å¤–éƒ½å¯ä»¥ç”±å›¾ 3 ä¸­çš„ cuboid æä¾›æ•°æ® ã€‚ä¾‹å¦‚ï¼ŒSELECT country, city, count(*) FROM table GROUP BY country, city åˆ™å®ƒå°†ä» Cuboid [country, province, city] ä¸­è·å–æ•°æ®ã€‚ å¿…è¦ç»´åº¦ ï¼ˆMandatory Dimensionï¼‰ç”¨æˆ·æœ‰æ—¶ä¼šå¯¹æŸä¸€ä¸ªæˆ–å‡ ä¸ªç»´åº¦ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢è¯·æ±‚ä¸­éƒ½å­˜åœ¨group byè¿™ä¸ªç»´åº¦ï¼Œé‚£ä¹ˆè¿™ä¸ªç»´åº¦å°±è¢«ç§°ä¸ºå¿…è¦ç»´åº¦ï¼Œåªæœ‰åŒ…å«æ­¤ç»´åº¦çš„Cuboidä¼šè¢«ç”Ÿæˆï¼ˆå¦‚å›¾10ï¼‰ã€‚å›¾10ä»¥å›¾ 1ä¸­çš„Cubeä¸ºä¾‹ï¼Œå‡è®¾ç»´åº¦Aæ˜¯å¿…è¦ç»´åº¦ï¼Œé‚£ä¹ˆç”Ÿæˆçš„Cubeåˆ™å¦‚å›¾11æ‰€ç¤ºï¼Œç»´åº¦æ•°ç›®ä»16å˜ä¸º9ã€‚å›¾11 å¿…è¦ç»´åº¦åº”ç”¨å®ä¾‹å‡è®¾ä¸€ä¸ªäº¤æ˜“æ•°æ®çš„Cubeï¼Œå®ƒå…·æœ‰å¾ˆå¤šæ™®é€šçš„ç»´åº¦ï¼Œåƒæ˜¯äº¤æ˜“æ—¶é—´order_dtï¼Œäº¤æ˜“çš„åœ°ç‚¹locationï¼Œäº¤æ˜“çš„å•†å“productå’Œæ”¯ä»˜ç±»å‹pay_typeç­‰ã€‚å…¶ä¸­ï¼Œäº¤æ˜“æ—¶é—´å°±æ˜¯ä¸€ä¸ªè¢«é«˜é¢‘ä½œä¸ºåˆ†ç»„æ¡ä»¶ï¼ˆgroup byï¼‰çš„ç»´åº¦ã€‚ å¦‚æœå°†äº¤æ˜“æ—¶é—´order_dtè®¾ç½®ä¸ºå¿…è¦ç»´åº¦ï¼ŒåŒ…å«çš„ç»´åº¦å’Œç»„åˆæ–¹å¼å¦‚å›¾12ï¼šå›¾12 ç³»åˆ—æ€»ç»“æ ¹æ®æœ¬ç³»åˆ—çš„åŸç†ä»‹ç»ï¼Œåœ¨Kylinçš„é«˜çº§è®¾ç½®ä¸­ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®æŸ¥è¯¢éœ€æ±‚å¯¹Cubeæ„å»ºé¢„è®¡ç®—çš„ç»“æœè¿›è¡Œä¼˜åŒ–ï¼ˆå‰ªæï¼‰ï¼Œä»è€Œå‡å°‘å ç”¨çš„å­˜å‚¨ç©ºé—´ã€‚ è€Œä¼˜åŒ–å¾—å½“çš„Cubeå¯ä»¥åœ¨å ç”¨å°½é‡å°‘çš„å­˜å‚¨ç©ºé—´çš„åŒæ—¶æä¾›æå¼ºçš„æŸ¥è¯¢æ€§èƒ½ã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"KYLIN","slug":"KYLIN","permalink":"http://www.wortyby.com/tags/KYLIN/"},{"name":"CUBE","slug":"CUBE","permalink":"http://www.wortyby.com/tags/CUBE/"}]},{"title":"Apache Kylin Cube æ„å»ºåŸç†","slug":"Apache Kylin Cube æ„å»ºåŸç†","date":"2018-10-08T11:43:25.000Z","updated":"2018-10-08T11:43:25.000Z","comments":true,"path":"2018/10/08/Apache Kylin Cube æ„å»ºåŸç†/","link":"","permalink":"http://www.wortyby.com/2018/10/08/Apache Kylin Cube æ„å»ºåŸç†/","excerpt":"","text":"æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Apache Kylinæ˜¯å¦‚ä½•å°†Hiveè¡¨ä¸­çš„æ•°æ®è½¬åŒ–ä¸ºHBaseçš„KVç»“æ„ï¼Œå¹¶ç®€å•ä»‹ç»äº†Kylinçš„SQLæŸ¥è¯¢æ˜¯å¦‚ä½•è½¬åŒ–ä¸ºHBaseçš„Scanæ“ä½œã€‚ Apache Kylin æ˜¯ä»€ä¹ˆApache Kylinæ˜¯ä¸€ä¸ªå¼€æºçš„ã€åŸºäºHadoopç”Ÿæ€ç³»ç»Ÿçš„OLAPæŸ¥è¯¢å¼•æ“ï¼Œèƒ½å¤Ÿé€šè¿‡SQLæ¥å£å¯¹åäº¿ã€ç”šè‡³ç™¾äº¿è¡Œçš„è¶…å¤§æ•°æ®é›†å®ç°ç§’çº§çš„å¤šç»´åˆ†ææŸ¥è¯¢ã€‚ OLAP æ˜¯ä»€ä¹ˆå³è”æœºåˆ†æå¤„ç†ï¼šä»¥å¤æ‚çš„åˆ†æå‹æŸ¥è¯¢ä¸ºä¸»ï¼Œéœ€è¦æ‰«æï¼Œèšåˆå¤§é‡æ•°æ®ã€‚ Kylinå¦‚ä½•å®ç°è¶…å¤§æ•°æ®é›†çš„ç§’çº§å¤šç»´åˆ†ææŸ¥è¯¢é¢„è®¡ç®—å¯¹äºè¶…å¤§æ•°æ®é›†çš„å¤æ‚æŸ¥è¯¢ï¼Œæ—¢ç„¶ç°åœºè®¡ç®—éœ€è¦èŠ±è´¹è¾ƒé•¿æ—¶é—´ï¼Œé‚£ä¹ˆæ ¹æ®ç©ºé—´æ¢æ—¶é—´çš„åŸç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥æå‰å°†æ‰€æœ‰å¯èƒ½çš„è®¡ç®—ç»“æœè®¡ç®—å¹¶å­˜å‚¨ä¸‹æ¥ï¼Œä»è€Œå®ç°è¶…å¤§æ•°æ®é›†çš„ç§’çº§å¤šç»´åˆ†ææŸ¥è¯¢ã€‚ Kylinçš„é¢„è®¡ç®—æ˜¯å¦‚ä½•å®ç°çš„å°†æ•°æ®æºHiveè¡¨ä¸­çš„æ•°æ®æŒ‰ç…§æŒ‡å®šçš„ç»´åº¦å’ŒæŒ‡æ ‡ ç”±è®¡ç®—å¼•æ“MapReduceç¦»çº¿è®¡ç®—å‡ºæ‰€æœ‰å¯èƒ½çš„æŸ¥è¯¢ç»“æœ(å³Cube)å­˜å‚¨åˆ°HBaseä¸­ã€‚ Cube å’Œ Cuboidæ˜¯ä»€ä¹ˆç®€å•åœ°è¯´ï¼Œä¸€ä¸ªcubeå°±æ˜¯ä¸€ä¸ªHiveè¡¨çš„æ•°æ®æŒ‰ç…§æŒ‡å®šç»´åº¦ä¸æŒ‡æ ‡è®¡ç®—å‡ºçš„æ‰€æœ‰ç»„åˆç»“æœã€‚å…¶ä¸­æ¯ä¸€ç§ç»´åº¦ç»„åˆç§°ä¸ºcuboidï¼Œä¸€ä¸ªcuboidåŒ…å«ä¸€ç§å…·ä½“ç»´åº¦ç»„åˆä¸‹æ‰€æœ‰æŒ‡æ ‡çš„å€¼ã€‚å¦‚ä¸‹å›¾ï¼Œæ•´ä¸ªç«‹æ–¹ä½“ç§°ä¸º1ä¸ªcubeï¼Œç«‹æ–¹ä½“ä¸­æ¯ä¸ªç½‘æ ¼ç‚¹ç§°ä¸º1ä¸ªcuboidï¼Œå›¾ä¸­ï¼ˆA,B,C,Dï¼‰å’Œï¼ˆAï¼ŒDï¼‰éƒ½æ˜¯cuboidï¼Œç‰¹åˆ«çš„ï¼Œï¼ˆA,B,C,Dï¼‰ç§°ä¸ºBase cuboidã€‚cubeçš„è®¡ç®—è¿‡ç¨‹æ˜¯é€å±‚è®¡ç®—çš„ï¼Œé¦–å…ˆè®¡ç®—Base cuboidï¼Œç„¶åè®¡ç®—ç»´åº¦æ•°ä¾æ¬¡å‡å°‘ï¼Œé€å±‚å‘ä¸‹è®¡ç®—æ¯å±‚çš„cuboidã€‚å›¾1 Cuboid çš„ç»´åº¦å’ŒæŒ‡æ ‡å¦‚ä½•è½¬æ¢ä¸ºHBaseçš„KVç»“æ„ç®€å•çš„è¯´Cuboidçš„ç»´åº¦ä¼šæ˜ å°„ä¸ºHBaseçš„Rowkeyï¼ŒCuboidçš„æŒ‡æ ‡ä¼šæ˜ å°„ä¸ºHBaseçš„Valueã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å›¾2å¦‚ä¸Šå›¾åŸå§‹è¡¨æ‰€ç¤ºï¼šHiveè¡¨æœ‰ä¸¤ä¸ªç»´åº¦åˆ— year å’Œ cityï¼Œæœ‰ä¸€ä¸ªæŒ‡æ ‡åˆ— priceã€‚å¦‚ä¸Šå›¾é¢„èšåˆè¡¨æ‰€ç¤ºï¼šæˆ‘ä»¬å…·ä½“è¦è®¡ç®—çš„æ˜¯ year å’Œ city è¿™ä¸¤ä¸ªç»´åº¦æ‰€æœ‰ç»´åº¦ç»„åˆï¼ˆå³4ä¸ªcuboidï¼‰ä¸‹çš„ sum(priece) æŒ‡æ ‡ï¼Œè¿™ä¸ªæŒ‡æ ‡çš„å…·ä½“è®¡ç®—è¿‡ç¨‹å°±æ˜¯ç”±MapReduceå®Œæˆçš„ã€‚å¦‚ä¸Šå›¾å­—å…¸ç¼–ç æ‰€ç¤ºï¼šä¸ºäº†èŠ‚çœå­˜å‚¨èµ„æºï¼ŒKylinå¯¹ç»´åº¦å€¼è¿›è¡Œäº†å­—å…¸ç¼–ç ã€‚å›¾ä¸­å°† beijing å’Œshanghai ä¾æ¬¡ç¼–ç ä¸º0å’Œ1ã€‚å¦‚ä¸Šå›¾HBase KVå­˜å‚¨æ‰€ç¤ºï¼šåœ¨è®¡ç®—cuboidè¿‡ç¨‹ä¸­ï¼Œä¼šå°†Hiveè¡¨çš„æ•°æ®è½¬åŒ–ä¸ºHBaseçš„KVå½¢å¼ã€‚Rowkeyçš„å…·ä½“æ ¼å¼æ˜¯ cuboid id + å…·ä½“çš„ç»´åº¦å€¼ï¼ˆæœ€æ–°çš„Rowkeyä¸­ä¸ºäº†å¹¶å‘æŸ¥è¯¢è¿˜åŠ å…¥äº†ShardKeyï¼‰ï¼Œä»¥é¢„èšåˆè¡¨å†…å®¹çš„ç¬¬2è¡Œä¸ºä¾‹ï¼Œå…¶ç»´åº¦ç»„åˆæ˜¯ï¼ˆyearï¼Œcityï¼‰ï¼Œæ‰€ä»¥cuboid idå°±æ˜¯00000011ï¼Œcuboidæ˜¯8ä½ï¼Œå…·ä½“ç»´åº¦å€¼æ˜¯1994å’Œshanghaiï¼Œæ‰€ä»¥ç¼–ç åçš„ç»´åº¦å€¼å¯¹åº”ä¸Šå›¾çš„å­—å…¸ç¼–ç ä¹Ÿæ˜¯11ï¼Œæ‰€ä»¥HBaseçš„Rowkeyå°±æ˜¯0000001111ï¼Œå¯¹åº”çš„HBase Valueå°±æ˜¯ sum(priece) çš„å…·ä½“å€¼ã€‚æ‰€æœ‰çš„cuboidè®¡ç®—å®Œæˆåï¼Œä¼šå°†cuboidè½¬åŒ–ä¸ºHBaseçš„ KeyValue æ ¼å¼ç”ŸæˆHBaseçš„HFileï¼Œæœ€åå°†HFile loadè¿›cubeå¯¹åº”çš„HBaseè¡¨ä¸­ã€‚ Cube æ„å»ºè¿‡ç¨‹é‡è¦æºç åˆ†æ ä»Hiveè¡¨ç”ŸæˆBase Cuboidåœ¨å®é™…çš„cubeæ„å»ºè¿‡ç¨‹ä¸­ï¼Œä¼šé¦–å…ˆæ ¹æ®cubeçš„Hiveäº‹å®è¡¨å’Œç»´è¡¨ç”Ÿæˆä¸€å¼ å¤§å®½è¡¨ï¼Œç„¶åè®¡ç®—å¤§å®½è¡¨åˆ—çš„åŸºæ•°ï¼Œå»ºç«‹ç»´åº¦å­—å…¸ï¼Œä¼°ç®—cuboidçš„å¤§å°ï¼Œå»ºç«‹cubeå¯¹åº”çš„HBaseè¡¨ï¼Œå†è®¡ç®—base cuboidã€‚è®¡ç®—base cuboidå°±æ˜¯ä¸€ä¸ªMapReduceä½œä¸šï¼Œå…¶è¾“å…¥æ˜¯ä¸Šé¢æåˆ°çš„Hiveå¤§å®½è¡¨ï¼Œè¾“å‡ºæ˜¯çš„keyæ˜¯å„ç§ç»´åº¦ç»„åˆï¼Œvalueæ˜¯Hiveå¤§å®½è¡¨ä¸­æŒ‡æ ‡çš„å€¼ã€‚1234567891011121314org.apache.kylin.engine.mr.steps.BaseCuboidJobmap é˜¶æ®µç”Ÿæˆkey-valueçš„ä»£ç å¦‚ä¸‹ï¼š protected void outputKV(Context context) throws IOException, InterruptedException &#123; intermediateTableDesc.sanityCheck(bytesSplitter); byte[] rowKey = buildKey(bytesSplitter.getSplitBuffers()); outputKey.set(rowKey, 0, rowKey.length); ByteBuffer valueBuf = buildValue(bytesSplitter.getSplitBuffers()); outputValue.set(valueBuf.array(), 0, valueBuf.position()); context.write(outputKey, outputValue); &#125;æ‰€æœ‰è®¡ç®—cuboidçš„reduceé˜¶æ®µä»£ç éƒ½ä¸€æ ·ï¼Œè§ä¸‹é¢ã€‚ ä»Base Cuboid é€å±‚è®¡ç®— Cuboidã€‚ä»base cuboid é€å±‚è®¡ç®—æ¯å±‚çš„cuboidï¼Œä¹Ÿæ˜¯MapReduceä½œä¸šï¼Œmapé˜¶æ®µæ¯å±‚ç»´åº¦æ•°ä¾æ¬¡å‡å°‘ï¼Œreduceé˜¶æ®µå¯¹æŒ‡æ ‡è¿›è¡Œèšåˆã€‚12345678910111213141516171819org.apache.kylin.engine.mr.steps.CuboidReducer public void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException &#123; aggs.reset(); //MeasureAggregators æ ¹æ®æ¯ç§æŒ‡æ ‡çš„ä¸åŒç±»å‹å¯¹æŒ‡æ ‡è¿›è¡Œèšåˆ for (Text value : values) &#123; codec.decode(ByteBuffer.wrap(value.getBytes(), 0, value.getLength()), input); if (cuboidLevel &gt; 0) &#123; // Base Cuboid çš„ cuboidLevel æ˜¯0 aggs.aggregate(input, needAggr); //æŒ‡æ ‡è¿›è¡Œè¿›ä¸€æ­¥èšåˆ &#125; else &#123; aggs.aggregate(input); &#125; &#125; aggs.collectStates(result); ByteBuffer valueBuf = codec.encode(result); outputValue.set(valueBuf.array(), 0, valueBuf.position()); context.write(key, outputValue); Cuboid è½¬åŒ–ä¸ºHBaseçš„HFileã€‚ä¸»è¦å°±æ˜¯æ•°æ®æ ¼å¼çš„è½¬åŒ–ã€‚è¯¦æƒ…è¯·å‚è€ƒï¼š Hive æ•°æ® bulkload å¯¼å…¥ HBase ä¸åŒç±»å‹çš„æŒ‡æ ‡æ˜¯å¦‚ä½•è¿›è¡Œèšåˆçš„æ¯ç§ä¸åŒçš„æŒ‡æ ‡éƒ½ä¼šæœ‰å¯¹åº”çš„èšåˆç®—æ³•ï¼Œæ‰€æœ‰æŒ‡æ ‡èšåˆçš„åŸºç±»æ˜¯org.apache.kylin.measure.MeasureAggregator ã€‚å…¶æ ¸å¿ƒæ–¹æ³•å¦‚ä¸‹ï¼š12345abstract public void reset();//ä¸åŒç±»å‹çš„æŒ‡æ ‡ç®—æ³•ä¼šå®ç°è¯¥æ–¹æ³•abstract public void aggregate(V value);abstract public V getState();ä»¥æœ€ç®€å•çš„longç±»å‹çš„sumæŒ‡æ ‡ä¸ºä¾‹ï¼š12345678910111213141516171819public class LongSumAggregator extends MeasureAggregator&lt;LongMutable&gt; &#123; LongMutable sum = new LongMutable(); @Override public void reset() &#123; sum.set(0); &#125; @Override public void aggregate(LongMutable value) &#123; sum.set(sum.get() + value.get()); &#125; @Override public LongMutable getState() &#123; return sum; &#125;&#125; SQLæŸ¥è¯¢æ˜¯å¦‚ä½•è½¬åŒ–ä¸ºHBaseçš„Scanæ“ä½œçš„è¿˜æ˜¯ä»¥å›¾2ä¸¾ä¾‹ï¼Œå‡è®¾æŸ¥è¯¢SQLå¦‚ä¸‹ï¼š1234select year, sum(price)from tablewhere city = &quot;beijing&quot;group by yearè¿™ä¸ªSQLæ¶‰åŠç»´åº¦ year å’Œ cityï¼Œæ‰€ä»¥å…¶å¯¹åº”çš„cuboidæ˜¯00000011ï¼Œåˆå› ä¸ºcityçš„å€¼æ˜¯ç¡®å®šçš„ beijing,æ‰€ä»¥åœ¨Scan HBaseæ—¶å°±ä¼šScan Rowkeyä»¥00000011å¼€å¤´ä¸”cityçš„å€¼æ˜¯ beijing çš„è¡Œï¼Œå–åˆ°å¯¹åº”æŒ‡æ ‡ sum(price)çš„å€¼ï¼Œè¿”å›ç»™ç”¨æˆ·ã€‚ æ€»ç»“æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Apache Kylinæ˜¯å¦‚ä½•å°†Hiveè¡¨ä¸­çš„æ•°æ®è½¬åŒ–ä¸ºHBaseçš„KVç»“æ„ï¼Œå¹¶ç®€å•ä»‹ç»äº†Kylinçš„SQLæŸ¥è¯¢æ˜¯å¦‚ä½•è½¬åŒ–ä¸ºHBaseçš„Scanæ“ä½œã€‚å¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ã€‚åŸæ–‡é“¾æ¥","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"KYLIN","slug":"KYLIN","permalink":"http://www.wortyby.com/tags/KYLIN/"},{"name":"CUBE","slug":"CUBE","permalink":"http://www.wortyby.com/tags/CUBE/"}]},{"title":"PySpark ä¹‹ DataFrame","slug":"PySpark ä¹‹ DataFrame","date":"2018-09-30T05:36:51.000Z","updated":"2018-09-30T05:36:51.000Z","comments":true,"path":"2018/09/30/PySpark ä¹‹ DataFrame/","link":"","permalink":"http://www.wortyby.com/2018/09/30/PySpark ä¹‹ DataFrame/","excerpt":"","text":"èƒŒæ™¯DataFrameæ˜¯åœ¨Spark 1.3ä¸­æ­£å¼å¼•å…¥çš„ä¸€ç§ä»¥RDDä¸ºåŸºç¡€çš„ä¸å¯å˜çš„åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œç±»ä¼¼äºä¼ ç»Ÿæ•°æ®åº“çš„äºŒç»´è¡¨æ ¼ï¼Œæ•°æ®åœ¨å…¶ä¸­ä»¥åˆ—çš„å½¢å¼è¢«ç»„ç»‡å­˜å‚¨ã€‚å¦‚æœç†Ÿæ‚‰Pandasï¼Œå…¶ä¸Pandas DataFrameæ˜¯éå¸¸ç±»ä¼¼çš„ä¸œè¥¿ã€‚DataFrame APIå—åˆ°Rå’ŒPythonï¼ˆPandasï¼‰ä¸­çš„æ•°æ®æ¡†æ¶çš„å¯å‘ï¼Œä½†æ˜¯ä»åº•å±‚å¼€å§‹è®¾è®¡ä»¥æ”¯æŒç°ä»£å¤§æ•°æ®å’Œæ•°æ®ç§‘å­¦åº”ç”¨ç¨‹åºã€‚ä½œä¸ºç°æœ‰RDD APIçš„æ‰©å±•ï¼ŒDataFrameå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼šèƒ½å¤Ÿä»å•å°ç¬”è®°æœ¬ç”µè„‘ä¸Šçš„åƒå­—èŠ‚æ•°æ®æ‰©å±•åˆ°å¤§å‹ç¾¤é›†ä¸Šçš„PBçº§æ•°æ®æ”¯æŒå„ç§æ•°æ®æ ¼å¼å’Œå­˜å‚¨ç³»ç»Ÿé€šè¿‡Spark SQL Catalystä¼˜åŒ–å™¨å®ç°æœ€å…ˆè¿›çš„ä¼˜åŒ–å’Œä»£ç ç”Ÿæˆé€šè¿‡Sparkæ— ç¼é›†æˆæ‰€æœ‰å¤§æ•°æ®å·¥å…·å’ŒåŸºç¡€æ¶æ„Pythonï¼ŒJavaï¼ŒScalaå’ŒRçš„APIï¼ˆé€šè¿‡SparkRå¼€å‘ï¼‰å¯¹äºç†Ÿæ‚‰å…¶ä»–ç¼–ç¨‹è¯­è¨€æ•°æ®æ¡†æ¶çš„æ–°ç”¨æˆ·ï¼Œæ­¤APIåº”è¯¥è®©ä»–ä»¬æ„Ÿåˆ°å®¾è‡³å¦‚å½’ã€‚å¯¹äºç°æœ‰çš„Sparkç”¨æˆ·ï¼Œæ­¤æ‰©å±•APIå°†ä½¿Sparkæ›´æ˜“äºç¼–ç¨‹ï¼ŒåŒæ—¶é€šè¿‡æ™ºèƒ½ä¼˜åŒ–å’Œä»£ç ç”Ÿæˆæ¥æé«˜æ€§èƒ½ã€‚é€šè¿‡DataFrameä¸Catalystä¼˜åŒ–å™¨ï¼Œç°æœ‰çš„Sparkç¨‹åºè¿ç§»åˆ°DataFrameæ—¶æ€§èƒ½å¾—åˆ°æ”¹å–„ã€‚ç”±äºä¼˜åŒ–å™¨ç”Ÿæˆç”¨äºæ‰§è¡Œçš„JVMå­—èŠ‚ç ï¼Œå› æ­¤Pythonç”¨æˆ·å°†ä½“éªŒåˆ°ä¸Scalaå’ŒJavaç”¨æˆ·ç›¸åŒçš„é«˜æ€§èƒ½ã€‚ åˆ›å»ºDataFrameSparkä¸­æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å°†æ•°æ®ä»RDDè½¬åŒ–ä¸ºDataFrameï¼šåå°„æ¨æ–­æˆ–è€…ç¼–ç¨‹æŒ‡å®šã€‚åå°„æ¨æ–­æ˜¯Sparkåº”ç”¨ç¨‹åºè‡ªåŠ¨è¯†åˆ—çš„ç±»å‹ï¼Œç„¶åé€šè¿‡Spark SQLå°†è¡Œå¯¹è±¡çš„RDDè½¬æ¢ä¸ºDataFrameã€‚ç¼–ç¨‹æŒ‡å®šåˆ™æ˜¯åœ¨è¿è¡Œä¹‹å‰ï¼Œäººå·¥ä»Spark SQLä¸­å¼•å…¥æ•°æ®ç±»å‹åˆ†é…ç»™ä¸åŒçš„åˆ—ã€‚ ä½¿ç”¨æ•°æ®ç»“æ„ï¼šæ™®é€šè¯»å–csvä¸ºDataFramesæ•°æ®ã€‚123456#### è¯»å–csvä¸ºDataFrametraffic = spark.read.csv(&apos;E:\\Documents\\Desktop\\data.csv&apos;, header=&apos;true&apos;)#### åˆ›å»ºä¸´æ—¶è¡¨traffic.createOrReplaceTempView(&quot;traffic&quot;)#### æ˜¾ç¤ºå‰10è¡Œtraffic.show(10)æ‰“å°è¡¨ç»“æ„ï¼Œå¯ä»¥çœ‹å‡ºSparkè‡ªåŠ¨å°†æ‰€æœ‰åˆ—æ¨æ–­ä¸ºstringï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç±»å‹ã€‚1traffic.printSchema()é€šè¿‡pandasè¾…åŠ©è¯»å–csvã€‚123456import pandas as pd df = pd.read_csv(&apos;E:\\Documents\\Desktop\\data.csv&apos;) traffic = spark.createDataFrame(df)traffic.createOrReplaceTempView(&quot;traffic&quot;)traffic.printSchema() åå°„æ¨æ–­1234traffic = spark.read.csv(&apos;E:\\Documents\\Desktop\\data.csv&apos;, header=&apos;true&apos;, inferSchema=&apos;true&apos;)traffic.createOrReplaceTempView(&quot;traffic&quot;)traffic.show(10)traffic.printSchema()inferSchemaå±æ€§ç”¨æ¥æŒ‡ç¤ºæ˜¯å¦ä½¿ç”¨è‡ªåŠ¨æ¨æ–­ï¼Œé»˜è®¤ä¸ºFalseã€‚ ç¼–ç¨‹æŒ‡å®šå°½ç®¡è‡ªåŠ¨æ¨æ–­æ¯”è¾ƒæ–¹ä¾¿ï¼Œå¦‚æœå¯ç”¨äº†inferSchemaï¼Œåˆ™å‡½æ•°å°†æ•°æ®å…¨éƒ¨è¯»å…¥ä»¥ç¡®å®šè¾“å…¥æ¨¡å¼ã€‚è¦é¿å…éå†æ•´ä¸ªæ•°æ®ä¸€æ¬¡ï¼Œåº”è¯¥ä½¿ç”¨æ¨¡å¼æ˜ç¡®æŒ‡å®šæ¨¡å¼ã€‚StructField(field, data_type=None, nullable=True, metadata=None)field â€“ Either the name of the field or a StructField objectdata_type â€“ If present, the DataType of the StructField to createnullable â€“ Whether the field to add should be nullable (default True)metadata â€“ Any additional metadata (default None)123456789101112131415from pyspark.sql.types import *# æŒ‡å®šDataFrameæ¯ä¸ªåˆ—çš„æ¨¡å¼schema = StructType([... StructField(&quot;detectorid&quot;, IntegerType()),... StructField(&quot;starttime&quot;,StringType()),... StructField(&quot;volume&quot;, IntegerType()),... StructField(&quot;speed&quot;, FloatType()),... StructField(&quot;occupancy&quot;, FloatType())])# ä½¿ç”¨æŒ‡å®šæ¨¡å¼è¯»å…¥traffic = spark.read.csv(&apos;E:\\Documents\\Desktop\\data.csv&apos;, header=&apos;true&apos;, schema=schema)traffic.createOrReplaceTempView(&quot;traffic&quot;)traffic.show(10)traffic.printSchema() DataFrameæŸ¥è¯¢ å¸¸ç”¨API select()æŠ•å½±ä¸€ç»„è¡¨è¾¾å¼å¹¶è¿”å›ä¸€ä¸ªæ–°çš„DataFrameã€‚å‚æ•°ï¼šcols - åˆ—åç§°ï¼ˆå­—ç¬¦ä¸²ï¼‰æˆ–è¡¨è¾¾å¼ï¼ˆåˆ—ï¼‰çš„åˆ—è¡¨ã€‚ å¦‚æœå…¶ä¸­ä¸€ä¸ªåˆ—åæ˜¯â€™*â€™ï¼Œåˆ™è¯¥åˆ—å°†å±•å¼€ä»¥åŒ…å«å½“å‰DataFrameä¸­çš„æ‰€æœ‰åˆ—ã€‚1234567891011&gt;&gt;&gt; traffic.select(&quot;speed&quot;).show(5)+-----+|speed|+-----+|56.52||53.54||54.64||54.94||51.65|+-----+only showing top 5 rows filter()ä½¿ç”¨ç»™å®šçš„æ¡ä»¶è¿‡æ»¤è¡Œã€‚where()æ˜¯filter()çš„åˆ«åã€‚å‚æ•°ï¼šcondition - ç±»å‹çš„ä¸€åˆ—.BooleanTypeæˆ–ä¸€ä¸ªSQLè¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ã€‚12345678910111213141516171819202122&gt;&gt;&gt; traffic.filter(traffic.speed &gt; 50).show(5)+----------+--------------+------+-----+---------+|detectorid| starttime|volume|speed|occupancy|+----------+--------------+------+-----+---------+| 100625|2015/12/1 0:00| 48|56.52| 1.29|| 100625|2015/12/1 0:15| 50|53.54| 1.48|| 100625|2015/12/1 0:30| 25|54.64| 0.62|| 100625|2015/12/1 0:45| 34|54.94| 0.85|| 100625|2015/12/1 1:00| 23|51.65| 0.6|+----------+--------------+------+-----+---------+only showing top 5 rows&gt;&gt;&gt; traffic.where(traffic.volume &gt; 50).show(5)+----------+--------------+------+-----+---------+|detectorid| starttime|volume|speed|occupancy|+----------+--------------+------+-----+---------+| 100625|2015/12/1 3:45| 61|57.62| 1.65|| 100625|2015/12/1 4:00| 69| 56.7| 1.89|| 100625|2015/12/1 4:15| 94|56.53| 2.69|| 100625|2015/12/1 4:30| 87|55.53| 2.58|| 100625|2015/12/1 4:45| 161|55.51| 4.62|+----------+--------------+------+-----+---------+only showing top 5 rows drop()è¿”å›åˆ é™¤æŒ‡å®šåˆ—çš„æ–°DataFrameã€‚å‚æ•°ï¼šcols - è¦åˆ é™¤çš„åˆ—çš„å­—ç¬¦ä¸²åç§°ï¼Œè¦åˆ é™¤çš„åˆ—æˆ–è¦åˆ é™¤çš„åˆ—çš„å­—ç¬¦ä¸²åç§°çš„åˆ—è¡¨ã€‚1234567891011&gt;&gt;&gt; traffic.drop(&quot;speed&quot;).show(5)+----------+--------------+------+---------+|detectorid| starttime|volume|occupancy|+----------+--------------+------+---------+| 100625|2015/12/1 0:00| 48| 1.29|| 100625|2015/12/1 0:15| 50| 1.48|| 100625|2015/12/1 0:30| 25| 0.62|| 100625|2015/12/1 0:45| 34| 0.85|| 100625|2015/12/1 1:00| 23| 0.6|+----------+--------------+------+---------+only showing top 5 rows cache()ä½¿ç”¨é»˜è®¤å­˜å‚¨çº§åˆ«ï¼ˆMEMORY_AND_DISKï¼‰æŒä¹…ä¿å­˜DataFrameã€‚1traffic.cache() collect()ä»¥Rowåˆ—è¡¨å½¢å¼è¿”å›æ‰€æœ‰è®°å½•ã€‚1traffic.collect() show()å°†å‰nè¡Œæ‰“å°åˆ°æ§åˆ¶å°ã€‚å‚æ•°ï¼šn - è¦æ˜¾ç¤ºçš„è¡Œæ•°ã€‚truncate - å¦‚æœè®¾ç½®ä¸ºTrueï¼Œåˆ™é»˜è®¤æˆªæ–­è¶…è¿‡20ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ å¦‚æœè®¾ç½®ä¸ºå¤§äº1çš„æ•°å­—ï¼Œåˆ™æˆªæ–­é•¿å­—ç¬¦ä¸²ä»¥æˆªæ–­é•¿åº¦å¹¶å°†å…¶å³å¯¹é½ã€‚1234567891011&gt;&gt;&gt; traffic.show(5)+----------+--------------+------+-----+---------+|detectorid| starttime|volume|speed|occupancy|+----------+--------------+------+-----+---------+| 100625|2015/12/1 0:00| 48|56.52| 1.29|| 100625|2015/12/1 0:15| 50|53.54| 1.48|| 100625|2015/12/1 0:30| 25|54.64| 0.62|| 100625|2015/12/1 0:45| 34|54.94| 0.85|| 100625|2015/12/1 1:00| 23|51.65| 0.6|+----------+--------------+------+-----+---------+only showing top 5 rows count()è¿”å›æ­¤DataFrameä¸­çš„è¡Œæ•°ã€‚12&gt;&gt;&gt; traffic.count()17814 columnsä»¥åˆ—è¡¨å½¢å¼è¿”å›æ‰€æœ‰åˆ—åç§°ã€‚12&gt;&gt;&gt; traffic.columns[&apos;detectorid&apos;, &apos;starttime&apos;, &apos;volume&apos;, &apos;speed&apos;, &apos;occupancy&apos;] dtypeså°†æ‰€æœ‰åˆ—åç§°åŠå…¶æ•°æ®ç±»å‹ä½œä¸ºåˆ—è¡¨è¿”å›ã€‚12&gt;&gt;&gt; traffic.dtypes[(&apos;detectorid&apos;, &apos;int&apos;), (&apos;starttime&apos;, &apos;string&apos;), (&apos;volume&apos;, &apos;int&apos;), (&apos;speed&apos;, &apos;double&apos;), (&apos;occupancy&apos;, &apos;double&apos;)] fillna()æ›¿æ¢çš„ç©ºå€¼ï¼Œåˆ«åna.fill()ã€‚å‚æ•°ï¼švalue - intï¼Œlongï¼Œfloatï¼Œstringæˆ–dictã€‚ ç”¨æ¥æ›¿æ¢ç©ºå€¼çš„å€¼ã€‚ å¦‚æœå€¼æ˜¯å­—å…¸ï¼Œåˆ™å­é›†å°†è¢«å¿½ç•¥ï¼Œå¹¶ä¸”å€¼å¿…é¡»æ˜¯ä»åˆ—åï¼ˆå­—ç¬¦ä¸²ï¼‰åˆ°æ›¿æ¢å€¼çš„æ˜ å°„ã€‚ æ›¿æ¢å€¼å¿…é¡»æ˜¯intï¼Œlongï¼Œfloatï¼Œbooleanæˆ–stringã€‚å­é›† - è¦è€ƒè™‘çš„åˆ—åç§°çš„å¯é€‰åˆ—è¡¨ã€‚ å­é›†ä¸­æŒ‡å®šçš„ä¸å…·æœ‰åŒ¹é…æ•°æ®ç±»å‹çš„åˆ—å°†è¢«å¿½ç•¥ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœvalueæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å­é›†åŒ…å«ä¸€ä¸ªéå­—ç¬¦ä¸²åˆ—ï¼Œåˆ™éå­—ç¬¦ä¸²åˆ—å°†è¢«å¿½ç•¥ã€‚12&gt;&gt;&gt; traffic.na.fill(10)&gt;&gt;&gt; traffic.na.fill(&#123;&apos;volume&apos;: 0, &apos;speed&apos;: &apos;0&apos;&#125;) corr()ä»¥åŒç²¾åº¦å€¼è®¡ç®—DataFrameçš„ä¸¤åˆ—çš„ç›¸å…³æ€§ã€‚ ç›®å‰åªæ”¯æŒPearson Correlation Coefficientã€‚ DataFrame.corr()å’ŒDataFrameStatFunctions.corr()æ˜¯å½¼æ­¤çš„åˆ«åã€‚å‚æ•°:col1 - ç¬¬ä¸€åˆ—çš„åç§°col2 - ç¬¬äºŒåˆ—çš„åç§°æ–¹æ³• - ç›¸å…³æ–¹æ³•ã€‚ ç›®å‰åªæ”¯æŒâ€œPearsonâ€12&gt;&gt;&gt; traffic.corr(&quot;volume&quot;, &quot;speed&quot;)-0.588695158526705 cov()è®¡ç®—ç»™å®šåˆ—çš„æ ·æœ¬åæ–¹å·®ï¼ˆç”±å®ƒä»¬çš„åç§°æŒ‡å®šï¼‰ä½œä¸ºåŒç²¾åº¦å€¼ã€‚ DataFrame.covï¼ˆï¼‰å’ŒDataFrameStatFunctions.covï¼ˆï¼‰æ˜¯åˆ«åã€‚å‚æ•°ï¼šcol1 - ç¬¬ä¸€åˆ—çš„åç§°col2 - ç¬¬äºŒåˆ—çš„åç§°12&gt;&gt;&gt; traffic.cov(&quot;volume&quot;, &quot;speed&quot;)-1166.285227777989 describe()è®¡ç®—æ•°å­—å’Œå­—ç¬¦ä¸²åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ã€‚è¿™åŒ…æ‹¬countï¼Œmeanï¼Œstddevï¼Œminå’Œmaxã€‚ å¦‚æœæœªç»™å‡ºåˆ—ï¼Œåˆ™æ­¤å‡½æ•°å°†è®¡ç®—æ‰€æœ‰æ•°å­—æˆ–å­—ç¬¦ä¸²åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ã€‚1234567891011121314151617181920&gt;&gt;&gt; df.describe().show()+-------+--------------+--------------+------------------+------------------+------------------+|summary| detectorid| starttime| volume| speed| occupancy|+-------+--------------+--------------+------------------+------------------+------------------+| count| 17814| 17814| 17814| 17737| 17814|| mean| 100627.5| null|208.72779836083978| 45.94760105993146|13.775621421354007|| stddev|1.707873064514| null| 129.673023730382|15.010086497913619|13.391984211880049|| min| 100625|2015/12/1 0:00| 0| 1.14| 0.0|| max| 100630|2015/12/9 9:45| 528| 69.33| 73.25|+-------+--------------+--------------+------------------+------------------+------------------+&gt;&gt;&gt; traffic.describe([&apos;speed&apos;]).show()+-------+------------------+|summary| speed|+-------+------------------+| count| 17737|| mean| 45.94760105993146|| stddev|15.010086497913619|| min| 1.14|| max| 69.33|+-------+------------------+ distinct()è¿”å›åŒ…å«æ­¤DataFrameä¸­ä¸åŒè¡Œçš„æ–°DataFrameã€‚12&gt;&gt;&gt; traffic.distinct().count()17814 createOrReplaceGlobalTempView()ä½¿ç”¨ç»™å®šåç§°åˆ›å»ºæˆ–æ›¿æ¢å…¨å±€ä¸´æ—¶è§†å›¾ã€‚æ­¤ä¸´æ—¶è§†å›¾çš„ç”Ÿå‘½å‘¨æœŸä¸æ­¤Sparkåº”ç”¨ç¨‹åºç›¸å…³è”ã€‚1234&gt;&gt;&gt; traffic.createOrReplaceGlobalTempView(&quot;traffic&quot;)&gt;&gt;&gt; df = spark.sql(&quot;select * from traffic&quot;)&gt;&gt;&gt; df.count()17814 createOrReplaceTempView()ä½¿ç”¨æ­¤DataFrameåˆ›å»ºæˆ–æ›¿æ¢æœ¬åœ°ä¸´æ—¶è§†å›¾ã€‚æ­¤ä¸´æ—¶è¡¨çš„ç”Ÿå‘½å‘¨æœŸä¸ç”¨äºåˆ›å»ºæ­¤DataFrameçš„SparkSessionç›¸å…³è”ã€‚1234&gt;&gt;&gt; traffic.createOrReplaceTempView(&quot;traffic&quot;)&gt;&gt;&gt; df = spark.sql(&quot;select * from traffic&quot;)&gt;&gt;&gt; df.count()17814 ä½¿ç”¨SQLæŸ¥è¯¢ç”±äºåˆ›å»ºäº†ä¸´æ—¶è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸´æ—¶è¡¨æ‰§è¡Œsqlæ“ä½œã€‚1234567891011121314151617181920212223242526&gt;&gt;&gt; spark.sql(&quot;select * from traffic where volume &gt; 50 and speed &gt; 50&quot;).show()+----------+---------------+------+-----+---------+|detectorid| starttime|volume|speed|occupancy|+----------+---------------+------+-----+---------+| 100625| 2015/12/1 3:45| 61|57.62| 1.65|| 100625| 2015/12/1 4:00| 69| 56.7| 1.89|| 100625| 2015/12/1 4:15| 94|56.53| 2.69|| 100625| 2015/12/1 4:30| 87|55.53| 2.58|| 100625| 2015/12/1 4:45| 161|55.51| 4.62|| 100625| 2015/12/1 5:00| 203|55.41| 5.96|| 100625| 2015/12/1 5:15| 185|55.14| 6.61|| 100625| 2015/12/1 5:30| 308|52.39| 9.87|| 100625| 2015/12/1 5:45| 343|51.01| 11.49|| 100625|2015/12/1 10:15| 306| 50.6| 11.98|| 100625|2015/12/1 10:30| 334|51.42| 11.53|| 100625|2015/12/1 10:45| 349|52.67| 11.51|| 100625|2015/12/1 11:00| 262|52.36| 10.54|| 100625|2015/12/1 12:00| 255|52.47| 9.36|| 100625|2015/12/1 12:15| 346|50.25| 13.44|| 100625|2015/12/1 12:30| 367| 51.2| 12.47|| 100625|2015/12/1 12:45| 330|52.78| 11.56|| 100625|2015/12/1 13:00| 306|52.36| 12.01|| 100625|2015/12/1 13:30| 371|50.28| 13.93|| 100625|2015/12/1 13:45| 294|50.62| 12.92|+----------+---------------+------+-----+---------+only showing top 20 rows Dataseté™¤äº†DataFrameï¼ŒSpark 1.6ä¸­è¿˜å¼•å…¥äº†Dataset APIï¼Œå…¶æä¾›äº†ä¸€ç§ç±»å‹å®‰å…¨çš„é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ¥å£ï¼Œä½†æ˜¯å…¶åªèƒ½åœ¨Javaä¸Scalaä¸­ä½¿ç”¨ã€‚Pythonä¸èƒ½ä½¿ç”¨è¯¥APIçš„åŸå› æ˜¯å› ä¸ºå…¶æœ¬èº«ä¸æ˜¯ä¸€ç§ç±»å‹å®‰å…¨çš„è¯­è¨€ã€‚åœ¨Spark 2.0ä¸­DataFrame APIè¢«æ•´åˆå…¥å¦‚Dataset APIï¼ŒDataFrameæ˜¯Datasetæœªç±»å‹åŒ–APIçš„ä¸€ä¸ªåˆ«åã€‚æœªç±»å‹åŒ–çš„APIï¼šDataFrame = Dataset[Row]ç±»å‹åŒ–çš„APIï¼šDataset[T]","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://www.wortyby.com/tags/spark/"},{"name":"DataFrame","slug":"DataFrame","permalink":"http://www.wortyby.com/tags/DataFrame/"}]},{"title":"å¤§æ•°æ®åˆ†æåˆ©å™¨KYLIN ä¹‹ç”¨æˆ·æƒé™ç¯‡","slug":"å¤§æ•°æ®åˆ†æåˆ©å™¨KYLIN ä¹‹ç”¨æˆ·æƒé™ç¯‡","date":"2018-09-30T03:00:38.000Z","updated":"2018-09-30T03:00:38.000Z","comments":true,"path":"2018/09/30/å¤§æ•°æ®åˆ†æåˆ©å™¨KYLIN ä¹‹ç”¨æˆ·æƒé™ç¯‡/","link":"","permalink":"http://www.wortyby.com/2018/09/30/å¤§æ•°æ®åˆ†æåˆ©å™¨KYLIN ä¹‹ç”¨æˆ·æƒé™ç¯‡/","excerpt":"","text":"Apache Kylin éƒ¨ç½²ä¹‹ä¸å®Œå…¨æŒ‡å—å¢åŠ ç”¨æˆ·javaçº¿ä¸Šè¿è¡Œå™¨OLAPç³»ç»Ÿè§£æï¼šApache Kylinå’ŒBaidu Paloå“ªå®¶å¼ºï¼ŸApache Kylin Cube æ„å»ºåŸç†","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"KYLIN","slug":"KYLIN","permalink":"http://www.wortyby.com/tags/KYLIN/"}]},{"title":"æ•°æ®é¡¹ç›®è¯¥åšçš„äº‹æƒ…","slug":"æ•°æ®è®¡åˆ’","date":"2018-09-26T07:37:53.000Z","updated":"2018-09-26T07:37:53.000Z","comments":true,"path":"2018/09/26/æ•°æ®è®¡åˆ’/","link":"","permalink":"http://www.wortyby.com/2018/09/26/æ•°æ®è®¡åˆ’/","excerpt":"","text":"autherdateversionseven2018-09-20version 1.0 ç°çŠ¶ æ•°æ®åŒæ­¥: æ•°æ®åŒæ­¥å™¨åº”è¯¥ç»Ÿä¸€åˆ°Hbase ï¼Œhive æŸ¥è¯¢ä½¿ç”¨ å¤–éƒ¨è¡¨åˆ›å»º ä¸´æ—¶è¡¨çš„æ–¹å¼å»åš ETL æˆ–å…¶ä»–çš„hive è¿ç®—ã€‚å°†è®¡ç®—ç»“æœå†å­˜å…¥HBASE ä¾›å®æ—¶æŸ¥è¯¢ï¼Œæˆ–æ˜¯å†™å…¥ redis ç»™æ¥å£è°ƒç”¨ã€‚å®æ—¶æ•°æ®è®¡ç®—ï¼Œç”±è¡Œä¸ºè®°å½•ç»Ÿä¸€æå‰å†™å…¥HBaseæ•°æ®è¿ç§»ï¼Œç»Ÿä¸€ç”±ä»»åŠ¡è°ƒåº¦ç»ˆç«¯ï¼Œä½¿ç”¨sqoop å€’å…¥Hbaseï¼Œé¿å…ä½¿ç”¨python åŒ…è£…ä»£ç ã€‚ ç°çŠ¶æ˜¯1.æ‰€æœ‰æ•°æ®éƒ½æ”¾Hive;2.æ•°æ®è¿ç§»ï¼Œé‡‡ç”¨å®šæ—¶è„šæœ¬å»åŒæ­¥æ•°æ®åº“ã€‚ æ•°æ®æ£€ç´¢: æ•°æ®å­—å…¸: æ•°æ®å­—å…¸é‡æ–°æ„å»ºä¸å¦ï¼Ÿç°çŠ¶è¯„ä¼°æ˜¯å¦èƒ½å¤Ÿç›¸å¯¹å‡†ç¡®çš„è®¡ç®—ç›¸ä¼¼åº¦ã€‚ å±•æœ› æ•°æ®é¢„æµ‹:ä¾èµ–ç‰¹å¾å·¥ç¨‹ä»¥åŠæ•°æ®æŒ–æ˜çš„ç»“æœè¿›è¡Œæ•°æ®é¢„æµ‹ å†…å®¹ç”»åƒ;æ²¡ä»€ä¹ˆæ¦‚å¿µ ç”¨æˆ·ç”»åƒ; ç”¨æˆ·å¸–å­åå¥½ ç”¨æˆ·éŸ³é¢‘/è§†é¢‘/èŠ‚ç›®/ä¸“è¾‘åå¥½ ç”¨æˆ·å›¾ç‰‡åå¥½ é¢„æµ‹æ•ˆæœå±•ç¤ºå¹³å°; ç‰¹å¾å·¥ç¨‹:åˆ©ç”¨ hive ç»“åˆ kylin å’Œ superset å¯ä»¥å®æ—¶æ„å»ºç”¨æˆ·çš„ä¸åŒç‰¹å¾å±•ç¤º ç‰¹å¾æå–; æ•°å€¼ç‰¹å¾; ç±»åˆ«ç‰¹å¾; æ—¶é—´ç‰¹å¾; ç©ºé—´ç‰¹å¾; æ–‡æœ¬ç‰¹å¾; å¸¸ç”¨æ¨¡å‹ç†è§£å„ä¸ªæ¨¡å‹çš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯ é€»è¾‘å›å½’ å› å¼åˆ†è§£æœº æ¢¯åº¦æå‡ é—®é¢˜æ•°å­¦å»ºæ¨¡ å»ºç«‹è¯„ä¼°æŒ‡æ ‡ åˆ†ç±»æŒ‡æ ‡ å›å½’æŒ‡æ ‡ æ’åºæŒ‡æ ‡ æ ·æœ¬é€‰æ‹© åŸæ•°æ®ä¸è®­ç»ƒæ•°æ®é€‰æ‹© äº¤å‰éªŒè¯ æ„å»ºpipeline æ‰§è¡Œ æ•°æ®åˆ†ç»„ï¼ŒæŒ‰ç…§æŒ‡æ ‡ï¼Œè¿›è¡Œäº¤å‰éªŒè¯æ•°æ®é¢„æµ‹çš„æ¦‚ç‡å¤§å° ä»¥åŠç¡®è®¤æ˜¯å¦è¿‡æ‹Ÿåˆï¼Ÿ æ•°æ®æŒ–æ˜ ç”¨æˆ·ç”»åƒ ç”¨æˆ·æ ‡è¯†åŸŸå¤–å¹³å°(å¾®ä¿¡ï¼Œå¾®åšï¼ŒçŸ¥ä¹â€¦)å¹³å°å†…(è®¾å¤‡å’ŒUID) ç”¨æˆ·ç‰¹å¾æ•°æ®æ”¶å¬å‘å¸–è¯„è®ºç‚¹èµå¹´é¾„(å¹³å°å†…å¤–ç”¨æˆ·ï¼Œçœ‹å„ä¸ªå¹³å°ç”¨æˆ·ç¾¤åˆ†å¸ƒ)æ”¶å¬æ—¶é—´ç‚¹(å¹³å°å†…å¤–ç”¨æˆ·ï¼Œçœ‹å„ä¸ªå¹³å°ç”¨æˆ·æ—¶é—´åˆ†é…) æ ·æœ¬æ•°æ®éšæœºæŠ½å–å…¶ä»–å¹³å°çš„ç”¨æˆ·ç‰¹å¾æ¥åŒ¹é…æ”¶å¬æˆ‘ä»¬å¹³å°å†…å®¹çš„å¯èƒ½æ€§å¤§å°ï¼Œç›¸åº”çš„å»å…¶ä»–å¹³å°æ‹‰ç”¨æˆ·åšæ¨å¹¿ï¼Ÿéšæœºçš„ä»æˆ‘ä»¬çš„å¹³å°ç”¨æˆ·ç‰¹å¾å»åŒ¹é…å…¶ä»–å¹³å°å†…å®¹ï¼Œçœ‹åˆä½œæœºä¼šåšæ¨å¹¿ï¼Ÿ æ ‡ç­¾å»ºæ¨¡å¯ä»¥é‡‡ç”¨kylin ä¸ superset åšå®æ—¶çš„æ ‡ç­¾æ„å»ºä¸BI æŠ¥è¡¨å±•ç¤º,æ¥è®©è¿è¥äººå‘˜è¿›è¡Œå¯¹åº”çš„è¿è¥ç­–ç•¥åˆ¶å®šã€‚ ç”¨æˆ·ç”»åƒå®æ—¶æŸ¥è¯¢ç³»ç»Ÿæ–¹ä¾¿è§‚æµ‹å¹³å°å†…ç”¨æˆ·çŠ¶æ€ä¸çƒ­ç‚¹å†…å®¹è¿½è¸ª äººç¾¤ç”»åƒåˆ†æç³»ç»Ÿæ–¹ä¾¿è§‚æµ‹ç”¨æˆ·ç¾¤ä½“åˆ†å¸ƒä»¥åŠæ„è§é¢†è¢–äº§ç”Ÿå½±å“åŠ›çš„é¢†åŸŸã€‚ è¯„è®ºæŒ–æ˜ è¯„è®ºæ ‡ç­¾æå– æ–‡å­—è¯„è®ºçš„æƒ…æ„Ÿåˆ†æ éŸ³é¢‘è¯„è®ºçš„æƒ…æ„Ÿåˆ†æ å›¾ç‰‡è¯„è®ºçš„æƒ…æ„Ÿåˆ†æ æ ‡ç­¾çš„å®æ—¶æŸ¥è¯¢ç³»ç»Ÿ éŸ³é¢‘æŒ–æ˜ éŸ³é¢‘æ ‡ç­¾æå– éŸ³é¢‘çš„éŸ³æ–‡è½¬å†™ éŸ³é¢‘çš„æƒ…æ„Ÿåˆ†æ éŸ³é¢‘æŒ–æ˜ä¿¡æ¯çš„å®æ—¶æŸ¥è¯¢ç³»ç»Ÿ å¸–å­æŒ–æ˜ å¸–å­æ ‡ç­¾æå– å¸–å­çš„æƒ…æ„Ÿåˆ†æ å¸–å­çš„å®æ—¶æŸ¥è¯¢ç³»ç»Ÿå®æ—¶è·Ÿè¸ªå¹³å°å†…å¸–å­çš„æƒ…ç»ªï¼Œé˜²æ­¢è´Ÿé¢å†…å®¹ä¼ æ’­ï¼Œåœ¨å¹³å°å†…å¯ä»¥å…ˆéåˆ¶æ‰è´Ÿé¢å†…å®¹ä¼ æ’­çš„å¯èƒ½æ€§ï¼Œè®¾å®šä¸€ä¸ªè­¦æˆ’å€¼ æœç´¢ä¸æ¨èæ ¹æ®ç”¨æˆ·çš„æœç´¢æ›´æ–°ç”¨æˆ·çš„åå¥½è¿›è€Œå»æ¨èå†…å®¹; æœç´¢ æ„å»ºæ•°æ®çš„å›¾å…³ç³»å¾—åˆ°ç±»ç›®çš„æƒé‡ä»¥åŠé‡è¦ç¨‹åº¦ æ„å»ºå›¾è¾¹å…³ç³»èŠ‚ç‚¹å‘é‡åˆ©ç”¨ç”¨æˆ·çš„æœç´¢æ¬¡ï¼Œç”Ÿæˆç”¨æˆ·å¯èƒ½æ„Ÿå…´è¶£çš„æ¨èæœç´¢è¯ ç±»ç›®ç›¸å…³æ€§å®æ—¶æŸ¥è¯¢ç³»ç»Ÿå®æ—¶çš„æ˜¾ç¤ºå¹³å°å†…ç”¨æˆ·çš„æœç´¢ï¼›å¹³å°ä¹Ÿå¯ä»¥åˆ©ç”¨äººç¾¤å±æ€§å’Œç”¨æˆ·å±æ€§ï¼ŒåŠ¨æ€çš„æ¨èç”¨æˆ·æœç´¢å…³é”®è¯ï¼Œå¼•å¯¼ç”¨æˆ·å»æŸ¥çœ‹å¹³å°å¸Œæœ›ä»–çœ‹çš„å†…å®¹ã€‚æˆ–æ˜¯ä»–å¯èƒ½æƒ³çœ‹çš„å†…å®¹ æ¨è ä»¥åŸŸå¤–çƒ­ç‚¹æ•°æ®æ¥æ¨å¹³å°å†…æ•°æ®çŸ¥ä¹å¾®åšã€‚ã€‚ã€‚ å¹³å°å†…çš„ç‰¹å¾æ•°æ®æ¨èæ ¹æ®ååŒè¿‡æ»¤ç®—æ³•æ¨èç”¨æˆ·å¯èƒ½è¦çœ‹çš„å¯èƒ½æ€§å†…å®¹ã€‚ å¼•å¯¼ç”¨æˆ·å®Œæˆæœç´¢ ç”¨æˆ·å¼•å¯¼çš„äº§å“å®šä¹‰ä¸è¡¡é‡æ ‡å‡† æœç´¢å‰çš„å¼•å¯¼æ¨è æŸ¥è¯¢è¯ æœç´¢ä¸­çš„å¼•å¯¼æŸ¥è¯¢è¯ è¡¥å…¨ æœç´¢åçš„å¼•å¯¼ç›¸å…³æ€§æœç´¢ æœç´¢çš„å®æ—¶åé¦ˆå¹³å°å±•ç¤ºå¹³å°å®æ—¶æœç´¢å¹³å°å¤–çš„çƒ­é—¨æœç´¢ä¸å¹³å°çš„çƒ­é—¨æœç´¢æ¯”è¾ƒï¼Œç¡®å®šå¹³å°çš„å®šä½å·®å¼‚è¿˜æ˜¯å½’ä¸€åˆ°å¹³å°å¤–çš„æœç´¢ã€‚ æ•°æ®å¬å›æ•°æ®æ¶ˆè´¹åé¦ˆå›ç‚‰è¿›è¡Œæ›´æ–°æ¨¡å‹ä¸ç‰¹å¾æ•°æ®å¬å›æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ åŸºäºååŒè¿‡æ»¤çš„å¬å› åŸºäºä½ç½®çš„å¬å› åŸºäºæœç´¢æŸ¥è¯¢çš„å¬å› åŸºäºç”¨æˆ·å…³ç³»å›¾çš„å¬å› åŸºäºç”¨æˆ·å®æ—¶è¡Œä¸ºçš„å¬å› A/B Test é€šè¿‡abtest æ–¹å¼æ¥è¿›è¡Œæ•ˆæœçš„æµ‹è¯•ä¸æ¯”è¾ƒ æ•°æ®æ¨é€ appç«¯ å¾®ä¿¡å°ç¨‹åºç«¯ ä¸¾ä¾‹å¼€è½¦çš„æ—¶å€™ï¼Œæ¨èæ”¶å¬çš„èŠ‚ç›®åº”è¯¥ä»¥äº¤é€šä¸»é¢˜ç›¸å…³çš„éŸ³é¢‘èŠ‚ç›®ç›¸å…³ï¼›ä¼‘æ¯çš„æ—¶å€™ï¼Œåº”è¯¥æ¨èå®æ—¶æ€§é«˜çš„çƒ­ç‚¹å¸–å­å†…å®¹ã€‚ç¡è§‰çš„æ—¶å€™ï¼Œåº”è¯¥æ¨èè½»æ¾çš„æ•…äº‹å¹¿æ’­ä¸ºä¸»ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"æ¶æ„é¡¹ç›®","slug":"æ¶æ„é¡¹ç›®","permalink":"http://www.wortyby.com/tags/æ¶æ„é¡¹ç›®/"}]},{"title":"è…¾è®¯æ¨èâ€”è®©æ‚¨çš„ç³»ç»Ÿç¬é—´ä¸ªæ€§åŒ–","slug":"è…¾è®¯æ¨èâ€”è®©æ‚¨çš„ç³»ç»Ÿç¬é—´ä¸ªæ€§åŒ–","date":"2018-09-26T06:39:48.000Z","updated":"2018-09-26T06:39:48.000Z","comments":true,"path":"2018/09/26/è…¾è®¯æ¨èâ€”è®©æ‚¨çš„ç³»ç»Ÿç¬é—´ä¸ªæ€§åŒ–/","link":"","permalink":"http://www.wortyby.com/2018/09/26/è…¾è®¯æ¨èâ€”è®©æ‚¨çš„ç³»ç»Ÿç¬é—´ä¸ªæ€§åŒ–/","excerpt":"","text":"è…¾è®¯æ¨èâ€œè…¾è®¯æ¨èâ€æ˜¯è…¾è®¯å¤§æ•°æ®è¿‘æœŸå¤§åŠ›æ‰“é€ çš„å¼€æ”¾æœåŠ¡å¹³å°ï¼Œæ—¨åœ¨é›†ä¸šåŠ¡æ¥å…¥ã€æ•°æ®ä¸ŠæŠ¥ã€ç®—æ³•è®¡ç®—ã€å®æ—¶æ¨èå’Œæ•ˆæœç›‘æ§äºä¸€ä½“ï¼Œå¯¹å¤–æä¾›å…¨è‡ªåŠ¨å®æ—¶ç²¾å‡†æ¨èæœåŠ¡ã€‚ è…¾è®¯æ¨èå®˜ç½‘: tuijian.qq.com æ¨èæ˜¯ä»€ä¹ˆï¼Ÿæ–‡ç« ä¸­æåˆ°çš„æ¨èå‡æ˜¯æŒ‡åœ¨æµ·é‡çš„ç‰©å“ä¸­è‡ªåŠ¨ä¸ºç”¨æˆ·é€‰å–åˆ°æ„Ÿå…´è¶£æˆ–åˆé€‚çš„ä¿¡æ¯ã€‚å°±è…¾è®¯æ–°é—»åº”ç”¨è€Œè¨€ï¼Œå…¨å›½å„åœ°æ¯å¤©äº§ç”Ÿçš„ä¿¡æ¯æ€»æ•°å ªç§°æµ·é‡ï¼Œä½†å±å¹•å°ºå¯¸æœ‰é™ï¼Œèƒ½ç»™ç”¨æˆ·å±•ç¤ºçš„æ–°é—»ä¹Ÿä¸å¤šï¼Œè¿™å°±æ¶‰åŠåˆ°å¸®åŠ©ç”¨æˆ·åœ¨æ–°é—»æµ·æ´‹ä¸­ä¸‡é‡ŒæŒ‘ä¸€ï¼Œæ‰¾åˆ°å»åˆç”¨æˆ·å…´è¶£çš„ä¿¡æ¯ã€‚ç±»ä¼¼çš„åœºæ™¯ä¸èƒœæšä¸¾ï¼Œæ·˜å®å¤©çŒ«ï¼Œè…¾è®¯è§†é¢‘ï¼Œå›¾ç‰‡ç¤¾åŒºï¼Œåº”ç”¨å®â€¦äº’è”ç½‘ä¸‹ï¼Œä¿¡æ¯è¿‡è½½å·²ç„¶ä¸å¯é€†è½¬ï¼Œæ¨èç³»ç»Ÿçš„ç²¾ç¡®æ€§ä¹Ÿå› æ­¤ä¸¾è¶³è½»é‡ã€‚ è…¾è®¯æ¨èçš„ç›®æ ‡è…¾è®¯æ¨èå¹³å°çš„ç›®æ ‡æ˜¯å¸®åŠ©ç¬¬ä¸‰æ–¹åº”ç”¨å®ç°ä¸ªæ€§åŒ–æ¨èåŠŸèƒ½ã€‚æˆ‘ä»¬ç€åŠ›äºï¼šå°†ç³»ç»Ÿèµ„æºäº‘æœåŠ¡åŒ–ï¼Œå¸®åŠ©åº”ç”¨èŠ‚çœå»ºè®¾ä¸ªæ€§åŒ–æœåŠ¡çš„å¼€é”€ã€‚ä»¥æ¨èæ–¹å¼å¼€æ”¾ç”¨æˆ·ç”»åƒï¼Œå¸®åŠ©åº”ç”¨å¢å¼ºä¸ªæ€§åŒ–æœåŠ¡èƒ½åŠ›ã€‚å®ç°æ•°æ®æ¥å…¥ï¼Œç®—æ³•è®¡ç®—å’Œå®æ—¶æ¨èå…¨æµç¨‹è‡ªåŠ¨åŒ–ï¼Œé™ä½åº”ç”¨æ„å»ºå®æ—¶æ¨èç³»ç»Ÿçš„é—¨æ§›ã€‚å…·ä½“è€Œè¨€ï¼Œåº”ç”¨å¼€å‘è€…ä»…éœ€ä¸ŠæŠ¥ç›¸åº”çš„ç‰©å“ä¿¡æ¯å’Œç”¨æˆ·è¡Œä¸ºï¼Œå¹³å°ä¾¿ä¼šè‡ªåŠ¨ç»“åˆè…¾è®¯ç”¨æˆ·ç”»åƒå’Œåº”ç”¨æœ¬èº«çš„æ•°æ®å¯¹å…¶ç”¨æˆ·è¿›è¡Œä¸ªæ€§åŒ–æ¨èã€‚ä»¥è…¾è®¯æ–°é—»åº”ç”¨ä¸ºä¾‹ï¼Œåº”ç”¨å¼€å‘è€…å°†æ¯å¤©å‘ç”Ÿçš„æ–°é—»ä¿¡æ¯ä»¥åŠç”¨æˆ·è¡Œä¸ºåŒ…æ‹¬ç‚¹å‡»ã€æµè§ˆã€è¯„è®ºç­‰æ•°æ®å®æ—¶ä¸ŠæŠ¥åˆ°è…¾è®¯æ¨èå¹³å°ã€‚å¹³å°ä¼šè‡ªåŠ¨åŸºäºè…¾è®¯ç”¨æˆ·ç”»åƒå’Œè¡Œä¸ºæ•°æ®è®¡ç®—å‡ºç”¨æˆ·ä¸æ–°é—»ä¹‹é—´çš„å…³ç³»ã€‚æ¯å½“ç”¨æˆ·æ‰“å¼€è…¾è®¯æ–°é—»æ—¶ï¼Œåº”ç”¨ä¾¿ä¼šå‘æ¨èå¹³å°å®æ—¶è¯·æ±‚å½“å‰ç”¨æˆ·çš„ä¸ªæ€§åŒ–æ¨èç»“æœï¼Œä»è€Œå°†ç›¸å…³ä¿¡æ¯å±•ç¤ºåœ¨ç”¨æˆ·çœ¼å‰ã€‚ç›®å‰ï¼Œè…¾è®¯æ¨èå¹³å°æ”¯æŒç€å…¬å¸å†…20å¤šé¡¹æ ¸å¿ƒä¸šåŠ¡ï¼Œå®è·µè¯æ˜ä¸ªæ€§åŒ–æ¨èæœåŠ¡å¸®åŠ©ä¸šåŠ¡æ— è®ºåœ¨ç”¨æˆ·ä½“éªŒï¼Œäº§å“ç²˜æ€§ï¼Œè¿˜æ˜¯ç‚¹å‡»ç‡ï¼Œè½¬åŒ–ç‡ç­‰æ–¹é¢å‡æœ‰æ˜¾è‘—æå‡ï¼Œå› æ­¤æ˜¯æ—¶å€™å°†è¿™å¥—å®æ—¶ä¸ªæ€§åŒ–æ¨èå¹³å°å¯¹å¤–å¼€æ”¾ï¼Œä»¥æ±‚ç”Ÿæ€ç¨³å®šï¼Œå…±ç”Ÿå…±èµ¢ã€‚æ€»çš„è¯´æ¥,è…¾è®¯æ¨èä½œä¸ºä¸€ç§äº‘æœåŠ¡ï¼Œé™ä½äº†ç¬¬ä¸‰æ–¹åº”ç”¨æ„å»ºå®æ—¶æ¨èç³»ç»Ÿçš„é—¨æ§›ï¼ŒèŠ‚çœäº†ç¬¬ä¸‰æ–¹åº”ç”¨å»ºè®¾ä¸ªæ€§åŒ–æœåŠ¡çš„ç³»ç»Ÿèµ„æºï¼Œæ›´å°†è…¾è®¯ç”¨æˆ·ç”»åƒä»¥æœåŠ¡çš„æ–¹å¼å¯¹ç¬¬ä¸‰æ–¹åº”ç”¨å¼€æ”¾ï¼Œå¢åŠ äº†åº”ç”¨ä¸ªæ€§åŒ–æœåŠ¡èƒ½åŠ›ã€‚ ä¸šåŠ¡æ¥å…¥æŒ‰ç³»ç»ŸæŒ‡å¼•ï¼Œç”¨æˆ·ä»…éœ€3æ­¥ï¼šå¡«å†™èµ„æ–™ã€æ³¨å†Œä¸šåŠ¡ã€æ·»åŠ åœºæ™¯ä¾¿å¯å®Œæˆä¸šåŠ¡æ¥å…¥ã€‚ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºå½“å‰ä¸šåŠ¡åˆ†é…å­˜å‚¨å’Œè®¡ç®—èµ„æºï¼ŒåŒæ—¶åˆå§‹åŒ–æ¨èå¼•æ“ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿæ§åˆ¶ä¸­å¿ƒä¼šä¸DSFã€TDBankã€TDPå’ŒTREå„å­ç³»ç»Ÿé€šä¿¡ï¼Œä¸‹å‘å½“å‰ä¸šåŠ¡ç›¸å…³é…ç½®ï¼Œæ‰€æœ‰è¿™ä¸€åˆ‡å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚å¾…ç³»ç»Ÿåˆå§‹åŒ–å®Œæ¯•ï¼Œå¯¹ç”¨æˆ·è€Œè¨€ä¸‡äº‹ä¿±å¤‡ï¼Œåªå·®æ•°æ®ã€‚ æ•°æ®ä¸ŠæŠ¥è…¾è®¯æ¨èåŸºäºä¸šåŠ¡è‡ªèº«ä¸ŠæŠ¥çš„ItemInfoï¼ˆç‰©å“ä¿¡æ¯ï¼‰å’ŒActionInfoï¼ˆç”¨æˆ·è¡Œä¸ºï¼‰ï¼Œå¹¶ç»“åˆ8äº¿è…¾è®¯ç”¨æˆ·ç”»åƒæä¾›ä¸ªæ€§åŒ–æ¨èæœåŠ¡ã€‚ä¸ºæ–¹ä¾¿ä¸šåŠ¡å¼€å‘è€…ä¸ŠæŠ¥ItemInfoå’ŒActionInfoä¸¤ç±»æ•°æ®ï¼Œç›®å‰è…¾è®¯æ¨èæä¾›äº†C++å’ŒJavaä¸¤ç§ç‰ˆæœ¬çš„SDKã€‚æˆ‘ä»¬å¸Œæœ›ä¸šåŠ¡ä¸ŠæŠ¥æ›´åŠ å®Œå–„å’Œå‡†ç¡®çš„è¡Œä¸ºæ•°æ®ï¼Œä½¿å¾—æˆ‘ä»¬æä¾›æ›´åŠ ç²¾å‡†æ¨èæœåŠ¡çš„åŒæ—¶ï¼Œä¹Ÿèƒ½æ›´å¥½åœ°ç»“åˆè…¾è®¯çš„ç”¨æˆ·ç”»åƒä¸ºè¯¥äº§å“æä¾›æ›´æœ‰ä»·å€¼çš„å±æ€§åˆ†æï¼Œæ¯”å¦‚å¹´é¾„ï¼Œæ€§åˆ«ï¼Œå­¦å†ï¼Œåˆ†å¸ƒåœ°åŸŸï¼Œç”¨æˆ·åå¥½ï¼Œæ´»è·ƒç¨‹åº¦ç­‰ã€‚ ç”¨æˆ·ç”»åƒè…¾è®¯æ¨èåŸºäºè…¾è®¯8äº¿ç”¨æˆ·ï¼Œåƒäº¿å…³ç³»é“¾å’Œä¼—å¤šè…¾è®¯ç³»ç›¸å…³äº§å“æ•°æ®æ‰“é€ äº†ç”¨æˆ·è¦†ç›–ç‡é«˜ä¸”å…´è¶£è¦†ç›–åº¦å¹¿çš„ç»Ÿä¸€ç”¨æˆ·ç”»åƒã€‚æˆ‘ä»¬åŸºäºè…¾è®¯ä¼—å¤šäº§å“ä¸­çš„è¡Œä¸ºæ•°æ®ä¸ºç”¨æˆ·é‡‡é›†ä¸°å¯Œçš„å…´è¶£æ ‡ç­¾ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨å¯¹è¿™äº›åŸå§‹æ ‡ç­¾è¿›è¡Œèšç±»å’Œåˆ†ç±»ï¼Œä»è€Œå¯¹ç”¨æˆ·å…´è¶£è¿›è¡ŒæŠ½è±¡ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨å»ºç«‹æ ‡ç­¾â€”&gt;ä¸»é¢˜ï¼ˆtopicï¼‰â€”&gt;ç±»ç›®çš„æ˜ å°„å…³ç³»ï¼Œä»è€Œä¸ºç”¨æˆ·ç”»åƒè¿›è¡Œå¤šç²’åº¦ã€å¤šå°ºåº¦å…´è¶£åˆ»ç”»ã€‚åŒæ—¶ç³»ç»Ÿä¼šæ ¹æ®å®æ—¶ä¸ŠæŠ¥çš„è¡Œä¸ºï¼Œä¸æ–­æ›´æ–°å½“å‰ç”¨æˆ·çš„ç”»åƒå…´è¶£ã€‚ç³»ç»Ÿä¼šå¯¹ä¸ŠæŠ¥çš„ç‰©å“ä¿¡æ¯è¿›è¡Œæ–‡æœ¬åˆ†æï¼Œä»è€Œå°†ç‰©å“ä¿¡æ¯æŠ½è±¡å¹¶æ˜ å°„åˆ°ä¸ç”¨æˆ·ç”»åƒç›¸åŒçš„ä¸»é¢˜å’Œç±»ç›®ç©ºé—´ã€‚è¿™æ ·ä¾¿å»ºç«‹äº†ç”¨æˆ·ä¸ç‰©å“é—´çš„æ³›è”ç³»ã€‚ æ¨èç­–ç•¥è…¾è®¯æ¨èå¹³å°ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†5ç§æ¨èç­–ç•¥ä¾›å¼€å‘è€…é€‰ç”¨ï¼šçƒ­åº¦ï¼Œäººç¾¤çƒ­åº¦ï¼ŒçŒœä½ å–œæ¬¢ï¼ŒçŒœä½ å–œæ¬¢ï¼ˆæ—¶é—´ä¼˜å…ˆï¼‰å’Œç›¸å…³æ¨èã€‚æˆ‘ä»¬å±è”½ç­–ç•¥èƒŒåçš„ç®—æ³•ç»†èŠ‚ä¸å‚æ•°ï¼Œé™ä½ç”¨æˆ·çš„ä½¿ç”¨é—¨æ§›ï¼ŒåŒæ—¶æä¾›è¶³å¤Ÿçš„è‡ªç”±åº¦è®©ç”¨æˆ·è‡ªè¡Œé€‰æ‹©ç­–ç•¥çš„ç»„åˆã€‚ä¹‹æ‰€ä»¥æä¾›5ç±»æ¨èç­–ç•¥ï¼Œé™¤äº†æœ¬èº«çš„ä¸šåŠ¡è¦æ±‚å¤–ï¼Œä¹Ÿå»ºè®®å¼€å‘è€…èƒ½åŸºäºæ­¤åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³æ¨èç®—æ³•å¸¦æ¥çš„è¿‡æ»¤æ°”æ³¡é—®é¢˜ï¼Œä¾‹å¦‚å°†äººç¾¤çƒ­åº¦å’ŒçŒœä½ å–œæ¬¢çš„æ¨èç»“æœè¿›è¡Œç©¿æ’åå¯¹ç”¨æˆ·å±•ç°ã€‚æˆ‘ä»¬ä¼šåŸºäºä¸ŠæŠ¥çš„ç‚¹å‡»ã€æ›å…‰è¡Œä¸ºä»¥åŠç”¨æˆ·ç”»åƒï¼Œé‡‡ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•å¯¹å½“å‰ç”¨æˆ·å¯èƒ½ç‚¹å‡»æŸç‰©å“çš„æ¦‚ç‡è¿›è¡Œé¢„ä¼°ã€‚æ¨èç³»ç»Ÿå†…éƒ¨æœ‰å¤šç§ç®—æ³•åŒæ—¶ABTestå’Œèåˆï¼Œä»¥æ±‚è¾¾åˆ°æ¨èæ•ˆæœçš„æœ€ä¼˜ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œè…¾è®¯æ¨èå¹³å°æä¾›äº†æ•´å¥—ä¸ªæ€§åŒ–æ¨èè§£å†³æ–¹æ¡ˆã€‚è¿‡ç¨‹ä¸­ï¼Œå¹³å°å°†ç³»ç»Ÿèµ„æºã€ç”¨æˆ·ç”»åƒã€ç®—æ³•è®¡ç®—ä»¥æ¨èæœåŠ¡çš„æ–¹å¼å¯¹å¤–å¼€æ”¾ï¼Œä»è€Œå¸®åŠ©ç¬¬ä¸‰æ–¹åº”ç”¨èŠ‚çœèµ„æºçš„åŒæ—¶è¿˜ä¸ºå…¶å¢åŠ äº†ä¸ªæ€§åŒ–æœåŠ¡èƒ½åŠ›ã€‚å¹³å°å†…éƒ¨å®ç°äº†èµ„æºåˆå§‹åŒ–ã€æ•°æ®å¤„ç†ã€ç®—æ³•è®¡ç®—å’Œè¿ç»´çº é”™çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ï¼Œå› æ­¤é™ä½äº†åº”ç”¨æ¥å…¥é—¨æ§›ï¼Œå‡å°‘äº†æ¥å…¥æ—¶é—´ï¼Œå¢åŠ äº†æœåŠ¡èƒ½åŠ›çš„ç¨³å®šæ€§ã€‚åŸæ–‡","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/tags/æ¨è/"}]},{"title":"FM(å› å¼åˆ†è§£æœºæ¨èç®—æ³•åŸç†)","slug":"FM(å› å¼åˆ†è§£æœºæ¨èç®—æ³•åŸç†ï¼‰","date":"2018-09-26T02:59:06.000Z","updated":"2018-09-26T02:59:06.000Z","comments":true,"path":"2018/09/26/FM(å› å¼åˆ†è§£æœºæ¨èç®—æ³•åŸç†ï¼‰/","link":"","permalink":"http://www.wortyby.com/2018/09/26/FM(å› å¼åˆ†è§£æœºæ¨èç®—æ³•åŸç†ï¼‰/","excerpt":"","text":"èƒŒæ™¯å¯¹äºåˆ†è§£æœº(Factorization Machinesï¼ŒFM)æ¨èç®—æ³•åŸç†ï¼Œæœ¬æ¥æƒ³è‡ªå·±å•ç‹¬å†™ä¸€ç¯‡çš„ã€‚ä½†æ˜¯çœ‹åˆ°peghotyå†™çš„FMä¸å…‰ç®€å•æ˜“æ‡‚ï¼Œè€Œä¸”æ’ç‰ˆä¹Ÿéå¸¸å¥½ï¼Œå› æ­¤è½¬è½½è¿‡æ¥ï¼Œè‡ªå·±å°±ä¸å†å•ç‹¬å†™FMäº†ã€‚ åŸç† ç›®å½• é¢„æµ‹ä»»åŠ¡ æ¨¡å‹æ–¹ç¨‹ å›å½’åˆ†ç±» å­¦ä¹ ç®—æ³•åŸæ–‡","categories":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/categories/æ¨è/"}],"tags":[{"name":"FM","slug":"FM","permalink":"http://www.wortyby.com/tags/FM/"}]},{"title":"æ·±å…¥æµ…å‡ºMLä¹‹Factorizationå®¶æ—","slug":"æ·±å…¥æµ…å‡ºMLä¹‹Factorizationå®¶æ—","date":"2018-09-21T09:51:49.000Z","updated":"2018-09-21T09:51:49.000Z","comments":true,"path":"2018/09/21/æ·±å…¥æµ…å‡ºMLä¹‹Factorizationå®¶æ—/","link":"","permalink":"http://www.wortyby.com/2018/09/21/æ·±å…¥æµ…å‡ºMLä¹‹Factorizationå®¶æ—/","excerpt":"","text":"å†…å®¹åˆ—è¡¨ å†™åœ¨å‰é¢ å› å­åˆ†è§£æœºå› å­åˆ†è§£æœºï¼ˆFactorization Machineï¼Œç®€ç§°FMï¼‰ï¼Œåˆç§°åˆ†è§£æœºå™¨ã€‚æ˜¯ç”±Konstanzå¤§å­¦ï¼ˆå¾·å›½åº·æ–¯å¦èŒ¨å¤§å­¦ï¼‰Steffen Rendleï¼ˆç°ä»»èŒäºGoogleï¼‰äº2010å¹´æœ€æ—©æå‡ºçš„ï¼Œæ—¨åœ¨è§£å†³å¤§è§„æ¨¡ç¨€ç–æ•°æ®ä¸‹çš„ç‰¹å¾ç»„åˆé—®é¢˜ã€‚åœ¨ç³»ç»Ÿä»‹ç»FMä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œç¨€ç–æ•°æ®æ˜¯æ€æ ·äº§ç”Ÿçš„ï¼Ÿç”¨æˆ·åœ¨ç½‘ç«™ä¸Šçš„è¡Œä¸ºæ•°æ®ä¼šè¢«Serverç«¯ä»¥æ—¥å¿—çš„å½¢å¼è®°å½•ä¸‹æ¥ï¼Œè¿™äº›æ•°æ®é€šå¸¸ä¼šå­˜æ”¾åœ¨å¤šå°å­˜å‚¨æœºå™¨çš„ç¡¬ç›˜ä¸Šã€‚ä»¥æˆ‘æµªä¸ºä¾‹ï¼Œå„äº§å“çº¿çºªå½•çš„ç”¨æˆ·è¡Œä¸ºæ—¥å¿—ä¼šé€šè¿‡flumeç­‰æ—¥å¿—æ”¶é›†å·¥å…·äº¤ç»™æ•°æ®ä¸­å¿ƒæ‰˜ç®¡ï¼Œå®ƒä»¬è´Ÿè´£æŠŠæ•°æ®å®šæ—¶ä¸Šä¼ è‡³HDFSä¸Šï¼Œæˆ–è€…ç”±æ•°æ®ä¸­å¿ƒç”ŸæˆHiveè¡¨ã€‚æˆ‘ä»¬ä¼šå‘ç°æ—¥å¿—ä¸­å¤§å¤šæ•°å‡ºç°çš„ç‰¹å¾æ˜¯categoricalç±»å‹çš„ï¼Œè¿™ç§ç‰¹å¾ç±»å‹çš„å–å€¼ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è¯†ï¼Œæœ¬èº«å¹¶æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œæ›´ä¸èƒ½ç”¨å…¶å–å€¼æ¯”è¾ƒå¤§å°ã€‚æ¯”å¦‚æ—¥å¿—ä¸­è®°å½•äº†ç”¨æˆ·è®¿é—®çš„é¢‘é“ï¼ˆchannelï¼‰ä¿¡æ¯ï¼Œå¦‚â€newsâ€, â€œautoâ€, â€œfinanceâ€ç­‰ã€‚å‡è®¾channelç‰¹å¾æœ‰10ä¸ªå–å€¼ï¼Œåˆ†åˆ«ä¸º{â€œautoâ€,â€œfinanceâ€,â€œentâ€,â€œnewsâ€,â€œsportsâ€,â€œmilâ€,â€œweatherâ€,â€œhouseâ€,â€œeduâ€,â€œgamesâ€}ã€‚éƒ¨åˆ†è®­ç»ƒæ•°æ®å¦‚ä¸‹ï¼šuserchanneluser1sportsuser2newsuser3financeuser4houseuser5eduuser6newsâ€¦â€¦ç‰¹å¾ ETL è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¯¹categoricalå‹ç‰¹å¾è¿›è¡Œone-hotç¼–ç ï¼ˆç‹¬çƒ­ç¼–ç ï¼‰ï¼Œå³å°†categoricalå‹ç‰¹å¾è½¬åŒ–ä¸ºæ•°å€¼å‹ç‰¹å¾ã€‚channelç‰¹å¾è½¬åŒ–åçš„ç»“æœå¦‚ä¸‹ï¼šuserchn-autochn-financechn-entchn-newschn-sportschn-milchn-weatherchn-housechn-educhn-gamesuser10000100000user20001000000user30100000000user40000000100user50000000010user60001000000å¯ä»¥å‘ç°ï¼Œç”± one-hotç¼–ç  å¸¦æ¥çš„æ•°æ®ç¨€ç–æ€§ä¼šå¯¼è‡´ç‰¹å¾ç©ºé—´å˜å¤§ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸€ç»´categoricalç‰¹å¾åœ¨ç»è¿‡one-hotç¼–ç åå˜æˆäº†10ç»´æ•°å€¼å‹ç‰¹å¾ã€‚çœŸå®åº”ç”¨åœºæ™¯ä¸­ï¼Œæœªç¼–ç å‰ç‰¹å¾æ€»ç»´åº¦å¯èƒ½ä»…æœ‰æ•°åç»´æˆ–è€…åˆ°æ•°ç™¾ç»´çš„categoricalå‹ç‰¹å¾ï¼Œç»è¿‡one-hotç¼–ç åï¼Œè¾¾åˆ°æ•°åƒä¸‡ã€æ•°äº¿ç”šè‡³æ›´é«˜ç»´åº¦çš„æ•°å€¼ç‰¹å¾åœ¨ä¸šå†…éƒ½æ˜¯å¸¸æœ‰çš„ã€‚æˆ‘ç»„å¹¿å‘Šå’Œæ¨èä¸šåŠ¡çš„ç‚¹å‡»é¢„ä¼°ç³»ç»Ÿï¼Œç¼–ç å‰æ˜¯ç‰¹å¾ä¸åˆ°100ç»´ï¼Œç¼–ç åï¼ˆåŒ…æ‹¬feature hashingï¼‰çš„ç»´åº¦è¾¾ç™¾ä¸‡ç»´é‡çº§ã€‚æ­¤å¤–ä¹Ÿèƒ½å‘ç°ï¼Œç‰¹å¾ç©ºé—´å¢é•¿çš„ç»´åº¦å–å†³äºcategoricalå‹ç‰¹å¾çš„å–å€¼ä¸ªæ•°ã€‚åœ¨æ•°æ®ç¨€ç–æ€§çš„ç°å®æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•å»åˆ©ç”¨è¿™äº›ç‰¹å¾æ¥æå‡learning performanceï¼Ÿ ç‰¹å¾å…³è”ä»¥åŠè¡¨å¾å½¢å¼æˆ–è®¸åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­è€ƒè™‘ç‰¹å¾ä¹‹é—´çš„å…³è”ä¿¡æ¯ã€‚é’ˆå¯¹ç‰¹å¾å…³è”ï¼Œæˆ‘ä»¬éœ€è¦è®¨è®ºä¸¤ä¸ªé—®é¢˜ï¼š1. ä¸ºä»€ä¹ˆè¦è€ƒè™‘ç‰¹å¾ä¹‹é—´çš„å…³è”ä¿¡æ¯ï¼Ÿ2. å¦‚ä½•è¡¨è¾¾ç‰¹å¾ä¹‹é—´çš„å…³è”ï¼Ÿ ä¸ºä»€ä¹ˆè¦è€ƒè™‘ç‰¹å¾ä¹‹é—´çš„å…³è”ä¿¡æ¯ï¼Ÿå¤§é‡çš„ç ”ç©¶å’Œå®é™…æ•°æ®åˆ†æç»“æœè¡¨æ˜ï¼šæŸäº›ç‰¹å¾ä¹‹é—´çš„å…³è”ä¿¡æ¯ï¼ˆç›¸å…³åº¦ï¼‰å¯¹äº‹ä»¶ç»“æœçš„çš„å‘ç”Ÿä¼šäº§ç”Ÿå¾ˆå¤§çš„å½±å“ã€‚ä»å®é™…ä¸šåŠ¡çº¿çš„å¹¿å‘Šç‚¹å‡»æ•°æ®åˆ†ææ¥çœ‹ï¼Œä¹Ÿæ­£å¼äº†è¿™æ ·çš„ç»“è®ºã€‚ å¦‚ä½•è¡¨è¾¾ç‰¹å¾ä¹‹é—´çš„å…³è”ï¼Ÿè¡¨ç¤ºç‰¹å¾ä¹‹é—´çš„å…³è”ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•çš„æ˜¯æ„é€ ç»„åˆç‰¹å¾ã€‚æ ·æœ¬ä¸­ç‰¹å¾ä¹‹é—´çš„å…³è”ä¿¡æ¯åœ¨one-hotç¼–ç å’Œæµ…å±‚å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚LRã€SVMï¼‰æ˜¯åšä¸åˆ°çš„ã€‚ç›®å‰å·¥ä¸šç•Œä¸»è¦æœ‰ä¸¤ç§æ‰‹æ®µå¾—åˆ°ç»„åˆç‰¹å¾ï¼šäººå·¥ç‰¹å¾å·¥ç¨‹ï¼ˆæ•°æ®åˆ†æï¼‹äººå·¥æ„é€ ï¼‰ï¼›é€šè¿‡æ¨¡å‹åšç»„åˆç‰¹å¾çš„å­¦ä¹ ï¼ˆæ·±åº¦å­¦ä¹ æ–¹æ³•ã€FM/FFMæ–¹æ³•ï¼‰æœ¬ç« ä¸»è¦è®¨è®ºFMå’ŒFFMç”¨æ¥å­¦ä¹ ç‰¹å¾ä¹‹é—´çš„å…³è”ã€‚æˆ‘ä»¬åœ¨ã€Šç¬¬01ç« ï¼šæ·±å…¥æµ…å‡ºMLä¹‹Regressionå®¶æ—ã€‹çœ‹åˆ°çš„å¤šé¡¹å¼å›å½’æ¨¡å‹ï¼Œå…¶ä¸­çš„äº¤å‰å› å­é¡¹xixjå°±æ˜¯ç»„åˆç‰¹å¾æœ€ç›´è§‚çš„ä¾‹å­ã€‚xixjè¡¨ç¤ºç‰¹å¾xiå’Œxjçš„ç»„åˆï¼Œå½“xiå’Œxjéƒ½éé›¶æ—¶ï¼Œç»„åˆç‰¹å¾xixjæ‰æœ‰æ„ä¹‰ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥äºŒé˜¶å¤šé¡¹å¼æ¨¡å‹ï¼ˆdegree=2æ—¶ï¼‰ä¸ºä¾‹ï¼Œæ¥åˆ†æå’Œæ¢è®¨FMåŸç†å’Œå‚æ•°å­¦ä¹ è¿‡ç¨‹ã€‚ FMæ¨¡å‹è¡¨è¾¾ä¸ºäº†æ›´å¥½çš„ä»‹ç»FMæ¨¡å‹ï¼Œæˆ‘ä»¬å…ˆä»å¤šé¡¹å¼å›å½’ã€äº¤å‰ç»„åˆç‰¹å¾è¯´èµ·ï¼Œç„¶åè‡ªç„¶åœ°è¿‡åº¦åˆ°FMæ¨¡å‹ã€‚äºŒé˜¶å¤šé¡¹å¼å›å½’æ¨¡å‹æˆ‘ä»¬å…ˆçœ‹äºŒé˜¶å¤šé¡¹å¼æ¨¡å‹çš„è¡¨è¾¾å¼ï¼šy&#x005E;(x):=w0+&#x2211;i=1nwixi&#x23DF;&#x7EBF;&#x6027;&#x56DE;&#x5F52;+&#x2211;i=1n&#x2211;j=i+1nwijxixj&#x23DF;&#x4EA4;&#x53C9;&#x9879;&#xFF08;&#x7EC4;&#x5408;&#x7279;&#x5F81;&#xFF09;(n.ml.1.9.1)å…¶ä¸­ï¼Œnè¡¨ç¤ºæ ·æœ¬ç‰¹å¾ç»´åº¦ï¼Œæˆªè· w0âˆˆR,wï¼{w1,w2,â‹¯,wn}âˆˆRn,wijâˆˆRnÃ—n ä¸ºæ¨¡å‹å‚æ•°ã€‚ä»å…¬å¼(n.ml.1.9.1)å¯çŸ¥ï¼Œäº¤å‰é¡¹ä¸­çš„ç»„åˆç‰¹å¾å‚æ•°æ€»å…±æœ‰n(nâˆ’1)2ä¸ªã€‚åœ¨è¿™é‡Œï¼Œä»»æ„ä¸¤ä¸ªäº¤å‰é¡¹å‚æ•°wijéƒ½æ˜¯ç‹¬ç«‹çš„ã€‚ç„¶è€Œï¼Œåœ¨æ•°æ®éå¸¸ç¨€ç–çš„å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œäº¤å‰é¡¹å‚æ•°çš„å­¦ä¹ æ˜¯å¾ˆå›°éš¾çš„ã€‚whyï¼Ÿå› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œå›å½’æ¨¡å‹çš„å‚æ•°wçš„å­¦ä¹ ç»“æœå°±æ˜¯ä»è®­ç»ƒæ ·æœ¬ä¸­è®¡ç®—å……åˆ†ç»Ÿè®¡é‡ï¼ˆå‡¡æ˜¯ç¬¦åˆæŒ‡æ•°æ—åˆ†å¸ƒçš„æ¨¡å‹éƒ½å…·æœ‰æ­¤æ€§è´¨ï¼‰ï¼Œè€Œåœ¨è¿™é‡Œäº¤å‰é¡¹çš„æ¯ä¸€ä¸ªå‚æ•°wijçš„å­¦ä¹ è¿‡ç¨‹éœ€è¦å¤§é‡çš„xiã€xjåŒæ—¶éé›¶çš„è®­ç»ƒæ ·æœ¬æ•°æ®ã€‚ç”±äºæ ·æœ¬æ•°æ®æœ¬æ¥å°±å¾ˆç¨€ç–ï¼Œèƒ½å¤Ÿæ»¡è¶³â€œxiå’Œxjéƒ½éé›¶â€çš„æ ·æœ¬æ•°å°±ä¼šæ›´å°‘ã€‚è®­ç»ƒæ ·æœ¬ä¸å……åˆ†ï¼Œå­¦åˆ°çš„å‚æ•°wijå°±ä¸æ˜¯å……åˆ†ç»Ÿè®¡é‡ç»“æœï¼Œå¯¼è‡´å‚æ•°wijä¸å‡†ç¡®ï¼Œè€Œè¿™ä¼šä¸¥é‡å½±å“æ¨¡å‹é¢„æµ‹çš„æ•ˆæœï¼ˆperformanceï¼‰å’Œç¨³å®šæ€§ã€‚How to do it ?é‚£ä¹ˆï¼Œå¦‚ä½•åœ¨é™ä½æ•°æ®ç¨€ç–é—®é¢˜ç»™æ¨¡å‹æ€§èƒ½å¸¦æ¥çš„é‡å¤§å½±å“çš„åŒæ—¶ï¼Œæœ‰æ•ˆåœ°è§£å†³äºŒé˜¶äº¤å‰é¡¹å‚æ•°çš„å­¦ä¹ é—®é¢˜å‘¢ï¼ŸçŸ©é˜µåˆ†è§£æ–¹æ³•å·²ç»ç»™å‡ºäº†è§£å†³æ€è·¯ã€‚è¿™é‡Œå€Ÿç”¨CMUè®¨è®ºè¯¾ä¸­æåˆ°çš„FMè¯¾ä»¶å’Œç¾å›¢ï¼æ·±å…¥FFMåŸç†ä¸å®è·µä¸­æåˆ°çš„çŸ©é˜µåˆ†è§£ä¾‹å­ï¼ˆç¾å›¢æŠ€æœ¯å›¢é˜Ÿçš„åˆ†äº«å¾ˆèµğŸ‘ï¼‰ã€‚åœ¨åŸºäºModel-Basedçš„ååŒè¿‡æ»¤ä¸­ï¼Œä¸€ä¸ªratingçŸ©é˜µå¯ä»¥åˆ†è§£ä¸ºuserçŸ©é˜µå’ŒitemçŸ©é˜µï¼Œæ¯ä¸ªuserå’Œiteméƒ½å¯ä»¥é‡‡ç”¨ä¸€ä¸ªéšå‘é‡è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸Šå›¾æŠŠæ¯ä¸€ä¸ªuserè¡¨ç¤ºæˆäº†ä¸€ä¸ªäºŒç»´å‘é‡ï¼ŒåŒæ—¶ä¹ŸæŠŠitemè¡¨ç¤ºæˆä¸€ä¸ªäºŒç»´å‘é‡ï¼Œä¸¤ä¸ªå‘é‡çš„å†…ç§¯å°±æ˜¯çŸ©é˜µä¸­userå¯¹itemçš„æ‰“åˆ†ã€‚æ ¹æ®çŸ©é˜µåˆ†è§£çš„å¯å‘ï¼Œå¦‚æœæŠŠå¤šé¡¹å¼æ¨¡å‹ä¸­äºŒé˜¶äº¤å‰é¡¹å‚æ•°wijç»„æˆä¸€ä¸ªå¯¹ç§°çŸ©é˜µWï¼ˆå¯¹è§’å…ƒç´ è®¾ä¸ºæ­£å®æ•°ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªçŸ©é˜µå°±å¯ä»¥åˆ†è§£ä¸ºW=VVTï¼ŒVâˆˆRnÃ—kç§°ä¸ºç³»æ•°çŸ©é˜µï¼Œå…¶ä¸­ç¬¬iè¡Œå¯¹åº”ç€ç¬¬iç»´ç‰¹å¾çš„éšå‘é‡ (è¿™éƒ¨åˆ†åœ¨FMå…¬å¼è§£è¯»ä¸­è¯¦ç»†ä»‹ç»)ã€‚å°†æ¯ä¸ªäº¤å‰é¡¹å‚æ•°wijç”¨éšå‘é‡çš„å†…ç§¯âŸ¨vi,vjâŸ©è¡¨ç¤ºï¼Œæ˜¯FMæ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³ã€‚ä¸‹é¢å¯¹FMæ¨¡å‹è¡¨è¾¾å¼å’Œå‚æ•°æ±‚è§£è¿‡ç¨‹ï¼Œç»™å‡ºè¯¦ç»†è§£è¯»ã€‚ FMæ¨¡å‹è¡¨è¾¾è¿™é‡Œæˆ‘ä»¬åªè®¨è®ºäºŒé˜¶FMæ¨¡å‹ï¼ˆdegreeï¼2ï¼‰ï¼Œå…¶è¡¨è¾¾å¼ä¸ºï¼šy&#x005E;(x):=w0+&#x2211;i=1nwixi+&#x2211;i=1n&#x2211;j=i+1n&#x27E8;vi,vj&#x27E9;xixj(ml.1.9.1)å…¶ä¸­ï¼Œviè¡¨ç¤ºç¬¬iç‰¹å¾çš„éšå‘é‡ï¼ŒâŸ¨â‹…,â‹…âŸ©è¡¨ç¤ºä¸¤ä¸ªé•¿åº¦ä¸ºkçš„å‘é‡çš„å†…ç§¯ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š&#x27E8;vi,vj&#x27E9;:=&#x2211;f=1kvi,f&#x22C5;vj,f(ml.1.9.2) å…¬å¼è§£è¯»ï¼š çº¿æ€§æ¨¡å‹ï¼‹äº¤å‰é¡¹ç›´è§‚åœ°çœ‹FMæ¨¡å‹è¡¨è¾¾å¼ï¼Œå‰ä¸¤é¡¹æ˜¯çº¿æ€§å›å½’æ¨¡å‹çš„è¡¨è¾¾å¼ï¼Œæœ€åä¸€é¡¹æ˜¯äºŒé˜¶ç‰¹å¾äº¤å‰é¡¹ï¼ˆåˆç§°ç»„åˆç‰¹å¾é¡¹ï¼‰ï¼Œè¡¨ç¤ºæ¨¡å‹å°†ä¸¤ä¸ªäº’å¼‚çš„ç‰¹å¾åˆ†é‡ä¹‹é—´çš„å…³è”ä¿¡æ¯è€ƒè™‘è¿›æ¥ã€‚ç”¨äº¤å‰é¡¹è¡¨ç¤ºç»„åˆç‰¹å¾ï¼Œä»è€Œå»ºç«‹ç‰¹å¾ä¸ç»“æœä¹‹é—´çš„éçº¿æ€§å…³ç³»ã€‚ äº¤å‰é¡¹ç³»æ•° â†’ éšå‘é‡å†…ç§¯ç”±äºFMæ¨¡å‹æ˜¯åœ¨çº¿æ€§å›å½’åŸºç¡€ä¸ŠåŠ å…¥äº†ç‰¹å¾äº¤å‰é¡¹ï¼Œæ¨¡å‹æ±‚è§£æ—¶ä¸ç›´æ¥æ±‚ç‰¹å¾äº¤å‰é¡¹çš„ç³»æ•°wijï¼ˆå› ä¸ºå¯¹åº”çš„ç»„åˆç‰¹å¾æ•°æ®ç¨€ç–ï¼Œå‚æ•°å­¦ä¹ ä¸å……åˆ†ï¼‰ï¼Œæ•…è€Œé‡‡ç”¨éšå‘é‡çš„å†…ç§¯âŸ¨vi,vjâŸ©è¡¨ç¤ºwijã€‚å…·ä½“çš„ï¼ŒFMæ±‚è§£è¿‡ç¨‹ä¸­çš„åšæ³•æ˜¯ï¼šå¯¹æ¯ä¸€ä¸ªç‰¹å¾åˆ†é‡xiå¼•å…¥éšå‘é‡viï¼(vi,1,vi,2,â‹¯,vi,k)ï¼Œåˆ©ç”¨vivTjå†…ç§¯ç»“æœå¯¹äº¤å‰é¡¹çš„ç³»æ•°wijè¿›è¡Œä¼°è®¡ï¼Œå…¬å¼è¡¨ç¤ºï¼šw&#x005E;ij:=vivjTéšå‘é‡çš„é•¿åº¦kç§°ä¸ºè¶…å‚æ•°(kâˆˆN+,kâ‰ªn)ï¼Œvi=(vi,1,vi,2,â‹¯,vi,k)çš„å«ä¹‰æ˜¯ç”¨kä¸ªæè¿°ç‰¹å¾çš„å› å­æ¥è¡¨ç¤ºç¬¬iç»´ç‰¹å¾ã€‚æ ¹æ®å…¬å¼(ml.1.9.1)ï¼ŒäºŒé˜¶äº¤å‰é¡¹çš„å‚æ•°ç”±nâ‹…nä¸ªå‡å°‘åˆ°nâ‹…kä¸ªï¼Œè¿œå°‘äºäºŒé˜¶å¤šé¡¹å¼æ¨¡å‹ä¸­çš„å‚æ•°æ•°é‡ã€‚æ­¤å¤–ï¼Œå‚æ•°å› å­åŒ–è¡¨ç¤ºåï¼Œä½¿å¾—xhxiçš„å‚æ•°ä¸xixjçš„å‚æ•°ä¸å†ç›¸äº’ç‹¬ç«‹ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ ·æœ¬ç¨€ç–æƒ…å†µä¸‹ç›¸å¯¹åˆç†çš„ä¼°è®¡FMæ¨¡å‹äº¤å‰é¡¹çš„å‚æ•°ã€‚å…·ä½“åœ°ï¼š&#x27E8;vh,vi&#x27E9;:=&#x2211;f=1kvh,f&#x22C5;vi,f(1)&#x27E8;vi,vj&#x27E9;:=&#x2211;f=1kvi,f&#x22C5;vj,f(2)(n.ml.1.9.2)xhxi ä¸xixjçš„ç³»æ•°åˆ†åˆ«ä¸ºâŸ¨vh,viâŸ©å’ŒâŸ¨vi,vjâŸ©ï¼Œä»–ä»¬ä¹‹é—´æœ‰å…±åŒé¡¹viã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰åŒ…å«xiçš„éé›¶ç»„åˆç‰¹å¾ï¼ˆå­˜åœ¨æŸä¸ªjâ‰ iï¼Œä½¿å¾—xixjâ‰ 0ï¼‰çš„æ ·æœ¬éƒ½å¯ä»¥ç”¨æ¥å­¦ä¹ éšå‘é‡viï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šé¿å…äº†æ•°æ®ç¨€ç–è¡Œé€ æˆå‚æ•°ä¼°è®¡ä¸å‡†ç¡®çš„å½±å“ã€‚åœ¨äºŒé˜¶å¤šé¡¹å¼æ¨¡å‹ä¸­ï¼Œå‚æ•°whiå’Œwijçš„å­¦ä¹ è¿‡ç¨‹æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚è®ºæ–‡ä¸­è¿˜æåˆ°FMæ¨¡å‹çš„åº”ç”¨åœºæ™¯ï¼Œå¹¶ä¸”è¯´å…¬å¼(ml.1.9.1)ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ‹Ÿåˆæ¨¡å‹ï¼ˆGeneric Modelï¼‰ï¼Œå¯ä»¥é‡‡ç”¨ä¸åŒçš„æŸå¤±å‡½æ•°æ¥è§£å†³å…·ä½“é—®é¢˜ã€‚æ¯”å¦‚ï¼šFMåº”ç”¨åœºæ™¯æŸå¤±å‡½æ•°è¯´æ˜å›å½’å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰æŸå¤±Mean Square Errorï¼Œä¸å¹³æ–¹è¯¯å·®ç±»ä¼¼äºŒç±»åˆ†ç±»Hinge/Cross-EntopyæŸå¤±åˆ†ç±»æ—¶ï¼Œç»“æœéœ€è¦åšsigmoidå˜æ¢æ’åº. FMå‚æ•°å­¦ä¹  ç­‰å¼å˜æ¢å…¬å¼(ml.1.9.1)ä¸­ç›´è§‚åœ°çœ‹ï¼ŒFMæ¨¡å‹çš„å¤æ‚åº¦ä¸ºO(kn2)ï¼Œä½†æ˜¯é€šè¿‡ä¸‹é¢çš„ç­‰ä»·è½¬æ¢ï¼Œå¯ä»¥å°†FMçš„äºŒæ¬¡é¡¹åŒ–ç®€ï¼Œå…¶å¤æ‚åº¦å¯ä¼˜åŒ–åˆ°O(kn)ã€‚å³ï¼š&#x2211;i=1n&#x2211;j=i+1n&#x27E8;vi,vj&#x27E9;xixj=12&#x2211;f=1k&#x27EE;(&#x2211;i=1nvi,fxi)2&#x2212;&#x2211;i=1nvi,f2xi2&#x27EF;(ml.1.9.3)ä¸‹é¢ç»™å‡ºè¯¦ç»†æ¨å¯¼ï¼š&#x2211;i=1n&#x2211;j=i+1n&#x27E8;vi,vj&#x27E9;xixj(1)=12&#x2211;i=1n&#x2211;j=1n&#x27E8;vi,vj&#x27E9;xixj&#x2212;12&#x2211;i=1n&#x27E8;vi,vi&#x27E9;xixi(2)=12(&#x2211;i=1n&#x2211;j=1n&#x2211;f=1kvi,fvj,fxixj&#x2212;&#x2211;i=1n&#x2211;f=1kvi,fvi,fxixi)(3)=12&#x2211;f=1k&#x27EE;(&#x2211;i=1nvi,fxi)&#x22C5;(&#x2211;j=1nvj,fxj)&#x2212;&#x2211;i=1nvi,f2xi2&#x27EF;(4)=12&#x2211;f=1k&#x27EE;(&#x2211;i=1nvi,fxi)2&#x2212;&#x2211;i=1nvi,f2xi2&#x27EF;(5)(n.ml.1.9.3) è§£è¯»ç¬¬ï¼ˆ1ï¼‰æ­¥åˆ°ç¬¬ï¼ˆ2ï¼‰æ­¥ï¼Œè¿™é‡Œç”¨Aè¡¨ç¤ºç³»æ•°çŸ©é˜µVçš„ä¸Šä¸‰è§’å…ƒç´ ï¼ŒBè¡¨ç¤ºå¯¹è§’çº¿ä¸Šçš„äº¤å‰é¡¹ç³»æ•°ã€‚ç”±äºç³»æ•°çŸ©é˜µVæ˜¯ä¸€ä¸ªå¯¹ç§°é˜µï¼Œæ‰€ä»¥ä¸‹ä¸‰è§’ä¸ä¸Šä¸‰è§’ç›¸ç­‰ï¼Œæœ‰ä¸‹å¼æˆç«‹ï¼š A=12(2A+B)&#x2212;12B.A=&#x2211;i=1n&#x2211;j=i+1n&#x27E8;vi,vj&#x27E9;xixj&#x005F;;B=12&#x2211;i=1n&#x27E8;vi,vi&#x27E9;xixi&#x005F;(n.ml.1.9.4)å¦‚æœç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descentï¼‰æ³•å­¦ä¹ æ¨¡å‹å‚æ•°ã€‚é‚£ä¹ˆï¼Œæ¨¡å‹å„ä¸ªå‚æ•°çš„æ¢¯åº¦å¦‚ä¸‹ï¼š&#x2202;&#x2202;&#x03B8;y(x)={1,if&#x03B8;isw0(&#x5E38;&#x6570;&#x9879;)xiif&#x03B8;iswi(&#x7EBF;&#x6027;&#x9879;)xi&#x2211;j=1nvj,fxj&#x2212;vi,fxi2,if&#x03B8;isvi,f(&#x4EA4;&#x53C9;&#x9879;)(ml.1.9.4) å…¶ä¸­ï¼Œ vj,fæ˜¯éšå‘é‡vjçš„ç¬¬fä¸ªå…ƒç´ ã€‚ æ¢¯åº¦æ³•è®­ç»ƒFMç»™å‡ºä¼ªä»£ç  FMè®­ç»ƒå¤æ‚åº¦ç”±äºâˆ‘nj=1vj,fxjåªä¸fæœ‰å…³ï¼Œåœ¨å‚æ•°è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦è®¡ç®—ç¬¬ä¸€æ¬¡æ‰€æœ‰fçš„âˆ‘nj=1vj,fxjï¼Œå°±èƒ½å¤Ÿæ–¹ä¾¿åœ°å¾—åˆ°æ‰€æœ‰vi,fçš„æ¢¯åº¦ã€‚æ˜¾ç„¶ï¼Œè®¡ç®—æ‰€æœ‰fçš„âˆ‘nj=1vj,fxjçš„å¤æ‚åº¦æ˜¯O(kn)ï¼›å·²çŸ¥âˆ‘nj=1vj,fxjæ—¶ï¼Œè®¡ç®—æ¯ä¸ªå‚æ•°æ¢¯åº¦çš„å¤æ‚åº¦æ˜¯O(n)ï¼›å¾—åˆ°æ¢¯åº¦åï¼Œæ›´æ–°æ¯ä¸ªå‚æ•°çš„å¤æ‚åº¦æ˜¯ O(1)ï¼›æ¨¡å‹å‚æ•°ä¸€å…±æœ‰nk+n+1ä¸ªã€‚å› æ­¤ï¼ŒFMå‚æ•°è®­ç»ƒçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(kn)ã€‚ç»¼ä¸Šå¯çŸ¥ï¼ŒFMç®—æ³•å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…å®Œæˆæ¨¡å‹è®­ç»ƒï¼Œä»¥åŠå¯¹æ–°æ ·æœ¬åšå‡ºé¢„æµ‹ï¼Œæ‰€ä»¥è¯´FMæ˜¯ä¸€ä¸ªéå¸¸é«˜æ•ˆçš„æ¨¡å‹ã€‚ FMæ€»ç»“ä¸Šé¢æˆ‘ä»¬ä¸»è¦æ˜¯ä»FMæ¨¡å‹å¼•å…¥ï¼ˆå¤šé¡¹å¼å¼€å§‹ï¼‰ã€æ¨¡å‹è¡¨è¾¾å’Œå‚æ•°å­¦ä¹ çš„è§’åº¦ä»‹ç»çš„FMæ¨¡å‹ï¼Œè¿™é‡Œæˆ‘æŠŠæˆ‘è®¤ä¸ºFMæœ€æ ¸å¿ƒçš„ç²¾é«“å’Œä»·å€¼æ€»ç»“å‡ºæ¥ï¼Œä¸å¤§å®¶è®¨è®ºã€‚FMæ¨¡å‹çš„æ ¸å¿ƒä½œç”¨å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹3ä¸ªï¼š 1. FMé™ä½äº†äº¤å‰é¡¹å‚æ•°å­¦ä¹ ä¸å……åˆ†çš„å½±å“one-hotç¼–ç åçš„æ ·æœ¬æ•°æ®éå¸¸ç¨€ç–ï¼Œç»„åˆç‰¹å¾æ›´æ˜¯å¦‚æ­¤ã€‚ä¸ºäº†è§£å†³äº¤å‰é¡¹å‚æ•°å­¦ä¹ ä¸å……åˆ†ã€å¯¼è‡´æ¨¡å‹æœ‰åæˆ–ä¸ç¨³å®šçš„é—®é¢˜ã€‚ä½œè€…å€Ÿé‰´çŸ©é˜µåˆ†è§£çš„æ€è·¯ï¼šæ¯ä¸€ç»´ç‰¹å¾ç”¨kç»´çš„éšå‘é‡è¡¨ç¤ºï¼Œäº¤å‰é¡¹çš„å‚æ•°wijç”¨å¯¹åº”ç‰¹å¾éšå‘é‡çš„å†…ç§¯è¡¨ç¤ºï¼Œå³âŸ¨vi,vjâŸ©ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºå¹³æ»‘æŠ€æœ¯ï¼‰ã€‚è¿™æ ·å‚æ•°å­¦ä¹ ç”±ä¹‹å‰å­¦ä¹ äº¤å‰é¡¹å‚æ•°wijçš„è¿‡ç¨‹ï¼Œè½¬å˜ä¸ºå­¦ä¹ nä¸ªå•ç‰¹å¾å¯¹åº”kç»´éšå‘é‡çš„è¿‡ç¨‹ã€‚å¾ˆæ˜æ˜¾ï¼Œå•ç‰¹å¾å‚æ•°ï¼ˆkç»´éšå‘é‡viï¼‰çš„å­¦ä¹ è¦æ¯”äº¤å‰é¡¹å‚æ•°wijå­¦ä¹ å¾—æ›´å……åˆ†ã€‚ç¤ºä¾‹è¯´æ˜ï¼šå‡å¦‚æœ‰10wæ¡è®­ç»ƒæ ·æœ¬ï¼Œå…¶ä¸­å‡ºç°å¥³æ€§ç‰¹å¾çš„æ ·æœ¬æ•°ä¸º3wï¼Œå‡ºç°ç”·æ€§ç‰¹å¾çš„æ ·æœ¬æ•°ä¸º7wï¼Œå‡ºç°æ±½è½¦ç‰¹å¾çš„æ ·æœ¬æ•°ä¸º2000ï¼Œå‡ºç°åŒ–å¦†å“çš„æ ·æœ¬æ•°ä¸º1000ã€‚ç‰¹å¾å…±ç°çš„æ ·æœ¬æ•°å¦‚ä¸‹ï¼šå…±ç°äº¤å‰ç‰¹å¾æ ·æœ¬æ•°æ³¨&lt;å¥³æ€§ï¼Œæ±½è½¦&gt;500åŒæ—¶å‡ºç°&lt;å¥³æ€§ï¼Œæ±½è½¦&gt;çš„æ ·æœ¬æ•°&lt;å¥³æ€§ï¼ŒåŒ–å¦†å“&gt;1000åŒæ—¶å‡ºç°&lt;å¥³æ€§ï¼ŒåŒ–å¦†å“&gt;çš„æ ·æœ¬æ•°&lt;ç”·æ€§ï¼Œæ±½è½¦&gt;1500åŒæ—¶å‡ºç°&lt;ç”·æ€§ï¼Œæ±½è½¦&gt;çš„æ ·æœ¬æ•°&lt;ç”·æ€§ï¼ŒåŒ–å¦†å“&gt;0æ ·æœ¬ä¸­æ— æ­¤ç‰¹å¾ç»„åˆé¡¹&lt;å¥³æ€§ï¼Œæ±½è½¦&gt; çš„å«ä¹‰æ˜¯ å¥³æ€§çœ‹æ±½è½¦å¹¿å‘Šã€‚å¯ä»¥çœ‹åˆ°ï¼Œå•ç‰¹å¾å¯¹åº”çš„æ ·æœ¬æ•°è¿œå¤§äºç»„åˆç‰¹å¾å¯¹åº”çš„æ ·æœ¬æ•°ã€‚è®­ç»ƒæ—¶ï¼Œå•ç‰¹å¾å‚æ•°ç›¸æ¯”äº¤å‰é¡¹ç‰¹å¾å‚æ•°ä¼šå­¦ä¹ åœ°æ›´å……åˆ†ã€‚å› æ­¤ï¼Œå¯ä»¥è¯´FMé™ä½äº†å› æ•°æ®ç¨€ç–ï¼Œå¯¼è‡´äº¤å‰é¡¹å‚æ•°å­¦ä¹ ä¸å……åˆ†çš„å½±å“ã€‚ 2. FMæå‡äº†æ¨¡å‹é¢„ä¼°èƒ½åŠ›ä¾ç„¶çœ‹ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæ ·æœ¬ä¸­æ²¡æœ‰*&lt;ç”·æ€§ï¼ŒåŒ–å¦†å“&gt;äº¤å‰ç‰¹å¾ï¼Œå³æ²¡æœ‰ç”·æ€§çœ‹åŒ–å¦†å“å¹¿å‘Šçš„æ•°æ®ã€‚å¦‚æœç”¨å¤šé¡¹å¼æ¨¡å‹æ¥å»ºæ¨¡ï¼Œå¯¹åº”çš„äº¤å‰é¡¹å‚æ•°wç”·æ€§,åŒ–å¦†å“æ˜¯å­¦ä¸å‡ºæ¥çš„ï¼Œå› ä¸ºæ•°æ®ä¸­æ²¡æœ‰å¯¹åº”çš„å…±ç°äº¤å‰ç‰¹å¾ã€‚é‚£ä¹ˆå¤šé¡¹å¼æ¨¡å‹å°±ä¸èƒ½å¯¹å‡ºç°çš„ç”·æ€§çœ‹åŒ–å¦†å“å¹¿å‘Š*åœºæ™¯ç»™å‡ºå‡†ç¡®åœ°é¢„ä¼°ã€‚FMæ¨¡å‹æ˜¯å¦èƒ½å¾—åˆ°äº¤å‰é¡¹å‚æ•°wç”·æ€§,åŒ–å¦†å“å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ç”±äºFMæ¨¡å‹æ˜¯æŠŠäº¤å‰é¡¹å‚æ•°ç”¨å¯¹åº”çš„ç‰¹å¾éšå‘é‡å†…ç§¯è¡¨ç¤ºï¼Œè¿™é‡Œè¡¨ç¤ºä¸ºwç”·æ€§,åŒ–å¦†å“=âŸ¨vç”·æ€§,våŒ–å¦†å“âŸ©ã€‚ç”¨ç”·æ€§ç‰¹å¾éšå‘é‡vç”·æ€§å’ŒåŒ–å¦†å“ç‰¹å¾éšå‘é‡våŒ–å¦†å“çš„å†…ç§¯è¡¨ç¤ºäº¤å‰é¡¹å‚æ•°wç”·æ€§,åŒ–å¦†å“ã€‚ç”±äºFMå­¦ä¹ çš„å‚æ•°å°±æ˜¯å•ç‰¹å¾çš„éšå‘é‡ï¼Œé‚£ä¹ˆç”·æ€§çœ‹åŒ–å¦†å“å¹¿å‘Šçš„é¢„ä¼°ç»“æœå¯ä»¥ç”¨âŸ¨vç”·æ€§,våŒ–å¦†å“âŸ©å¾—åˆ°ã€‚è¿™æ ·ï¼Œå³ä¾¿è®­ç»ƒé›†ä¸­æ²¡æœ‰å‡ºç°ç”·æ€§çœ‹åŒ–å¦†å“å¹¿å‘Šçš„æ ·æœ¬ï¼ŒFMæ¨¡å‹ä»ç„¶å¯ä»¥ç”¨æ¥é¢„ä¼°ï¼Œæå‡äº†é¢„ä¼°èƒ½åŠ›ã€‚ 3. FMæå‡äº†å‚æ•°å­¦ä¹ æ•ˆç‡è¿™ä¸ªæ˜¾è€Œæ˜“è§ï¼Œå‚æ•°ä¸ªæ•°ç”±(n2+n+1)å˜ä¸º(nk+n+1)ä¸ªï¼Œæ¨¡å‹è®­ç»ƒå¤æ‚åº¦ä¹Ÿç”±O(mn2)å˜ä¸ºO(mnk)ã€‚mä¸ºè®­ç»ƒæ ·æœ¬æ•°ã€‚å¯¹äºè®­ç»ƒæ ·æœ¬å’Œç‰¹å¾æ•°è€Œè¨€ï¼Œéƒ½æ˜¯çº¿æ€§å¤æ‚åº¦ã€‚æ­¤å¤–ï¼Œå°±FMæ¨¡å‹æœ¬èº«è€Œè¨€ï¼Œå®ƒæ˜¯åœ¨å¤šé¡¹å¼æ¨¡å‹åŸºç¡€ä¸Šå¯¹å‚æ•°çš„è®¡ç®—åšäº†è°ƒæ•´ï¼Œå› æ­¤ä¹Ÿæœ‰äººæŠŠFMæ¨¡å‹ç§°ä¸ºå¤šé¡¹å¼çš„å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼Œä¹Ÿæ˜¯æ°å¦‚å…¶åˆ†çš„ã€‚ä»äº¤äº’é¡¹çš„è§’åº¦çœ‹ï¼ŒFMä»…ä»…æ˜¯ä¸€ä¸ªå¯ä»¥è¡¨ç¤ºç‰¹å¾ä¹‹é—´äº¤äº’å…³ç³»çš„å‡½æ•°è¡¨æ³•å¼ï¼Œå¯ä»¥æ¨å¹¿åˆ°æ›´é«˜é˜¶å½¢å¼ï¼Œå³å°†å¤šä¸ªäº’å¼‚ç‰¹å¾åˆ†é‡ä¹‹é—´çš„å…³è”ä¿¡æ¯è€ƒè™‘è¿›æ¥ã€‚ä¾‹å¦‚åœ¨å¹¿å‘Šä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¦‚æœè€ƒè™‘User-Ad-Contextä¸‰ä¸ªç»´åº¦ç‰¹å¾ä¹‹é—´çš„å…³ç³»ï¼Œåœ¨FMæ¨¡å‹ä¸­å¯¹åº”çš„degreeä¸º3ã€‚ æ€»ç»“æœ€åä¸€å¥è¯æ€»ç»“ï¼ŒFMæœ€å¤§ç‰¹ç‚¹å’Œä¼˜åŠ¿ï¼šFMæ¨¡å‹å¯¹ç¨€ç–æ•°æ®æœ‰æ›´å¥½çš„å­¦ä¹ èƒ½åŠ›ï¼Œé€šè¿‡äº¤äº’é¡¹å¯ä»¥å­¦ä¹ ç‰¹å¾ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œå¹¶ä¸”ä¿è¯äº†å­¦ä¹ æ•ˆç‡å’Œé¢„ä¼°èƒ½åŠ›ã€‚ åœºæ„ŸçŸ¥åˆ†è§£æœºåœºæ„ŸçŸ¥åˆ†è§£æœºå™¨ï¼ˆField-aware Factorization Machine ï¼Œç®€ç§°FFMï¼‰æœ€åˆçš„æ¦‚å¿µæ¥è‡ªäºYu-Chin Juanä¸å…¶æ¯”èµ›é˜Ÿå‘˜ï¼Œå®ƒä»¬å€Ÿé‰´äº†è¾£å­Michael Jahrerçš„è®ºæ–‡ä¸­fieldæ¦‚å¿µï¼Œæå‡ºäº†FMçš„å‡çº§ç‰ˆæ¨¡å‹ã€‚é€šè¿‡å¼•å…¥fieldçš„æ¦‚å¿µï¼ŒFFMå§ç›¸åŒæ€§è´¨çš„ç‰¹å¾å½’äºåŒä¸€ä¸ªfieldã€‚åœ¨FMå¼€å¤´one-hotç¼–ç ä¸­æåˆ°ç”¨äºè®¿é—®çš„channelï¼Œç¼–ç ç”Ÿæˆäº†10ä¸ªæ•°å€¼å‹ç‰¹å¾ï¼Œè¿™10ä¸ªç‰¹å¾éƒ½æ˜¯ç”¨äºè¯´æ˜ç”¨æˆ·PVæ—¶å¯¹åº”çš„channelç±»åˆ«ï¼Œå› æ­¤å¯ä»¥å°†å…¶æ”¾åœ¨åŒä¸€ä¸ªfieldä¸­ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŒä¸€ä¸ªcategoricalç‰¹å¾ç»è¿‡one-hotç¼–ç ç”Ÿæˆçš„æ•°å€¼å‹ç‰¹å¾éƒ½å¯ä»¥æ”¾åœ¨åŒä¸€ä¸ªfieldä¸­ã€‚åŒä¸€ä¸ªcategoricalç‰¹å¾å¯ä»¥åŒ…æ‹¬ç”¨æˆ·å±æ€§ä¿¡æ¯ï¼ˆå¹´é¾„ã€æ€§åˆ«ã€èŒä¸šã€æ”¶å…¥ã€åœ°åŸŸç­‰ï¼‰ï¼Œç”¨æˆ·è¡Œä¸ºä¿¡æ¯ï¼ˆå…´è¶£ã€åå¥½ã€æ—¶é—´ç­‰ï¼‰ï¼Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆä½ç½®ã€å†…å®¹ç­‰ï¼‰ä»¥åŠå…¶å®ƒä¿¡æ¯ï¼ˆå¤©æ°”ã€äº¤é€šç­‰ï¼‰ã€‚åœ¨FFMä¸­ï¼Œæ¯ä¸€ç»´ç‰¹å¾xiï¼Œé’ˆå¯¹å…¶å®ƒç‰¹å¾çš„æ¯ä¸€ç§â€fieldâ€ fjï¼Œéƒ½ä¼šå­¦ä¹ ä¸€ä¸ªéšå‘é‡vi,fjã€‚å› æ­¤ï¼Œéšå‘é‡ä¸ä»…ä¸ç‰¹å¾ç›¸å…³ï¼Œä¹Ÿä¸fieldç›¸å…³ã€‚å‡è®¾æ¯æ¡æ ·æœ¬çš„nä¸ªç‰¹å¾å±äºfä¸ªfieldï¼Œé‚£ä¹ˆFFMçš„äºŒæ¬¡é¡¹æœ‰nfä¸ªéšå‘é‡ã€‚è€Œåœ¨FMæ¨¡å‹ä¸­ï¼Œæ¯ä¸€ç»´ç‰¹å¾çš„éšå‘é‡åªæœ‰ä¸€ä¸ªã€‚å› æ­¤å¯ä»¥å§FMçœ‹ä½œæ˜¯FFMçš„ç‰¹ä¾‹ï¼Œå³æŠŠæ‰€æœ‰çš„ç‰¹å¾éƒ½å½’å±åˆ°ä¸€ä¸ªfieldæ˜¯çš„FFMæ¨¡å‹ã€‚æ ¹æ®FFMçš„fieldæ•æ„Ÿç‰¹æ€§ï¼Œå¯ä»¥å¯¼å‡ºå…¶æ¨¡å‹è¡¨è¾¾å¼ï¼š\\[yÌ‚ (x):=w0+âˆ‘i=1nwixi+âˆ‘i=1nâˆ‘j=i+1nâŸ¨vi,fj,vj,fiâŸ©xixj(ml.1.9.5)\\]å…¶ä¸­ï¼Œfjæ˜¯ç¬¬jä¸ªç‰¹å¾æ‰€å±çš„fieldã€‚å¦‚æœéšå‘é‡çš„é•¿åº¦ä¸ºkï¼Œé‚£ä¹ˆFFMçš„äºŒäº¤å‰é¡¹å‚æ•°å°±æœ‰nfkä¸ªï¼Œè¿œå¤šäºFMæ¨¡å‹çš„nkä¸ªã€‚æ­¤å¤–ï¼Œç”±äºéšå‘é‡ä¸fieldç›¸å…³ï¼ŒFFMçš„äº¤å‰é¡¹å¹¶ä¸èƒ½å¤ŸåƒFMé‚£æ ·åšåŒ–ç®€ï¼Œå…¶é¢„æµ‹å¤æ‚åº¦ä¸ºO(kn2)ã€‚è¿™é‡Œä»¥NTU_FFM.pdfå’Œç¾å›¢ï¼æ·±å…¥FFMåŸç†ä¸å®è·µéƒ½æåˆ°çš„ä¾‹å­ï¼Œç»™å‡ºFFMï¼Fieldsç‰¹å¾ç»„åˆçš„å·¥ä½œè¿‡ç¨‹ã€‚ç»™å‡ºä¸€ä¸‹è¾“å…¥æ•°æ®ï¼šUserMovieGenrePriceYuChin3IdiotsComedy, Drama$9.99Priceæ˜¯æ•°å€¼å‹ç‰¹å¾ï¼Œå®é™…åº”ç”¨ä¸­é€šå¸¸ä¼šæŠŠä»·æ ¼åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºé—´ï¼ˆå³è¿ç»­ç‰¹å¾ç¦»æ•£åŒ–ï¼‰ï¼Œç„¶åå†one-hotç¼–ç ï¼Œè¿™é‡Œå‡è®¾$9.99å¯¹åº”çš„ç¦»æ•£åŒ–åŒºé—´tagä¸ºâ€2â€ã€‚å½“ç„¶ä¸æ˜¯æ‰€æœ‰çš„è¿ç»­å‹ç‰¹å¾éƒ½è¦åšç¦»æ•£åŒ–ï¼Œæ¯”å¦‚æŸå¹¿å‘Šä½ã€æŸç±»å¹¿å‘Šï¼å•†å“ã€æŠ‘æˆ–æŸç±»äººç¾¤ç»Ÿè®¡çš„å†å²CTRï¼ˆpseudoï¼CTRï¼‰é€šå¸¸æ— éœ€åšç¦»æ•£åŒ–ã€‚è¯¥æ¡è®°å½•å¯ä»¥ç¼–ç ä¸º5ä¸ªæ•°å€¼ç‰¹å¾ï¼Œå³User^YuChin, Movie^3Idiots, Genre^Comedy, Genre^Drama, Price2*ã€‚å…¶ä¸­*GenreComedy, Genre^Dramaå±äºåŒä¸€ä¸ªfieldã€‚ä¸ºäº†è¯´æ˜FFMçš„æ ·æœ¬æ ¼å¼ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„ç‰¹å¾å’Œå¯¹åº”çš„fieldæ˜ å°„æˆæ•´æ•°ç¼–å·ã€‚Field NameField IndexFeature NameFeature IndexUser1User^YuChin1Movie2Movie^3Idiots2Genre3Genre^Comedy3ï¼ï¼Genre^Drama4Price4Price^25é‚£ä¹ˆï¼ŒFFMæ‰€æœ‰çš„ï¼ˆäºŒé˜¶ï¼‰ç»„åˆç‰¹å¾å…±æœ‰10é¡¹ï¼ˆC25=5Ã—42!=10ï¼‰ï¼Œå³ä¸ºï¼šå…¶ä¸­ï¼Œçº¢è‰²è¡¨ç¤ºFieldç¼–ç ï¼Œè“è‰²è¡¨ç¤ºFeatureç¼–ç ï¼Œç»¿è‰²è¡¨ç¤ºæ ·æœ¬çš„ç»„åˆç‰¹å¾å–å€¼ï¼ˆç¦»æ•£åŒ–åçš„ç»“æœï¼‰ã€‚äºŒé˜¶äº¤å‰é¡¹çš„ç³»æ•°æ˜¯é€šè¿‡ä¸Fieldç›¸å…³çš„éšå‘é‡çš„å†…ç§¯å¾—åˆ°çš„ã€‚å¦‚æœå•ç‰¹å¾æœ‰nä¸ªï¼Œå…¨éƒ¨åšäºŒé˜¶ç‰¹å¾ç»„åˆçš„è¯ï¼Œä¼šæœ‰C2n=n(nâˆ’1)2ä¸ªã€‚ FFMåº”ç”¨åœºæ™¯åœ¨æˆ‘ä»¬çš„å¹¿å‘Šä¸šåŠ¡ç³»ç»Ÿã€å•†ä¸šæ¨èä»¥åŠè‡ªåª’ä½“ï¼æ¨èç³»ç»Ÿä¸­ï¼ŒFFMæ¨¡å‹ä½œä¸ºç‚¹å‡»é¢„ä¼°ç³»ç»Ÿä¸­çš„æ ¸å¿ƒç®—æ³•ä¹‹ä¸€ï¼Œç”¨äºé¢„ä¼°å¹¿å‘Šã€å•†å“ã€æ–‡ç« çš„ç‚¹å‡»ç‡ï¼ˆCTRï¼‰å’Œè½¬åŒ–ç‡ï¼ˆCVRï¼‰ã€‚åœ¨é„™å¸å¹¿å‘Šç®—æ³•å›¢é˜Ÿï¼Œç‚¹å‡»é¢„ä¼°ç³»ç»Ÿå·²æˆä¸ºåŸºç¡€è®¾æ–½ï¼Œæ”¯æŒå¹¶æœåŠ¡äºä¸åŒçš„ä¸šåŠ¡çº¿å’Œåº”ç”¨åœºæ™¯ã€‚é¢„ä¼°æ¨¡å‹éƒ½æ˜¯ç¦»çº¿è®­ç»ƒï¼Œç„¶åå®šæ—¶æ›´æ–°åˆ°çº¿ä¸Šå®æ—¶è®¡ç®—ï¼Œå› æ­¤é¢„ä¼°é—®é¢˜æœ€å¤§çš„å·®å¼‚å°±ä½“ç°åœ¨æ•°æ®åœºæ™¯å’Œç‰¹å¾å·¥ç¨‹ã€‚ä»¥å¹¿å‘Šçš„ç‚¹å‡»ç‡ä¸ºä¾‹ï¼Œç‰¹å¾ä¸»è¦åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼šç”¨æˆ·å±æ€§ä¸è¡Œä¸ºç‰¹å¾ï¼šå¹¿å‘Šç‰¹å¾ï¼šä¸Šä¸‹æ–‡ç¯å¢ƒç‰¹å¾ï¼šä¸ºäº†ä½¿ç”¨å¼€æºçš„FFMæ¨¡å‹ï¼Œæ‰€ä»¥çš„ç‰¹å¾å¿…é¡»è½¬åŒ–ä¸ºfield_id:feat_id:valueæ ¼å¼ï¼Œå…¶ä¸­field_idè¡¨ç¤ºç‰¹å¾æ‰€å±fieldçš„ç¼–å·ï¼Œfeat_idè¡¨ç¤ºç‰¹å¾ç¼–å·ï¼Œvalueä¸ºç‰¹å¾å–å€¼ã€‚æ•°å€¼å‹çš„ç‰¹å¾å¦‚æœæ— éœ€ç¦»æ•£åŒ–ï¼Œåªéœ€åˆ†é…å•ç‹¬çš„fieldç¼–å·å³å¯ï¼Œå¦‚å†å²pseudo-ctrã€‚categoricalç‰¹å¾éœ€è¦ç»è¿‡one-hotç¼–ç è½¬åŒ–ä¸ºæ•°å€¼å‹ï¼Œç¼–ç äº§ç”Ÿçš„æ‰€æœ‰ç‰¹å¾åŒå±äºä¸€ä¸ªfieldï¼Œç‰¹å¾valueåªèƒ½æ˜¯0/1, å¦‚ç”¨æˆ·å¹´é¾„åŒºé—´ã€æ€§åˆ«ã€å…´è¶£ã€äººç¾¤ç­‰ã€‚å¼€æºå·¥å…·FFMä½¿ç”¨æ—¶ï¼Œæ³¨æ„äº‹é¡¹ï¼ˆå‚è€ƒæ–°æµªå¹¿å‘Šç®—æ³•ç»„çš„å®æˆ˜ç»éªŒå’Œç¾å›¢ï¼æ·±å…¥FFMåŸç†ä¸å®è·µï¼‰: æ ·æœ¬å½’ä¸€åŒ–ï¼š ç‰¹å¾å½’ä¸€åŒ–ï¼š çœç•¥0å€¼ç‰¹å¾ï¼šå›å½’ã€åˆ†ç±»ã€æ’åºç­‰ã€‚æ¨èç®—æ³•ï¼Œé¢„ä¼°æ¨¡å‹ï¼ˆå¦‚CTRé¢„ä¼°ç­‰ï¼‰ å‚è€ƒèµ„æ–™Sinaå¹¿å‘Šç‚¹å‡»é¢„ä¼°ç³»ç»Ÿå®è·µFMã€FFMç›¸å…³Paperã€æŠ€æœ¯åšå®¢ç¾å›¢æŠ€æœ¯å›¢é˜ŸåŸæ–‡","categories":[{"name":"æ¨è","slug":"æ¨è","permalink":"http://www.wortyby.com/categories/æ¨è/"}],"tags":[{"name":"FM","slug":"FM","permalink":"http://www.wortyby.com/tags/FM/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://www.wortyby.com/tags/ç®—æ³•/"}]},{"title":"Hive,Hbase,HDFSç­‰ä¹‹é—´çš„å…³ç³»","slug":"Hive,Hbase,HDFSç­‰ä¹‹é—´çš„å…³ç³»","date":"2018-09-21T05:17:26.000Z","updated":"2018-09-21T05:17:26.000Z","comments":true,"path":"2018/09/21/Hive,Hbase,HDFSç­‰ä¹‹é—´çš„å…³ç³»/","link":"","permalink":"http://www.wortyby.com/2018/09/21/Hive,Hbase,HDFSç­‰ä¹‹é—´çš„å…³ç³»/","excerpt":"","text":"Hiveï¼šhiveä¸æ”¯æŒæ›´æ”¹æ•°æ®çš„æ“ä½œï¼ŒHiveåŸºäºæ•°æ®ä»“åº“ï¼Œæä¾›é™æ€æ•°æ®çš„åŠ¨æ€æŸ¥è¯¢ã€‚å…¶ä½¿ç”¨ç±»SQLè¯­è¨€ï¼Œåº•å±‚ç»è¿‡ç¼–è¯‘è½¬ä¸ºMapReduceç¨‹åºï¼Œåœ¨Hadoopä¸Šè¿è¡Œï¼Œæ•°æ®å­˜å‚¨åœ¨HDFSä¸Šã€‚ HDFS:HDFSæ˜¯GFSçš„ä¸€ç§å®ç°ï¼Œä»–çš„å®Œæ•´åå­—æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œç±»ä¼¼äºFAT32ï¼ŒNTFSï¼Œæ˜¯ä¸€ç§æ–‡ä»¶æ ¼å¼ï¼Œæ˜¯åº•å±‚çš„ã€‚Hiveä¸Hbaseçš„æ•°æ®ä¸€èˆ¬éƒ½å­˜å‚¨åœ¨HDFSä¸Šã€‚hadoop HDFSä¸ºä»–ä»¬æä¾›äº†é«˜å¯é æ€§çš„åº•å±‚å­˜å‚¨æ”¯æŒã€‚ hbase:Hbaseæ˜¯Hadoop databaseï¼Œå³Hadoopæ•°æ®åº“ã€‚å®ƒæ˜¯ä¸€ä¸ªé€‚åˆäºéç»“æ„åŒ–æ•°æ®å­˜å‚¨çš„æ•°æ®åº“ï¼ŒHBaseåŸºäºåˆ—çš„è€Œä¸æ˜¯åŸºäºè¡Œçš„æ¨¡å¼ã€‚HBaseæ˜¯Google Bigtableçš„å¼€æºå®ç°ï¼Œç±»ä¼¼Google Bigtableåˆ©ç”¨GFSä½œä¸ºå…¶æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿï¼ŒHBaseåˆ©ç”¨Hadoop HDFSä½œä¸ºå…¶æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿï¼›Googleè¿è¡ŒMapReduceæ¥å¤„ç†Bigtableä¸­çš„æµ·é‡æ•°æ®ï¼ŒHBaseåŒæ ·åˆ©ç”¨Hadoop MapReduceæ¥å¤„ç†HBaseä¸­çš„æµ·é‡æ•°æ®ã€‚Hadoop HDFSä¸ºHBaseæä¾›äº†é«˜å¯é æ€§çš„åº•å±‚å­˜å‚¨æ”¯æŒï¼ŒHadoop MapReduceä¸ºHBaseæä¾›äº†é«˜æ€§èƒ½çš„è®¡ç®—èƒ½åŠ›ï¼ŒZookeeperä¸ºHBaseæä¾›äº†ç¨³å®šæœåŠ¡å’Œfailoveræœºåˆ¶ã€‚Pigå’ŒHiveè¿˜ä¸ºHBaseæä¾›äº†é«˜å±‚è¯­è¨€æ”¯æŒï¼Œä½¿å¾—åœ¨HBaseä¸Šè¿›è¡Œæ•°æ®ç»Ÿè®¡å¤„ç†å˜çš„éå¸¸ç®€å•ã€‚ Sqoopåˆ™ä¸ºHBaseæä¾›äº†æ–¹ä¾¿çš„RDBMSï¼ˆå…³ç³»å‹æ•°æ®åº“ï¼‰æ•°æ®å¯¼å…¥åŠŸèƒ½ï¼Œä½¿å¾—ä¼ ç»Ÿæ•°æ®åº“æ•°æ®å‘HBaseä¸­è¿ç§»å˜çš„éå¸¸æ–¹ä¾¿ã€‚ Pigï¼šPigçš„è¯­è¨€å±‚åŒ…æ‹¬ä¸€ä¸ªå«åšPigLatinçš„æ–‡æœ¬è¯­è¨€,Pig Latinæ˜¯é¢å‘æ•°æ®æµçš„ç¼–ç¨‹æ–¹å¼ã€‚Pigå’ŒHiveç±»ä¼¼æ›´ä¾§é‡äºæ•°æ®çš„æŸ¥è¯¢å’Œåˆ†æï¼Œåº•å±‚éƒ½æ˜¯è½¬åŒ–æˆMapReduceç¨‹åºè¿è¡Œã€‚åŒºåˆ«æ˜¯Hiveæ˜¯ç±»SQLçš„æŸ¥è¯¢è¯­è¨€ï¼Œè¦æ±‚æ•°æ®å­˜å‚¨äºè¡¨ä¸­ï¼Œè€ŒPigæ˜¯é¢å‘æ•°æ®æµçš„ä¸€ä¸ªç¨‹åºè¯­è¨€ã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"HBase","slug":"HBase","permalink":"http://www.wortyby.com/tags/HBase/"},{"name":"Hive","slug":"Hive","permalink":"http://www.wortyby.com/tags/Hive/"},{"name":"HDFS","slug":"HDFS","permalink":"http://www.wortyby.com/tags/HDFS/"}]},{"title":"å¤§æ•°æ®ç»„ä»¶åŸç†æ€»ç»“-Hadoopã€Hbaseã€Kafkaã€Zookeeperã€Spark","slug":"å¤§æ•°æ®ç»„ä»¶åŸç†æ€»ç»“","date":"2018-09-21T05:13:56.000Z","updated":"2018-09-21T05:13:56.000Z","comments":true,"path":"2018/09/21/å¤§æ•°æ®ç»„ä»¶åŸç†æ€»ç»“/","link":"","permalink":"http://www.wortyby.com/2018/09/21/å¤§æ•°æ®ç»„ä»¶åŸç†æ€»ç»“/","excerpt":"","text":"HadoopåŸç†åˆ†ä¸ºHDFSä¸Yarnä¸¤ä¸ªéƒ¨åˆ†ã€‚HDFSæœ‰Namenodeå’ŒDatanodeä¸¤ä¸ªéƒ¨åˆ†ã€‚æ¯ä¸ªèŠ‚ç‚¹å ç”¨ä¸€ä¸ªç”µè„‘ã€‚Datanodeå®šæ—¶å‘Namenodeå‘é€å¿ƒè·³åŒ…ï¼Œå¿ƒè·³åŒ…ä¸­åŒ…å«Datanodeçš„æ ¡éªŒç­‰ä¿¡æ¯ï¼Œç”¨æ¥ç›‘æ§Datanodeã€‚HDFSå°†æ•°æ®åˆ†ä¸ºå—ï¼Œé»˜è®¤ä¸º64Mæ¯ä¸ªå—ä¿¡æ¯æŒ‰ç…§é…ç½®çš„å‚æ•°åˆ†åˆ«å¤‡ä»½åœ¨ä¸åŒçš„Datanodeï¼Œè€Œæ•°æ®å—åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿™äº›ä¿¡æ¯éƒ½å­˜å‚¨åˆ°Namenodeä¸Šé¢ã€‚Yarnæ˜¯MapReduce2ï¼Œå¯ä»¥é›†æˆæ›´å¤šçš„ç»„ä»¶ï¼Œå¦‚sparkã€mpiç­‰ã€‚MapReduceåŒ…æ‹¬Jobtrakerä¸Tasktrakerä¸¤ä¸ªéƒ¨åˆ†ã€‚å…¶ä¸­JobTrakeræ˜¯åœ¨ä¸»èŠ‚ç‚¹ä¸Šï¼Œè´Ÿè´£æ•´ä½“çš„è°ƒåº¦ã€‚Tasktrakeråœ¨slaveèŠ‚ç‚¹ä¸Šï¼Œå½“æäº¤ä»»åŠ¡åï¼Œå°†å…¶äº¤ç»™Jobtrakerè¿›è¡Œè°ƒåº¦ï¼Œè°ƒåº¦åˆ°è¯¥ä»»åŠ¡ä¹‹åå°±ä¼šå°†jaråŒ…å‘é€åˆ°å“åº”çš„Tasktrakerï¼Œä»¥å®ç°åˆ†å¸ƒå¼ä¸­ç§»åŠ¨è®¡ç®—èµ„æºè€Œéç§»åŠ¨æ•°æ®ã€‚å› ä¸ºè¿™äº›ä»»åŠ¡éƒ½æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ¯ä¸ªä»»åŠ¡éœ€è¦è°ƒç”¨å“ªä¸ªèŠ‚ç‚¹çš„æ•°æ®å¿…é¡»éå¸¸çš„æ˜ç¡®ï¼Œé€šå¸¸è¿™ä¸€éƒ¨åˆ†æ˜¯é€šè¿‡Jobtrakerè¿›è¡ŒæŒ‡æŒ¥ã€‚åœ¨MapReduceçš„å¼€å§‹ï¼Œæ¯ä¸ªblockä½œä¸ºä¸€ä¸ªMapè¾“å…¥ï¼ŒMapè¾“å…¥åå°±è¿›å…¥shuffleé˜¶æ®µã€‚Shuffleé˜¶æ®µä¸»è¦åˆ†ä¸ºMapå’ŒReduceä¸¤ä¸ªé˜¶æ®µã€‚åœ¨Map Shuffleé˜¶æ®µï¼ŒMapè¾“å…¥æŒ‰ç”¨æˆ·çš„ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œç”Ÿæˆçš„ç»“æœæŒ‰keyæ’åºï¼Œç„¶åè¿›å…¥å†…å­˜ï¼Œæº¢å‡ºåå½¢æˆä¸€ä¸ªspillå†™å…¥ç£ç›˜ï¼Œè¿™æ ·å¤šä¸ªspillåœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸­è¿›è¡Œå¤šè·¯å½’å¹¶æ’åºï¼ˆèƒœè€…æ ‘ï¼‰å½¢æˆä¸€ä¸ªæ’åºæ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œè¿™æœŸé—´é‚£äº›Mapæ–‡ä»¶äº¤ç»™é‚£äº›èŠ‚ç‚¹å¤„ç†ç”±Jobtrakerè¿›è¡Œè°ƒåº¦ï¼Œæœ€åç”Ÿæˆä¸€ä¸ªå¤§æ’åºçš„æ–‡ä»¶ï¼Œå¹¶ä¸”åˆ é™¤spillã€‚ä¹‹åï¼Œå†å°†å¤šä¸ªèŠ‚ç‚¹ä¸Šå·²ç»æ’åºçš„æ–‡ä»¶è¿›è¡Œè¡Œå¤šè·¯å½’å¹¶æ’åºï¼ˆä¸€ä¸ªå¤§æ–‡ä»¶Nåˆ†åˆ°nä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åˆ†ä¸ºkä¸ªspillï¼Œä¸€ä¸ªspillé•¿åº¦sï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯N(lognï¼ˆnä¸ªèŠ‚ç‚¹å¤šè·¯å½’å¹¶æ’åºï¼‰ + logkï¼ˆæ¯ä¸ªèŠ‚ç‚¹å†…kä¸ªspillæ’åºï¼‰ + logsï¼ˆæ¯ä¸ªspillå†…éƒ¨è¿›è¡Œæ’åºï¼‰)ï¼ŒN=nks,æ‰€ä»¥æœ€åçš„å¤æ‚åº¦è¿˜æ˜¯NlogNï¼‰ã€‚å®ŒæˆMap Shuffleé˜¶æ®µåé€šçŸ¥Jobtrakerè¿›å…¥Reduce Shuffleé˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå› ä¸ºå·²ç»æ’åºï¼Œå¾ˆå®¹æ˜“å°†ç”¨æˆ·çš„ç¨‹åºç›´æ¥ä½œç”¨åˆ°ç›¸åŒkeyçš„æ•°æ®ä¸Šï¼Œè¿™äº›æ•°æ®ä½œä¸ºReduceçš„è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œæœ€ç»ˆå°†è¾“å‡ºçš„ç»“æœæ•°æ®å†™å…¥åˆ°HDFSä¸Šï¼Œå¹¶åˆ é™¤ç£ç›˜æ•°æ®ã€‚Mapä¸€èˆ¬å¤šï¼ŒReduceå°‘ï¼Œæ‰€ä»¥é€šè¿‡Hashçš„æ–¹æ³•å°†Mapæ–‡ä»¶æ˜ å°„åˆ°Reduceä¸Šï¼Œè¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªé˜¶æ®µå«åšPatitionã€‚ä¸ºäº†é¿å…è­¬å¦‚æ‰€æœ‰æ•°æ®ç›¸åŠ è¿™ç§æ“ä½œä½¿å¾—æ•°æ®è´Ÿè½½ç§»åŠ¨çš„æ•°é‡å°‘çš„Reduceé˜¶æ®µï¼Œé€ æˆæ•ˆç‡ä½ä¸‹çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åœ¨Map Shuffleé˜¶æ®µåŠ ä¸€ä¸ªCombineé˜¶æ®µï¼Œè¿™ä¸ªCombineæ˜¯åœ¨æ¯ä¸€å°èŠ‚ç‚¹ä¸Šå°†å·²ç»æ’åºå¥½çš„æ–‡ä»¶è¿›è¡Œä¸€æ¬¡Reduceå¹¶å°†ç»“æœä½œä¸ºReduce Shuffleé˜¶æ®µçš„è¾“å…¥ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘æ•°æ®çš„è¾“å…¥é‡ã€‚é€šå¸¸Reduceçš„ä¸ªæ•°é€šè¿‡ç”¨æˆ·æ¥æŒ‡å®šï¼Œé€šå¸¸å’ŒCPUä¸ªæ•°ç›¸é€‚åº”æ‰èƒ½ä½¿å…¶æ•ˆç‡è¾¾åˆ°æœ€å¤§ã€‚ HBaseåŸç†Hbaseæ˜¯åˆ—å­˜å‚¨æ•°æ®åº“ã€‚å…¶å­˜å‚¨çš„ç»„ç»‡ç»“æ„å°±æ˜¯å°†ç›¸åŒçš„åˆ—æ—å­˜å‚¨åœ¨ä¸€èµ·ï¼Œå› æ­¤å¾—åçš„ã€‚Hbaseå­˜å‚¨æœ‰è¡Œé”®ï¼Œä½œä¸ºå”¯ä¸€æ ‡è¯†ï¼Œåˆ—è¡¨ç¤ºä¸º&lt;åˆ—æ—&gt;:&lt;åˆ—&gt;å­˜å‚¨ä¿¡æ¯ï¼Œå¦‚addressï¼šcityï¼Œaddressï¼šproviceï¼Œç„¶åæ˜¯æ—¶é—´æˆ³ã€‚Hbaseç‰©ç†æ¨¡å‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæ€»ç»“ç‚¹HMasterï¼Œé€šè¿‡å…¶è‡ªå¸¦çš„zookeeperä¸å®¢æˆ·ç«¯ç›¸è¿æ¥ã€‚Hbseä½œä¸ºåˆ†å¸ƒå¼æ¯ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºä¸€ä¸ªRegionServerï¼Œç»´æŠ¤Regionçš„çŠ¶æ€å’Œç®¡ç†ã€‚Regionæ˜¯æ•°æ®ç®¡ç†çš„åŸºæœ¬å•ä½ã€‚æœ€åˆåªæœ‰ä¸€ä¸ªï¼Œé€šè¿‡æ‰©å……åè¾¾åˆ°é˜ˆå€¼ç„¶ååˆ†è£‚ï¼Œé€šè¿‡Serveræ§åˆ¶å…¶è§„æ¨¡ã€‚åœ¨RegionServerä¸­ï¼Œæ¯ä¸€ä¸ªstoreä½œä¸ºä¸€ä¸ªåˆ—æ—ã€‚å½“æ•°æ®æ’å…¥è¿›æ¥ï¼Œæ–°æ•°æ®æˆä¸ºMemstoreï¼Œå†™å…¥å†…å­˜ï¼Œå½“Memstoreè¾¾åˆ°é˜ˆå€¼åï¼Œé€šè¿‡Flashcacheè¿›ç¨‹å°†æ•°æ®å†™å…¥storeFileï¼Œä¹Ÿå°±æ˜¯å½“å†…å­˜æ•°æ®å¢å¤šåæº¢å‡ºæˆä¸€ä¸ªStoreFileå†™å…¥ç£ç›˜ï¼Œè¿™é‡Œå’ŒHadoopçš„spillç±»ä¼¼ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯åœ¨HDFSä¸Šè¿›è¡Œçš„æ“ä½œã€‚æ‰€ä»¥æ•°æ®çš„æ’å…¥å¹¶ä¸æ˜¯è¿½åŠ çš„è¿‡ç¨‹ï¼Œè€Œæ˜¯ç§¯ç´¯æˆå¤§å—æ•°æ®åä¸€å¹¶å†™å…¥ã€‚å½“StoreFileæ•°é‡è¿‡å¤šæ—¶ï¼Œè¿›è¡Œåˆå¹¶ï¼Œå°†å½¢æˆä¸€ä¸ªå¤§çš„StoreFileå¹¶ä¸”åˆ é™¤æ‰åŸæ¥çš„StoreFileã€‚å†å½“StoreFileå¤§å°è¶…è¿‡ä¸€å®šé˜ˆå€¼åï¼Œåˆ†è£‚æˆRegionã€‚HBaseæœ‰ä¸€ä¸ªROOTè¡¨å’ŒMETAè¡¨ã€‚METAè¡¨è®°å½•ç”¨æˆ·Regionçš„ä¿¡æ¯ï¼Œä½†æ˜¯éšç€æ•°æ®å¢å¤šï¼ŒMETAä¹Ÿä¼šå¢å¤§ï¼Œè¿›è€Œåˆ†è£‚æˆå¤šä¸ªRegion ï¼Œé‚£æˆ‘ä»¬ç”¨ROOTè¡¨è®°å½•ä¸‹METAçš„ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªäºŒçº§è¡¨ï¼Œè€Œzookeeperä¸­è®°å½•ROOTè¡¨çš„locationã€‚å½“æˆ‘ä»¬éœ€æ‰¾æ‰¾åˆ°ä¸€æ¡ä¿¡æ¯æ—¶ï¼Œå…ˆå»zookeeperæŸ¥æ‰¾ROOTï¼Œä»ROOTä¸­æŸ¥æ‰¾METAæ‰¾åˆ°METAä½ç½®ï¼Œåœ¨è¿›å…¥METAè¡¨ä¸­å¯»æ‰¾è¯¥æ•°æ®æ‰€åœ¨Regionï¼Œå†è¯»å–è¯¥Regionçš„ä¿¡æ¯ã€‚HBaseé€‚åˆå¤§é‡æ’å…¥åˆåŒæ—¶è¯»çš„æƒ…å†µï¼Œå…¶ç“¶é¢ˆæ˜¯ç¡¬ç›˜çš„ä¼ è¾“é€Ÿåº¦è€Œä¸å†æ˜¯åƒOracleä¸€æ ·ç“¶é¢ˆåœ¨ç¡¬ç›˜çš„å¯»é“é€Ÿåº¦ã€‚ ZookeeperåŸç†Zookeeperæ˜¯ä¸€ä¸ªèµ„æºç®¡ç†åº“ï¼Œå¯¹èŠ‚ç‚¹è¿›è¡Œåè°ƒã€é€šä¿¡ã€å¤±è´¥å¤„ç†ã€èŠ‚ç‚¹æŸåçš„å¤„ç†ç­‰ï¼Œæ˜¯ä¸€ä¸ªæ— ä¸­å¿ƒè®¾è®¡ï¼Œä¸»èŠ‚ç‚¹é€šè¿‡é€‰ä¸¾äº§ç”Ÿã€‚Zookeeperçš„èŠ‚ç‚¹æ˜¯Znodeã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜æ”¾1Mçš„æ•°æ®ï¼Œclientè®¿é—®æœåŠ¡å™¨æ—¶åˆ›å»ºä¸€ä¸ªZnodeï¼Œå¯ä»¥æ˜¯çŸ­æš‚çš„Znodeï¼Œå…¶ä¸Šå¯ä»¥æ”¾ä¸Šè§‚å¯ŸWatcherå¯¹nodeè¿›è¡Œç›‘æ§ã€‚Zookeeperæœ‰é«˜å¯ç”¨æ€§ï¼Œæ¯ä¸ªæœºå™¨å¤åˆ¶ä¸€ä»½æ•°æ®ï¼Œåªè¦æœ‰ä¸€èˆ¬ä»¥ä¸Šçš„æœºå™¨å¯ä»¥æ­£å¸¸çš„è¿è¡Œï¼Œæ•´ä¸ªé›†ç¾¤å°±å¯ä»¥å·¥ä½œã€‚æ¯”å¦‚6å°çš„é›†ç¾¤å®¹å¿2å°æ–­å¼€ï¼Œè¶…è¿‡ä¸¤å°è¾¾åˆ°ä¸€èˆ¬çš„æ•°é‡å°±ä¸å¯ä»¥ï¼Œå› æ­¤é›†ç¾¤é€šå¸¸éƒ½æ˜¯å¥‡æ•°æ¥èŠ‚çº¦èµ„æºã€‚Zookeeperä½¿ç”¨zabåè®®ï¼Œæ˜¯ä¸€ä¸ªæ— ä¸­å¿ƒåè®®ï¼Œé€šè¿‡é€‰ä¸¾çš„æ–¹å¼äº§ç”Ÿleaderï¼Œé€šè¿‡æ¯å°æœºå™¨çš„ä¿¡æ¯æ‰©æ•£é€‰ä¸¾æœ€é—²çš„èµ„æºåˆ©ç”¨è¾ƒå°‘çš„èŠ‚ç‚¹ä½œä¸ºä¸»æ§ã€‚åŒæ—¶å½“é…ç½®æ•°æ®æœ‰æ›´æ”¹æ›´æ–°æ—¶ï¼Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šæœ‰é…ç½®watcherå¹¶è§¦å‘è¯»å–æ›´æ”¹ï¼Œã€‚å› æ­¤èƒ½å¤Ÿä¿è¯ä¸€è‡´æ€§ã€‚æ¯ä¸ªèŠ‚ç‚¹é€šè¿‡leaderå¹¿æ’­çš„æ–¹å¼ï¼Œä½¿æ‰€æœ‰followeråŒæ­¥ã€‚Zookeeperå¯ä»¥å®ç°åˆ†å¸ƒå¼é”æœºåˆ¶ã€‚é€šè¿‡watcherç›‘æ§ï¼Œå¯¹æ¯ä¸ªZnodeçš„é”éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€çš„ç¼–å·ï¼ŒæŒ‰ç…§åºå·çš„å¤§å°æ¯”è¾ƒï¼Œæ¥åˆ†é…é”ã€‚å½“ä¸€ä¸ªæš‚æ—¶Znodeå®Œç»“ååˆ é™¤æœ¬èŠ‚ç‚¹ï¼Œé€šçŸ¥leaderå®Œç»“ï¼Œä¹‹åä¸‹ä¸€ä¸ªZnodeè·å–é”è¿›è¡Œæ“ä½œã€‚ KafkaåŸç†Kafkaæ˜¯åˆ†å¸ƒå¼å‘å¸ƒ-è®¢é˜…æ¶ˆæ¯ç³»ç»Ÿã€‚å®ƒæœ€åˆç”±LinkedInå…¬å¸å¼€å‘ï¼Œä¹‹åæˆä¸ºApacheé¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚Kafkaæ˜¯ä¸€ç§å¿«é€Ÿã€å¯æ‰©å±•çš„ã€è®¾è®¡å†…åœ¨å°±æ˜¯åˆ†å¸ƒå¼çš„ï¼Œåˆ†åŒºçš„å’Œå¯å¤åˆ¶çš„æäº¤æ—¥å¿—æœåŠ¡ã€‚å®ƒè¢«è®¾è®¡ä¸ºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæ˜“äºå‘å¤–æ‰©å±•ï¼›å®ƒåŒæ—¶ä¸ºå‘å¸ƒå’Œè®¢é˜…æä¾›é«˜ååé‡ï¼›å®ƒæ”¯æŒå¤šè®¢é˜…è€…ï¼Œå½“å¤±è´¥æ—¶èƒ½è‡ªåŠ¨å¹³è¡¡æ¶ˆè´¹è€…ï¼›å®ƒå°†æ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå› æ­¤å¯ç”¨äºæ‰¹é‡æ¶ˆè´¹ï¼Œä¾‹å¦‚ETLï¼Œä»¥åŠå®æ—¶åº”ç”¨ç¨‹åºã€‚brokerå’Œç”Ÿäº§è€…ã€æ¶ˆè´¹è€…å„è‡ªéƒ½æ˜¯é›†ç¾¤ï¼Œé›†ç¾¤ä¸­çš„å„ä¸ªå®ä¾‹ä»–ä»¬ä¹‹é—´æ˜¯å¯¹ç­‰çš„ï¼Œé›†ç¾¤æ‰©å……èŠ‚ç‚¹å¾ˆæ–¹ä¾¿ã€‚Kafkaçš„åŸºæœ¬æ¦‚å¿µåŒ…æ‹¬è¯é¢˜ã€ç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ã€ä»£ç†æˆ–è€…kafkaé›†ç¾¤ã€‚è¯é¢˜æ˜¯ç‰¹å®šç±»å‹çš„æ¶ˆæ¯æµã€‚æ¶ˆæ¯æ˜¯å­—èŠ‚çš„æœ‰æ•ˆè´Ÿè½½ï¼Œè¯é¢˜æ˜¯æ¶ˆæ¯çš„åˆ†ç±»åæˆ–ç§å­åã€‚ç”Ÿäº§è€…æ˜¯èƒ½å¤Ÿå‘å¸ƒæ¶ˆæ¯åˆ°è¯é¢˜çš„ä»»ä½•å¯¹è±¡ã€‚å·²å‘å¸ƒçš„æ¶ˆæ¯ä¿å­˜åœ¨ä¸€ç»„æœåŠ¡å™¨ä¸­ï¼Œå®ƒä»¬è¢«ç§°ä¸ºä»£ç†æˆ–Kafkaé›†ç¾¤ã€‚æ¶ˆè´¹è€…å¯ä»¥è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªè¯é¢˜ï¼Œå¹¶ä»Brokeræ‹‰æ•°æ®ï¼Œä»è€Œæ¶ˆè´¹è¿™äº›å·²å‘å¸ƒçš„æ¶ˆæ¯ã€‚Kafkaçš„å­˜å‚¨å¸ƒå±€éå¸¸ç®€å•ã€‚è¯é¢˜çš„æ¯ä¸ªåˆ†åŒºå¯¹åº”ä¸€ä¸ªé€»è¾‘æ—¥å¿—ã€‚ç‰©ç†ä¸Šï¼Œä¸€ä¸ªæ—¥å¿—ä¸ºç›¸åŒå¤§å°çš„ä¸€ç»„åˆ†æ®µæ–‡ä»¶ã€‚æ¯æ¬¡ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åˆ°ä¸€ä¸ªåˆ†åŒºï¼Œä»£ç†å°±å°†æ¶ˆæ¯è¿½åŠ åˆ°æœ€åä¸€ä¸ªæ®µæ–‡ä»¶ä¸­ã€‚å½“å‘å¸ƒçš„æ¶ˆæ¯æ•°é‡è¾¾åˆ°è®¾å®šå€¼æˆ–è€…ç»è¿‡ä¸€å®šçš„æ—¶é—´åï¼Œæ®µæ–‡ä»¶çœŸæ­£å†™å…¥ç£ç›˜ä¸­ã€‚å†™å…¥å®Œæˆåï¼Œæ¶ˆæ¯å…¬å¼€ç»™æ¶ˆè´¹è€…ã€‚æ®µæ–‡ä»¶æœºåˆ¶å’ŒHadoopä¸­spillç±»ä¼¼ã€‚æ¶ˆè´¹è€…å§‹ç»ˆä»ç‰¹å®šåˆ†åŒºé¡ºåºåœ°è·å–æ¶ˆæ¯ï¼Œå¦‚æœæ¶ˆè´¹è€…çŸ¥é“ç‰¹å®šæ¶ˆæ¯çš„åç§»é‡ï¼Œä¹Ÿå°±è¯´æ˜æ¶ˆè´¹è€…å·²ç»æ¶ˆè´¹äº†ä¹‹å‰çš„æ‰€æœ‰æ¶ˆæ¯ã€‚æ¶ˆè´¹è€…å‘ä»£ç†å‘å‡ºå¼‚æ­¥æ‹‰è¯·æ±‚ï¼Œå‡†å¤‡å­—èŠ‚ç¼“å†²åŒºç”¨äºæ¶ˆè´¹ã€‚æ¯ä¸ªå¼‚æ­¥æ‹‰è¯·æ±‚éƒ½åŒ…å«è¦æ¶ˆè´¹çš„æ¶ˆæ¯åç§»é‡ä¸å…¶å®ƒæ¶ˆæ¯ç³»ç»Ÿä¸åŒï¼ŒKafkaä»£ç†æ˜¯æ— çŠ¶æ€çš„ã€‚è¿™æ„å‘³ç€æ¶ˆè´¹è€…å¿…é¡»ç»´æŠ¤å·²æ¶ˆè´¹çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯ç”±æ¶ˆè´¹è€…è‡ªå·±ç»´æŠ¤ï¼Œä»£ç†å®Œå…¨ä¸ç®¡ã€‚æ¶ˆè´¹è€…å¯ä»¥æ•…æ„å€’å›åˆ°è€çš„åç§»é‡å†æ¬¡æ¶ˆè´¹æ•°æ®ã€‚è¿™è¿åäº†é˜Ÿåˆ—çš„å¸¸è§çº¦å®šï¼Œä½†è¢«è¯æ˜æ˜¯è®¸å¤šæ¶ˆè´¹è€…çš„åŸºæœ¬ç‰¹å¾ã€‚kafkaçš„brokeråœ¨é…ç½®æ–‡ä»¶ä¸­å¯ä»¥é…ç½®æœ€å¤šä¿å­˜å¤šå°‘å°æ—¶çš„æ•°æ®å’Œåˆ†åŒºæœ€å¤§çš„ç©ºé—´å ç”¨ï¼Œè¿‡æœŸçš„å’Œè¶…é‡çš„æ•°æ®ä¼šè¢«brokerè‡ªåŠ¨æ¸…é™¤æ‰ã€‚Kafkaä¼šè®°å½•offsetåˆ°zkï¼ŒåŒæ—¶åˆåœ¨å†…å­˜ä¸­ç»´æŠ¤offsetï¼Œå…è®¸å¿«é€Ÿçš„checkpointï¼Œå¦‚æœconsumeræ¯”partitionå¤šæ˜¯æµªè´¹ï¼Œå› ä¸ºkafkaä¸å…è®¸partitionä¸Šå¹¶è¡Œconsumerè¯»å–ã€‚åŒæ—¶ï¼Œconsumeræ¯”partitionå°‘ï¼Œä¸€ä¸ªconsumerä¼šå¯¹åº”å¤šä¸ªpartitionï¼Œæœ‰å¯èƒ½å¯¼è‡´partitionä¸­æ•°æ®çš„è¯»å–ä¸å‡åŒ€ï¼Œä¹Ÿä¸èƒ½ä¿è¯æ•°æ®é—´çš„é¡ºåºæ€§ï¼Œkafkaåªæœ‰åœ¨ä¸€ä¸ªpartitionè¯»å–çš„æ—¶å€™æ‰èƒ½ä¿è¯æ—¶é—´ä¸Šæ˜¯æœ‰é¡ºåºçš„ã€‚å¢åŠ partitionæˆ–è€…consumeræˆ–è€…brokerä¼šå¯¼è‡´rebalanceï¼Œæ‰€ä»¥rebalanceåconsumerå¯¹åº”çš„partitionä¼šå‘ç”Ÿå˜åŒ–ã€‚ SparkåŸç†spark å¯ä»¥å¾ˆå®¹æ˜“å’Œyarnç»“åˆï¼Œç›´æ¥è°ƒç”¨HDFSã€Hbaseä¸Šé¢çš„æ•°æ®ï¼Œå’Œhadoopç»“åˆã€‚é…ç½®å¾ˆå®¹æ˜“ã€‚sparkå‘å±•è¿…çŒ›ï¼Œæ¡†æ¶æ¯”hadoopæ›´åŠ çµæ´»å®ç”¨ã€‚å‡å°‘äº†å»¶æ—¶å¤„ç†ï¼Œæé«˜æ€§èƒ½æ•ˆç‡å®ç”¨çµæ´»æ€§ã€‚ä¹Ÿå¯ä»¥ä¸hadoopåˆ‡å®ç›¸äº’ç»“åˆã€‚sparkæ ¸å¿ƒéƒ¨åˆ†åˆ†ä¸ºRDDã€‚Spark SQLã€Spark Streamingã€MLlibã€GraphXã€Spark Rç­‰æ ¸å¿ƒç»„ä»¶è§£å†³äº†å¾ˆå¤šçš„å¤§æ•°æ®é—®é¢˜ï¼Œå…¶å®Œç¾çš„æ¡†æ¶æ—¥å—æ¬¢è¿ã€‚å…¶ç›¸åº”çš„ç”Ÿæ€ç¯å¢ƒåŒ…æ‹¬zepplinç­‰å¯è§†åŒ–æ–¹é¢ï¼Œæ­£æ—¥ç›Šå£®å¤§ã€‚å¤§å‹å…¬å¸äº‰ç›¸å®ç”¨sparkæ¥ä»£æ›¿åŸæœ‰hadoopä¸Šç›¸åº”çš„åŠŸèƒ½æ¨¡å—ã€‚Sparkè¯»å†™è¿‡ç¨‹ä¸åƒhadoopæº¢å‡ºå†™å…¥ç£ç›˜ï¼Œéƒ½æ˜¯åŸºäºå†…å­˜ï¼Œå› æ­¤é€Ÿåº¦å¾ˆå¿«ã€‚å¦å¤–DAGä½œä¸šè°ƒåº¦ç³»ç»Ÿçš„å®½çª„ä¾èµ–è®©Sparké€Ÿåº¦æé«˜ã€‚RDDæ˜¯å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®ä¹Ÿæ˜¯sparkçš„æ ¸å¿ƒï¼Œå®Œå…¨å¼¹æ€§çš„ï¼Œå¦‚æœæ•°æ®ä¸¢å¤±ä¸€éƒ¨åˆ†è¿˜å¯ä»¥é‡å»ºã€‚æœ‰è‡ªåŠ¨å®¹é”™ã€ä½ç½®æ„ŸçŸ¥è°ƒåº¦å’Œå¯ä¼¸ç¼©æ€§ï¼Œé€šè¿‡æ•°æ®æ£€æŸ¥ç‚¹å’Œè®°å½•æ•°æ®æ›´æ–°é‡‘è±¡å®¹é”™æ€§æ£€æŸ¥ã€‚é€šè¿‡SparkContext.textFile()åŠ è½½æ–‡ä»¶å˜æˆRDDï¼Œç„¶åé€šè¿‡transformationæ„å»ºæ–°çš„RDDï¼Œé€šè¿‡actionå°†RDDå­˜å‚¨åˆ°å¤–éƒ¨ç³»ç»Ÿã€‚RDDä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼Œä¹Ÿå°±æ˜¯æ‡’åŠ è½½ï¼Œåªæœ‰å½“ç”¨åˆ°çš„æ—¶å€™æ‰åŠ è½½æ•°æ®ã€‚å¦‚æœåŠ è½½å­˜å‚¨æ‰€æœ‰çš„ä¸­é—´è¿‡ç¨‹ä¼šæµªè´¹ç©ºé—´ã€‚å› æ­¤è¦å»¶è¿ŸåŠ è½½ã€‚ä¸€æ—¦sparkçœ‹åˆ°æ•´ä¸ªå˜æ¢é“¾ï¼Œä»–å¯ä»¥è®¡ç®—ä»…éœ€çš„ç»“æœæ•°æ®ï¼Œå¦‚æœä¸‹é¢çš„å‡½æ•°ä¸éœ€è¦æ•°æ®é‚£ä¹ˆæ•°æ®ä¹Ÿä¸ä¼šå†åŠ è½½ã€‚è½¬æ¢RDDæ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰åœ¨åŠ¨ä½œä¸­æ‰å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚Sparkåˆ†ä¸ºdriverå’Œexecutorï¼Œdriveræäº¤ä½œä¸šï¼Œexecutoræ˜¯applicationæ—©worknodeä¸Šçš„è¿›ç¨‹ï¼Œè¿è¡Œtaskï¼Œdriverå¯¹åº”ä¸ºsparkcontextã€‚Sparkçš„RDDæ“ä½œæœ‰transformationã€actionã€‚Transformationå¯¹RDDè¿›è¡Œä¾èµ–åŒ…è£…ï¼ŒRDDæ‰€å¯¹åº”çš„ä¾èµ–éƒ½è¿›è¡ŒDAGçš„æ„å»ºå¹¶ä¿å­˜ï¼Œåœ¨worknodeæŒ‚æ‰ä¹‹åé™¤äº†é€šè¿‡å¤‡ä»½æ¢å¤è¿˜å¯ä»¥é€šè¿‡å…ƒæ•°æ®å¯¹å…¶ä¿å­˜çš„ä¾èµ–å†è®¡ç®—ä¸€æ¬¡å¾—åˆ°ã€‚å½“ä½œä¸šæäº¤ä¹Ÿå°±æ˜¯è°ƒç”¨runJobæ—¶ï¼Œsparkä¼šæ ¹æ®RDDæ„å»ºDAGå›¾ï¼Œæäº¤ç»™DAGSchedulerï¼Œè¿™ä¸ªDAGScheduleræ˜¯åœ¨SparkContextåˆ›å»ºæ—¶ä¸€åŒåˆå§‹åŒ–çš„ï¼Œä»–ä¼šå¯¹ä½œä¸šè¿›è¡Œè°ƒåº¦å¤„ç†ã€‚å½“ä¾èµ–å›¾æ„å»ºå¥½ä»¥åï¼Œä»actionå¼€å§‹è¿›è¡Œè§£æï¼Œæ¯ä¸€ä¸ªæ“ä½œä½œä¸ºä¸€ä¸ªtaskï¼Œæ¯é‡åˆ°shuffleå°±åˆ‡å‰²æˆä¸ºä¸€ä¸ªtaskSetï¼Œå¹¶æŠŠæ•°æ®è¾“å‡ºåˆ°ç£ç›˜ï¼Œå¦‚æœä¸æ˜¯shuffleæ•°æ®è¿˜åœ¨å†…å­˜ä¸­å­˜å‚¨ã€‚å°±è¿™æ ·å†å¾€å‰æ¨è¿›ï¼Œç›´åˆ°æ²¡æœ‰ç®—å­ï¼Œç„¶åè¿è¡Œä»å‰é¢å¼€å§‹ï¼Œå¦‚æœæ²¡æœ‰actionçš„ç®—å­åœ¨è¿™é‡Œä¸ä¼šæ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°actionä¸ºæ­¢æ‰å¼€å§‹è¿è¡Œï¼Œè¿™å°±å½¢æˆäº†sparkçš„æ‡’åŠ è½½ï¼Œtasksetæäº¤ç»™TaskShedulerç”ŸæˆTaskSetManagerå¹¶ä¸”æäº¤ç»™Executorè¿è¡Œï¼Œè¿è¡Œç»“æŸååé¦ˆç»™DAGSchedulerå®Œæˆä¸€ä¸ªtaskSetï¼Œä¹‹åå†æäº¤ä¸‹ä¸€ä¸ªï¼Œå½“TaskSetè¿è¡Œå¤±è´¥æ—¶å°±è¿”å›DAGSchedulerå¹¶é‡æ–°å†æ¬¡åˆ›å»ºã€‚ä¸€ä¸ªjobé‡Œé¢å¯èƒ½æœ‰å¤šä¸ªTaskSetï¼Œä¸€ä¸ªapplicationå¯èƒ½åŒ…å«å¤šä¸ªjobã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"HBASE","slug":"HBASE","permalink":"http://www.wortyby.com/tags/HBASE/"},{"name":"SPARK","slug":"SPARK","permalink":"http://www.wortyby.com/tags/SPARK/"},{"name":"HADOOP","slug":"HADOOP","permalink":"http://www.wortyby.com/tags/HADOOP/"},{"name":"KAFKA","slug":"KAFKA","permalink":"http://www.wortyby.com/tags/KAFKA/"},{"name":"ZOOKEEPER","slug":"ZOOKEEPER","permalink":"http://www.wortyby.com/tags/ZOOKEEPER/"}]},{"title":"Happybase è¿›è¡Œ è¿‡æ»¤æŸ¥è¯¢","slug":"Happybase è¿›è¡Œ è¿‡æ»¤æŸ¥è¯¢","date":"2018-09-18T08:19:47.000Z","updated":"2018-09-18T08:19:47.000Z","comments":true,"path":"2018/09/18/Happybase è¿›è¡Œ è¿‡æ»¤æŸ¥è¯¢/","link":"","permalink":"http://www.wortyby.com/2018/09/18/Happybase è¿›è¡Œ è¿‡æ»¤æŸ¥è¯¢/","excerpt":"","text":"èƒŒæ™¯HBASE ä¸­çš„æ•°æ® ï¼Œå½“åˆ©ç”¨ scan è¿›è¡Œæ•°æ®æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¦‚æœä¸ç»™è¿‡æ»¤æ¡ä»¶ï¼Œä»–ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½è¾“å‡ºã€‚å¦‚æœæˆ‘ä»¬ä»…ä»…æ˜¯æƒ³å¾—åˆ°æŸäº›åˆ—çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç¥­å‡ºfilter ç¥å™¨ã€‚æˆ–æ˜¯ columns æ¥æŒ‡å®šæˆ‘ä»¬éœ€è¦å“ªäº›åˆ—çš„æ•°æ®ã€‚ä¸‹é¢æˆ‘ä»¬ä¸Šä»£ç æ¥çœ‹çœ‹ filter å’Œ column æ¥è¿›è¡Œ ç­›é€‰æ•°æ®çš„ç”¨æ³•ã€‚ åˆå§‹åŒ–ä»£ç 123import happybaseconnection = happybase.Connection(&apos;localhost&apos;, autoconnect=False)table = connection.table(&apos;live_gift&apos;) columns æ¥æŒ‡å®šåˆ—åç§°é€šè¿‡columns æ¥ç¡®å®š å½“å‰éœ€è¦å“ªäº›åˆ—çš„æ•°æ®ï¼Œä¸€èˆ¬ä¼šåŠ ä¸Šä¸€ä¸ª limit å‚æ•°ä¸åºŸè¯ï¼Œå…ˆä¸Šä»£ç çœ‹çœ‹å®ƒä¸ºä½•æ–¹ç¥åœ£ã€‚1data = table.scan(columns=[b&apos;g:user_id&apos;, b&apos;g:gift_price&apos;], limit=20)å¾—åˆ°çš„ç»“æœå°±æ˜¯ä»¥user_idï¼Œgift_price 2åˆ—çš„æ•°æ®ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹å¼éƒ½æ˜¯ç®€å•çš„æŸ¥çœ‹æ•°æ®ï¼Œä½†æ›´å®é™…çš„åœºæ™¯å¯èƒ½éœ€è¦ç»¼åˆå„ç§æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢ï¼Œé‚£ä¹ˆå°±éœ€è¦ç¥­å‡º filter ç¥å™¨äº† filter æ¥è¿‡æ»¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®è¿›è¡Œè¾“å‡ºé€šè¿‡filter æ¥ç¡®å®šå½“å‰éœ€è¦ç¬¦åˆè¿™äº›æ¡ä»¶çš„æ•°æ®è¿›è¡Œè¾“å‡ºã€‚filter æ˜¯ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜åœ¨ï¼Œå¦‚æœæ˜¯å¤šä¸ªæ¡ä»¶æŸ¥è¯¢ï¼Œå°±ç»¼åˆæ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸² å•ä¸€æ¡ä»¶æŸ¥è¯¢æ‹¿å‡ºå¼€å§‹æ—¶é—´å¤§äº è¿™ä¸ªæ—¶é—´çš„æ•°æ®1data = table.scan(columns=[b&apos;s:live_id&apos;, b&apos;s:start_time&apos;], filter=&quot;SingleColumnValueFilter(&apos;s&apos;, &apos;start_time&apos;, &gt;=, &apos;binary:1490976000&apos;)&quot;) å¤šä¸ªæ¡ä»¶æŸ¥è¯¢æ‹¿å‡º live_id = 15909çš„æ•°æ®ï¼Œgift_price=20 çš„æ•°æ®1data = table.scan(columns=[b&apos;g:user_id&apos;, b&apos;g:gift_price&apos;], filter=&quot;SingleColumnValueFilter(&apos;g&apos;, &apos;live_id&apos;, =, &apos;binary:15909&apos;)&quot; and &quot;SingleColumnValueFilter(&apos;g&apos;, &apos;gift_price&apos;, =, &apos;binary:20&apos;)&quot;, limit=20)happyhbaseå®˜æ–¹æ–‡æ¡£","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"HBASE","slug":"HBASE","permalink":"http://www.wortyby.com/tags/HBASE/"}]},{"title":"python redisä¹‹è¿æ¥æ± çš„åŸç†","slug":"python redisä¹‹è¿æ¥æ± çš„åŸç†","date":"2018-09-14T06:14:30.000Z","updated":"2018-09-14T06:14:30.000Z","comments":true,"path":"2018/09/14/python redisä¹‹è¿æ¥æ± çš„åŸç†/","link":"","permalink":"http://www.wortyby.com/2018/09/14/python redisä¹‹è¿æ¥æ± çš„åŸç†/","excerpt":"","text":"æˆ‘ä»¬ä½¿ç”¨redisè¿æ¥æ± , å´ä¸æ€ä¹ˆäº†è§£è¿™ä¸ªè¿æ¥æ± çš„åŸç†, ä»Šå¤©æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹ ä»€ä¹ˆæ˜¯è¿æ¥æ± é€šå¸¸æƒ…å†µä¸‹, å½“æˆ‘ä»¬éœ€è¦åšredisæ“ä½œæ—¶, ä¼šåˆ›å»ºä¸€ä¸ªè¿æ¥, å¹¶åŸºäºè¿™ä¸ªè¿æ¥è¿›è¡Œredisæ“ä½œ, æ“ä½œå®Œæˆå, é‡Šæ”¾è¿æ¥,ä¸€èˆ¬æƒ…å†µä¸‹, è¿™æ˜¯æ²¡é—®é¢˜çš„, ä½†å½“å¹¶å‘é‡æ¯”è¾ƒé«˜çš„æ—¶å€™, é¢‘ç¹çš„è¿æ¥åˆ›å»ºå’Œé‡Šæ”¾å¯¹æ€§èƒ½ä¼šæœ‰è¾ƒé«˜çš„å½±å“äºæ˜¯, è¿æ¥æ± å°±å‘æŒ¥ä½œç”¨äº†è¿æ¥æ± çš„åŸç†æ˜¯, é€šè¿‡é¢„å…ˆåˆ›å»ºå¤šä¸ªè¿æ¥, å½“è¿›è¡Œredisæ“ä½œæ—¶, ç›´æ¥è·å–å·²ç»åˆ›å»ºçš„è¿æ¥è¿›è¡Œæ“ä½œ, è€Œä¸”æ“ä½œå®Œæˆå, ä¸ä¼šé‡Šæ”¾, ç”¨äºåç»­çš„å…¶ä»–redisæ“ä½œè¿™æ ·å°±è¾¾åˆ°äº†é¿å…é¢‘ç¹çš„redisè¿æ¥åˆ›å»ºå’Œé‡Šæ”¾çš„ç›®çš„, ä»è€Œæé«˜æ€§èƒ½äº† åŸç†é‚£ä¹ˆ, åœ¨redis-pyä¸­, ä»–æ˜¯æ€ä¹ˆè¿›è¡Œè¿æ¥æ± ç®¡ç†çš„å‘¢è¿æ¥æ± ä½¿ç”¨é¦–å…ˆçœ‹ä¸‹å¦‚ä½•è¿›è¡Œè¿æ¥æ± æ“ä½œçš„1234rdp = redis.ConnectionPool(host=&apos;127.0.0.1&apos;, port=6379, password=&apos;xxxxx&apos;)rdc = redis.StrictRedis(connection_pool=rdp)rdc.set(&apos;name&apos;, &apos;Yi_Zhi_Yu&apos;)rdc.get(&apos;name&apos;) åŸç†è§£æå½“redis.ConnectionPool å®ä¾‹åŒ–çš„æ—¶å€™, åšäº†ä»€ä¹ˆ123456789def __init__(self, connection_class=Connection, max_connections=None, **connection_kwargs): max_connections = max_connections or 2 ** 31 if not isinstance(max_connections, (int, long)) or max_connections &lt; 0: raise ValueError(&apos;&quot;max_connections&quot; must be a positive integer&apos;) self.connection_class = connection_class self.connection_kwargs = connection_kwargs self.max_connections = max_connectionsè¿™ä¸ªè¿æ¥æ± çš„å®ä¾‹åŒ–å…¶å®æœªåšä»»ä½•çœŸå®çš„redisè¿æ¥, ä»…ä»…æ˜¯è®¾ç½®æœ€å¤§è¿æ¥æ•°, è¿æ¥å‚æ•°å’Œè¿æ¥ç±»StrictRedis å®ä¾‹åŒ–çš„æ—¶å€™, åˆåšäº†ä»€ä¹ˆ12345def __init__(self, ...connection_pool=None...): if not connection_pool: ... connection_pool = ConnectionPool(**kwargs) self.connection_pool = connection_poolä»¥ä¸Šä»…ä¿ç•™äº†å…³é”®éƒ¨åˆ†ä»£ç å¯ä»¥çœ‹å‡º, ä½¿ç”¨StrictRedis å³ä½¿ä¸åˆ›å»ºè¿æ¥æ± , ä»–ä¹Ÿä¼šè‡ªå·±åˆ›å»ºåˆ°è¿™é‡Œ, æˆ‘ä»¬è¿˜æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆredisè¿æ¥çœŸå®å‘ç”Ÿç»§ç»­ä¸‹ä¸€æ­¥å°±æ˜¯set æ“ä½œäº†, å¾ˆæ˜æ˜¾, è¿™ä¸ªæ—¶å€™ä¸€å®šä¼šå‘ç”Ÿredisè¿æ¥(è¦ä¸ç„¶æ€ä¹ˆset)123def set(self, name, value, ex=None, px=None, nx=False, xx=False): ... return self.execute_command(&apos;SET&apos;, *pieces)æˆ‘ä»¬ç»§ç»­çœ‹çœ‹execute_command12345678910111213141516def execute_command(self, *args, **options): &quot;Execute a command and return a parsed response&quot; pool = self.connection_pool command_name = args[0] connection = pool.get_connection(command_name, **options) try: connection.send_command(*args) return self.parse_response(connection, command_name, **options) except (ConnectionError, TimeoutError) as e: connection.disconnect() if not connection.retry_on_timeout and isinstance(e, TimeoutError): raise connection.send_command(*args) return self.parse_response(connection, command_name, **options) finally: pool.release(connection)ç»ˆäº, åœ¨è¿™æˆ‘ä»¬çœ‹åˆ°åˆ°äº†è¿æ¥åˆ›å»º123456789101112connection = pool.get_connection(command_name, **options)è¿™é‡Œè°ƒç”¨çš„æ˜¯ConnectionPoolçš„get_connectiondef get_connection(self, command_name, *keys, **options): &quot;Get a connection from the pool&quot; self._checkpid() try: connection = self._available_connections.pop() except IndexError: connection = self.make_connection() self._in_use_connections.add(connection) return connectionå¦‚æœæœ‰å¯ç”¨çš„è¿æ¥, è·å–å¯ç”¨çš„é“¾æ¥, å¦‚æœæ²¡æœ‰, åˆ›å»ºä¸€ä¸ª123456def make_connection(self): &quot;Create a new connection&quot; if self._created_connections &gt;= self.max_connections: raise ConnectionError(&quot;Too many connections&quot;) self._created_connections += 1 return self.connection_class(**self.connection_kwargs)ç»ˆäº, æˆ‘ä»¬çœ‹åˆ°äº†, åœ¨è¿™é‡Œåˆ›å»ºäº†è¿æ¥åœ¨ConnectionPoolçš„å®ä¾‹ä¸­, æœ‰ä¸¤ä¸ªlist, ä¾æ¬¡æ˜¯ _available_connections, _in_use_connections,åˆ†åˆ«è¡¨ç¤ºå¯ç”¨çš„è¿æ¥é›†åˆå’Œæ­£åœ¨ä½¿ç”¨çš„è¿æ¥é›†åˆ, åœ¨ä¸Šé¢çš„get_connectionä¸­, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è·å–è¿æ¥çš„è¿‡ç¨‹æ˜¯ä»å¯ç”¨è¿æ¥é›†åˆå°è¯•è·å–è¿æ¥,å¦‚æœè·å–ä¸åˆ°, é‡æ–°åˆ›å»ºè¿æ¥å°†è·å–åˆ°çš„è¿æ¥æ·»åŠ åˆ°æ­£åœ¨ä½¿ç”¨çš„è¿æ¥é›†åˆä¸Šé¢æ˜¯å¾€**_in_use_connections**é‡Œæ·»åŠ è¿æ¥çš„, è¿™ç§è¿æ¥è¡¨ç¤ºæ­£åœ¨ä½¿ç”¨ä¸­, é‚£æ˜¯ä»€ä¹ˆæ—¶å€™å°†æ­£åœ¨ä½¿ç”¨çš„è¿æ¥æ”¾å›åˆ°å¯ç”¨è¿æ¥åˆ—è¡¨ä¸­çš„å‘¢è¿™ä¸ªè¿˜æ˜¯åœ¨execute_commandé‡Œ, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨æ‰§è¡Œredisæ“ä½œæ—¶, åœ¨finallyéƒ¨åˆ†, ä¼šæ‰§è¡Œä¸€ä¸‹1pool.release(connection)è¿æ¥æ± å¯¹è±¡è°ƒç”¨releaseæ–¹æ³•, å°†è¿æ¥ä»_in_use_connections æ”¾å› _available_connectionsÃ…, è¿™æ ·åç»­çš„è¿æ¥è·å–å°±èƒ½å†æ¬¡ä½¿ç”¨è¿™ä¸ªè¿æ¥äº†release æ–¹æ³•å¦‚ä¸‹1234567def release(self, connection): &quot;Releases the connection back to the pool&quot; self._checkpid() if connection.pid != self.pid: return self._in_use_connections.remove(connection) self._available_connections.append(connection) æ€»ç»“è‡³æ­¤, æˆ‘ä»¬æŠŠè¿æ¥æ± çš„ç®¡ç†æµç¨‹èµ°äº†ä¸€é, ConnectionPoolé€šè¿‡ç®¡ç†å¯ç”¨è¿æ¥åˆ—è¡¨(_available_connections) å’Œ æ­£åœ¨ä½¿ç”¨çš„è¿æ¥åˆ—è¡¨ ä»è€Œå®ç°è¿æ¥æ± ç®¡ç†","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"redis","slug":"redis","permalink":"http://www.wortyby.com/tags/redis/"},{"name":"è¿æ¥æ± ","slug":"è¿æ¥æ± ","permalink":"http://www.wortyby.com/tags/è¿æ¥æ± /"}]},{"title":"HBaseä¸­CloumnFamilyçš„è®¾è®¡è§„åˆ™","slug":"HBaseä¸­CloumnFamilyçš„è®¾è®¡è§„åˆ™","date":"2018-09-14T05:56:39.000Z","updated":"2018-09-14T05:56:39.000Z","comments":true,"path":"2018/09/14/HBaseä¸­CloumnFamilyçš„è®¾è®¡è§„åˆ™/","link":"","permalink":"http://www.wortyby.com/2018/09/14/HBaseä¸­CloumnFamilyçš„è®¾è®¡è§„åˆ™/","excerpt":"","text":"HBaseæœ¬èº«çš„è®¾è®¡ç›®æ ‡æ˜¯ æ”¯æŒç¨€ç–è¡¨ï¼Œè€Œ ç¨€ç–è¡¨é€šå¸¸ä¼šæœ‰å¾ˆå¤šåˆ—ï¼Œä½†æ˜¯æ¯ä¸€è¡Œæœ‰å€¼çš„åˆ—åˆæ¯”è¾ƒå°‘ã€‚ æ›¿ä»£æ–¹æ¡ˆå¦‚æœä¸ä½¿ç”¨Column Familyçš„æ¦‚å¿µï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§è®¾è®¡æ–¹æ¡ˆï¼š æ–¹æ¡ˆä¸€æŠŠæ‰€æœ‰åˆ—çš„æ•°æ®æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆä¹Ÿå°±æ˜¯ä¼ ç»Ÿçš„æŒ‰è¡Œå­˜å‚¨ï¼‰ã€‚é‚£ä¹ˆå½“æˆ‘ä»¬æƒ³è¦è®¿é—®å°‘æ•°å‡ ä¸ªåˆ—çš„æ•°æ®æ—¶ï¼Œéœ€è¦éå†æ¯ä¸€è¡Œï¼Œè¯»å–æ•´ä¸ªè¡¨çš„æ•°æ®ï¼Œè¿™æ ·å­æ˜¯å¾ˆä½æ•ˆçš„ã€‚ æ–¹æ¡ˆäºŒæŠŠæ¯ä¸ªåˆ—çš„æ•°æ®å•ç‹¬åˆ†å¼€å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆæŒ‰åˆ—å­˜å‚¨ï¼‰ã€‚é‚£ä¹ˆå½“æˆ‘ä»¬æƒ³è¦è®¿é—®å°‘æ•°å‡ ä¸ªåˆ—çš„æ•°æ®æ—¶ï¼Œåªéœ€è¦è¯»å–å¯¹åº”çš„æ–‡ä»¶ï¼Œä¸ç”¨è¯»å–æ•´ä¸ªè¡¨çš„æ•°æ®ï¼Œè¯»å–æ•ˆç‡å¾ˆé«˜ã€‚ç„¶è€Œï¼Œç”±äºç¨€ç–è¡¨é€šå¸¸ä¼šæœ‰å¾ˆå¤šåˆ—ï¼Œè¿™ä¼šå¯¼è‡´æ–‡ä»¶æ•°é‡ç‰¹åˆ«å¤šï¼Œè¿™æœ¬èº«ä¼šå½±å“æ–‡ä»¶ç³»ç»Ÿçš„æ•ˆç‡ã€‚è€ŒColumn Familyçš„æå‡ºå°±æ˜¯ä¸ºäº†åœ¨ä¸Šé¢ä¸¤ç§æ–¹æ¡ˆä¸­åšä¸€ä¸ªæŠ˜ä¸­ã€‚HBaseä¸­ å°†ä¸€ä¸ªColumn Familyä¸­çš„åˆ—å­˜åœ¨ä¸€èµ·ï¼Œè€Œä¸åŒColumn Familyçš„æ•°æ®åˆ™åˆ†å¼€ã€‚ç”±äºåœ¨HBaseä¸­Column Familyçš„æ•°é‡é€šå¸¸å¾ˆå°ï¼ŒåŒæ—¶HBaseå»ºè®®æŠŠç»å¸¸ä¸€èµ·è®¿é—®çš„æ¯”è¾ƒç±»ä¼¼çš„åˆ—æ”¾åœ¨åŒä¸€ä¸ªColumn Familyä¸­ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è®¿é—®å°‘æ•°å‡ ä¸ªåˆ—æ—¶ï¼Œåªè¯»å–å°½é‡å°‘çš„æ•°æ®ã€‚ ä¼˜åŒ–ï¼šå› ä¸ºä¸€ç›´åœ¨åšhbaseçš„åº”ç”¨å±‚é¢çš„å¼€å‘ï¼Œæ‰€ä»¥ä½“ä¼šçš„æ¯”è¾ƒæ·±çš„ä¸€ç‚¹æ˜¯hbaseçš„è¡¨ç»“æ„è®¾è®¡ä¼šå¯¹ç³»ç»Ÿçš„æ€§èƒ½ä»¥åŠå¼€é”€ä¸Šé€ æˆå¾ˆå¤§çš„åŒºåˆ«ï¼Œæœ¬ç¯‡æ–‡ç« å…ˆæŒ‰ç…§hbaseè¡¨ä¸­çš„rowkeyã€columnfamilyã€columnã€timestampå‡ ä¸ªæ–¹é¢è¿›è¡Œä¸€äº›åˆ†æã€‚æœ€åç»“åˆåˆ†æå¦‚ä½•è®¾è®¡ä¸€ç§é€‚åˆåº”ç”¨çš„é«˜æ•ˆè¡¨ç»“æ„ã€‚ è¡¨çš„å±æ€§ æœ€å¤§ç‰ˆæœ¬æ•°ï¼šé€šå¸¸æ˜¯3ï¼Œå¦‚æœå¯¹äºæ›´æ–°æ¯”è¾ƒé¢‘ç¹çš„åº”ç”¨å®Œå…¨å¯ä»¥è®¾ç½®ä¸º1ï¼Œèƒ½å¤Ÿå¿«é€Ÿçš„æ·˜æ±°æ— ç”¨æ•°æ®ï¼Œå¯¹äºèŠ‚çœå­˜å‚¨ç©ºé—´å’Œæé«˜æŸ¥è¯¢é€Ÿåº¦æœ‰æ•ˆæœã€‚ä¸è¿‡è¿™ç±»éœ€æ±‚åœ¨æµ·é‡æ•°æ®é¢†åŸŸæ¯”è¾ƒå°ä¼—ã€‚ å‹ç¼©ç®—æ³•ï¼šå¯ä»¥å°è¯•ä¸€ä¸‹æœ€æ–°å‡ºç‚‰çš„snappyç®—æ³•ï¼Œç›¸å¯¹lzoæ¥è¯´ï¼Œå‹ç¼©ç‡æ¥è¿‘ï¼Œå‹ç¼©æ•ˆç‡ç¨é«˜ï¼Œè§£å‹æ•ˆç‡é«˜å¾ˆå¤šã€‚ inmemoryï¼šè¡¨åœ¨å†…å­˜ä¸­å­˜æ”¾ï¼Œä¸€ç›´ä¼šè¢«å¿½ç•¥çš„å±æ€§ã€‚å¦‚æœå®Œå…¨å°†æ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œé‚£ä¹ˆhbaseå’Œç°åœ¨æµè¡Œçš„å†…å­˜æ•°æ®åº“memorycachedå’Œredisæ€§èƒ½å·®è·æœ‰å¤šå°‘ï¼Œå°šå¾…å®æµ‹ã€‚ bloomfilterï¼šæ ¹æ®åº”ç”¨æ¥å®šï¼Œçœ‹éœ€è¦ç²¾ç¡®åˆ°rowkeyè¿˜æ˜¯columnã€‚ä¸è¿‡è¿™é‡Œéœ€è¦ç†è§£ä¸€ä¸‹åŸç†ï¼Œbloomfilterçš„ä½œç”¨æ˜¯å¯¹ä¸€ä¸ªregionä¸‹æŸ¥æ‰¾è®°å½•æ‰€åœ¨çš„hfileæœ‰ç”¨ã€‚å³å¦‚æœä¸€ä¸ªregionä¸‹çš„hfileæ•°é‡å¾ˆå¤šï¼Œbloomfilterçš„ä½œç”¨è¶Šæ˜æ˜¾ã€‚é€‚åˆé‚£ç§compactionèµ¶ä¸ä¸Šflushé€Ÿåº¦çš„åº”ç”¨ã€‚ rowkeyrowkeyæ˜¯hbaseçš„key-valueå­˜å‚¨ä¸­çš„keyï¼Œé€šå¸¸ä½¿ç”¨ç”¨æˆ·è¦æŸ¥è¯¢çš„å­—æ®µä½œä¸ºrowkeyï¼ŒæŸ¥è¯¢ç»“æœä½œä¸ºvalueã€‚å¯ä»¥é€šè¿‡è®¾è®¡æ»¡è¶³å‡ ç§ä¸åŒçš„æŸ¥è¯¢éœ€æ±‚ã€‚ æ•°å­—rowkeyçš„ä»å¤§åˆ°å°æ’åºï¼šåŸç”Ÿhbaseåªæ”¯æŒä»å°åˆ°å¤§çš„æ’åºï¼Œè¿™æ ·å°±å¯¹äºæ’è¡Œæ¦œä¸€ç±»çš„æŸ¥è¯¢éœ€æ±‚å¾ˆå°´å°¬ã€‚é‚£ä¹ˆé‡‡ç”¨rowkey = Integer.MAX_VALUE-rowkeyçš„æ–¹å¼å°†rowkeyè¿›è¡Œè½¬æ¢ï¼Œæœ€å¤§çš„å˜æœ€å°ï¼Œæœ€å°çš„å˜æœ€å¤§ã€‚åœ¨åº”ç”¨å±‚å†è½¬å›æ¥å³å¯å®Œæˆæ’åºéœ€æ±‚ã€‚ rowkeyçš„æ•£åˆ—åŸåˆ™ï¼šå¦‚æœrowkeyæ˜¯ç±»ä¼¼æ—¶é—´æˆ³çš„æ–¹å¼é€’å¢çš„ç”Ÿæˆï¼Œå»ºè®®ä¸è¦ä½¿ç”¨æ­£åºç›´æ¥å†™å…¥rowkeyï¼Œè€Œæ˜¯é‡‡ç”¨reverseçš„æ–¹å¼åè½¬rowkeyï¼Œä½¿å¾—rowkeyå¤§è‡´å‡è¡¡åˆ†å¸ƒï¼Œè¿™æ ·è®¾è®¡æœ‰ä¸ªå¥½å¤„æ˜¯èƒ½å°†regionserverçš„è´Ÿè½½å‡è¡¡ï¼Œå¦åˆ™å®¹æ˜“äº§ç”Ÿæ‰€æœ‰æ–°æ•°æ®éƒ½åœ¨ä¸€ä¸ªregionserverä¸Šå †ç§¯çš„ç°è±¡ï¼Œè¿™ä¸€ç‚¹è¿˜å¯ä»¥ç»“åˆtableçš„é¢„åˆ‡åˆ†ä¸€èµ·è®¾è®¡ã€‚ columnfamilycolumnfamilyå°½é‡å°‘ï¼ŒåŸå› æ˜¯è¿‡å¤šçš„columnfamilyä¹‹é—´ä¼šäº’ç›¸å½±å“ã€‚ columnå¯¹äºcolumnéœ€è¦æ‰©å±•çš„åº”ç”¨ï¼Œcolumnå¯ä»¥æŒ‰æ™®é€šçš„æ–¹å¼è®¾è®¡ï¼Œä½†æ˜¯å¯¹äºåˆ—ç›¸å¯¹å›ºå®šçš„åº”ç”¨ï¼Œæœ€å¥½é‡‡ç”¨å°†ä¸€è¡Œè®°å½•å°è£…åˆ°ä¸€ä¸ªcolumnä¸­çš„æ–¹å¼ï¼Œè¿™æ ·èƒ½å¤ŸèŠ‚çœå­˜å‚¨ç©ºé—´ã€‚å°è£…çš„æ–¹å¼æ¨èprotocolbufferã€‚ æ‘¸ç´¢ä¸è®¨è®ºä»¥ä¸‹ä¼šåˆ†åœºæ™¯ä»‹ç»ä¸€äº›ç‰¹æ®Šçš„è¡¨ç»“æ„è®¾è®¡æ–¹æ³•ï¼Œåªæ˜¯ä¸€äº›æ‘¸ç´¢ï¼Œæ¬¢è¿è®¨è®ºï¼š valueæ•°ç›®è¿‡å¤šåœºæ™¯ä¸‹çš„è¡¨ç»“æ„è®¾è®¡ï¼šç›®å‰æˆ‘ç¢°åˆ°äº†ä¸€ç§key-valueçš„æ•°æ®ç»“æ„ï¼ŒæŸä¸€ä¸ªkeyä¸‹é¢åŒ…å«çš„columnå¾ˆå¤šï¼Œä»¥è‡´äºå®¢æˆ·ç«¯æŸ¥è¯¢çš„æ—¶å€™oomï¼Œbulkloadå†™å…¥çš„æ—¶å€™oomï¼Œregionsplitçš„æ—¶å€™å¤±è´¥è¿™ä¸‰ç§åæœã€‚é€šå¸¸æ¥è®²ï¼Œhbaseçš„columnæ•°ç›®ä¸è¦è¶…è¿‡ç™¾ä¸‡è¿™ä¸ªæ•°é‡çº§ã€‚åœ¨å®˜æ–¹çš„è¯´æ˜å’Œæˆ‘å®é™…çš„æµ‹è¯•ä¸­éƒ½éªŒè¯äº†è¿™ä¸€ç‚¹ã€‚æœ‰ä¸¤ç§æ€è·¯å¯ä»¥å‚è€ƒï¼Œç¬¬ä¸€ç§æ˜¯å•ç‹¬å¤„ç†è¿™äº›ç‰¹æ®Šçš„rowkeyï¼Œç¬¬äºŒç§å¦‚ä¸‹ï¼šå¯ä»¥è€ƒè™‘å°†columnè®¾è®¡åˆ°rowkeyçš„æ–¹æ³•è§£å†³ã€‚ä¾‹å¦‚åŸæ¥çš„rowkeyæ˜¯uid1,ï¼Œcolumnæ˜¯uid2ï¼Œuid3â€¦ã€‚é‡æ–°è®¾è®¡ä¹‹årowkeyä¸º&lt;uid2&gt;ï¼Œ&lt;uid1&gt;â€¦å½“ç„¶å¤§å®¶ä¼šæœ‰ç–‘é—®ï¼Œè¿™ç§æ–¹å¼å¦‚ä½•æŸ¥è¯¢ï¼Œå¦‚æœè¦æŸ¥è¯¢uid1ä¸‹é¢çš„æ‰€æœ‰uidæ€ä¹ˆåŠã€‚è¿™é‡Œè¯´æ˜ä¸€ä¸‹hbaseå¹¶ä¸æ˜¯åªæœ‰getä¸€ç§éšæœºè¯»å–çš„æ–¹æ³•ã€‚è€Œæ˜¯å«æœ‰scan(startkey,endkey)çš„æ‰«ææ–¹æ³•ï¼Œè€Œè¿™ç§æ–¹æ³•å’Œgetçš„æ•ˆç‡ç›¸å½“ã€‚éœ€è¦å–å¾—uid1ä¸‹çš„è®°å½•åªéœ€è¦new Scan(â€œuid1&quot;,&quot;uid1~â€)å³å¯ã€‚è¿™é‡Œçš„è®¾è®¡çµæ„Ÿæ¥è‡ªäºhadoop worldå¤§ä¼šä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ç¯‡æ–‡ç« æœ¬èº«ä¹Ÿå¾ˆæ£’ï¼Œæ¨èå¤§å®¶çœ‹ä¸€ä¸‹http://www.cloudera.com/resource/hadoop-world-2011-presentation-slides-advanced-hbase-schema-design/ å…¶ä»–å‚è€ƒèµ„æ–™ï¼š è¡¨è®¾è®¡ä¼˜åŒ–æ€»ç»“å‚è€ƒHBaseæ€§èƒ½ä¼˜åŒ–æ–¹æ³•æ€»ç»“ï¼ˆä¸€ï¼‰ï¼šè¡¨çš„è®¾è®¡å…³äºcloumn familyçš„æè¿°ï¼šä¸è¦åœ¨ä¸€å¼ è¡¨é‡Œå®šä¹‰å¤ªå¤šçš„****column familyã€‚ç›®å‰Hbaseå¹¶ä¸èƒ½å¾ˆå¥½çš„å¤„ç†è¶…è¿‡2~3ä¸ªcolumn familyçš„è¡¨ã€‚å› ä¸ºæŸä¸ªcolumn familyåœ¨flushçš„æ—¶å€™ï¼Œå®ƒé‚»è¿‘çš„column familyä¹Ÿä¼šå› å…³è”æ•ˆåº”è¢«è§¦å‘flushï¼Œæœ€ç»ˆå¯¼è‡´ç³»ç»Ÿäº§ç”Ÿæ›´å¤šçš„I/Oã€‚","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"HBASE","slug":"HBASE","permalink":"http://www.wortyby.com/tags/HBASE/"}]},{"title":"Python è¿›ç¨‹ç®¡ç†å·¥å…· Supervisor ä½¿ç”¨æ•™ç¨‹","slug":"Python è¿›ç¨‹ç®¡ç†å·¥å…· Supervisor ä½¿ç”¨æ•™ç¨‹","date":"2018-09-06T11:57:32.000Z","updated":"2018-09-06T11:57:32.000Z","comments":true,"path":"2018/09/06/Python è¿›ç¨‹ç®¡ç†å·¥å…· Supervisor ä½¿ç”¨æ•™ç¨‹/","link":"","permalink":"http://www.wortyby.com/2018/09/06/Python è¿›ç¨‹ç®¡ç†å·¥å…· Supervisor ä½¿ç”¨æ•™ç¨‹/","excerpt":"","text":"Supervisor æ˜¯åŸºäº Python çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´ç®€å•çš„å¯åŠ¨ã€é‡å¯å’Œåœæ­¢æœåŠ¡å™¨ä¸Šçš„åå°è¿›ç¨‹ï¼Œæ˜¯ Linux æœåŠ¡å™¨ç®¡ç†çš„æ•ˆç‡å·¥å…·ã€‚ä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è¿›ç¨‹ç®¡ç†å‘¢ï¼Ÿå°±æ˜¯æ‰§è¡Œä¸€äº›éœ€è¦ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼å¯åŠ¨çš„ç¨‹åºï¼Œæ¯”å¦‚ä¸€ä¸ªåå°ä»»åŠ¡ã€ä¸€ç»„ Web æœåŠ¡çš„è¿›ç¨‹ï¼ˆè¯´æ˜¯ä¸€ç»„ï¼Œæ˜¯å› ä¸ºç»å¸¸ç”¨ Nginx æ¥åšè´Ÿè½½å‡è¡¡ï¼‰ï¼Œè¿™äº›å¾ˆå¯èƒ½æ˜¯ä¸€äº›ç½‘ç«™ã€REST API çš„æœåŠ¡ã€æ¶ˆæ¯æ¨é€çš„åå°æœåŠ¡ã€æ—¥å¿—æ•°æ®çš„å¤„ç†åˆ†ææœåŠ¡ç­‰ç­‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ Supervisor æ˜¯é€šç”¨çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥å¯åŠ¨ä»»æ„è¿›ç¨‹ï¼Œä¸ä»…ä»…æ˜¯ç”¨æ¥ç®¡ç† Python è¿›ç¨‹ã€‚Supervisor ç»å¸¸è¢«ç”¨æ¥ç®¡ç†ç”± gunicorn å¯åŠ¨çš„ Django æˆ– Flask ç­‰ Web æœåŠ¡çš„è¿›ç¨‹ã€‚æˆ‘æœ€å¸¸ç”¨çš„æ˜¯ç”¨æ¥ç®¡ç†å’Œå¯åŠ¨ä¸€ç»„ Tornado è¿›ç¨‹æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSupervisor è¿˜èƒ½å¾ˆå‹å¥½çš„ç®¡ç†ç¨‹åºåœ¨å‘½ä»¤è¡Œä¸Šè¾“å‡ºçš„æ—¥å¿—ï¼Œå¯ä»¥å°†æ—¥å¿—é‡å®šå‘åˆ°è‡ªå®šä¹‰çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œè¿˜èƒ½æŒ‰æ–‡ä»¶å¤§å°å¯¹æ—¥å¿—è¿›è¡Œåˆ†å‰²ã€‚ç›®å‰ Supervisor åªèƒ½è¿è¡Œåœ¨ Unix-Like çš„ç³»ç»Ÿä¸Šï¼Œä¹Ÿå°±æ˜¯æ— æ³•è¿è¡Œåœ¨ Windows ä¸Šã€‚Supervisor å®˜æ–¹ç‰ˆç›®å‰åªèƒ½è¿è¡Œåœ¨ Python 2.4 ä»¥ä¸Šç‰ˆæœ¬ï¼Œä½†æ˜¯è¿˜æ— æ³•è¿è¡Œåœ¨ Python 3 ä¸Šï¼Œä¸è¿‡å·²ç»æœ‰ä¸€ä¸ª Python 3 çš„ç§»æ¤ç‰ˆ supervisor-py3kã€‚Supervisor æœ‰ä¸¤ä¸ªä¸»è¦çš„ç»„æˆéƒ¨åˆ†ï¼šsupervisordï¼Œè¿è¡Œ Supervisor æ—¶ä¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ supervisordï¼Œå®ƒè´Ÿè´£å¯åŠ¨æ‰€ç®¡ç†çš„è¿›ç¨‹ï¼Œå¹¶å°†æ‰€ç®¡ç†çš„è¿›ç¨‹ä½œä¸ºè‡ªå·±çš„å­è¿›ç¨‹æ¥å¯åŠ¨ï¼Œè€Œä¸”å¯ä»¥åœ¨æ‰€ç®¡ç†çš„è¿›ç¨‹å‡ºç°å´©æºƒæ—¶è‡ªåŠ¨é‡å¯ã€‚supervisorctlï¼Œæ˜¯å‘½ä»¤è¡Œç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œ stopã€startã€restart ç­‰å‘½ä»¤ï¼Œæ¥å¯¹è¿™äº›å­è¿›ç¨‹è¿›è¡Œç®¡ç†ã€‚ å®‰è£…sudo pip install supervisor åˆ›å»ºé…ç½®æ–‡ä»¶echo_supervisord_conf &gt; /etc/supervisord.conf å¦‚æœå‡ºç°æ²¡æœ‰æƒé™çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨è¿™æ¡å‘½ä»¤sudo su - root -c &quot;echo_supervisord_conf &gt; /etc/supervisord.conf&quot; é…ç½®æ–‡ä»¶è¯´æ˜æƒ³è¦äº†è§£æ€ä¹ˆé…ç½®éœ€è¦ç®¡ç†çš„è¿›ç¨‹ï¼Œåªè¦æ‰“å¼€ supervisord.conf å°±å¯ä»¥äº†ï¼Œé‡Œé¢æœ‰å¾ˆè¯¦ç»†çš„æ³¨é‡Šä¿¡æ¯ã€‚æ‰“å¼€é…ç½®æ–‡ä»¶vim /etc/supervisord.conf é»˜è®¤çš„é…ç½®æ–‡ä»¶æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªå‘éœ€è¦æ³¨æ„ï¼Œsupervisord.pid ä»¥åŠ supervisor.sock æ˜¯æ”¾åœ¨ /tmp ç›®å½•ä¸‹ï¼Œä½†æ˜¯ /tmp ç›®å½•æ˜¯å­˜æ”¾ä¸´æ—¶æ–‡ä»¶ï¼Œé‡Œé¢çš„æ–‡ä»¶æ˜¯ä¼šè¢« Linux ç³»ç»Ÿåˆ é™¤çš„ï¼Œä¸€æ—¦è¿™äº›æ–‡ä»¶ä¸¢å¤±ï¼Œå°±æ— æ³•å†é€šè¿‡ supervisorctl æ¥æ‰§è¡Œ restart å’Œ stop å‘½ä»¤äº†ï¼Œå°†åªä¼šå¾—åˆ° unix:///tmp/supervisor.sock ä¸å­˜åœ¨çš„é”™è¯¯ ã€‚å› æ­¤å¯ä»¥å•ç‹¬å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¥å­˜æ”¾è¿™äº›æ–‡ä»¶ï¼Œæ¯”å¦‚æ”¾åœ¨ /home/supervisor/åˆ›å»ºæ–‡ä»¶å¤¹mkdir /home/supervisor mkdir /var/log/supervisor mkdir /etc/supervisor.d ç„¶åå¯¹ä¸€äº›é…ç½®è¿›è¡Œä¿®æ”¹1234567891011121314151617181920212223242526272829303132333435363738394041[unix_http_server] ;file=/tmp/supervisor.sock ; (the path to the socket file) ;ä¿®æ”¹ä¸º /home/supervisor ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤ file=/home/supervisor/supervisor.sock ; (the path to the socket file) ;chmod=0700 ; socket file mode (default 0700) ;chown=nobody:nogroup ; socket file uid:gid owner ;username=user ; (default is no username (open server)) ;password=123 ; (default is no password (open server)) ;[inet_http_server] ; inet (TCP) server disabled by default ;port=127.0.0.1:9001 ; (ip_address:port specifier, *:port for ;all iface) ;username=user ; (default is no username (open server)) ;password=123 ; (default is no password (open server)) ... [supervisord] ;logfile=/tmp/supervisord.log ; (main log file;default $CWD/supervisord.log) ;ä¿®æ”¹ä¸º /var/log ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤ logfile=/var/log/supervisor/supervisord.log ; (main log file;default $CWD/supervisord.log) ; æ—¥å¿—æ–‡ä»¶å¤šå¤§æ—¶è¿›è¡Œåˆ†å‰² logfile_maxbytes=50MB ; (max main logfile bytes b4 rotation;default 50MB) ; æœ€å¤šä¿ç•™å¤šå°‘ä»½æ—¥å¿—æ–‡ä»¶ logfile_backups=10 ; (num of main logfile rotation backups;default 10) loglevel=info ; (log level;default info; others: debug,warn,trace) ;pidfile=/tmp/supervisord.pid ; (supervisord pidfile;default supervisord.pid) ;ä¿®æ”¹ä¸º /home/supervisor ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤ pidfile=/home/supervisor/supervisord.pid ; (supervisord pidfile;default supervisord.pid) ... ;è®¾ç½®å¯åŠ¨supervisordçš„ç”¨æˆ·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸è¦è½»æ˜“ç”¨rootç”¨æˆ·æ¥å¯åŠ¨ï¼Œé™¤éä½ çœŸçš„ç¡®å®šè¦è¿™ä¹ˆåš ;user=chrism ; (default is current user, required if root) ... [supervisorctl] ; å¿…é¡»å’Œ&apos;unix\\_http\\_server&apos;é‡Œé¢çš„è®¾å®šåŒ¹é… ;serverurl=unix:///tmp/supervisor.sock ; use a unix:// URL for a unix socket ;ä¿®æ”¹ä¸º /home/supervisor ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤ serverurl=unix:///home/supervisor/supervisor.sock ; use a unix:// URL for a unix socket ;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket ;username=chris ; should be same as http_username if set ;password=123 ; should be same as http_password if set ...é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿›ç¨‹çš„æ—¥å¿—æ–‡ä»¶è¾¾åˆ°50MBæ—¶ï¼Œå°†è¿›è¡Œåˆ†å‰²ï¼Œæœ€å¤šä¿ç•™10ä¸ªæ–‡ä»¶ï¼Œå½“ç„¶è¿™äº›é…ç½®ä¹Ÿå¯ä»¥å¯¹æ¯ä¸ªè¿›ç¨‹å•ç‹¬é…ç½®ã€‚ æƒé™é—®é¢˜è®¾ç½®å¥½é…ç½®æ–‡ä»¶åï¼Œåº”å…ˆåˆ›å»ºä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­æ–°å¢çš„æ–‡ä»¶å¤¹ã€‚å¦‚æœæŒ‡å®šäº†å¯åŠ¨ç”¨æˆ· userï¼Œè¿™é‡Œä»¥ oxygen ä¸ºä¾‹ï¼Œé‚£ä¹ˆåº”æ³¨æ„ç›¸å…³æ–‡ä»¶çš„æƒé™é—®é¢˜ï¼ŒåŒ…æ‹¬æ—¥å¿—æ–‡ä»¶ï¼Œå¦åˆ™ä¼šå‡ºç°æ²¡æœ‰æƒé™çš„é”™è¯¯ã€‚ä¾‹å¦‚è®¾ç½®äº†å¯åŠ¨ç”¨æˆ· oxygenï¼Œç„¶åå¯åŠ¨ supervisord å‡ºç°é”™è¯¯Error: Cannot open an HTTP server: socket.error reported errno.EACCES (13) å°±æ˜¯ç”±äºä¸Šé¢çš„é…ç½®æ–‡ä»¶ä¸­ /home/supervisor æ–‡ä»¶å¤¹ï¼Œæ²¡æœ‰æˆäºˆå¯åŠ¨ supervisord çš„ç”¨æˆ· oxygen çš„å†™æƒé™ï¼Œå¯ä»¥å°†è¿™ä¸ªæ–‡ä»¶å¤¹çš„æ‹¥æœ‰è€…è®¾ç½®è¯¥è¯¥è´¦å·sudo chown oxygen /home/supervisor ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ root ç”¨æˆ·å¯åŠ¨ supervisord è¿›ç¨‹ï¼Œç„¶ååœ¨å…¶æ‰€ç®¡ç†çš„è¿›ç¨‹ä¸­ï¼Œå†å…·ä½“æŒ‡å®šéœ€è¦ä»¥é‚£ä¸ªç”¨æˆ·å¯åŠ¨è¿™äº›è¿›ç¨‹ã€‚ ä½¿ç”¨æµè§ˆå™¨æ¥ç®¡ç†supervisor åŒæ—¶æä¾›äº†é€šè¿‡æµè§ˆå™¨æ¥ç®¡ç†è¿›ç¨‹çš„æ–¹æ³•ï¼Œåªéœ€è¦æ³¨é‡Šæ‰å¦‚ä¸‹å‡ è¡Œå°±å¯ä»¥äº†ã€‚12345678910;[inet_http_server] ; inet (TCP) server disabled by default ;port=127.0.0.1:9001 ; (ip_address:port specifier, *:port for ;all iface) ;username=user ; (default is no username (open server)) ;password=123 ; (default is no password (open server)) [supervisorctl] ... ;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket ;username=chris ; should be same as http_username if set ;password=123 ; should be same as http_password if set ä½¿ç”¨ includeåœ¨é…ç½®æ–‡ä»¶çš„æœ€åï¼Œæœ‰ä¸€ä¸ª [include] çš„é…ç½®é¡¹ï¼Œè·Ÿ Nginx ä¸€æ ·ï¼Œå¯ä»¥ include æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸ºæ¯ä¸ªè¿›ç¨‹æˆ–ç›¸å…³çš„å‡ ä¸ªè¿›ç¨‹çš„é…ç½®å•ç‹¬å†™æˆä¸€ä¸ªæ–‡ä»¶ã€‚12[include]files = /etc/supervisor.d/*.ini è¿›ç¨‹çš„é…ç½®æ ·ä¾‹sudo pip install supervisor ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹; è®¾ç½®è¿›ç¨‹çš„åç§°ï¼Œä½¿ç”¨ supervisorctl æ¥ç®¡ç†è¿›ç¨‹æ—¶éœ€è¦ä½¿ç”¨è¯¥è¿›ç¨‹å [program:your_program_name] command=python server.py --port=9000 ;numprocs=1 ; é»˜è®¤ä¸º1 ;process_name=%(program_name)s ; é»˜è®¤ä¸º %(program_name)sï¼Œå³ [program:x] ä¸­çš„ x directory=/home/python/tornado_server ; æ‰§è¡Œ command ä¹‹å‰ï¼Œå…ˆåˆ‡æ¢åˆ°å·¥ä½œç›®å½• user=oxygen ; ä½¿ç”¨ oxygen ç”¨æˆ·æ¥å¯åŠ¨è¯¥è¿›ç¨‹ ; ç¨‹åºå´©æºƒæ—¶è‡ªåŠ¨é‡å¯ï¼Œé‡å¯æ¬¡æ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œé»˜è®¤ä¸º3æ¬¡ autorestart=true redirect_stderr=true ; é‡å®šå‘è¾“å‡ºçš„æ—¥å¿— stdout_logfile = /var/log/supervisor/tornado_server.log loglevel=info è®¾ç½®æ—¥å¿—çº§åˆ«loglevel æŒ‡å®šäº†æ—¥å¿—çš„çº§åˆ«ï¼Œç”¨ Python çš„ print è¯­å¥è¾“å‡ºçš„æ—¥å¿—æ˜¯ä¸ä¼šè¢«è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­çš„ï¼Œéœ€è¦æ­é… Python çš„ logging æ¨¡å—æ¥è¾“å‡ºæœ‰æŒ‡å®šçº§åˆ«çš„æ—¥å¿—ã€‚ å¤šä¸ªè¿›ç¨‹æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„å®šä¹‰ï¼Œä¸€ä¸ª [program:x] å®é™…ä¸Šæ˜¯è¡¨ç¤ºä¸€ç»„ç›¸åŒç‰¹å¾æˆ–åŒç±»çš„è¿›ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª [program:x] å¯ä»¥å¯åŠ¨å¤šä¸ªè¿›ç¨‹ã€‚è¿™ç»„è¿›ç¨‹çš„æˆå‘˜æ˜¯é€šè¿‡ numprocs å’Œ process_name è¿™ä¸¤ä¸ªå‚æ•°æ¥ç¡®å®šçš„ï¼Œè¿™å¥è¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹è¿™ä¸ªä¾‹å­ã€‚12345678910111213; è®¾ç½®è¿›ç¨‹çš„åç§°ï¼Œä½¿ç”¨ supervisorctl æ¥ç®¡ç†è¿›ç¨‹æ—¶éœ€è¦ä½¿ç”¨è¯¥è¿›ç¨‹å [program:foo] ; å¯ä»¥åœ¨ command è¿™é‡Œç”¨ python è¡¨è¾¾å¼ä¼ é€’ä¸åŒçš„å‚æ•°ç»™æ¯ä¸ªè¿›ç¨‹ command=python server.py --port=90%(process_num)02d directory=/home/python/tornado_server ; æ‰§è¡Œ command ä¹‹å‰ï¼Œå…ˆåˆ‡æ¢åˆ°å·¥ä½œç›®å½• ; è‹¥ numprocs ä¸ä¸º1ï¼Œprocess\\_name çš„è¡¨è¾¾å¼ä¸­ä¸€å®šè¦åŒ…å« process_num æ¥åŒºåˆ†ä¸åŒçš„è¿›ç¨‹ numprocs=2 process_name=%(program_name)s_%(process_num)02d; user=oxygen ; ä½¿ç”¨ oxygen ç”¨æˆ·æ¥å¯åŠ¨è¯¥è¿›ç¨‹ autorestart=true ; ç¨‹åºå´©æºƒæ—¶è‡ªåŠ¨é‡å¯ redirect_stderr=true ; é‡å®šå‘è¾“å‡ºçš„æ—¥å¿— stdout_logfile = /var/log/supervisor/tornado_server.log loglevel=infoä¸Šé¢è¿™ä¸ªä¾‹å­ä¼šå¯åŠ¨ä¸¤ä¸ªè¿›ç¨‹ï¼Œprocess_name åˆ†åˆ«ä¸º foo:foo_01 å’Œ foo:foo_02ã€‚é€šè¿‡è¿™æ ·ä¸€ç§æ–¹å¼ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ª [program:x] é…ç½®é¡¹ï¼Œæ¥å¯åŠ¨ä¸€ç»„éå¸¸ç±»ä¼¼çš„è¿›ç¨‹ã€‚å†ä»‹ç»ä¸¤ä¸ªé…ç½®é¡¹ stopasgroup å’Œ killasgroup12345; é»˜è®¤ä¸º falseï¼Œå¦‚æœè®¾ç½®ä¸º trueï¼Œå½“è¿›ç¨‹æ”¶åˆ° stop ä¿¡å·æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥ä¿¡å·å‘ç»™è¯¥è¿›ç¨‹çš„å­è¿›ç¨‹ã€‚å¦‚æœè¿™ä¸ªé…ç½®é¡¹ä¸º trueï¼Œé‚£ä¹ˆä¹Ÿéšå« killasgroup ä¸º trueã€‚ä¾‹å¦‚åœ¨ Debug æ¨¡å¼ä½¿ç”¨ Flask æ—¶ï¼ŒFlask ä¸ä¼šå°†æ¥æ”¶åˆ°çš„ stop ä¿¡å·ä¹Ÿä¼ é€’ç»™å®ƒçš„å­è¿›ç¨‹ï¼Œå› æ­¤å°±éœ€è¦è®¾ç½®è¿™ä¸ªé…ç½®é¡¹ã€‚ stopasgroup=false ; send stop signal to the UNIX process ; é»˜è®¤ä¸º falseï¼Œå¦‚æœè®¾ç½®ä¸º trueï¼Œå½“è¿›ç¨‹æ”¶åˆ° kill ä¿¡å·æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥ä¿¡å·å‘ç»™è¯¥è¿›ç¨‹çš„å­è¿›ç¨‹ã€‚å¦‚æœè¿™ä¸ªç¨‹åºä½¿ç”¨äº† python çš„ multiprocessing æ—¶ï¼Œå°±èƒ½è‡ªåŠ¨åœæ­¢å®ƒçš„å­çº¿ç¨‹ã€‚ killasgroup=false ; SIGKILL the UNIX process group (def false)æ›´è¯¦ç»†çš„é…ç½®ä¾‹å­ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ï¼Œå®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œ123456789101112131415161718192021222324252627282930;[program:theprogramname] ;command=/bin/cat ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=999 ; the relative start priority (default 999) ;autostart=true ; start at supervisord start (default: true) ;autorestart=unexpected ; whether/when to restart (default: unexpected) ;startsecs=1 ; number of secs prog must stay running (def. 1) ;startretries=3 ; max # of serial start failures (default 3) ;exitcodes=0,2 ; &apos;expected&apos; exit codes for process (default 0,2) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=true ; redirect proc stderr to stdout (default false) ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout\\_logfile\\_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (default 10) ;stdout_capture\\_maxbytes=1MB ; number of bytes in &apos;capturemode&apos; (default 0) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (default 10) ;stderr_capture_maxbytes=1MB ; number of bytes in &apos;capturemode&apos; (default 0) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A=&quot;1&quot;,B=&quot;2&quot; ; process environment additions (def no adds) ;serverurl=AUTO ; override serverurl computation (childutils) å°†å¤šä¸ªè¿›ç¨‹æŒ‰ç»„ç®¡ç†Supervisor åŒæ—¶è¿˜æä¾›äº†å¦å¤–ä¸€ç§è¿›ç¨‹ç»„çš„ç®¡ç†æ–¹å¼ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ supervisorctl å‘½ä»¤æ¥ç®¡ç†ä¸€ç»„è¿›ç¨‹ã€‚è·Ÿ [program:x] çš„è¿›ç¨‹ç»„ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œçš„è¿›ç¨‹æ˜¯ä¸€ä¸ªä¸ªçš„ [program:x] ã€‚123[group:thegroupname] programs=progname1,progname2 ; each refers to &apos;x&apos; in \\[program:x\\] definitions priority=999 ; the relative start priority (default 999)å½“æ·»åŠ äº†ä¸Šè¿°é…ç½®åï¼Œprogname1 å’Œ progname2 çš„è¿›ç¨‹åå°±ä¼šå˜æˆ thegroupname:progname1 å’Œ thegroupname:progname2 ä»¥åå°±è¦ç”¨è¿™ä¸ªåå­—æ¥ç®¡ç†è¿›ç¨‹äº†ï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„ progname1ã€‚ä»¥åæ‰§è¡Œ supervisorctl stop thegroupname: å°±èƒ½åŒæ—¶ç»“æŸ progname1 å’Œ progname2ï¼Œæ‰§è¡Œ supervisorctl stop thegroupname:progname1 å°±èƒ½ç»“æŸ progname1ã€‚supervisorctl çš„å‘½ä»¤æˆ‘ä»¬ç¨åä»‹ç»ã€‚ å¯åŠ¨ supervisordæ‰§è¡Œ supervisord å‘½ä»¤ï¼Œå°†ä¼šå¯åŠ¨ supervisord è¿›ç¨‹ï¼ŒåŒæ—¶æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„è¿›ç¨‹ä¹Ÿä¼šç›¸åº”å¯åŠ¨ã€‚123456# ä½¿ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ /etc/supervisord.conf supervisord # æ˜ç¡®æŒ‡å®šé…ç½®æ–‡ä»¶ supervisord -c /etc/supervisord.conf # ä½¿ç”¨ user ç”¨æˆ·å¯åŠ¨ supervisord supervisord -u useræ›´å¤šå‚æ•°è¯·å‚è€ƒæ–‡æ¡£ supervisorctl å‘½ä»¤ä»‹ç»12345678910111213141516# åœæ­¢æŸä¸€ä¸ªè¿›ç¨‹ï¼Œprogram_name ä¸º [program:x] é‡Œçš„ x supervisorctl stop program_name # å¯åŠ¨æŸä¸ªè¿›ç¨‹ supervisorctl start program_name # é‡å¯æŸä¸ªè¿›ç¨‹ supervisorctl restart program_name # ç»“æŸæ‰€æœ‰å±äºåä¸º groupworker è¿™ä¸ªåˆ†ç»„çš„è¿›ç¨‹ (startï¼Œrestart åŒç†) supervisorctl stop groupworker: # ç»“æŸ groupworker:name1 è¿™ä¸ªè¿›ç¨‹ (startï¼Œrestart åŒç†) supervisorctl stop groupworker:name1 # åœæ­¢å…¨éƒ¨è¿›ç¨‹ï¼Œæ³¨ï¼šstartã€restartã€stop éƒ½ä¸ä¼šè½½å…¥æœ€æ–°çš„é…ç½®æ–‡ä»¶ supervisorctl stop all # è½½å…¥æœ€æ–°çš„é…ç½®æ–‡ä»¶ï¼Œåœæ­¢åŸæœ‰è¿›ç¨‹å¹¶æŒ‰æ–°çš„é…ç½®å¯åŠ¨ã€ç®¡ç†æ‰€æœ‰è¿›ç¨‹ supervisorctl reload # æ ¹æ®æœ€æ–°çš„é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨æ–°é…ç½®æˆ–æœ‰æ”¹åŠ¨çš„è¿›ç¨‹ï¼Œé…ç½®æ²¡æœ‰æ”¹åŠ¨çš„è¿›ç¨‹ä¸ä¼šå—å½±å“è€Œé‡å¯ supervisorctl updateæ³¨æ„ï¼šæ˜¾ç¤ºç”¨ stop åœæ­¢æ‰çš„è¿›ç¨‹ï¼Œç”¨ reload æˆ–è€… update éƒ½ä¸ä¼šè‡ªåŠ¨é‡å¯ã€‚ä¹Ÿå¯ä»¥å‚è€ƒè¿™é‡Œ å¼€æœºè‡ªåŠ¨å¯åŠ¨ Supervisord æ–¹æ³•1æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•ï¼Œå› ä¸º Linux åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šæ‰§è¡Œ /etc/rc.local é‡Œé¢çš„è„šæœ¬ï¼Œæ‰€ä»¥åªè¦åœ¨è¿™é‡Œæ·»åŠ æ‰§è¡Œå‘½ä»¤å°±å¯ä»¥12# å¦‚æœæ˜¯ Ubuntu æ·»åŠ ä»¥ä¸‹å†…å®¹ /usr/local/bin/supervisord -c /etc/supervisord.conf12# å¦‚æœæ˜¯ Centos æ·»åŠ ä»¥ä¸‹å†…å®¹ /usr/bin/supervisord -c /etc/supervisord.confä»¥ä¸Šå†…å®¹éœ€è¦æ·»åŠ åœ¨ exit å‘½ä»¤å‰ï¼Œè€Œä¸”ç”±äºåœ¨æ‰§è¡Œ rc.local è„šæœ¬æ—¶ï¼ŒPATH ç¯å¢ƒå˜é‡æœªå…¨éƒ¨åˆå§‹åŒ–ï¼Œå› æ­¤å‘½ä»¤éœ€è¦ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚å¯ä»¥ç”¨ which supervisord æŸ¥çœ‹ä¸€ä¸‹ supervisord æ‰€åœ¨çš„è·¯å¾„ã€‚åœ¨æ·»åŠ å‰ï¼Œå…ˆåœ¨ç»ˆç«¯æµ‹è¯•ä¸€ä¸‹å‘½ä»¤æ˜¯å¦èƒ½æ­£å¸¸æ‰§è¡Œï¼Œå¦‚æœæ‰¾ä¸åˆ° supervisordï¼Œå¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤æ‰¾åˆ°sudo find / -name supervisord å¦‚æœæ˜¯ Ubuntu 16.04 ä»¥ä¸Šï¼Œrc.local è¢«å½“æˆäº†æœåŠ¡ï¼Œè€Œä¸”é»˜è®¤æ˜¯ä¸ä¼šå¯åŠ¨ï¼Œéœ€è¦æ‰‹åŠ¨å¯ç”¨ä¸€ä¸‹æœåŠ¡ã€‚https://askubuntu.com/questions/765120/after-upgrade-to-16-04-lts-rc-local-not-executing-commandå¯ç”¨ rc.local æœåŠ¡sudo systemctl enable rc-local.service æ–¹æ³•2Supervisord é»˜è®¤æƒ…å†µä¸‹å¹¶æ²¡æœ‰è¢«å®‰è£…æˆæœåŠ¡ï¼Œå®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚å®˜æ–¹å·²ç»ç»™å‡ºäº†è„šæœ¬å¯ä»¥å°† Supervisord å®‰è£…æˆæœåŠ¡ï¼Œå¯ä»¥å‚è€ƒè¿™é‡ŒæŸ¥çœ‹å„ç§æ“ä½œç³»ç»Ÿçš„å®‰è£…è„šæœ¬ï¼Œä½†æ˜¯æˆ‘ç”¨å®˜æ–¹è¿™é‡Œç»™çš„ Ubuntu è„šæœ¬å´æ— æ³•è¿è¡Œã€‚å®‰è£…æ–¹æ³•å¯ä»¥å‚è€ƒ serverfault ä¸Šçš„å›ç­”ã€‚æ¯”å¦‚æˆ‘æ˜¯ Ubuntu ç³»ç»Ÿï¼Œå¯ä»¥è¿™ä¹ˆå®‰è£…ï¼Œè¿™é‡Œé€‰æ‹©äº†å¦å¤–ä¸€ä¸ªè„šæœ¬123456789# ä¸‹è½½è„šæœ¬ sudo su - root -c &quot;sudo curl https://gist.githubusercontent.com/howthebodyworks/176149/raw/d60b505a585dda836fadecca8f6b03884153196b/supervisord.sh &gt; /etc/init.d/supervisord&quot; # è®¾ç½®è¯¥è„šæœ¬ä¸ºå¯ä»¥æ‰§è¡Œ sudo chmod +x /etc/init.d/supervisord # è®¾ç½®ä¸ºå¼€æœºè‡ªåŠ¨è¿è¡Œ sudo update-rc.d supervisord defaults # è¯•ä¸€ä¸‹ï¼Œæ˜¯å¦å·¥ä½œæ­£å¸¸ service supervisord stop service supervisord startæ³¨æ„ï¼šè¿™ä¸ªè„šæœ¬ä¸‹è½½ä¸‹æ¥åï¼Œè¿˜éœ€æ£€æŸ¥ä¸€ä¸‹ä¸æˆ‘ä»¬çš„é…ç½®æ˜¯å¦ç›¸ç¬¦åˆï¼Œæ¯”å¦‚é»˜è®¤çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œpid æ–‡ä»¶è·¯å¾„ç­‰ï¼Œå¦‚æœå­˜åœ¨ä¸åŒåˆ™éœ€è¦è¿›è¡Œä¸€äº›ä¿®æ”¹ã€‚","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://www.wortyby.com/categories/å·¥å…·/"}],"tags":[{"name":"Linux å·¥å…·","slug":"Linux-å·¥å…·","permalink":"http://www.wortyby.com/tags/Linux-å·¥å…·/"},{"name":"python","slug":"python","permalink":"http://www.wortyby.com/tags/python/"}]},{"title":"çŸ©é˜µè¿ç®—å’Œæ–‡æœ¬å¤„ç†ä¸­çš„åˆ†ç±»é—®é¢˜","slug":"çŸ©é˜µè¿ç®—å’Œæ–‡æœ¬å¤„ç†ä¸­çš„åˆ†ç±»é—®é¢˜","date":"2018-09-05T06:57:58.000Z","updated":"2018-09-05T06:57:58.000Z","comments":true,"path":"2018/09/05/çŸ©é˜µè¿ç®—å’Œæ–‡æœ¬å¤„ç†ä¸­çš„åˆ†ç±»é—®é¢˜/","link":"","permalink":"http://www.wortyby.com/2018/09/05/çŸ©é˜µè¿ç®—å’Œæ–‡æœ¬å¤„ç†ä¸­çš„åˆ†ç±»é—®é¢˜/","excerpt":"","text":"èƒŒæ™¯æˆ‘åœ¨å¤§å­¦å­¦ä¹ çº¿æ€§ä»£æ•°æ—¶ï¼Œå®åœ¨æƒ³ä¸å‡ºå®ƒé™¤äº†å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•è§£çº¿æ€§æ–¹ç¨‹å¤–ï¼Œè¿˜èƒ½æœ‰ä»€ä¹ˆåˆ«çš„ç”¨é€”ã€‚å…³äºçŸ©é˜µçš„è®¸å¤šæ¦‚å¿µï¼Œæ¯”å¦‚ç‰¹å¾å€¼ç­‰ç­‰ï¼Œæ›´æ˜¯è„±ç¦»æ—¥å¸¸ç”Ÿæ´»ã€‚åæ¥åœ¨æ•°å€¼åˆ†æä¸­åˆå­¦äº†å¾ˆå¤šçŸ©é˜µçš„è¿‘ä¼¼ç®—æ³•ï¼Œè¿˜æ˜¯çœ‹ä¸åˆ°å¯ä»¥åº”ç”¨çš„åœ°æ–¹ã€‚å½“æ—¶é€‰è¿™äº›è¯¾ï¼Œå®Œå…¨æ˜¯ä¸ºäº†æ··å­¦åˆ†çš„å­¦ä½ã€‚æˆ‘æƒ³ï¼Œå¾ˆå¤šåŒå­¦éƒ½å¤šå¤šå°‘å°‘æœ‰è¿‡ç±»ä¼¼çš„ç»å†ã€‚ç›´åˆ°åæ¥é•¿æœŸåšè‡ªç„¶è¯­è¨€å¤„ç†çš„ç ”ç©¶ï¼Œæˆ‘æ‰å‘ç°æ•°å­¦å®¶ä»¬æå‡ºé‚£äº›çŸ©é˜µçš„æ¦‚å¿µå’Œç®—æ³•ï¼Œæ˜¯æœ‰å®é™…åº”ç”¨çš„æ„ä¹‰çš„ã€‚ è¯­éŸ³åˆ†ç±»é—®é¢˜åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œæœ€å¸¸è§çš„ä¸¤ç±»çš„åˆ†ç±»é—®é¢˜åˆ†åˆ«æ˜¯ï¼Œå°†æ–‡æœ¬æŒ‰ä¸»é¢˜å½’ç±»ï¼ˆæ¯”å¦‚å°†æ‰€æœ‰ä»‹ç»äºšè¿ä¼šçš„æ–°é—»å½’åˆ°ä½“è‚²ç±»ï¼‰å’Œå°†è¯æ±‡è¡¨ä¸­çš„å­—è¯æŒ‰æ„æ€å½’ç±»ï¼ˆæ¯”å¦‚å°†å„ç§ä½“è‚²è¿åŠ¨çš„åç§°ä¸ªå½’æˆä¸€ç±»ï¼‰ã€‚è¿™ä¸¤ç§åˆ†ç±»é—®é¢˜éƒ½å¯ç”¨é€šè¿‡çŸ©é˜µè¿ç®—æ¥åœ†æ»¡åœ°ã€åŒæ—¶è§£å†³ã€‚ä¸ºäº†è¯´æ˜å¦‚ä½•ç”¨çŸ©é˜µè¿™ä¸ªå·¥å…·ç±»è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„ï¼Œè®©æˆ‘ä»¬å…ˆæ¥æ¥å›é¡¾ä¸€ä¸‹æˆ‘ä»¬åœ¨ä½™å¼¦å®šç†å’Œæ–°é—»åˆ†ç±»ä¸­ä»‹ç»çš„æ–¹æ³•ã€‚åˆ†ç±»çš„å…³é”®æ˜¯è®¡ç®—ç›¸å…³æ€§ã€‚æˆ‘ä»¬é¦–å…ˆå¯¹ä¸¤ä¸ªæ–‡æœ¬è®¡ç®—å‡ºå®ƒä»¬çš„å†…å®¹è¯ï¼Œæˆ–è€…è¯´å®è¯çš„å‘é‡ï¼Œç„¶åæ±‚è¿™ä¸¤ä¸ªå‘é‡çš„å¤¹è§’ã€‚å½“è¿™ä¸¤ä¸ªå‘é‡å¤¹è§’ä¸ºé›¶æ—¶ï¼Œæ–°é—»å°±ç›¸å…³ï¼›å½“å®ƒä»¬å‚ç›´æˆ–è€…è¯´æ­£äº¤æ—¶ï¼Œæ–°é—»åˆ™æ— å…³ã€‚å½“ç„¶ï¼Œå¤¹è§’çš„ä½™å¼¦ç­‰åŒäºå‘é‡çš„å†…ç§¯ã€‚ä»ç†è®ºä¸Šè®²ï¼Œè¿™ç§ç®—æ³•éå¸¸å¥½ã€‚ä½†æ˜¯è®¡ç®—æ—¶é—´ç‰¹åˆ«é•¿ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬è¦å¤„ç†çš„æ–‡ç« çš„æ•°é‡éƒ½å¾ˆå¤§ï¼Œè‡³å°‘åœ¨ç™¾ä¸‡ç¯‡ä»¥ä¸Šï¼ŒäºŒæ¬¡å›æ ‡æœ‰éå¸¸é•¿ï¼Œæ¯”å¦‚è¯´æœ‰äº”åä¸‡ä¸ªè¯ï¼ˆåŒ…æ‹¬äººååœ°åäº§å“åç§°ç­‰ç­‰ï¼‰ã€‚å¦‚æœæƒ³é€šè¿‡å¯¹ä¸€ç™¾ä¸‡ç¯‡æ–‡ç« ä¸¤ç¯‡ä¸¤ç¯‡åœ°æˆå¯¹æ¯”è¾ƒï¼Œæ¥æ‰¾å‡ºæ‰€æœ‰å…±åŒä¸»é¢˜çš„æ–‡ç« ï¼Œå°±è¦æ¯”è¾ƒäº”åƒäº¿å¯¹æ–‡ç« ã€‚ç°åœ¨çš„è®¡ç®—æœºä¸€ç§’é’Ÿæœ€å¤šå¯ä»¥æ¯”è¾ƒä¸€åƒå¯¹æ–‡ç« ï¼Œå®Œæˆè¿™ä¸€ç™¾ä¸‡ç¯‡æ–‡ç« ç›¸å…³æ€§æ¯”è¾ƒå°±éœ€è¦åäº”å¹´æ—¶é—´ã€‚æ³¨æ„ï¼Œè¦çœŸæ­£å®Œæˆæ–‡ç« çš„åˆ†ç±»è¿˜è¦åå¤é‡å¤ä¸Šè¿°è®¡ç®—ã€‚ çŸ©é˜µå¤„ç†åœ¨æ–‡æœ¬åˆ†ç±»ä¸­ï¼Œå¦ä¸€ç§åŠæ³•æ˜¯åˆ©ç”¨çŸ©é˜µè¿ç®—ä¸­çš„å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSingular Value Decompositionï¼Œç®€ç§° SVD)ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¥‡å¼‚å€¼åˆ†è§£æ˜¯æ€ä¹ˆå›äº‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå¤§çŸ©é˜µAæ¥æè¿°è¿™ä¸€ç™¾ä¸‡ç¯‡æ–‡ç« å’Œäº”åä¸‡è¯çš„å…³è”æ€§ã€‚è¿™ä¸ªçŸ©é˜µä¸­ï¼Œæ¯ä¸€è¡Œå¯¹åº”ä¸€ç¯‡æ–‡ç« ï¼Œæ¯ä¸€åˆ—å¯¹åº”ä¸€ä¸ªè¯ã€‚åœ¨ä¸Šé¢çš„å›¾ä¸­ï¼ŒM=1,000,000ï¼ŒN=500,000ã€‚ç¬¬ i è¡Œï¼Œç¬¬ j åˆ—çš„å…ƒç´ ï¼Œæ˜¯å­—å…¸ä¸­ç¬¬ j ä¸ªè¯åœ¨ç¬¬ i ç¯‡æ–‡ç« ä¸­å‡ºç°çš„åŠ æƒè¯é¢‘ï¼ˆæ¯”å¦‚ï¼ŒTF/IDF)ã€‚è¯»è€…å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œè¿™ä¸ªçŸ©é˜µéå¸¸å¤§ï¼Œæœ‰ä¸€ç™¾ä¸‡ä¹˜ä»¥äº”åä¸‡ï¼Œå³äº”åƒäº¿ä¸ªå…ƒç´ ã€‚å¥‡å¼‚å€¼åˆ†è§£å°±æ˜¯æŠŠä¸Šé¢è¿™æ ·ä¸€ä¸ªå¤§çŸ©é˜µï¼Œåˆ†è§£æˆä¸‰ä¸ªå°çŸ©é˜µç›¸ä¹˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ¯”å¦‚æŠŠä¸Šé¢çš„ä¾‹å­ä¸­çš„çŸ©é˜µåˆ†è§£æˆä¸€ä¸ªä¸€ç™¾ä¸‡ä¹˜ä»¥ä¸€ç™¾çš„çŸ©é˜µXï¼Œä¸€ä¸ªä¸€ç™¾ä¹˜ä»¥ä¸€ç™¾çš„çŸ©é˜µBï¼Œå’Œä¸€ä¸ªä¸€ç™¾ä¹˜ä»¥äº”åä¸‡çš„çŸ©é˜µYã€‚è¿™ä¸‰ä¸ªçŸ©é˜µçš„å…ƒç´ æ€»æ•°åŠ èµ·æ¥ä¹Ÿä¸è¿‡1.5äº¿ï¼Œä»…ä»…æ˜¯åŸæ¥çš„ä¸‰åƒåˆ†ä¹‹ä¸€ã€‚ç›¸åº”çš„å­˜å‚¨é‡å’Œè®¡ç®—é‡éƒ½ä¼šå°ä¸‰ä¸ªæ•°é‡çº§ä»¥ä¸Šã€‚ä¸‰ä¸ªçŸ©é˜µæœ‰éå¸¸æ¸…æ¥šçš„ç‰©ç†å«ä¹‰ã€‚ç¬¬ä¸€ä¸ªçŸ©é˜µXä¸­çš„æ¯ä¸€è¡Œè¡¨ç¤ºæ„æ€ç›¸å…³çš„ä¸€ç±»è¯ï¼Œå…¶ä¸­çš„æ¯ä¸ªéé›¶å…ƒç´ è¡¨ç¤ºè¿™ç±»è¯ä¸­æ¯ä¸ªè¯çš„é‡è¦æ€§ï¼ˆæˆ–è€…è¯´ç›¸å…³æ€§ï¼‰ï¼Œæ•°å€¼è¶Šå¤§è¶Šç›¸å…³ã€‚æœ€åä¸€ä¸ªçŸ©é˜µYä¸­çš„æ¯ä¸€åˆ—è¡¨ç¤ºåŒä¸€ä¸»é¢˜ä¸€ç±»æ–‡ç« ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ è¡¨ç¤ºè¿™ç±»æ–‡ç« ä¸­æ¯ç¯‡æ–‡ç« çš„ç›¸å…³æ€§ã€‚ä¸­é—´çš„çŸ©é˜µåˆ™è¡¨ç¤ºç±»è¯å’Œæ–‡ç« é›·ä¹‹é—´çš„ç›¸å…³æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªè¦å¯¹å…³è”çŸ©é˜µAè¿›è¡Œä¸€æ¬¡**å¥‡å¼‚å€¼åˆ†è§£**ï¼Œw æˆ‘ä»¬å°±å¯ä»¥åŒæ—¶å®Œæˆäº†è¿‘ä¹‰è¯åˆ†ç±»å’Œæ–‡ç« çš„åˆ†ç±»ã€‚ï¼ˆåŒæ—¶å¾—åˆ°æ¯ç±»æ–‡ç« å’Œæ¯ç±»è¯çš„ç›¸å…³æ€§ï¼‰ã€‚ç°åœ¨å‰©ä¸‹çš„å”¯ä¸€é—®é¢˜ï¼Œå°±æ˜¯å¦‚ä½•ç”¨è®¡ç®—æœºè¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£ã€‚è¿™æ—¶ï¼Œçº¿æ€§ä»£æ•°ä¸­çš„è®¸å¤šæ¦‚å¿µï¼Œæ¯”å¦‚çŸ©é˜µçš„ç‰¹å¾å€¼ç­‰ç­‰ï¼Œä»¥åŠæ•°å€¼åˆ†æçš„å„ç§ç®—æ³•å°±ç»Ÿç»Ÿç”¨ä¸Šäº†ã€‚åœ¨å¾ˆé•¿æ—¶é—´å†…ï¼Œå¥‡å¼‚å€¼åˆ†è§£éƒ½æ— æ³•å¹¶è¡Œå¤„ç†ã€‚ï¼ˆè™½ç„¶ Google æ—©å°±æœ‰äº†MapReduce ç­‰å¹¶è¡Œè®¡ç®—çš„å·¥å…·ï¼Œä½†æ˜¯ç”±äºå¥‡å¼‚å€¼åˆ†è§£å¾ˆéš¾æ‹†æˆä¸ç›¸å…³å­è¿ç®—ï¼Œå³ä½¿åœ¨ Google å†…éƒ¨ä»¥å‰ä¹Ÿæ— æ³•åˆ©ç”¨å¹¶è¡Œè®¡ç®—çš„ä¼˜åŠ¿æ¥åˆ†è§£çŸ©é˜µã€‚ï¼‰æœ€è¿‘ï¼ŒGoogle ä¸­å›½çš„å¼ æ™ºå¨åšå£«å’Œå‡ ä¸ªä¸­å›½çš„å·¥ç¨‹å¸ˆåŠå®ä¹ ç”Ÿå·²ç»å®ç°äº†å¥‡å¼‚å€¼åˆ†è§£çš„å¹¶è¡Œç®—æ³•ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ Google ä¸­å›½å¯¹ä¸–ç•Œçš„ä¸€ä¸ªè´¡çŒ®ã€‚åˆ©ç”¨ç›¸å¯¹ç†µï¼Œæˆ‘ä»¬å¯ä»¥åˆ°å¤„ä¿¡æ¯æ£€ç´¢ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼šè¯é¢‘ç‡-é€†å‘æ–‡æ¡£é¢‘ç‡ï¼ˆTF/IDF)ã€‚æˆ‘ä»¬ä¸‹å›ä¼šä»‹ç»å¦‚ä½•æ ¹æ®ç›¸å…³æ€§å¯¹æœç´¢å‡ºçš„ç½‘é¡µè¿›è¡Œæ’åºï¼Œå°±è¦ç”¨çš„é¤TF/IDF çš„æ¦‚å¿µã€‚å¦å¤–ï¼Œåœ¨æ–°é—»çš„åˆ†ç±»ä¸­ä¹Ÿè¦ç”¨åˆ°ç›¸å¯¹ç†µå’Œ TF/IDFã€‚åŸæ–‡é“¾æ¥ä¿¡æ¯ç†µ","categories":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"http://www.wortyby.com/categories/æ•°å­¦/"}],"tags":[{"name":"çº¿æ€§ä»£æ•°","slug":"çº¿æ€§ä»£æ•°","permalink":"http://www.wortyby.com/tags/çº¿æ€§ä»£æ•°/"},{"name":"åˆ†ç±»","slug":"åˆ†ç±»","permalink":"http://www.wortyby.com/tags/åˆ†ç±»/"}]},{"title":"é©¬å°”å¯å¤«é“¾çš„æ‰©å±• è´å¶æ–¯ç½‘ç»œ","slug":"é©¬å°”å¯å¤«é“¾çš„æ‰©å±• è´å¶æ–¯ç½‘ç»œ ","date":"2018-09-05T06:29:01.000Z","updated":"2018-09-05T06:29:01.000Z","comments":true,"path":"2018/09/05/é©¬å°”å¯å¤«é“¾çš„æ‰©å±• è´å¶æ–¯ç½‘ç»œ /","link":"","permalink":"http://www.wortyby.com/2018/09/05/é©¬å°”å¯å¤«é“¾çš„æ‰©å±• è´å¶æ–¯ç½‘ç»œ /","excerpt":"","text":"æˆ‘ä»¬åœ¨å‰é¢çš„ç³»åˆ—ä¸­å¤šæ¬¡æåˆ°é©¬å°”å¯å¤«é“¾ (MarkovChain)ï¼Œå®ƒæè¿°äº†ä¸€ç§çŠ¶æ€åºåˆ—ï¼Œå…¶æ¯ä¸ªçŠ¶æ€å€¼å–å†³äºå‰é¢æœ‰é™ä¸ªçŠ¶æ€ã€‚è¿™ç§æ¨¡å‹ï¼Œå¯¹å¾ˆå¤šå®é™…é—®é¢˜æ¥è®²æ˜¯ä¸€ç§å¾ˆç²—ç•¥çš„ç®€åŒ–ã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¾ˆå¤šäº‹ç‰©ç›¸äº’çš„å…³ç³»å¹¶ä¸èƒ½ç”¨ä¸€æ¡é“¾æ¥ä¸²èµ·æ¥ã€‚å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯èƒ½æ˜¯äº¤å‰çš„ã€é”™ç»¼å¤æ‚çš„ã€‚æ¯”å¦‚åœ¨ä¸‹å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¿ƒè¡€ç®¡ç–¾ç—…å’Œå®ƒçš„æˆå› ä¹‹é—´çš„å…³ç³»æ˜¯é”™ç»¼å¤æ‚çš„ã€‚æ˜¾ç„¶æ— æ³•ç”¨ä¸€ä¸ªé“¾æ¥è¡¨ç¤ºã€‚ ä¿¡å¿µç½‘ç»œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šè¿°çš„æœ‰å‘å›¾çœ‹æˆä¸€ä¸ªç½‘ç»œï¼Œå®ƒå°±æ˜¯**è´å¶æ–¯ç½‘ç»œã€‚å…¶ä¸­æ¯ä¸ªåœ†åœˆè¡¨ç¤ºä¸€ä¸ªçŠ¶æ€ã€‚çŠ¶æ€ä¹‹é—´çš„è¿çº¿è¡¨ç¤ºå®ƒä»¬çš„å› æœå…³ç³»ã€‚æ¯”å¦‚ä»å¿ƒè¡€ç®¡ç–¾ç—…å‡ºå‘åˆ°å¸çƒŸçš„å¼§çº¿è¡¨ç¤ºå¿ƒè¡€ç®¡ç–¾ç—…å¯èƒ½å’Œå¸çƒŸæœ‰å…³ã€‚å½“ç„¶ï¼Œè¿™äº›å…³ç³»å¯ä»¥æœ‰ä¸€ä¸ªé‡åŒ–çš„å¯ä¿¡åº¦ (belief)ï¼Œç”¨ä¸€ä¸ªæ¦‚ç‡æè¿°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·ä¸€å¼ ç½‘ç»œä¼°è®¡å‡ºä¸€ä¸ªäººçš„å¿ƒè¡€ç®¡ç–¾ç—…çš„å¯èƒ½æ€§ã€‚åœ¨ç½‘ç»œä¸­æ¯ä¸ªèŠ‚ç‚¹æ¦‚ç‡çš„è®¡ç®—ï¼Œå¯ä»¥ç”¨è´å¶æ–¯å…¬å¼æ¥è¿›è¡Œï¼Œè´å¶æ–¯ç½‘ç»œå› æ­¤è€Œå¾—åã€‚ç”±äºç½‘ç»œçš„æ¯ä¸ªå¼§æœ‰ä¸€ä¸ªå¯ä¿¡åº¦ï¼Œè´å¶æ–¯ç½‘ç»œä¹Ÿè¢«ç§°ä½œä¿¡å¿µç½‘ç»œ** (belief networks)ã€‚å’Œé©¬å°”å¯å¤«é“¾ç±»ä¼¼ï¼Œè´å¶æ–¯ç½‘ç»œä¸­çš„æ¯ä¸ªçŠ¶æ€å€¼å–å†³äºå‰é¢æœ‰é™ä¸ªçŠ¶æ€ã€‚ä¸åŒçš„æ˜¯ï¼Œè´å¶æ–¯ç½‘ç»œæ¯”é©¬å°”å¯å¤«é“¾çµæ´»ï¼Œå®ƒä¸å—é©¬å°”å¯å¤«é“¾çš„é“¾çŠ¶ç»“æ„çš„çº¦æŸï¼Œå› æ­¤å¯ä»¥æ›´å‡†ç¡®åœ°æè¿°äº‹ä»¶ä¹‹é—´çš„ç›¸å…³æ€§ã€‚å¯ä»¥è®²ï¼Œé©¬å°”å¯å¤«é“¾æ˜¯è´å¶æ–¯ç½‘ç»œçš„ç‰¹ä¾‹ï¼Œè€Œè´å¶æ–¯ç½‘ç»œæ˜¯é©¬å°”å¯å¤«é“¾çš„æ¨å¹¿ã€‚ è´å¶æ–¯ç½‘ç»œä¸é©¬å°”ç§‘å¤«é“¾çš„æ¯”è¾ƒä½¿ç”¨è´å¶æ–¯ç½‘ç»œå¿…é¡»çŸ¥é“å„ä¸ªçŠ¶æ€ä¹‹é—´ç›¸å…³çš„æ¦‚ç‡ã€‚å¾—åˆ°è¿™äº›å‚æ•°çš„è¿‡ç¨‹å«åšè®­ç»ƒã€‚å’Œè®­ç»ƒé©¬å°”å¯å¤«æ¨¡å‹ä¸€æ ·ï¼Œè®­ç»ƒè´å¶æ–¯ç½‘ç»œè¦ç”¨ä¸€äº›å·²çŸ¥çš„æ•°æ®ã€‚æ¯”å¦‚åœ¨è®­ç»ƒä¸Šé¢çš„ç½‘ç»œï¼Œéœ€è¦çŸ¥é“ä¸€äº›å¿ƒè¡€ç®¡ç–¾ç—…å’Œå¸çƒŸã€å®¶æ—ç—…å²ç­‰æœ‰å…³çš„æƒ…å†µã€‚ç›¸æ¯”é©¬å°”å¯å¤«é“¾ï¼Œè´å¶æ–¯ç½‘ç»œçš„è®­ç»ƒæ¯”è¾ƒå¤æ‚ï¼Œä»ç†è®ºä¸Šè®²ï¼Œå®ƒæ˜¯ä¸€ä¸ª NP-complete é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºç°åœ¨çš„è®¡ç®—æœºæ˜¯ä¸å¯è®¡ç®—çš„ã€‚ä½†æ˜¯ï¼Œå¯¹äºæŸäº›åº”ç”¨ï¼Œè¿™ä¸ªè®­ç»ƒè¿‡ç¨‹å¯ä»¥ç®€åŒ–ï¼Œå¹¶åœ¨è®¡ç®—ä¸Šå®ç°ã€‚ è´å¶æ–¯ç½‘ç»œçš„å·¥å…·ä¸åº”ç”¨å€¼å¾—ä¸€æçš„æ˜¯ IBM Watson ç ”ç©¶æ‰€çš„èŒ¨å¨æ ¼åšå£« (Geoffrey Zweig) å’Œè¥¿é›…å›¾åç››é¡¿å¤§å­¦çš„æ¯”å°”é»˜ (Jeff Bilmes) æ•™æˆå®Œæˆäº†ä¸€ä¸ªé€šç”¨çš„è´å¶æ–¯ç½‘ç»œçš„å·¥å…·åŒ…ï¼Œæä¾›ç»™å¯¹è´å¶æ–¯ç½‘ç»œæœ‰å…´è¶£çš„ç ”ç©¶è€…ã€‚è´å¶æ–¯ç½‘ç»œåœ¨å›¾åƒå¤„ç†ã€æ–‡å­—å¤„ç†ã€æ”¯æŒå†³ç­–ç­‰æ–¹é¢æœ‰å¾ˆå¤šåº”ç”¨ã€‚åœ¨æ–‡å­—å¤„ç†æ–¹é¢ï¼Œè¯­ä¹‰ç›¸è¿‘çš„è¯ä¹‹é—´çš„å…³ç³»å¯ä»¥ç”¨ä¸€ä¸ªè´å¶æ–¯ç½‘ç»œæ¥æè¿°ã€‚æˆ‘ä»¬åˆ©ç”¨è´å¶æ–¯ç½‘ç»œï¼Œå¯ä»¥æ‰¾å‡ºè¿‘ä¹‰è¯å’Œç›¸å…³çš„è¯ï¼Œåœ¨ Google æœç´¢å’Œ Google å¹¿å‘Šä¸­éƒ½æœ‰ç›´æ¥çš„åº”ç”¨ã€‚åŸæ–‡é“¾æ¥","categories":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"http://www.wortyby.com/categories/æ•°å­¦/"}],"tags":[{"name":"åˆ†ç±»","slug":"åˆ†ç±»","permalink":"http://www.wortyby.com/tags/åˆ†ç±»/"},{"name":"å›¾","slug":"å›¾","permalink":"http://www.wortyby.com/tags/å›¾/"}]},{"title":"PySpark åˆä½“éªŒä¹‹DataFrame","slug":"PySpark åˆä½“éªŒä¹‹DataFrame","date":"2018-09-04T11:47:24.000Z","updated":"2018-09-04T11:47:24.000Z","comments":true,"path":"2018/09/04/PySpark åˆä½“éªŒä¹‹DataFrame/","link":"","permalink":"http://www.wortyby.com/2018/09/04/PySpark åˆä½“éªŒä¹‹DataFrame/","excerpt":"","text":"##èƒŒæ™¯PySpark è¿›è¡Œæ•°æ®è¿ç®—çš„æ—¶å€™ï¼Œæœ‰2ä¸ªåŸºæœ¬æ¦‚å¿µæ˜¯éœ€è¦æˆ‘ä»¬é‡ç‚¹æŒæ¡çš„ã€‚åˆ†åˆ«æ˜¯DataFrameä¸RDD(Resilient Distributed DataSet)ï¼ŒRDD ä¸»è¦è´Ÿè´£æ•°æ®è®¡ç®—ï¼ŒDataFrame ä¸»è¦è´Ÿè´£æ•°æ®æ“ä½œã€‚ é‰´äºè¿™ç¯‡æ–‡ç« ä»‹ç»è¿‡RDDï¼Œæœ¬ç¯‡æ–‡ç« é‡ç‚¹ä»‹ç»DataFrameã€‚DataFrame æ˜¯ä¸€ä¸ªç»„ç»‡æˆå‘½ååˆ—çš„æ•°æ®é›†ã€‚å®ƒåœ¨æ¦‚å¿µä¸Šç­‰åŒäºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨æˆ–æ˜¯Python ä¸­çš„é‡Œçš„æ•°æ®æ¡†æ¶(pandas)ï¼Œä½†å…¶ç»è¿‡äº†ä¼˜åŒ–ã€‚DataFrames å¯ä»¥ä»å„ç§å„æ ·çš„æºæ„å»ºï¼Œä¾‹å¦‚ç»“æ„åŒ–æ•°æ®æ–‡ä»¶,Hive ä¸­çš„è¡¨,å¤–éƒ¨æ•°æ®åº“,RDD è½¬æ¢DataFrame API å¯ä»¥è¢«Scalaï¼ŒJavaï¼ŒPythonå’ŒRè°ƒç”¨ã€‚Python ä¸­ DataFrame ç”± Row çš„æ•°æ®é›†è¡¨ç¤º ã€‚ç”±äºæˆ‘ä»¬ç°åœ¨æ˜¯åœ¨PySpark çš„ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è°ˆè°ˆ DataFrame åœ¨ Python ä¸­çš„ä½¿ç”¨ã€‚æˆ–è®¸ä¹‹å‰äº†è§£è¿‡ pandas é‡Œçš„dataframe æ“ä½œï¼Œä¹Ÿå¯ä»¥å¯¹æ¯”ç€äº†è§£ï¼ŒåŒæ—¶ ä¹Ÿæ”¯æŒ PySpark DataFrame ä¸ pandas çš„ dataframe ä¹‹é—´çš„è½¬æ¢ã€‚è¯¥æ–‡å°†ä»¥ Sparkåˆå§‹åŒ–ï¼ŒDataFrame åˆå§‹åŒ–ï¼ŒDataFrame è¿ç®—ï¼ŒRDD ä¸ DataFrame è½¬åŒ–ï¼ŒDataFrame ä¸ pandas dataframe è½¬åŒ– å››ä¸ªéƒ¨åˆ†å±•å¼€ Spark åˆå§‹åŒ–ï¼šåœ¨ è¿›è¡Œ DataFrame æ“ä½œ çš„æ—¶å€™éœ€è¦å¯¹Spark ä¸Šä¸‹æ–‡ç¯å¢ƒè¿›è¡Œåˆå§‹åŒ–ï¼Œåœ¨PySpark ä¸­é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œåˆå§‹åŒ–SparkSession ä¸ SparkContext åˆå§‹åŒ–123456789from pyspark.sql import SparkSessionspark = SparkSession \\ .builder \\ .appName(&quot;RDD_and_DataFrame&quot;) \\ .config(&quot;spark.some.config.option&quot;, &quot;some-value&quot;) \\ .getOrCreate() sc = spark.sparkContextsparkContext åˆå§‹åŒ–ä¹‹åï¼Œéœ€è¦è¿›è¡Œæ•°æ®è¯»å–æ¥åˆå§‹åŒ–DataFrame DataFrame åˆå§‹åŒ–æˆ‘ä»¬ä»¥ä» txt æ–‡æ¡£è¯»å–æ•°æ®çš„æ–¹å¼æ¥åˆå§‹åŒ–DataFrame çš„ä¾‹å­æ¥è¯´æ˜ DataFrame çš„ç›¸å…³è¿ç®—æ–¹å¼ä»¥åŠç›¸å…³æ€§è´¨ åˆ›å»ºDataFrame ä»¥åŠ DataFrame ä¸ RDD çš„è½¬æ¢123456789101112131415161718192021 lines = sc.textFile(&quot;employee.txt&quot;)parts = lines.map(lambda l: l.split(&quot;,&quot;))employee = parts.map(lambda p: Row(name=p[0], salary=int(p[1]))) #RDDè½¬æ¢æˆDataFrameemployee_temp = spark.createDataFrame(employee) #æ˜¾ç¤ºDataFrameæ•°æ®employee_temp.show() #åˆ›å»ºè§†å›¾employee_temp.createOrReplaceTempView(&quot;employee&quot;)#è¿‡æ»¤æ•°æ®employee_result = spark.sql(&quot;SELECT name,salary FROM employee WHERE salary &gt;= 14000 AND salary &lt;= 20000&quot;) # DataFrameè½¬æ¢æˆRDDresult = employee_result.rdd.map(lambda p: &quot;name: &quot; + p.name + &quot; salary: &quot; + str(p.salary)).collect() #æ‰“å°RDDæ•°æ®for n in result:","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"DataFrame","slug":"DataFrame","permalink":"http://www.wortyby.com/tags/DataFrame/"},{"name":"SPARK","slug":"SPARK","permalink":"http://www.wortyby.com/tags/SPARK/"}]},{"title":"PySpark åˆä½“éªŒä¹‹RDD","slug":"PySpark åˆä½“éªŒä¹‹è¿ç®—è§„åˆ™","date":"2018-09-04T11:43:21.000Z","updated":"2018-09-04T11:43:21.000Z","comments":true,"path":"2018/09/04/PySpark åˆä½“éªŒä¹‹è¿ç®—è§„åˆ™/","link":"","permalink":"http://www.wortyby.com/2018/09/04/PySpark åˆä½“éªŒä¹‹è¿ç®—è§„åˆ™/","excerpt":"","text":"èƒŒæ™¯PySpark è¿›è¡Œæ•°æ®è¿ç®—çš„æ—¶å€™ï¼Œæœ‰2ä¸ªåŸºæœ¬æ¦‚å¿µæ˜¯éœ€è¦æˆ‘ä»¬é‡ç‚¹æŒæ¡çš„ã€‚åˆ†åˆ«æ˜¯DataFrameä¸RDD(Resilient Distributed DataSet)ï¼ŒRDD ä¸»è¦è´Ÿè´£æ•°æ®è®¡ç®—ï¼ŒDataFrame ä¸»è¦è´Ÿè´£æ•°æ®æ“ä½œã€‚ æœ¬æ–‡é‡ç‚¹ä»‹ç»RDDï¼Œä¸‹ç¯‡æ–‡ç« é‡ç‚¹ä»‹ç»DataFrameã€‚RDD å¯ä»¥å¯¼å…¥å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿçš„æ•°æ®é›†ï¼Œä¾‹å¦‚ï¼šHDFSï¼ŒHBASE æˆ–è€… æœ¬åœ°æ–‡ä»¶ *.JSON æˆ–è€…*.XML ç­‰æ•°æ®æºã€‚è¯¥æ–‡å°†ä»¥ SparkContextåˆå§‹åŒ–ï¼ŒRDD åˆå§‹åŒ–ï¼Œè¿ç®—ï¼ŒæŒä¹…åŒ– å››ä¸ªéƒ¨åˆ†å±•å¼€ SparkContext åˆå§‹åŒ–ï¼šåœ¨ è¿›è¡ŒRDD çš„æ—¶å€™éœ€è¦å¯¹Spark ä¸Šä¸‹æ–‡ç¯å¢ƒè¿›è¡Œåˆå§‹åŒ–ï¼Œåœ¨PySpark ä¸­é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œåˆå§‹åŒ–SparkContext123from pyspark import SparkConf, SparkContextconf = *** #sparkè¿è¡Œç¯å¢ƒçš„é…ç½®ä¿¡æ¯åˆå§‹åŒ–sc = SparkContext(conf)sparkContext åˆå§‹åŒ–ä¹‹åï¼Œéœ€è¦è¿›è¡Œæ•°æ®è¯»å–æ¥åˆå§‹åŒ–RDD RDD åˆå§‹åŒ–æˆ‘ä»¬ä»¥åˆå§‹åŒ–æ•°å­—å’Œå­—ç¬¦ä¸²çš„ä¾‹å­æ¥è¯´æ˜ RDDçš„ç›¸å…³è¿ç®—æ–¹å¼ä»¥åŠç›¸å…³æ€§è´¨ åˆ›å»ºRDD1kvRDD = sc.parallelize([(3, 4), (3, 6), (5, 6), (1, 2), (&apos;sd&apos;,3)]) RDD è½¬åŒ–ä¸º Python æ•°æ®ç±»å‹RDD ç±»å‹çš„æ•°æ®å¯ä»¥ä½¿ç”¨ collect æ–¹æ³•è½¬åŒ–ä¸º Python çš„æ•°æ®ç±»å‹:1print (kvRDD.collect())è¾“å‡ºä¸º1[(3, 4), (3, 6), (5, 6), (1, 2), (&apos;sd&apos;, 3)] RDD åŸºæœ¬è¿ç®— map è¿ç®—mapè¿ç®—å¯ä»¥é€šè¿‡ä¼ å…¥çš„å‡½æ•°ï¼Œå°†æ¯ä¸€ä¸ªå…ƒç´ ç»è¿‡å‡½æ•°è¿ç®—äº§ç”Ÿå¦å¤–ä¸€ä¸ªRDDã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­å°† value å€¼ç»Ÿä¸€åŠ  1ä¹‹åè¿›è¡Œè¿”å› å…³äº value çš„list ã€‚1print ((kvRDD.map(lambda x:x[1]+1).collect()))è¾“å‡ºä¸º1[5, 7, 7, 3, 4] filter è¿ç®—filterå¯ä»¥ç”¨äºå¯¹RDDå†…æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œç­›é€‰ï¼Œå¹¶äº§ç”Ÿå¦å¤–ä¸€ä¸ªRDDã€‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç­›é€‰kvRDDä¸­æ•°å­—å°äº3çš„å…ƒç´ ã€‚1print(kvRDD.filter(lambda a:a[0]&gt;3).collect())è¾“å‡ºä¸º1[(5, 6), (&apos;sd&apos;, 3)] distinct è¿ç®—distinctè¿ç®—ä¼šåˆ é™¤é‡å¤çš„å…ƒç´ ï¼šä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å»é™¤kvRDDä¸­é‡å¤çš„çš„å…ƒç´ ('sd',3)ã€‚12kvRDD = sc.parallelize([(3, 4), (3, 6), (5, 6), (1, 2), (&apos;sd&apos;,3),(&apos;sd&apos;,3)])print(kvRDD. distinct().collect())è¾“å‡ºä¸º1[(&apos;sd&apos;, 3), (5, 6), (1, 2), (3, 4), (3, 6)] randomSplit è¿ç®—randomSplit è¿ç®—å°†æ•´ä¸ªé›†åˆä»¥éšæœºæ•°çš„æ–¹å¼æŒ‰ç…§æ¯”ä¾‹åˆ†ä¸ºå¤šä¸ªRDDï¼Œæ¯”å¦‚æŒ‰ç…§0.4å’Œ0.6çš„æ¯”ä¾‹å°†kvRDDåˆ†ä¸ºä¸¤ä¸ªRDDï¼Œå¹¶è¾“å‡ºï¼š1234567kvRDD = sc.parallelize([(3, 4), (3, 6), (5, 6), (1, 2), (&apos;sd&apos;,3),(&apos;sd&apos;,3)])sRDD = kvRDD.randomSplit([0.4,0.6])print (len(sRDD))print (sRDD[0].collect())print (sRDD[1].collect())è¾“å‡ºä¸º1232[(5, 6), (1, 2)][(3, 4), (3, 6), (&apos;sd&apos;, 3), (&apos;sd&apos;, 3)] groupBy è¿ç®—groupByè¿ç®—å¯ä»¥æŒ‰ç…§ä¼ å…¥åŒ¿åå‡½æ•°çš„è§„åˆ™ï¼Œå°†æ•°æ®åˆ†ä¸ºå¤šä¸ªArrayã€‚123kvRDD = sc.parallelize([1,2,3,4,5])result = kvRDD.groupBy(lambda x: x % 2).collect()print(sorted([(x, sorted(y)) for (x, y) in result]))è¾“å‡ºä¸º1[(0, [2, 4]), (1, [1, 3, 5])] RDD å¤åˆè¿ç®—RDD ä¹Ÿæ”¯æŒæ‰§è¡Œå¤šä¸ªRDDçš„è¿ç®—,å³æ”¯æŒ å¤åˆè¿ç®—RDD å¤åˆè¿ç®—ä¸»è¦åŒ…å« å¹¶é›†è¿ç®—ã€äº¤é›†è¿ç®—ã€å·®é›†è¿ç®—ã€ç¬›å¡å°”ç§¯è¿ç®—å…ˆå‡†å¤‡ä¸‰ä¸ªDEMO RDD123RDD1 = sc.parallelize([3,1,2,5,5])RDD2 = sc.parallelize([5,6])RDD3 = sc.parallelize([2,7]) å¹¶é›†è¿ç®—é€šè¿‡ä½¿ç”¨ union å‡½æ•°è¿›è¡Œå¹¶é›†è¿ç®—:è¾“å…¥1print(RDD1.union(RDD2).union(RDD3).collect())è¾“å‡º1[3, 1, 2, 5, 5, 5, 6, 2, 7] äº¤é›†è¿ç®—å¯ä»¥ä½¿ç”¨intersectionè¿›è¡Œäº¤é›†è¿ç®—ï¼šè¾“å…¥1print(RDD1.intersection(RDD3).collect())è¾“å‡º1[2] å·®é›†è¿ç®—å¯ä»¥ä½¿ç”¨subtractå‡½æ•°è¿›è¡Œå·®é›†è¿ç®—:è¾“å…¥1print (RDD1.subtract(RDD2).collect())ç”±äºä¸¤ä¸ªRDDçš„é‡å¤éƒ¨åˆ†ä¸º5ï¼Œæ‰€ä»¥è¾“å‡ºä¸º[1,2,3]:è¾“å‡º1[1,2,3] ç¬›å¡å°”ç§¯è¿ç®—å¯ä»¥ä½¿ç”¨cartesianå‡½æ•°è¿›è¡Œç¬›å¡å°”ä¹˜ç§¯è¿ç®—:è¾“å…¥1print (RDD1.cartesian(RDD2).collect())ç”±äºä¸¤ä¸ªRDDåˆ†åˆ«æœ‰5ä¸ªå…ƒç´ å’Œ2ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥è¿”å›ç»“æœæœ‰10å„å…ƒç´ ï¼šè¾“å‡º1[(3, 5), (3, 6), (1, 5), (1, 6), (2, 5), (2, 6), (5, 5), (5, 5), (5, 6), (5, 6)] RDD åŸºæœ¬ â€œåŠ¨ä½œâ€ è¿ç®— è¯»å–å…ƒç´ å¯ä»¥ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤è¯»å–RDDå†…çš„å…ƒç´ ï¼Œè¿™æ˜¯Actionsè¿ç®—ï¼Œæ‰€ä»¥ä¼šé©¬ä¸Šæ‰§è¡Œï¼š12345678#å–ç¬¬ä¸€æ¡æ•°æ®print (RDD1.first())#å–å‰ä¸¤æ¡æ•°æ®print (RDD1.take(2))#å‡åºæ’åˆ—ï¼Œå¹¶å–å‰3æ¡æ•°æ®print (RDD1.takeOrdered(10))#é™åºæ’åˆ—ï¼Œå¹¶å–å‰3æ¡æ•°æ®print (RDD1.takeOrdered(3,lambda x:-x))è¾“å‡ºä¸º:12343[3, 1][1, 2, 3, 5, 5][5, 5, 3] ç»Ÿè®¡åŠŸèƒ½å¯ä»¥å°†RDDå†…çš„å…ƒç´ è¿›è¡Œç»Ÿè®¡è¿ç®—ï¼š1234567891011121314#ç»Ÿè®¡print (RDD1.stats())#æœ€å°å€¼print (RDD1.min())#æœ€å¤§å€¼print (RDD1.max())#æ ‡å‡†å·®print (RDD1.stdev())#è®¡æ•°print (RDD1.count())#æ±‚å’Œprint (RDD1.sum())#å¹³å‡print (RDD1.mean())è¾“å‡ºä¸º:1234567(count: 5, mean: 3.2, stdev: 1.6, max: 5.0, min: 1.0)151.65163.2 RDD key-Value åŸºæœ¬ â€œè½¬æ¢â€ è¿ç®—Spark RDDæ”¯æŒé”®å€¼å¯¹è¿ç®—ï¼ŒKey-Valueè¿ç®—æ˜¯ MR*(mapreduce)*è¿ç®—çš„åŸºç¡€ï¼Œæœ¬èŠ‚ä»‹ç»RDDé”®å€¼çš„åŸºæœ¬â€œè½¬æ¢â€è¿ç®—ã€‚ åˆå§‹åŒ–æˆ‘ä»¬ç”¨å…ƒç´ ç±»å‹ä¸ºtupleå…ƒç»„çš„æ•°ç»„åˆå§‹åŒ–æˆ‘ä»¬çš„RDDï¼Œè¿™é‡Œï¼Œæ¯ä¸ªtupleçš„ç¬¬ä¸€ä¸ªå€¼å°†ä½œä¸ºé”®ï¼Œè€Œç¬¬äºŒä¸ªå…ƒç´ å°†ä½œä¸ºå€¼ã€‚1kvRDD1 = sc.parallelize([(3,4),(3,6),(5,6),(1,2)]) å¾—åˆ°keyå’Œvalueå€¼å¯ä»¥ä½¿ç”¨keyså’Œvalueså‡½æ•°åˆ†åˆ«å¾—åˆ°RDDçš„é”®æ•°ç»„å’Œå€¼æ•°ç»„ï¼š12print (kvRDD1.keys().collect())print (kvRDD1.values().collect())è¾“å‡ºä¸ºï¼š12[3, 3, 5, 1][4, 6, 6, 2] ç­›é€‰å…ƒç´ å¯ä»¥æŒ‰ç…§é”®è¿›è¡Œå…ƒç´ ç­›é€‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å€¼è¿›è¡Œå…ƒç´ ç­›é€‰ï¼Œå’Œä¹‹å‰çš„ä¸€æ ·ï¼Œä½¿ç”¨filterå‡½æ•°ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶RDDä¸­æ˜¯ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªäºŒå…ƒç»„ï¼ŒäºŒå…ƒç»„çš„ç¬¬ä¸€ä¸ªå€¼ä»£è¡¨é”®ï¼Œç¬¬äºŒä¸ªå€¼ä»£è¡¨å€¼ï¼Œæ‰€ä»¥æŒ‰ç…§å¦‚ä¸‹çš„ä»£ç æ—¢å¯ä»¥æŒ‰ç…§é”®è¿›è¡Œç­›é€‰ï¼Œæˆ‘ä»¬ç­›é€‰é”®å€¼å°äº5çš„æ•°æ®ï¼š1print (kvRDD1.filter(lambda x:x[0] &lt; 5).collect())è¾“å‡ºä¸ºï¼š1[(3, 4), (3, 6), (1, 2)]åŒæ ·ï¼Œå°†x[0]æ›¿æ¢ä¸ºx[1]å°±æ˜¯æŒ‰ç…§å€¼è¿›è¡Œç­›é€‰ï¼Œæˆ‘ä»¬ç­›é€‰å€¼å°äº5çš„æ•°æ®ï¼š1print (kvRDD1.filter(lambda x:x[1] &lt; 5).collect())è¾“å‡ºä¸ºï¼š1[(3, 4), (1, 2)] å€¼è¿ç®—æˆ‘ä»¬å¯ä»¥ä½¿ç”¨mapValuesæ–¹æ³•å¤„ç†valueå€¼ï¼Œä¸‹é¢çš„ä»£ç å°†valueå€¼è¿›è¡Œäº†å¹³æ–¹å¤„ç†ï¼š1print (kvRDD1.mapValues(lambda x:x**2).collect())è¾“å‡ºä¸ºï¼š1[(3, 16), (3, 36), (5, 36), (1, 4)] æŒ‰ç…§keyæ’åºå¯ä»¥ä½¿ç”¨sortByKeyæŒ‰ç…§keyè¿›è¡Œæ’åºï¼Œä¼ å…¥å‚æ•°çš„é»˜è®¤å€¼ä¸ºtrueï¼Œæ˜¯æŒ‰ç…§ä»å°åˆ°å¤§æ’åºï¼Œä¹Ÿå¯ä»¥ä¼ å…¥å‚æ•°falseï¼Œè¡¨ç¤ºä»å¤§åˆ°å°æ’åºï¼š123print (kvRDD1.sortByKey().collect())print (kvRDD1.sortByKey(True).collect())print (kvRDD1.sortByKey(False).collect())è¾“å‡ºä¸ºï¼š123[(1, 2), (3, 4), (3, 6), (5, 6)][(1, 2), (3, 4), (3, 6), (5, 6)][(5, 6), (3, 4), (3, 6), (1, 2)] åˆå¹¶ç›¸åŒkeyå€¼çš„æ•°æ®ä½¿ç”¨reduceByKeyå‡½æ•°å¯ä»¥å¯¹å…·æœ‰ç›¸åŒkeyå€¼çš„æ•°æ®è¿›è¡Œåˆå¹¶ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼Œç”±äºRDDä¸­å­˜åœ¨ï¼ˆ3,4ï¼‰å’Œï¼ˆ3,6ï¼‰ä¸¤æ¡keyå€¼å‡ä¸º3çš„æ•°æ®ï¼Œä»–ä»¬å°†è¢«åˆä¸ºä¸€æ¡æ•°æ®ï¼š1print (kvRDD1.reduceByKey(lambda x,y:x+y).collect())è¾“å‡ºä¸º1[(1, 2), (3, 10), (5, 6)] å¤šä¸ªRDD Key-Valueâ€œè½¬æ¢â€è¿ç®— åˆå§‹åŒ–é¦–å…ˆæˆ‘ä»¬åˆå§‹åŒ–ä¸¤ä¸ªk-vçš„RDDï¼š12kvRDD1 = sc.parallelize([(3,4),(3,6),(5,6),(1,2)])kvRDD2 = sc.parallelize([(3,8)]) å†…è¿æ¥è¿ç®—joinè¿ç®—å¯ä»¥å®ç°ç±»ä¼¼æ•°æ®åº“çš„å†…è¿æ¥ï¼Œå°†ä¸¤ä¸ªRDDæŒ‰ç…§ç›¸åŒçš„keyå€¼joinèµ·æ¥ï¼ŒkvRDD1ä¸kvRDD2çš„keyå€¼å”¯ä¸€ç›¸åŒçš„æ˜¯3ï¼ŒkvRDD1ä¸­æœ‰ä¸¤æ¡keyå€¼ä¸º3çš„æ•°æ®ï¼ˆ3,4ï¼‰å’Œï¼ˆ3,6ï¼‰ï¼Œè€ŒkvRDD2ä¸­åªæœ‰ä¸€æ¡keyå€¼ä¸º3çš„æ•°æ®ï¼ˆ3,8ï¼‰ï¼Œæ‰€ä»¥joinçš„ç»“æœæ˜¯ï¼ˆ3ï¼Œï¼ˆ4,8ï¼‰ï¼‰ å’Œï¼ˆ3ï¼Œï¼ˆ6ï¼Œ8ï¼‰ï¼‰ï¼š1print (kvRDD1.join(kvRDD2).collect())è¾“å‡ºä¸º:1[(3, (4, 8)), (3, (6, 8))] å·¦å¤–è¿æ¥ä½¿ç”¨leftOuterJoinå¯ä»¥å®ç°ç±»ä¼¼æ•°æ®åº“çš„å·¦å¤–è¿æ¥ï¼Œå¦‚æœkvRDD1çš„keyå€¼å¯¹åº”ä¸åˆ°kvRDD2ï¼Œå°±ä¼šæ˜¾ç¤ºNone1print (kvRDD1.leftOuterJoin(kvRDD2).collect())è¾“å‡ºä¸º:1[(1, (2, None)), (3, (4, 8)), (3, (6, 8)), (5, (6, None))] å³å¤–è¿æ¥ä½¿ç”¨rightOuterJoinå¯ä»¥å®ç°ç±»ä¼¼æ•°æ®åº“çš„å³å¤–è¿æ¥ï¼Œå¦‚æœkvRDD2çš„keyå€¼å¯¹åº”ä¸åˆ°kvRDD1ï¼Œå°±ä¼šæ˜¾ç¤ºNone1print (kvRDD1.rightOuterJoin(kvRDD2).collect())è¾“å‡ºä¸ºï¼š1[(3, (4, 8)), (3, (6, 8))] åˆ é™¤ç›¸åŒkeyå€¼æ•°æ®ä½¿ç”¨subtractByKeyè¿ç®—ä¼šåˆ é™¤ç›¸åŒkeyå€¼å¾—æ•°æ®ï¼š1print (kvRDD1.subtractByKey(kvRDD2).collect())ç»“æœä¸ºï¼š1[(1, 2), (5, 6)] Key-Valueâ€œåŠ¨ä½œâ€è¿ç®— è¯»å–æ•°æ®å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡ ç§æ–¹å¼è¯»å–RDDçš„æ•°æ®ï¼š1234567891011121314#è¯»å–ç¬¬ä¸€æ¡æ•°æ®print (kvRDD1.first())#è¯»å–å‰ä¸¤æ¡æ•°æ®print (kvRDD1.take(2))#è¯»å–ç¬¬ä¸€æ¡æ•°æ®çš„keyå€¼print (kvRDD1.first()[0])#è¯»å–ç¬¬ä¸€æ¡æ•°æ®çš„valueå€¼print (kvRDD1.first()[1])è¾“å‡ºä¸º:(3, 4)[(3, 4), (3, 6)]34 æŒ‰keyå€¼ç»Ÿè®¡ï¼šä½¿ç”¨countByKeyå‡½æ•°å¯ä»¥ç»Ÿè®¡å„ä¸ªkeyå€¼å¯¹åº”çš„æ•°æ®çš„æ¡æ•°ï¼š1print (kvRDD1.countByKey().collect())è¾“å‡ºä¸ºï¼š1defaultdict(&lt;type &apos;int&apos;&gt;, &#123;1: 1, 3: 2, 5: 1&#125;) lookupæŸ¥æ‰¾è¿ç®—ä½¿ç”¨lookupå‡½æ•°å¯ä»¥æ ¹æ®è¾“å…¥çš„keyå€¼æ¥æŸ¥æ‰¾å¯¹åº”çš„Valueå€¼ï¼š1print (kvRDD1.lookup(3))è¾“å‡ºä¸ºï¼š1[4, 6] æŒä¹…åŒ–æ“ä½œspark RDDçš„æŒä¹…åŒ–æœºåˆ¶ï¼Œå¯ä»¥å°†éœ€è¦é‡å¤è¿ç®—çš„RDDå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä»¥ä¾¿å¤§å¹…æå‡è¿ç®—æ•ˆç‡ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„å‡½æ•°ï¼šæŒä¹…åŒ–ä½¿ç”¨persistå‡½æ•°å¯¹RDDè¿›è¡ŒæŒä¹…åŒ–ï¼š1kvRDD1.persist()åœ¨æŒä¹…åŒ–çš„åŒæ—¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šæŒä¹…åŒ–å­˜å‚¨ç­‰çº§ï¼šç­‰çº§è¯´æ˜MEMORY_ONLYä»¥ååºåˆ—åŒ–çš„JAVAå¯¹è±¡çš„æ–¹å¼å­˜å‚¨åœ¨JVMä¸­. å¦‚æœå†…å­˜ä¸å¤Ÿï¼Œ RDDçš„ä¸€äº›åˆ†åŒºå°†ä¸ä¼šè¢«ç¼“å­˜ï¼Œ è¿™æ ·å½“å†æ¬¡éœ€è¦è¿™äº›åˆ†åŒºçš„æ—¶å€™ï¼Œå°†ä¼šé‡æ–°è®¡ç®—ã€‚è¿™æ˜¯é»˜è®¤çš„çº§åˆ«ã€‚MEMORY_AND_DISKä»¥ååºåˆ—åŒ–çš„JAVAå¯¹è±¡çš„æ–¹å¼å­˜å‚¨åœ¨JVMä¸­. å¦‚æœå†…å­˜ä¸å¤Ÿï¼Œ RDDçš„ä¸€äº›åˆ†åŒºå°†å°†ä¼šç¼“å­˜åœ¨ç£ç›˜ä¸Šï¼Œå†æ¬¡éœ€è¦çš„æ—¶å€™ä»ç£ç›˜è¯»å–ã€‚MEMORY_ONLY_SERä»¥åºåˆ—åŒ–JAVAå¯¹è±¡çš„æ–¹å¼å­˜å‚¨ (æ¯ä¸ªåˆ†åŒºä¸€ä¸ªå­—èŠ‚æ•°ç»„). ç›¸æ¯”äºååºåˆ—åŒ–çš„æ–¹å¼,è¿™æ ·æ›´é«˜æ•ˆçš„åˆ©ç”¨ç©ºé—´ï¼Œ å°¤å…¶æ˜¯ä½¿ç”¨å¿«é€Ÿåºåˆ—åŒ–æ—¶ã€‚ä½†æ˜¯è¯»å–æ˜¯CPUæ“ä½œå¾ˆå¯†é›†ã€‚MEMORY_AND_DISK_SERä¸MEMORY_ONLY_SERç›¸ä¼¼, åŒºåˆ«æ˜¯ä½†å†…å­˜ä¸è¶³æ—¶ï¼Œå­˜å‚¨åœ¨ç£ç›˜ä¸Šè€Œä¸æ˜¯æ¯æ¬¡é‡æ–°è®¡ç®—ã€‚DISK_ONLYåªå­˜å‚¨RDDåœ¨ç£ç›˜MEMORY_ONLY_2, MEMORY_AND_DISK_2, etc.ä¸ä¸Šé¢çš„çº§åˆ«ç›¸åŒï¼Œåªä¸è¿‡æ¯ä¸ªåˆ†åŒºçš„å‰¯æœ¬åªå­˜å‚¨åœ¨ä¸¤ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šã€‚OFF_HEAP (experimental)å°†RDDä»¥åºåˆ—åŒ–çš„æ–¹å¼å­˜å‚¨åœ¨ Tachyon. ä¸ MEMORY_ONLY_SERç›¸æ¯”, OFF_HEAPå‡å°‘äº†åƒåœ¾å›æ”¶ã€‚å…è®¸æ‰§è¡Œä½“æ›´å°é€šè¿‡å…±äº«ä¸€ä¸ªå†…å­˜æ± ã€‚å› æ­¤å¯¹äºæ‹¥æœ‰è¾ƒå¤§å †å†…å­˜å’Œé«˜å¹¶å‘çš„ç¯å¢ƒæœ‰è¾ƒå¤§çš„å¸å¼•åŠ›ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå› ä¸ºRDDå­˜å‚¨åœ¨Tachyonä¸Šï¼Œæ‰§è¡Œä½“çš„å´©æºƒä¸ä¼šé€ æˆç¼“å­˜çš„ä¸¢å¤±ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹.Tachyonä¸­çš„å†…å­˜æ˜¯å¯ä¸¢å¼ƒçš„ï¼Œè¿™æ · Tachyon å¯¹äºä»å†…å­˜ä¸­æŒ¤å‡ºçš„å—ä¸ä¼šè¯•å›¾é‡å»ºå®ƒã€‚å¦‚æœä½ æ‰“ç®—ä½¿ç”¨Tachyonä½œä¸ºå †ç¼“å­˜ï¼ŒSparkæä¾›äº†ä¸Tachyonç›¸å…¼å®¹çš„ç‰ˆæœ¬ã€‚é¦–å…ˆæˆ‘ä»¬å¯¼å…¥ç›¸å…³å‡½æ•°ï¼š1from pyspark.storagelevel import StorageLevelåœ¨scalaä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸Šè¿°çš„æŒä¹…åŒ–ç­‰çº§å…³é”®è¯ï¼Œä½†æ˜¯åœ¨pysparkä¸­å°è£…ä¸ºäº†ä¸€ä¸ªç±»ï¼ŒStorageLevelç±»ï¼Œå¹¶åœ¨åˆå§‹åŒ–æ—¶æŒ‡å®šä¸€äº›å‚æ•°ï¼Œé€šè¿‡ä¸åŒçš„å‚æ•°ç»„åˆï¼Œå¯ä»¥å®ç°ä¸Šé¢çš„ä¸åŒå­˜å‚¨ç­‰çº§ã€‚StorageLevelç±»çš„åˆå§‹åŒ–å‡½æ•°å¦‚ä¸‹ï¼š123456def __init__(self, useDisk, useMemory, useOffHeap, deserialized, replication=1): self.useDisk = useDisk self.useMemory = useMemory self.useOffHeap = useOffHeap self.deserialized = deserialized self.replication = replicationé‚£ä¹ˆä¸åŒçš„å­˜å‚¨ç­‰çº§å¯¹åº”çš„å‚æ•°ä¸º:1234567891011121314151617181920StorageLevel.DISK_ONLY = StorageLevel(True, False, False, False)StorageLevel.DISK_ONLY_2 = StorageLevel(True, False, False, False, 2)StorageLevel.MEMORY_ONLY = StorageLevel(False, True, False, False)StorageLevel.MEMORY_ONLY_2 = StorageLevel(False, True, False, False, 2)StorageLevel.MEMORY_AND_DISK = StorageLevel(True, True, False, False)StorageLevel.MEMORY_AND_DISK_2 = StorageLevel(True, True, False, False, 2)StorageLevel.OFF_HEAP = StorageLevel(True, True, True, False, 1)&quot;&quot;&quot;.. note:: The following four storage level constants are deprecated in 2.0, since the records \\will always be serialized in Python.&quot;&quot;&quot;StorageLevel.MEMORY_ONLY_SER = StorageLevel.MEMORY_ONLY&quot;&quot;&quot;.. note:: Deprecated in 2.0, use ``StorageLevel.MEMORY_ONLY`` instead.&quot;&quot;&quot;StorageLevel.MEMORY_ONLY_SER_2 = StorageLevel.MEMORY_ONLY_2&quot;&quot;&quot;.. note:: Deprecated in 2.0, use ``StorageLevel.MEMORY_ONLY_2`` instead.&quot;&quot;&quot;StorageLevel.MEMORY_AND_DISK_SER = StorageLevel.MEMORY_AND_DISK&quot;&quot;&quot;.. note:: Deprecated in 2.0, use ``StorageLevel.MEMORY_AND_DISK`` instead.&quot;&quot;&quot;StorageLevel.MEMORY_AND_DISK_SER_2 = StorageLevel.MEMORY_AND_DISK_2&quot;&quot;&quot;.. note:: Deprecated in 2.0, use ``StorageLevel.MEMORY_AND_DISK_2`` instead.&quot;&quot;&quot; å–æ¶ˆæŒä¹…åŒ–ä½¿ç”¨unpersistå‡½æ•°å¯¹RDDè¿›è¡ŒæŒä¹…åŒ–ï¼š1kvRDD1.unpersist() ç»¼ä¸Šæ‰€è¿°:å“‡ï¼Œæœ‰å…³pysparkçš„RDDçš„åŸºæœ¬æ“ä½œå°±æ˜¯ä¸Šé¢è¿™äº›å•¦ï¼Œæƒ³è¦äº†è§£æ›´å¤šçš„ç›†å‹ä»¬å¯ä»¥å‚ç…§å®˜ç½‘ç»™å‡ºçš„å®˜æ–¹æ–‡æ¡£ä»Šå¤©ä¸»è¦ä»‹ç»äº†ä¸¤ç§RDDï¼ŒåŸºæœ¬çš„RDDå’ŒKey-Valueå½¢å¼çš„RDDï¼Œä»‹ç»äº†ä»–ä»¬çš„å‡ ç§â€œè½¬æ¢â€è¿ç®—å’Œâ€œåŠ¨ä½œâ€è¿ç®—ï¼Œæ•´ç†å¦‚ä¸‹ï¼šRDDè¿ç®—è¯´æ˜åŸºæœ¬RDDâ€œè½¬æ¢â€è¿ç®—mapï¼ˆå¯¹å„æ•°æ®è¿›è¡Œè½¬æ¢ï¼‰ï¼Œfilterï¼ˆè¿‡æ»¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼‰ï¼Œdistinctï¼ˆå»é‡è¿ç®—ï¼‰ï¼ŒrandomSplitï¼ˆæ ¹æ®æŒ‡å®šçš„æ¯”ä¾‹éšæœºåˆ†ä¸ºNå„RDDï¼‰ï¼ŒgroupByï¼ˆæ ¹æ®æ¡ä»¶å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼‰ï¼Œunionï¼ˆä¸¤ä¸ªRDDå–å¹¶é›†ï¼‰ï¼Œintersectionï¼ˆä¸¤ä¸ªRDDå–äº¤é›†ï¼‰ï¼Œsubtractï¼ˆä¸¤ä¸ªRDDå–å·®é›†ï¼‰ã€‚cartesianï¼ˆä¸¤ä¸ªRDDè¿›è¡Œç¬›å¡å°”ç§¯è¿ç®—ï¼‰åŸºæœ¬RDDâ€œåŠ¨ä½œâ€è¿ç®—firstï¼ˆå–ç¬¬ä¸€æ¡æ•°æ®ï¼‰ï¼Œtakeï¼ˆå–å‰å‡ æ¡æ•°æ®ï¼‰ï¼ŒtakeOrderedï¼ˆæ’åºåå–å‰Næ¡æ•°æ®ï¼‰ï¼Œç»Ÿè®¡å‡½æ•°Key-Valueå½¢å¼ RDDâ€œè½¬æ¢â€è¿ç®—filterï¼ˆè¿‡æ»¤ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼‰ï¼ŒmapValuesï¼ˆå¯¹valueå€¼è¿›è¡Œè½¬æ¢ï¼‰ï¼ŒsortByKeyï¼ˆæ ¹æ®keyå€¼è¿›è¡Œæ’åºï¼‰ï¼ŒreduceByKeyï¼ˆåˆå¹¶ç›¸åŒkeyå€¼çš„æ•°æ®ï¼‰ï¼Œjoinï¼ˆå†…è¿æ¥ä¸¤ä¸ªKDDï¼‰ï¼ŒleftOuterJoinï¼ˆå·¦å¤–è¿æ¥ä¸¤ä¸ªKDDï¼‰ï¼ŒrightOuterJoinï¼ˆå³å¤–è¿æ¥ä¸¤ä¸ªRDDï¼‰ï¼ŒsubtractByKeyï¼ˆç›¸å½“äºkeyå€¼å¾—å·®é›†è¿ç®—ï¼‰Key-Valueå½¢å¼ RDDâ€œåŠ¨ä½œâ€è¿ç®—firstï¼ˆå–ç¬¬ä¸€æ¡æ•°æ®ï¼‰ï¼Œtakeï¼ˆå–å‰å‡ æ¡æ•°æ®ï¼‰ï¼ŒcountByKeyï¼ˆæ ¹æ®keyå€¼åˆ†ç»„ç»Ÿè®¡ï¼‰ï¼Œlookupï¼ˆæ ¹æ®keyå€¼æŸ¥æ‰¾valueå€¼ï¼‰RDDæŒä¹…åŒ–persistç”¨äºå¯¹RDDè¿›è¡ŒæŒä¹…åŒ–ï¼Œunpersistå–æ¶ˆRDDçš„æŒä¹…åŒ–ï¼Œæ³¨æ„æŒä¹…åŒ–çš„å­˜å‚¨ç­‰çº§","categories":[{"name":"å¤§æ•°æ®","slug":"å¤§æ•°æ®","permalink":"http://www.wortyby.com/categories/å¤§æ•°æ®/"}],"tags":[{"name":"SPARK","slug":"SPARK","permalink":"http://www.wortyby.com/tags/SPARK/"},{"name":"RDD","slug":"RDD","permalink":"http://www.wortyby.com/tags/RDD/"}]},{"title":"tmpwatch å·¥å…·ä½¿ç”¨è¯´æ˜","slug":"tmpwatch å·¥å…·ä½¿ç”¨è¯´æ˜","date":"2018-08-31T09:14:56.000Z","updated":"2018-08-31T09:14:56.000Z","comments":true,"path":"2018/08/31/tmpwatch å·¥å…·ä½¿ç”¨è¯´æ˜/","link":"","permalink":"http://www.wortyby.com/2018/08/31/tmpwatch å·¥å…·ä½¿ç”¨è¯´æ˜/","excerpt":"","text":"èƒŒæ™¯tmp ç›®å½•åŸæ¥åªæœ‰åœ¨å¯åŠ¨çš„æ—¶å€™æ‰ä¼šè¢«æ¸…ç†â€¦â€¦ ä¸åŒçš„ Linux å‘è¡Œç‰ˆå…¶å®å¯¹ /tmp ç›®å½•çš„æ¸…ç†æ–¹å¼æœ‰æ‰€ä¸åŒï¼šåœ¨ Debian-like çš„ç³»ç»Ÿï¼Œå¯åŠ¨çš„æ—¶å€™æ‰ä¼šæ¸…ç† (è§„åˆ™å®šä¹‰åœ¨ /etc/default/rcS)åœ¨ RedHat-like çš„ç³»ç»Ÿï¼ŒæŒ‰æ–‡ä»¶å­˜åœ¨æ—¶é—´å®šæ—¶æ¸…ç† (RHEL6 è§„åˆ™å®šä¹‰åœ¨ /etc/cron.daily/tmpwatch; RHEL7 ä»¥åŠ RedHat-like with systemd è§„åˆ™å®šä¹‰åœ¨ /usr/lib/tmpfiles.d/tmp.conf, é€šè¿‡ systemd-tmpfiles-clean.service æœåŠ¡è°ƒç”¨)åœ¨ CentOS é‡Œï¼Œä¹Ÿæ˜¯æŒ‰æ–‡ä»¶å­˜åœ¨æ—¶é—´æ¸…ç†çš„ (é€šè¿‡ crontab çš„é…ç½® /etc/cron.daily å®šæ—¶æ‰§è¡Œ tmpwatch æ¥å®ç°)åœ¨ Gentoo é‡Œä¹Ÿæ˜¯å¯åŠ¨æ¸…ç†ï¼Œè§„åˆ™å®šä¹‰åœ¨ /etc/conf.d/bootmiscï¼Œå¤§ Gentoo å°±æ˜¯ä¸èµ°å¯»å¸¸è·¯å¯¹äºé‚£äº›åªèƒ½å¼€æœºæ¸…ç†ä¸´æ—¶æ–‡ä»¶çš„å‘è¡Œç‰ˆï¼Œå¦‚æœä½œä¸ºæœåŠ¡å™¨ï¼Œè¿™ç§ä¸é‡å¯å°±å¯¹ä¸´æ—¶æ–‡ä»¶ç›®å½•çš„åƒåœ¾ä¸é—®ä¸ç®¡çš„åšäº‹é£æ ¼å®åœ¨æ˜¯å¾ˆä¸é è°±ã€‚ä¸è¿‡ä»ä¸Šé¢å…¶ä»–å‘è¡Œç‰ˆå¤§å®¶ä¼°è®¡ä¹Ÿä¼šå‘ç°ï¼Œè§£å†³æ­¤é—®é¢˜çš„å…³é”®å°±åœ¨äº tmpwatch å’Œå®šæ—¶ä»»åŠ¡çš„é…åˆä½¿ç”¨ã€‚ æœåŠ¡å™¨é™¤äº†è°ƒç”¨ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡å¤–ï¼Œè¿˜ä¼šæ‰§è¡Œç³»ç»Ÿè‡ªå·±çš„ï¼Œæ¯”å¦‚ï¼š12345/etc/cron.hourly/etc/cron.daily/etc/cron.dailyç›®çš„èƒ½å¤Ÿè‡ªåŠ¨åˆ é™¤ä¸ç»å¸¸ä½¿ç”¨çš„ä¸´æ—¶æ–‡ä»¶ä¸ºäº†ä¿è¯tmpç›®å½•ä¸çˆ†æ»¡ï¼Œç³»ç»Ÿé»˜è®¤æƒ…å†µä¸‹æ¯æ—¥ä¼šå¤„ç†ä¸€æ¬¡tmpç›®å½•æ–‡ä»¶ã€‚å®‰è£…1yum install tmpwatch -yåŠŸèƒ½è¯´æ˜åˆ é™¤æš‚å­˜æ–‡ä»¶(é»˜è®¤æ˜¯240å°æ—¶ï¼Œ10å¤©)tmpwatch æ˜¯ä¸“é—¨ç”¨äºè§£å†³â€œåˆ é™¤ xxx å¤©æ²¡æœ‰è¢«è®¿é—®/ä¿®æ”¹è¿‡çš„æ–‡ä»¶â€è¿™æ ·éœ€æ±‚çš„å‘½ä»¤ã€‚ä½¿ç”¨æ–¹å¼ä¹Ÿæå…¶ç®€å•ï¼šé™¤äº†åˆ é™¤tmp æ–‡ä»¶å¤¹ä¹‹å¤–ä¹Ÿå¯ä»¥åˆ é™¤ä»»ä½•å…¶ä»–æŒ‡å®šæ–‡ä»¶å¤¹è¯­æ³•tmpwatch [-afqv][â€“test][è¶…æœŸæ—¶é—´][ç›®å½•â€¦]æ‰§è¡ŒtmpwatchæŒ‡ä»¤å¯åˆ é™¤ä¸å¿…è¦çš„æš‚å­˜æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥è®¾ç½®æ–‡ä»¶è¶…æœŸæ—¶é—´ï¼Œå•ä½ä»¥å°æ—¶è®¡ç®—ã€‚ tmpwatch å‚æ•°è¯´æ˜123456789101112131415-u, --atime åŸºäºè®¿é—®æ—¶é—´æ¥åˆ é™¤æ–‡ä»¶ï¼Œé»˜è®¤çš„ã€‚-m, --mtime åŸºäºä¿®æ”¹æ—¶é—´æ¥åˆ é™¤æ–‡ä»¶ã€‚-c, --ctime åŸºäºåˆ›å»ºæ—¶é—´æ¥åˆ é™¤æ–‡ä»¶ï¼Œå¯¹äºç›®å½•ï¼ŒåŸºäºmtimeã€‚-M, --dirmtime åˆ é™¤ç›®å½•åŸºäºç›®å½•çš„ä¿®æ”¹æ—¶é—´è€Œä¸æ˜¯è®¿é—®æ—¶é—´ã€‚-a, --all åˆ é™¤æ‰€æœ‰çš„æ–‡ä»¶ç±»å‹ï¼Œä¸åªæ˜¯æ™®é€šæ–‡ä»¶ï¼Œç¬¦å·é“¾æ¥å’Œç›®å½•ã€‚-d, --nodirs ä¸å°è¯•åˆ é™¤ç›®å½•ï¼Œå³ä½¿æ˜¯ç©ºç›®å½•ã€‚-d, --nosymlinks ä¸å°è¯•åˆ é™¤ç¬¦å·é“¾æ¥ã€‚-f, --force å¼ºåˆ¶åˆ é™¤ã€‚-q, --quiet åªæŠ¥å‘Šé”™è¯¯ä¿¡æ¯ã€‚-s, --fuser å¦‚æœæ–‡ä»¶å·²ç»æ˜¯æ‰“å¼€çŠ¶æ€åœ¨åˆ é™¤å‰ï¼Œå°è¯•ä½¿ç”¨â€œå®šå½±â€å‘½ä»¤ã€‚é»˜è®¤ä¸å¯ç”¨ã€‚-t, --test ä»…ä½œæµ‹è¯•ï¼Œå¹¶ä¸çœŸçš„åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚-U, --exclude-user=user ä¸åˆ é™¤å±äºè°çš„æ–‡ä»¶ã€‚-v, --verbose æ‰“å°è¯¦ç»†ä¿¡æ¯ã€‚-x, --exclude=path æ’é™¤è·¯å¾„ï¼Œå¦‚æœè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå®ƒåŒ…å«çš„æ‰€æœ‰æ–‡ä»¶è¢«æ’é™¤äº†ã€‚å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ä¸åŒ…å«ç¬¦å·é“¾æ¥ã€‚-X, --exclude-pattern=pattern æ’é™¤æŸè§„åˆ™ä¸‹çš„è·¯å¾„ã€‚","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://www.wortyby.com/categories/å·¥å…·/"}],"tags":[{"name":"Linux å·¥å…·","slug":"Linux-å·¥å…·","permalink":"http://www.wortyby.com/tags/Linux-å·¥å…·/"},{"name":"æ¸…ç†","slug":"æ¸…ç†","permalink":"http://www.wortyby.com/tags/æ¸…ç†/"}]}]}